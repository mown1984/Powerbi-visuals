var powerbi;!function(e){!function(e){e[e.Grouping=0]="Grouping",e[e.Measure=1]="Measure",e[e.GroupingOrMeasure=2]="GroupingOrMeasure"}(e.VisualDataRoleKind||(e.VisualDataRoleKind={}));e.VisualDataRoleKind;!function(e){e[e.Create=0]="Create",e[e.Append=1]="Append"}(e.VisualDataChangeOperationKind||(e.VisualDataChangeOperationKind={}));e.VisualDataChangeOperationKind;!function(e){e[e.Data=2]="Data",e[e.Resize=4]="Resize",e[e.ViewMode=8]="ViewMode",e[e.Style=16]="Style",e[e.ResizeEnd=32]="ResizeEnd"}(e.VisualUpdateType||(e.VisualUpdateType={}));e.VisualUpdateType;!function(e){}(e.VisualPermissions||(e.VisualPermissions={}));var a;e.VisualPermissions;!function(e){var a;!function(e){!function(e){e[e.PowerBI=0]="PowerBI",e[e.External=1]="External",e[e.User=2]="User"}(e.ErrorSource||(e.ErrorSource={}));e.ErrorSource}(a=e.telemetry||(e.telemetry={}))}(a=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));

;var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){var e="",t=0;for(t=0;32>t;t+=1){var i=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=i.toString(16)}return e}e.generateGuid=t}(t=e.telemetry||(e.telemetry={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){e.ExtensibilityVisualApiUsage=function(t,i,n,o,r,s,a){void 0===r&&(r=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0);var u={name:t,apiVersion:i,custom:n,parentId:o,isError:r,errorSource:s,errorCode:a},c={name:"PBI.Extensibility.VisualApiUsage",category:1,time:Date.now(),id:e.generateGuid(),getFormattedInfoObject:function(){var t={name:u.name,apiVersion:u.apiVersion,custom:u.custom,parentId:u.parentId,isError:u.isError};return"undefined"!=typeof u.errorSource&&(t.errorSource=e.ErrorSource[u.errorSource]),"undefined"!=typeof u.errorCode&&(t.errorCode=u.errorCode),t},info:u,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.ExtensibilityVisualApiUsageLoggers&&(c.loggers=e.ExtensibilityVisualApiUsageLoggers),c},e.VisualException=function(t,i,n,o,r,s,a,u){var c={visualType:t,isCustom:i,apiVersion:n,source:o,lineNumber:r,columnNumber:s,stack:a,message:u},p={name:"PBI.VisualException",category:2,time:Date.now(),id:e.generateGuid(),getFormattedInfoObject:function(){var e={visualType:c.visualType,isCustom:c.isCustom,apiVersion:c.apiVersion,source:c.source,lineNumber:c.lineNumber,columnNumber:c.columnNumber,stack:c.stack,message:c.message};return e},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.VisualExceptionLoggers&&(p.loggers=e.VisualExceptionLoggers),p}}(t=e.telemetry||(e.telemetry={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return function(t){t.__capabilities__=e.capabilities}}e.VisualPlugin=t}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.hostServices=e.hostServices,this.selectedIds=[],this.promiseFactory=this.hostServices.promiseFactory()}return e.prototype.select=function(e,t){void 0===t&&(t=!1);var i=this.promiseFactory.defer();return this.hostServices.shouldRetainSelection()?this.sendSelectionToHost([e]):(this.selectInternal(e,t),this.sendSelectionToHost(this.selectedIds)),i.resolve(this.selectedIds),i.promise},e.prototype.showContextMenu=function(e,t){var i=this.promiseFactory.defer();return this.sendContextMenuToHost(e,t),i.resolve(null),i.promise},e.prototype.hasSelection=function(){return this.selectedIds.length>0},e.prototype.clear=function(){var e=this.promiseFactory.defer();return this.selectedIds=[],this.sendSelectionToHost([]),e.resolve(null),e.promise},e.prototype.getSelectionIds=function(){return this.selectedIds},e.prototype.sendSelectionToHost=function(e){var t={data:e.filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()})},i=this.getSelectorsByColumn(e);_.isEmpty(i)||(t.data2=i),this.hostServices.onSelect(t)},e.prototype.sendContextMenuToHost=function(e,t){var i=this.getSelectorsByColumn([e]);if(!_.isEmpty(i)){var n={data:i,position:t};this.hostServices.onContextMenu(n)}},e.prototype.getSelectorsByColumn=function(e){return _(e).filter(function(e){return e.hasIdentity}).map(function(e){return e.getSelectorsByColumn()}).compact().value()},e.prototype.selectInternal=function(t,i){e.containsSelection(this.selectedIds,t)?this.selectedIds=i?this.selectedIds.filter(function(e){return!t.equals(e)}):this.selectedIds.length>1?[t]:[]:i?this.selectedIds.push(t):this.selectedIds=[t]},e.containsSelection=function(e,t){return e.some(function(e){return t.equals(e)})},e}();e.SelectionManager=t}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function t(){}return t.prototype.withCategory=function(e,t){return e&&e.source&&e.source.queryName&&e.identity&&(this.ensureDataMap()[e.source.queryName]=e.identity[t]),this},t.prototype.withSeries=function(e,t){return e&&e.source&&e.source.queryName&&t&&(this.ensureDataMap()[e.source.queryName]=t.identity),this},t.prototype.withMeasure=function(e){return this.measure=e,this},t.prototype.createSelectionId=function(){return e.visuals.SelectionId.createWithSelectorForColumnAndMeasure(this.ensureDataMap(),this.measure)},t.prototype.ensureDataMap=function(){return this.dataMap||(this.dataMap={}),this.dataMap},t}();t.SelectionIdBuilder=i}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,i){var n={name:e.name,apiVersion:e.apiVersion,custom:!!e.custom};return new t.VisualSafeExecutionWrapper(new o(e,i),n,i)}var n=e.visuals.telemetry.ExtensibilityVisualApiUsage;t.visualApiVersions=[],t.createVisualAdapter=i;var o=function(){function i(t,i){this.telemetryService=i,this.plugin=t;var o=t.apiVersion,r=this.getVersionIndex(o),s=!1;o?r>-1?(this.apiVersionIndex=r,this.legacy=!1):s=!0:this.legacy=!0,this.telemetryService&&this.telemetryService.logEvent(n,this.plugin.name,this.plugin.apiVersion,!!this.plugin.custom,void 0,s,e.visuals.telemetry.ErrorSource.User)}return i.prototype.init=function(e){if(e.element.empty(),this.legacy)this.visual=this.plugin.create(),this.visualLegacy.init(e);else{var i=t.visualApiVersions[this.apiVersionIndex].hostAdapter(e.host);this.visual=this.plugin.create({element:e.element.get(0),host:i}),this.overloadMethods()}},i.prototype.update=function(t){t.type&e.VisualUpdateType.Resize&&this.visualHasMethod("onResizing")?this.onResizing(t.viewport,t.resizeMode):this.visualHasMethod("update")?this.visualLegacy.update(t):((!t.type||t.type&e.VisualUpdateType.Data)&&this.onDataChanged(_.pick(t,["dataViews","operationKind"])),t.type&e.VisualUpdateType.ViewMode&&this.onViewModeChanged(t.viewMode))},i.prototype.destroy=function(){this.visualHasMethod("destroy")&&this.visualLegacy.destroy()},i.prototype.enumerateObjectInstances=function(e){return this.visualHasMethod("enumerateObjectInstances")?this.visualLegacy.enumerateObjectInstances(e):void 0},i.prototype.enumerateObjectRepetition=function(){return this.visualHasMethod("enumerateObjectRepetition")?this.visualLegacy.enumerateObjectRepetition():void 0},i.prototype.onResizing=function(e,t){this.visualHasMethod("onResizing")&&this.visualLegacy.onResizing(e,t)},i.prototype.onDataChanged=function(e){this.visualHasMethod("onDataChanged")&&this.visualLegacy.onDataChanged(e)},i.prototype.onViewModeChanged=function(e){this.visualHasMethod("onViewModeChanged")&&this.visualLegacy.onViewModeChanged(e)},i.prototype.onClearSelection=function(){this.visualHasMethod("onClearSelection")&&this.visualLegacy.onClearSelection()},i.prototype.canResizeTo=function(e){return this.visualHasMethod("canResizeTo")?this.visualLegacy.canResizeTo(e):void 0},i.prototype.unwrap=function(){return this.visual},Object.defineProperty(i.prototype,"visualNew",{get:function(){return this.legacy?void 0:this.visual},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visualLegacy",{get:function(){return this.legacy?this.visual:void 0},enumerable:!0,configurable:!0}),i.prototype.visualHasMethod=function(e){var t=this.legacy?this.visualLegacy:this.visualNew;return t&&_.isFunction(t[e])},i.prototype.getVersionIndex=function(e){if(e)for(var i=t.visualApiVersions.length,n=0;i>n;n++)if(t.visualApiVersions[n].version===e)return n;return-1},i.prototype.overloadMethods=function(){var e=this.getCompiledOverloads();for(var t in e)this[t]=e[t]},i.prototype.getCompiledOverloads=function(){for(var e={},i=this.apiVersionIndex,n=this.visualNew,o=0;i>=o;o++){var r=t.visualApiVersions[o].overloads;_.isFunction(r)&&_.assign(e,r(n))}return e},i}();t.VisualAdapter=o}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.visuals.telemetry.VisualException,n=function(){function e(e,t,i,n){this.wrappedVisual=e,this.visualInfo=t,this.telemetryService=i,this.silent=n}return e.prototype.init=function(e){var t=this;this.wrappedVisual.init&&this.executeSafely(function(){return t.wrappedVisual.init(e)})},e.prototype.destroy=function(){var e=this;this.wrappedVisual.destroy&&this.executeSafely(function(){return e.wrappedVisual.destroy()})},e.prototype.update=function(e){var t=this;this.wrappedVisual.update&&this.executeSafely(function(){return t.wrappedVisual.update(e)})},e.prototype.onResizing=function(e,t){var i=this;this.wrappedVisual.onResizing&&this.executeSafely(function(){return i.wrappedVisual.onResizing(e,t)})},e.prototype.onDataChanged=function(e){var t=this;this.wrappedVisual.onDataChanged&&this.executeSafely(function(){return t.wrappedVisual.onDataChanged(e)})},e.prototype.onViewModeChanged=function(e){var t=this;this.wrappedVisual.onViewModeChanged&&this.executeSafely(function(){return t.wrappedVisual.onViewModeChanged(e)})},e.prototype.onClearSelection=function(){var e=this;this.wrappedVisual.onClearSelection&&this.executeSafely(function(){return e.wrappedVisual.onClearSelection()})},e.prototype.canResizeTo=function(e){var t=this;return this.wrappedVisual.canResizeTo?this.executeSafely(function(){return t.wrappedVisual.canResizeTo(e)}):void 0},e.prototype.enumerateObjectInstances=function(e){var t=this;return this.wrappedVisual.enumerateObjectInstances?this.executeSafely(function(){return t.wrappedVisual.enumerateObjectInstances(e)}):void 0},e.prototype.enumerateObjectRepetition=function(){var e=this;return this.wrappedVisual.enumerateObjectRepetition?this.executeSafely(function(){return e.wrappedVisual.enumerateObjectRepetition()}):void 0},e.prototype.unwrap=function(){var e=this.wrappedVisual;return e.unwrap?e.unwrap():e},e.prototype.isCustomVisual=function(){return this.visualInfo.custom},e.prototype.executeSafely=function(e){try{return e()}catch(t){!this.silent,this.telemetryService&&this.telemetryService.logEvent(i,this.visualInfo.name,this.visualInfo.custom,this.visualInfo.apiVersion,t.fileName,t.lineNumber,t.columnNumber,t.stack,t.message)}},e}();t.VisualSafeExecutionWrapper=n}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var n=function(t){return{update:function(i){if(t.update){var n=i.type||e.VisualUpdateType.Data;n&e.VisualUpdateType.Resize&&2===i.resizeMode&&(n|=e.VisualUpdateType.ResizeEnd),t.update({viewport:i.viewport,dataViews:i.dataViews,type:n})}},destroy:function(){t.destroy&&t.destroy()},enumerateObjectInstances:function(e){return t.enumerateObjectInstances?t.enumerateObjectInstances(e):void 0}}},o=function(e){return{}};t.visualApiVersions.push({version:"1.0.0",overloads:n,hostAdapter:o})}(i=t.v100||(t.v100={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var n=function(i){return{createSelectionIdBuilder:function(){return new e.visuals.SelectionIdBuilder},createSelectionManager:function(){return new t.SelectionManager({hostServices:i})}}};t.visualApiVersions.push({version:"1.1.0",hostAdapter:n})}(i=t.v110||(t.v110={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));

;var jsCommon;!function(e){var t;!function(e){e.escKeyCode=27,e.enterKeyCode=13,e.tabKeyCode=9,e.upArrowKeyCode=38,e.downArrowKeyCode=40,e.leftArrowKeyCode=37,e.rightArrowKeyCode=39,e.homeKeyCode=36,e.endKeyCode=35,e.backSpaceKeyCode=8,e.deleteKeyCode=46,e.spaceKeyCode=32,e.shiftKeyCode=16,e.ctrlKeyCode=17,e.altKeyCode=18,e.aKeyCode=65,e.cKeyCode=67,e.sKeyCode=83,e.vKeyCode=86,e.wKeyCode=87,e.xKeyCode=88,e.yKeyCode=89,e.zKeyCode=90,e.DocumentBody="body",e.Anchor="a",e.EditableTextElements=":text, textarea",e.EditableNumericElements='[type="number"]',e.disabledAttributeOrValue="disabled",e.readonlyAttributeOrValue="readonly",e.idAttribute="id",e.styleAttribute="style",e.hrefAttribute="href",e.targetAttribute="target",e.blankValue="_blank",e.selfValue="_self",e.classAttribute="class",e.titleAttribute="title",e.srcAttribute="src",e.contextmenuEventName="contextmenu",e.blurEventName="blur",e.keyUpEventName="keyup",e.inputEventName="input",e.changeEventName="change",e.cutEventName="cut",e.keyDownEventName="keydown",e.mouseMoveEventName="mousemove",e.mouseDownEventName="mousedown",e.mouseEnterEventName="mouseenter",e.mouseLeaveEventName="mouseleave",e.mouseOverEventName="mouseover",e.mouseOutEventName="mouseout",e.mouseClickEventName="click",e.pasteEventName="paste",e.scrollEventName="scroll",e.dropEventName="drop",e.focusEventName="focus",e.focusInEventName="focusin",e.focusOutEventName="focusout",e.selectEventName="select",e.messageEventName="message",e.loadEventName="load",e.beforeUnload="beforeunload",e.inputAndSelectEventNames="input, select"}(t=e.DOMConstants||(e.DOMConstants={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){!function(e){e[e.ResourceCodeReference=0]="ResourceCodeReference",e[e.EmbeddedString=1]="EmbeddedString"}(e.PowerBIErrorResourceType||(e.PowerBIErrorResourceType={}));var t=e.PowerBIErrorResourceType,r=function(){function e(e){this.m_serviceError=e}return Object.defineProperty(e.prototype,"code",{get:function(){return e.codeName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.httpRequestId},set:function(e){this.httpRequestId=e},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t;return t=6===this.m_serviceError.statusCode?n.GetDetailsFromTransformError(e,this.m_serviceError):n.GetDetailsFromServerErrorStatusCode(e,this.m_serviceError.statusCode),n.addAdditionalInfo(t,this.m_serviceError.errorDetails,e),n.addDebugErrorInfo(t,this.code,this.m_serviceError.message||null,this.m_serviceError.stackTrace||null),t},e.codeName="ServiceErrorToClientError",e}();e.ServiceErrorToClientError=r;var n=function(){function r(){}return r.addAdditionalInfo=function(e,n,o){if(n)for(var i=0;i<n.length;i++){var a=n[i],s=o.getOptional(r.serverErrorPrefix+a.code),u={errorInfoKey:s?s:a.code,errorInfoValue:a.detail.type===t.ResourceCodeReference?o.get(r.serverErrorPrefix+a.detail.value):a.detail.value};e.displayableErrorInfo.push(u)}return e},r.addDebugErrorInfo=function(t,r,n,o){return t.debugErrorInfo=t.debugErrorInfo||[],r&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.ClientErrorCode,errorInfoValue:r}),n&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.ErrorDetails,errorInfoValue:n}),o&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.StackTrace,errorInfoValue:o}),t},r.GetDetailsFromTransformError=function(e,t){var r=e.get("ServiceError_CannotLoadVisual"),n=e.get("ServiceError_CannotLoadVisual"),o=t.message,i=[];i.push({errorInfoKey:n,errorInfoValue:o});var a={message:r,displayableErrorInfo:i};return a},r.GetDetailsFromServerErrorStatusCode=function(e,t){var r="",n="",o="";switch(t){case 2:r=e.get("ServiceError_ModelCannotLoad"),n=e.get("ServiceError_ModelConvertFailureKey"),o=e.get("ServiceError_ModelConvertFailureValue");break;case 3:r=e.get("ServiceError_ModelCannotLoad"),n=e.get("ServiceError_ModelCreationFailureKey"),o=e.get("ServiceError_ModelCreationFailureValue");break;case 1:r=e.get("ServiceError_ModelCannotLoad"),n=e.get("ServiceError_ModelFetchingFailureKey"),o=e.get("ServiceError_ModelFetchingFailureValue");break;case 4:r=e.get("ServiceError_CannotLoadVisual"),n=e.get("ServiceError_ExecuteSemanticQueryErrorKey"),o=e.get("ServiceError_ExecuteSemanticQueryErrorValue");break;case 5:r=e.get("ServiceError_CannotLoadVisual"),n=e.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatKey"),o=e.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatValue");break;case 0:default:r=e.get("ServiceError_GeneralError"),n=e.get("ServiceError_GeneralErrorKey"),o=e.get("ServiceError_GeneralErrorValue")}var i=[];i.push({errorInfoKey:n,errorInfoValue:o});var a={message:r,displayableErrorInfo:i};return a},r.serverErrorPrefix="ServerError_",r}();e.PowerBIErrorDetailHelper=n}(powerbi||(powerbi={}));var powerbi;!function(e){}(powerbi||(powerbi={}));var powerbi;if(function(e){function t(e){return new n(e)}e.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"},e.createGeoTaggingAnalyzerService=t;var r={GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",GeotaggingString_VRMBackCompat_CountryRegion:"CountryRegion",GeotaggingString_VRMBackCompat_StateOrProvince:"StateOrProvince"},n=function(){function t(e){this.GeotaggingString_VRMBackCompat_CountryRegion="CountryRegion",this.GeotaggingString_VRMBackCompat_StateOrProvince="StateOrProvince",this.GeotaggingString_Continent=e("GeotaggingString_Continent").toLowerCase(),this.GeotaggingString_Continents=e("GeotaggingString_Continents").toLowerCase(),this.GeotaggingString_Country=e("GeotaggingString_Country").toLowerCase(),this.GeotaggingString_Countries=e("GeotaggingString_Countries").toLowerCase(),this.GeotaggingString_State=e("GeotaggingString_State").toLowerCase(),this.GeotaggingString_States=e("GeotaggingString_States").toLowerCase(),this.GeotaggingString_City=e("GeotaggingString_City").toLowerCase(),this.GeotaggingString_Cities=e("GeotaggingString_Cities").toLowerCase(),this.GeotaggingString_Town=e("GeotaggingString_Town").toLowerCase(),this.GeotaggingString_Towns=e("GeotaggingString_Towns").toLowerCase(),this.GeotaggingString_Province=e("GeotaggingString_Province").toLowerCase(),this.GeotaggingString_Provinces=e("GeotaggingString_Provinces").toLowerCase(),this.GeotaggingString_County=e("GeotaggingString_County").toLowerCase(),this.GeotaggingString_Counties=e("GeotaggingString_Counties").toLowerCase(),this.GeotaggingString_Village=e("GeotaggingString_Village").toLowerCase(),this.GeotaggingString_Villages=e("GeotaggingString_Villages").toLowerCase(),this.GeotaggingString_Post=e("GeotaggingString_Post").toLowerCase(),this.GeotaggingString_Zip=e("GeotaggingString_Zip").toLowerCase(),this.GeotaggingString_Code=e("GeotaggingString_Code").toLowerCase(),this.GeotaggingString_Place=e("GeotaggingString_Place").toLowerCase(),this.GeotaggingString_Places=e("GeotaggingString_Places").toLowerCase(),this.GeotaggingString_Address=e("GeotaggingString_Address").toLowerCase(),this.GeotaggingString_Addresses=e("GeotaggingString_Addresses").toLowerCase(),this.GeotaggingString_Street=e("GeotaggingString_Street").toLowerCase(),this.GeotaggingString_Streets=e("GeotaggingString_Streets").toLowerCase(),this.GeotaggingString_Longitude=e("GeotaggingString_Longitude").toLowerCase(),this.GeotaggingString_Longitude_Short=e("GeotaggingString_Longitude_Short").toLowerCase(),this.GeotaggingString_Latitude=e("GeotaggingString_Latitude").toLowerCase(),this.GeotaggingString_Latitude_Short=e("GeotaggingString_Latitude_Short").toLowerCase(),this.GeotaggingString_PostalCode=e("GeotaggingString_PostalCode").toLowerCase(),this.GeotaggingString_PostalCodes=e("GeotaggingString_PostalCodes").toLowerCase(),this.GeotaggingString_ZipCode=e("GeotaggingString_ZipCode").toLowerCase(),this.GeotaggingString_ZipCodes=e("GeotaggingString_ZipCodes").toLowerCase(),this.GeotaggingString_Territory=e("GeotaggingString_Territory").toLowerCase(),this.GeotaggingString_Territories=e("GeotaggingString_Territories").toLowerCase()}return t.prototype.isLongitudeOrLatitude=function(e){return this.isLongitude(e)||this.isLatitude(e)},t.prototype.isGeographic=function(e){return this.isLongitudeOrLatitude(e)||this.isGeocodable(e)},t.prototype.isGeocodable=function(e){return this.isAddress(e)||this.isCity(e)||this.isContinent(e)||this.isCountry(e)||this.isCounty(e)||this.isStateOrProvince(e)||this.isPlace(e)||this.isPostalCode(e)||this.isTerritory(e)},t.prototype.isGeoshapable=function(e){return this.isCity(e)||this.isCountry(e)||this.isCounty(e)||this.isStateOrProvince(e)||this.isPostalCode(e)||this.isTerritory(e)||this.isGeoshapableEnglish(e)},t.prototype.isGeoshapableEnglish=function(e){return this.isEnglishCity(e)||this.isEnglishCountry(e)||this.isEnglishCounty(e)||this.isEnglishStateOrProvince(e)||this.isEnglishPostalCode(e)||this.isEnglishTerritory(e)},t.prototype.isAddress=function(e){return t.hasMatches(e,[this.GeotaggingString_Address,this.GeotaggingString_Addresses,this.GeotaggingString_Street,this.GeotaggingString_Streets])},t.prototype.isPlace=function(e){return t.hasMatches(e,[this.GeotaggingString_Place,this.GeotaggingString_Places])},t.prototype.isCity=function(e){return t.hasMatches(e,[this.GeotaggingString_City,this.GeotaggingString_Cities,this.GeotaggingString_Town,this.GeotaggingString_Towns,this.GeotaggingString_Village,this.GeotaggingString_Villages])},t.prototype.isStateOrProvince=function(e){return t.hasMatches(e,[this.GeotaggingString_State,this.GeotaggingString_States,this.GeotaggingString_Province,this.GeotaggingString_Provinces,this.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isCountry=function(e){return t.hasMatches(e,[this.GeotaggingString_Country,this.GeotaggingString_Countries,this.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isCounty=function(e){return t.hasMatches(e,[this.GeotaggingString_County,this.GeotaggingString_Counties])},t.prototype.isContinent=function(e){return t.hasMatches(e,[this.GeotaggingString_Continent,this.GeotaggingString_Continents])},t.prototype.isPostalCode=function(e){var r=t.hasMatches(e,[this.GeotaggingString_Post,this.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[this.GeotaggingString_PostalCode,this.GeotaggingString_PostalCodes,this.GeotaggingString_ZipCode,this.GeotaggingString_ZipCodes]);if(!r){var n=/\s+/,o=e.replace(n,"");r=t.hasMatches(o,[this.GeotaggingString_PostalCode.replace(n,""),this.GeotaggingString_PostalCodes.replace(n,""),this.GeotaggingString_ZipCode.replace(n,""),this.GeotaggingString_ZipCodes.replace(n,"")])}return r},t.prototype.isLongitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Longitude])||t.hasMatches(e,[this.GeotaggingString_Longitude_Short],!0)},t.prototype.isLatitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Latitude])||t.hasMatches(e,[this.GeotaggingString_Latitude_Short],!0)},t.prototype.isTerritory=function(e){return t.hasMatches(e,[this.GeotaggingString_Territory,this.GeotaggingString_Territories])},t.hasMatches=function(e,t,r){for(var n=/\W/,o=e.toLowerCase(),i=0,a=t.length;a>i;i++){var s=t[i].toLowerCase();if(r){var u=o.indexOf(s);if(u>-1){var g=void 0,c=void 0;if(g=c=!0,u-1>0&&(c=n.test(o[u-1])),u+s.length<o.length&&(g=n.test(o[u+s.length])),c&&g)return!0}}else if(o.indexOf(s)>-1)return!0}return!1},t.prototype.getFieldType=function(t){return null!=t?this.isLatitude(t)?e.CategoryTypes.Latitude:this.isLongitude(t)?e.CategoryTypes.Longitude:this.isPostalCode(t)?e.CategoryTypes.PostalCode:this.isAddress(t)?e.CategoryTypes.Address:this.isPlace(t)?e.CategoryTypes.Place:this.isCity(t)?e.CategoryTypes.City:this.isCountry(t)?e.CategoryTypes.CountryRegion:this.isCounty(t)?e.CategoryTypes.County:this.isStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isContinent(t)?e.CategoryTypes.Continent:this.getEnglishFieldType(t):void 0},t.prototype.isEnglishAddress=function(e){return t.hasMatches(e,[r.GeotaggingString_Address,r.GeotaggingString_Addresses,r.GeotaggingString_Street,r.GeotaggingString_Streets])},t.prototype.isEnglishPlace=function(e){return t.hasMatches(e,[r.GeotaggingString_Place,r.GeotaggingString_Places])},t.prototype.isEnglishCity=function(e){return t.hasMatches(e,[r.GeotaggingString_City,r.GeotaggingString_Cities,r.GeotaggingString_Town,r.GeotaggingString_Towns,r.GeotaggingString_Village,r.GeotaggingString_Villages])},t.prototype.isEnglishStateOrProvince=function(e){return t.hasMatches(e,[r.GeotaggingString_State,r.GeotaggingString_States,r.GeotaggingString_Province,r.GeotaggingString_Provinces,r.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isEnglishCountry=function(e){return t.hasMatches(e,[r.GeotaggingString_Country,r.GeotaggingString_Countries,r.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isEnglishCounty=function(e){return t.hasMatches(e,[r.GeotaggingString_County,r.GeotaggingString_Counties])},t.prototype.isEnglishContinent=function(e){return t.hasMatches(e,[r.GeotaggingString_Continent,r.GeotaggingString_Continents])},t.prototype.isEnglishPostalCode=function(e){var n=t.hasMatches(e,[r.GeotaggingString_Post,r.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[r.GeotaggingString_PostalCode,r.GeotaggingString_PostalCodes,r.GeotaggingString_ZipCode,r.GeotaggingString_ZipCodes]);if(!n){var o=new RegExp("s");n=t.hasMatches(e,[r.GeotaggingString_PostalCode.replace(o,""),r.GeotaggingString_PostalCodes.replace(o,""),r.GeotaggingString_ZipCode.replace(o,""),r.GeotaggingString_ZipCodes.replace(o,"")])}return n},t.prototype.isEnglishLongitude=function(e){return t.hasMatches(e,[r.GeotaggingString_Longitude])||t.hasMatches(e,[r.GeotaggingString_Longitude_Short],!0)},t.prototype.isEnglishLatitude=function(e){return t.hasMatches(e,[r.GeotaggingString_Latitude])||t.hasMatches(e,[r.GeotaggingString_Latitude_Short],!0)},t.prototype.isEnglishTerritory=function(e){return t.hasMatches(e,[r.GeotaggingString_Territory,r.GeotaggingString_Territories])},t.prototype.getEnglishFieldType=function(t){return null!=t?this.isEnglishLatitude(t)?e.CategoryTypes.Latitude:this.isEnglishLongitude(t)?e.CategoryTypes.Longitude:this.isEnglishPostalCode(t)?e.CategoryTypes.PostalCode:this.isEnglishAddress(t)?e.CategoryTypes.Address:this.isEnglishPlace(t)?e.CategoryTypes.Place:this.isEnglishCity(t)?e.CategoryTypes.City:this.isEnglishCountry(t)?e.CategoryTypes.CountryRegion:this.isEnglishCounty(t)?e.CategoryTypes.County:this.isEnglishStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isEnglishContinent(t)?e.CategoryTypes.Continent:void 0:void 0},t}();e.GeoTaggingAnalyzerService=n}(powerbi||(powerbi={})),"undefined"==typeof DEBUG)var DEBUG=!0;var powerbi;!function(e){var t;!function(e){e.ClientErrorCode="Client Error Code",e.ErrorCode="Error Code",e.ErrorDetails="Error Details",e.HttpRequestId="HTTP Request Id",e.JobId="Job Id",e.ODataErrorMessage="OData Error Message",e.StackTrace="Stack Trace"}(t=e.ClientErrorStrings||(e.ClientErrorStrings={}));var r=function(){function e(e){this.errorCode=e}return Object.defineProperty(e.prototype,"code",{get:function(){return this.errorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var r={message:e.get("ClientError_UnknownClientErrorValue"),displayableErrorInfo:[{errorInfoKey:e.get("ClientError_UnknownClientErrorKey"),errorInfoValue:e.get("ClientError_UnknownClientErrorValue")}],debugErrorInfo:[{errorInfoKey:t.ClientErrorCode,errorInfoValue:this.code}]};return r},e}();e.UnknownClientError=r;var n=function(){function e(e,t){this.httpStatusCode=e,this.httpRequestId=t}return Object.defineProperty(e.prototype,"code",{get:function(){return"HttpClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.httpRequestId},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var r={message:null,displayableErrorInfo:[{errorInfoKey:e.get("DsrError_Key"),errorInfoValue:e.get("DsrError_UnknownErrorValue")},{errorInfoKey:e.get("ClientError_HttpResponseStatusCodeKey"),errorInfoValue:this.httpStatusCode.toString()}],debugErrorInfo:[{errorInfoKey:t.HttpRequestId,errorInfoValue:this.httpRequestId},{errorInfoKey:t.ClientErrorCode,errorInfoValue:this.code}]};return r},e}();e.HttpClientError=n;var o=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"IgnorableClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t={message:"",displayableErrorInfo:[]};return t},e}();e.IgnorableClientError=o}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){for(var r=[],n=e.length-1;n>=0;--n)-1!==t.indexOf(e[n])&&r.push(e[n]);return r}function r(e,t){for(var r=[],n=e.length-1;n>=0;--n){var o=e[n];-1===t.indexOf(o)&&r.push(o)}return r}function n(e){for(var t=[],r=0,n=e.length;n>r;r++){var o=e[r];-1===t.indexOf(o)&&t.push(o)}return t}function o(e,t){for(var r=0,n=t.length;n>r;++r)i(e,t[r])}function i(e,t){e.indexOf(t)<0&&e.push(t)}function a(e,t,r){for(var n=[],o=t;r>=o;++o)n.push(e[o]);return n}function s(e,t){for(var r=[],n=0;t>n;++n)r.push(e[n]);return r}function u(e){return s(e,e.length)}function g(e,t,r){if(e===t)return!0;if(!!e!=!!t)return!1;var n=e.length;if(n!==t.length)return!1;for(var o=0;n>o&&r(e[o],t[o]);)++o;return o===n}function c(e){return e&&0===e.length?null:e}function l(e,t){for(var r=0,n=e.length;n>r;++r)if(t(e[r]))return r;return-1}function f(e,t){if(0===t)return e.slice();var r=e.slice(t);return Array.prototype.push.apply(r,e.slice(0,t)),r}function d(){return p([])}function p(e){var t=e;return t.withId=m,t}function h(e,t){for(var r=0,n=e.length;n>r;r++){var o=e[r];if(o.id===t)return o}}function m(t){return e.findWithId(this,t)}function y(){return v([])}function v(e){var t=e;return t.withName=w,t}function C(e,t){var r=S(e,t);return r>=0?e[r]:void 0}function S(e,t){for(var r=0,n=e.length;n>r;r++){var o=e[r];if(o.name===t)return r}return-1}function E(e,t){for(var r=e.length,n=r-1;n>=0;n--){var o=e[n]-t;if(0===o)return!1;if(!(o>0))return e.splice(n+1,0,t),!0}return e.unshift(t),!0}function b(e,t){var r=e.indexOf(t);return 0>r?!1:(e.splice(r,1),!0)}function w(e){var t=this;return C(t,e)}function T(e){if(e)for(;e.length>0;)e.pop()}function x(e){return!e||0===e.length}function G(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function P(e,t,r){return _.any(e,function(e){return r(e,t)})}function I(e){for(var t=e;null!=t;){if(_.isArray(t))return!0;t=Object.getPrototypeOf(t)}return!1}e.intersect=t,e.diff=r,e.distinct=n,e.union=o,e.unionSingle=i,e.range=a,e.take=s,e.copy=u,e.sequenceEqual=g,e.emptyToNull=c,e.indexOf=l,e.rotate=f,e.createWithId=d,e.extendWithId=p,e.findWithId=h,e.createWithName=y,e.extendWithName=v,e.findItemWithName=C,e.indexWithName=S,e.insertSorted=E,e.removeFirst=b,e.clear=T,e.isUndefinedOrEmpty=x,e.swap=G,e.isInArray=P,e.isArrayOrInheritedArray=I}(t=e.ArrayExtensions||(e.ArrayExtensions={}))}(jsCommon||(jsCommon={}));var InJs;!function(e){var t;!function(e){function t(){return $("<div/>")}function r(){return $("<span/>")}function n(){return $('<input type="checkbox"/>')}function o(){return $("<ul/>")}function i(){return $("<li/>")}function a(){return $('<input type="button"/>')}function s(){return $("<select/>")}function u(){return $('<input type="text"/>')}function g(){return $("<img/>")}function c(){return $("<iframe/>")}e.div=t,e.span=r,e.checkbox=n,e.ul=o,e.li=i,e.button=a,e.select=s,e.textBox=u,e.img=g,e.iframe=c}(t=e.DomFactory||(e.DomFactory={}))}(InJs||(InJs={}));var powerbi;!function(e){function t(e,t){return void 0!==e?e:t}var r;!function(e){function r(t){return t>=0?t<e.POSITIVE_POWERS.length?e.POSITIVE_POWERS[t]:1/0:(t=-t,t>0&&t<e.NEGATIVE_POWERS.length?e.NEGATIVE_POWERS[t]:0)}function n(t){if(t>1&&1e16>t)return 1e8>t?1e4>t?100>t?10>t?0:1:1e3>t?2:3:1e6>t?1e5>t?4:5:1e7>t?6:7:1e12>t?1e10>t?1e9>t?8:9:1e11>t?10:11:1e14>t?1e13>t?12:13:1e15>t?14:15;if(t>1e-16&&1>t)return 1e-8>t?1e-12>t?1e-14>t?1e-15>t?-16:-15:1e-13>t?-14:-13:1e-10>t?1e-11>t?-12:-11:1e-9>t?-10:-9:1e-4>t?1e-6>t?1e-7>t?-8:-7:1e-5>t?-6:-5:.01>t?.001>t?-4:-3:.1>t?-2:-1;var r=Math.log(t)/e.LOG_E_10;return e.floorWithPrecision(r)}function o(t,r){if(void 0===r&&(r=e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS),t){var n=e.log10(Math.abs(t));if(n<e.MIN_EXP)return 0;var o=Math.max(n-r,-e.NEGATIVE_POWERS.length+1);return e.pow10(o)}}function i(r,n,o){return o=t(o,e.DEFAULT_PRECISION),r===n||Math.abs(r-n)<o}function a(r,n,o){return o=t(o,e.DEFAULT_PRECISION),n>r&&Math.abs(r-n)>o}function s(r,n,o){return o=t(o,e.DEFAULT_PRECISION),n>r||Math.abs(r-n)<o}function u(r,n,o){return o=t(o,e.DEFAULT_PRECISION),r>n&&Math.abs(r-n)>o}function g(r,n,o){return o=t(o,e.DEFAULT_PRECISION),r>n||Math.abs(r-n)<o}function c(r,n){n=t(n,e.DEFAULT_PRECISION);var o=Math.round(r);return Math.abs(r-o)<n?o:Math.floor(r)}function l(r,n){n=t(n,e.DEFAULT_PRECISION);var o=Math.round(r);return Math.abs(r-o)<n?o:Math.ceil(r)}function f(r,n){return n=t(n,e.DEFAULT_PRECISION),0===n||0===r?r:Math.floor(r/n)*n}function d(r,n){return n=t(n,e.DEFAULT_PRECISION),0===n||0===r?r:Math.ceil(r/n)*n}function p(r,n){if(n=t(n,e.DEFAULT_PRECISION),0===n||0===r)return r;var o=Math.round(r/n)*n,i=Math.round(e.log10(Math.abs(r))-e.log10(n))+1;return i>0&&16>i&&(o=parseFloat(o.toPrecision(i))),o}function h(e,t,r){return void 0===e||null===e?e:t>e?t:e>r?r:e}function m(e){return.5+e<<0}function y(e,t,r,n,o){if(0===r||0===o)return e>=t&&t+r>=e?n:NaN;var i=(e-t)/r,a=n+i*o;return a}function v(e){return p(e,o(e))}function C(e){return null!==e&&e%1===0}function S(e,t){return Math.round(e/t)*t}e.MIN_VALUE=-Number.MAX_VALUE,e.MAX_VALUE=Number.MAX_VALUE,e.MIN_EXP=-308,e.MAX_EXP=308,e.EPSILON=1e-323,e.DEFAULT_PRECISION=1e-4,e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS=12,e.LOG_E_10=Math.log(10),e.POSITIVE_POWERS=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16,1e17,1e18,1e19,1e20,1e21,1e22,1e23,1e24,1e25,1e26,1e27,1e28,1e29,1e30,1e31,1e32,1e33,1e34,1e35,1e36,1e37,1e38,1e39,1e40,1e41,1e42,1e43,1e44,1e45,1e46,1e47,1e48,1e49,1e50,1e51,1e52,1e53,1e54,1e55,1e56,1e57,1e58,1e59,1e60,1e61,1e62,1e63,1e64,1e65,1e66,1e67,1e68,1e69,1e70,1e71,1e72,1e73,1e74,1e75,1e76,1e77,1e78,1e79,1e80,1e81,1e82,1e83,1e84,1e85,1e86,1e87,1e88,1e89,1e90,1e91,1e92,1e93,1e94,1e95,1e96,1e97,1e98,1e99,1e100,1e101,1e102,1e103,1e104,1e105,1e106,1e107,1e108,1e109,1e110,1e111,1e112,1e113,1e114,1e115,1e116,1e117,1e118,1e119,1e120,1e121,1e122,1e123,1e124,1e125,1e126,1e127,1e128,1e129,1e130,1e131,1e132,1e133,1e134,1e135,1e136,1e137,1e138,1e139,1e140,1e141,1e142,1e143,1e144,1e145,1e146,1e147,1e148,1e149,1e150,1e151,1e152,1e153,1e154,1e155,1e156,1e157,1e158,1e159,1e160,1e161,1e162,1e163,1e164,1e165,1e166,1e167,1e168,1e169,1e170,1e171,1e172,1e173,1e174,1e175,1e176,1e177,1e178,1e179,1e180,1e181,1e182,1e183,1e184,1e185,1e186,1e187,1e188,1e189,1e190,1e191,1e192,1e193,1e194,1e195,1e196,1e197,1e198,1e199,1e200,1e201,1e202,1e203,1e204,1e205,1e206,1e207,1e208,1e209,1e210,1e211,1e212,1e213,1e214,1e215,1e216,1e217,1e218,1e219,1e220,1e221,1e222,1e223,1e224,1e225,1e226,1e227,1e228,1e229,1e230,1e231,1e232,1e233,1e234,1e235,1e236,1e237,1e238,1e239,1e240,1e241,1e242,1e243,1e244,1e245,1e246,1e247,1e248,1e249,1e250,1e251,1e252,1e253,1e254,1e255,1e256,1e257,1e258,1e259,1e260,1e261,1e262,1e263,1e264,1e265,1e266,1e267,1e268,1e269,1e270,1e271,1e272,1e273,1e274,1e275,1e276,1e277,1e278,1e279,1e280,1e281,1e282,1e283,1e284,1e285,1e286,1e287,1e288,1e289,1e290,1e291,1e292,1e293,1e294,1e295,1e296,1e297,1e298,1e299,1e300,1e301,1e302,1e303,1e304,1e305,1e306,1e307,1e308],e.NEGATIVE_POWERS=[1,.1,.01,.001,1e-4,1e-5,1e-6,1e-7,1e-8,1e-9,1e-10,1e-11,1e-12,1e-13,1e-14,1e-15,1e-16,1e-17,1e-18,1e-19,1e-20,1e-21,1e-22,1e-23,1e-24,1e-25,1e-26,1e-27,1e-28,1e-29,1e-30,1e-31,1e-32,1e-33,1e-34,1e-35,1e-36,1e-37,1e-38,1e-39,1e-40,1e-41,1e-42,1e-43,1e-44,1e-45,1e-46,1e-47,1e-48,1e-49,1e-50,1e-51,1e-52,1e-53,1e-54,1e-55,1e-56,1e-57,1e-58,1e-59,1e-60,1e-61,1e-62,1e-63,1e-64,1e-65,1e-66,1e-67,1e-68,1e-69,1e-70,1e-71,1e-72,1e-73,1e-74,1e-75,1e-76,1e-77,1e-78,1e-79,1e-80,1e-81,1e-82,1e-83,1e-84,1e-85,1e-86,1e-87,1e-88,1e-89,1e-90,1e-91,1e-92,1e-93,1e-94,1e-95,1e-96,1e-97,1e-98,1e-99,1e-100,1e-101,1e-102,1e-103,1e-104,1e-105,1e-106,1e-107,1e-108,1e-109,1e-110,1e-111,1e-112,1e-113,1e-114,1e-115,1e-116,1e-117,1e-118,1e-119,1e-120,1e-121,1e-122,1e-123,1e-124,1e-125,1e-126,1e-127,1e-128,1e-129,1e-130,1e-131,1e-132,1e-133,1e-134,1e-135,1e-136,1e-137,1e-138,1e-139,1e-140,1e-141,1e-142,1e-143,1e-144,1e-145,1e-146,1e-147,1e-148,1e-149,1e-150,1e-151,1e-152,1e-153,1e-154,1e-155,1e-156,1e-157,1e-158,1e-159,1e-160,1e-161,1e-162,1e-163,1e-164,1e-165,1e-166,1e-167,1e-168,1e-169,1e-170,1e-171,1e-172,1e-173,1e-174,1e-175,1e-176,1e-177,1e-178,1e-179,1e-180,1e-181,1e-182,1e-183,1e-184,1e-185,1e-186,1e-187,1e-188,1e-189,1e-190,1e-191,1e-192,1e-193,1e-194,1e-195,1e-196,1e-197,1e-198,1e-199,1e-200,1e-201,1e-202,1e-203,1e-204,1e-205,1e-206,1e-207,1e-208,1e-209,1e-210,1e-211,1e-212,1e-213,1e-214,1e-215,1e-216,1e-217,1e-218,1e-219,1e-220,1e-221,1e-222,1e-223,1e-224,1e-225,1e-226,1e-227,1e-228,1e-229,1e-230,1e-231,1e-232,1e-233,1e-234,1e-235,1e-236,1e-237,1e-238,1e-239,1e-240,1e-241,1e-242,1e-243,1e-244,1e-245,1e-246,1e-247,1e-248,1e-249,1e-250,1e-251,1e-252,1e-253,1e-254,1e-255,1e-256,1e-257,1e-258,1e-259,1e-260,1e-261,1e-262,1e-263,1e-264,1e-265,1e-266,1e-267,1e-268,1e-269,1e-270,1e-271,1e-272,1e-273,1e-274,1e-275,1e-276,1e-277,1e-278,1e-279,1e-280,1e-281,1e-282,1e-283,1e-284,1e-285,1e-286,1e-287,1e-288,1e-289,1e-290,1e-291,1e-292,1e-293,1e-294,1e-295,1e-296,1e-297,1e-298,1e-299,1e-300,1e-301,1e-302,1e-303,1e-304,1e-305,1e-306,1e-307,1e-308,1e-309,1e-310,1e-311,1e-312,1e-313,1e-314,1e-315,1e-316,1e-317,1e-318,1e-319,1e-320,1e-321,1e-322,1e-323,0],e.pow10=r,e.log10=n,e.getPrecision=o,e.equalWithPrecision=i,e.lessWithPrecision=a,e.lessOrEqualWithPrecision=s,e.greaterWithPrecision=u,e.greaterOrEqualWithPrecision=g,e.floorWithPrecision=c,e.ceilWithPrecision=l,e.floorToPrecision=f,e.ceilToPrecision=d,e.roundToPrecision=p,e.ensureInRange=h,e.round=m,e.project=y,e.removeDecimalNoise=v,e.isInteger=C,e.toIncrement=S}(r=e.Double||(e.Double={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t,r=powerbi.Double;!function(e){function t(e,t){if(0===t)return e;var r=o(e),n=i(r),u=s(n,t),g=a(u);return c(g)}function n(e){var t=o(e);return c(t)}function o(e){if(e.indexOf("#")>=0){if(7===e.length){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1],16),G:parseInt(t[2],16),B:parseInt(t[3],16)}}if(4===e.length){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1]+t[1],16),G:parseInt(t[2]+t[2],16),B:parseInt(t[3]+t[3],16)}}}else{if(e.indexOf("rgb(")>=0){var t=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1],10),G:parseInt(t[2],10),B:parseInt(t[3],10)}}if(e.indexOf("rgba(")>=0){var t=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d*(?:\.\d+)?)\)$/.exec(e);if(null==t||t.length<5)return;return{R:parseInt(t[1],10),G:parseInt(t[2],10),B:parseInt(t[3],10),A:parseFloat(t[4])}}}}function i(e){var t,r,n=e.R/255,o=e.G/255,i=e.B/255,a=Math.min(n,Math.min(o,i)),s=Math.max(n,Math.max(o,i)),u=s,g=s-a;return 0===s||0===g?(t=0,r=0):(t=g/s,r=n===s?(o-i)/g:o===s?2+(i-n)/g:4+(n-o)/g),r/=6,0>r&&(r+=1),{H:r,S:t,V:u}}function a(e){var t,r,n,o=e.H,i=e.S,a=e.V;if(0===i)t=a,r=a,n=a;else{var s=void 0,u=void 0,g=void 0,c=void 0,l=void 0,f=void 0;switch(f=6*o,l=Math.floor(f),c=f-l,s=a*(1-i),u=a*(1-i*c),g=a*(1-i*(1-c)),l){case 0:t=a,r=g,n=s;break;case 1:t=u,r=a,n=s;break;case 2:t=s,r=a,n=g;break;case 3:t=s,r=u,n=a;break;case 4:t=g,r=s,n=a;break;case 5:t=a,r=s,n=u}}return{R:Math.floor(255*t),G:Math.floor(255*r),B:Math.floor(255*n)}}function s(e,t){var r=e.H+t;return{H:r>1?r-1:r,S:e.S,V:e.V}}function u(e,t){var r=Math.floor(t);return{R:Math.max(0,e.R-r),G:Math.max(0,e.G-r),B:Math.max(0,e.B-r)}}function g(e){return null==e.A?"rgb("+e.R+","+e.G+","+e.B+")":"rgba("+e.R+","+e.G+","+e.B+","+e.A+")"}function c(e){return"#"+l(e.R)+l(e.G)+l(e.B)}function l(e){var t=r.ensureInRange(e,0,255),n=t.toString(16).toUpperCase();return 1===n.length?"0"+n:n}e.rotate=t,e.normalizeToHexString=n,e.parseColorString=o,e.darken=u,e.rgbString=g,e.hexString=c}(t=e.Color||(e.Color={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e){return{"class":e,selector:"."+e}}e.createClassAndSelector=t,e.styleAttribute="style",e.pixelUnits="px",e.heightProperty="height",e.widthProperty="width",e.topProperty="top",e.bottomProperty="bottom",e.leftProperty="left",e.rightProperty="right",e.marginTopProperty="margin-top",e.marginLeftProperty="margin-left",e.displayProperty="display",e.backgroundProperty="background",e.backgroundColorProperty="background-color",e.backgroundRepeatProperty="background-repeat",e.backgroundSizeProperty="background-size",e.backgroundImageProperty="background-image",e.textShadowProperty="text-shadow",e.textAlignProperty="text-align",e.borderTopWidthProperty="border-top-width",e.borderBottomWidthProperty="border-bottom-width",e.borderLeftWidthProperty="border-left-width",e.borderRightWidthProperty="border-right-width",e.fontSizeProperty="font-size",e.fontWeightProperty="font-weight",e.colorProperty="color",e.opacityProperty="opacity",e.paddingLeftProperty="padding-left",e.paddingRightProperty="padding-right",e.positionProperty="position",e.maxWidthProperty="max-width",e.minWidthProperty="min-width",e.overflowProperty="overflow",e.overflowXProperty="overflow-x",e.overflowYProperty="overflow-y",e.transformProperty="transform",e.webkitTransformProperty="-webkit-transform",e.cursorProperty="cursor",e.visibilityProperty="visibility",e.absoluteValue="absolute",e.zeroPixelValue="0px",e.autoValue="auto",e.hiddenValue="hidden",e.noneValue="none",e.blockValue="block",e.inlineBlockValue="inline-block",e.transparentValue="transparent",e.boldValue="bold",e.visibleValue="visible",e.tableRowValue="table-row",e.coverValue="cover",e.pointerValue="pointer",e.scrollValue="scroll"}(t=e.CssConstants||(e.CssConstants={}))}(jsCommon||(jsCommon={}));var debug;!function(e){function t(e,t){e!==!0&&i(t||"condition: "+e)}function r(e,t){null!==e&&void 0!==e||i(t||"condition: "+e)}function n(e,t){null!=e&&e.length>0||i(t||"condition: "+e);
}function o(e,t){}function i(t){(e.assertFailFunction||alert)("Debug Assert failed: "+t)}e.assert=t,e.assertValue=r,e.assertNonEmpty=n,e.assertAnyValue=o,e.assertFail=i}(debug||(debug={}));var jsCommon;!function(e){function t(e){void 0===e&&(e=1);var t,r;try{throw new Error}catch(n){t=n.stack,null!=t&&(r=t.split("\n"),r.splice(1,e),t=r.join("\n"))}return t}var r;!function(e){function r(){return{name:"infoNavAppAlreadyPresent",message:"Cannot initialize embedded scenario when the InfoNav App is already present in this context",stack:c()}}function n(e){return{name:"invalidOperation",message:e,stack:c()}}function o(e,t){return{name:"invalidArgumentError",argument:e,message:t,stack:c()}}function i(e){return{name:"argumentNull",argument:e,message:"Argument was null",stack:c()}}function a(e){return{name:"argumentUndefined",argument:e,message:"Argument was undefined",stack:c()}}function s(e){return{name:"argumentOutOfRange",argument:e,message:"Argument was out of range",stack:c()}}function u(e,t){return{name:"pureVirtualMethodException",message:"This method must be overriden by the derived class:"+e+"."+t,stack:c()}}function g(e){return{name:"notImplementedException",message:e,stack:c()}}function c(){return t(2)}e.infoNavAppAlreadyPresent=r,e.invalidOperation=n,e.argument=o,e.argumentNull=i,e.argumentUndefined=a,e.argumentOutOfRange=s,e.pureVirtualMethodException=u,e.notImplementedException=g}(r=e.Errors||(e.Errors={})),e.getStackTrace=t}(jsCommon||(jsCommon={})),$.fn.multiline=function(e){return this.text(e),this.html(this.html().replace(/\n/g,"<br/>")),this},$.fn.togglePanelControl=function(){return this.each(function(){$(this).addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find(".accordionHeader").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){$(this).toggleClass("ui-state-hover")}).prepend('<span class="ui-icon ui-icon-triangle-1-e"></span>').click(function(){return $(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().slideToggle(),!1}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide()})};var jsCommon;!function(e){var t;!function(e){e.VisibleSelector=":visible"}(t=e.JQueryConstants||(e.JQueryConstants={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(t){e.Utility.throwIfNullOrUndefined(t,this,"constructor","factoryMethod"),this.factoryMethod=t}return t.prototype.getValue=function(){return null!==this.factoryMethod&&(this.value=this.factoryMethod(),this.factoryMethod=null),this.value},t}();e.Lazy=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){function t(e,t){function r(){}r.prototype=e;var n=new r;return t&&t(n),n}function r(e){var r=Object.getPrototypeOf(e);return r!==Object.prototype&&r!==Array.prototype||(e=t(e)),e}function n(e,r){if(e){for(var n,o=0,i=e.length;i>o;o++){var a=r(e[o]);a&&(n||(n=t(e)),n[o]=a)}return n}}e.inherit=t,e.inheritSingle=r,e.overrideArray=n}(t=e.Prototype||(e.Prototype={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e,t,r){switch(t){case"m":t="M";break;case"O":case"o":t="yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fff'0000'";break;case"R":case"r":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'";break;case"s":t="S";break;case"u":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="yyyy'-'MM'-'dd HH':'mm':'ss'Z'";break;case"U":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="F";break;case"y":case"Y":switch(r){case"default":case"en":case"en-US":t="MMMM, yyyy";break;default:t="Y"}}return{value:e,format:t}}function r(e){if(e=e.replace(/%K/g,"zzz"),e=e.replace(/K/g,"zzz"),e=e.replace(/fffffff/g,"fff0000"),e=e.replace(/ffffff/g,"fff000"),e=e.replace(/fffff/g,"fff00"),e=e.replace(/ffff/g,"fff0"),e=e.replace(/yyyyy/g,"0yyyy"),e=e.replace(/(^y|^)yyy(^y|$)/g,"yyyy"),n||(n=["d","f","F","g","h","H","K","m","M","s","t","y","z",":","/"].map(function(e){return{r:new RegExp("%"+e+"(?!"+e+")","g"),s:e}})),-1!==e.indexOf("%")&&e.length>2)for(var t=0;t<n.length;t++)e=e.replace(n[t].r,n[t].s);return e}var n;e.findDateFormat=t,e.fixDateTimeFormat=r}(t=e.Formatting||(e.Formatting={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(e,t){void 0===t&&(t=$.noop),r(e.cssFiles||[]);var o=e.javaScriptFilesWithCallback||[];if(e.javaScriptFiles)for(var i=0,a=e.javaScriptFiles.length;a>i;++i)o.push({javascriptFile:e.javaScriptFiles[i]});n(o,t)}function r(e){e.forEach(function(e){-1===S.indexOf(e)&&(S.push(e),o(e))})}function n(e,t){function r(){--o||g(e,s)}function n(){--a||t()}var o=e.length,a=o,s=[];e.forEach(function(e,t){var o=e.javascriptFile;-1===E.indexOf(o)?o in b?b[o].push(function(){r(),n()}):(b[o]=[function(){n()}],l(o)?(s[t]=e,r()):i(o,function(e){s[t]={javascriptFile:e},r()})):(r(),n())})}function o(e){var t=v.cloneNode();t.href=e,y?m.insertBefore(t,y):m.appendChild(t)}function i(e,t){c(e,function(){t(this.responseText)})}function a(e,t){if(void 0===t&&(t=$.noop),!e)return void t();var r=e.javascriptFile,n=t;if(e.onLoadCallback){var o=function(){e.onLoadCallback().then(t)};n=o}l(r)?u(r,n):s(r,n)}function s(e,t){void 0===t&&(t=$.noop);var r;e&&(r=C.cloneNode(),r.setAttribute("type","text/javascript"),r.innerHTML=e,m.appendChild(r)),setTimeout(t,0)}function u(e,t){var r;e&&(r=C.cloneNode(),r.setAttribute("src",e),r.setAttribute("charset","utf-8"),r.onload=t,m.appendChild(r))}function g(e,t){p(t,a,function(){e.forEach(function(e){var t=e.javascriptFile,r=b[t];r&&r.forEach(function(e){e()}),delete b[t],-1===E.indexOf(t)&&E.push(t)})})}function c(e,t,r){var n=new XMLHttpRequest;try{n.open("GET",e,!0),n.onload=t,n.onerror=r,n.send(null)}catch(o){}}function l(e){var t=location.protocol+"//"+location.host+"/";return/^http[s]?:\/\/.+/i.test(e)&&0!==e.indexOf(t)}function f(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(0!==e.length){for(var r=[],n=e.length;n--;)!function(t){r[t]=function(){e[t](r[t+1]||f)}}(n);r[0]()}}function p(e,t,r){for(var n=[],o=0,i=e.length;i-1>o;o++)!function(r){n[r]=function(n){t(e[r],n)}}(o);n[i-1]=function(n){t(e[i-1],r)},d.apply(null,n)}var h=document,m=h.head,y=m.getElementsByTagName("script")[0],v=h.createElement("link"),C=h.createElement("script"),S=[],E=[],b=[];v.setAttribute("rel","stylesheet"),e.requires=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){function t(){return new r}e.createJQueryPromiseFactory=t;var r=function(){function e(){}return e.prototype.defer=function(){return new n($.Deferred())},e.prototype.reject=function(e){var t=this.defer();return t.reject(e),t.promise},e.prototype.resolve=function(e){var t=this.defer();return t.resolve(e),t.promise},e.prototype.all=function(e){var t=jQuery.map(e,function(e){return e&&e.promise?e.promise:e});return new o($.when.apply($,t))},e.prototype.when=function(e){var t=e&&e.promise?e.promise:e;return new o($.when(t))},e}(),n=function(){function e(e){this.deferred=e,this.promise=new o(e.promise())}return e.prototype.resolve=function(e){this.deferred.resolve(e)},e.prototype.reject=function(e){this.deferred.reject(e)},e}(),o=function(){function e(e){this.promise=e}return e.prototype.then=function(t,r){return new e(this.promise.then(e.wrapCallback(t),e.wrapCallback(r)))},e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(t){return this.promise.always(e.wrapCallback(t)),this},e.wrapCallback=function(t){return t?function(r){var n=t(r);return n instanceof e?n.promise:n}:t},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function e(){}return e.prototype.getData=function(e){try{if(localStorage){var t=localStorage[e];if(t)return JSON.parse(t)}}catch(r){}return null},e.prototype.setData=function(e,t){try{localStorage&&(localStorage[e]=JSON.stringify(t))}catch(r){}},e}(),r=function(){function e(t){this.cache={},this.clearCacheInterval=null!=t?t:e.defaultClearCacheInterval,this.clearCache()}return e.prototype.getData=function(e){return this.cache[e]},e.prototype.setData=function(e,t){var r=this;this.cache[e]=t,null==this.clearCacheTimerId&&(this.clearCacheTimerId=setTimeout(function(){return r.clearCache()},this.clearCacheInterval))},e.prototype.clearCache=function(){this.cache={},this.clearCacheTimerId=void 0},e.defaultClearCacheInterval=864e5,e}();e.EphemeralStorageService=r,e.localStorageService=new t,e.ephemeralStorageService=new r}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e,t,r){if(r){for(var o=e-1;o>-1;o--)if(n(t[o]))return o+1}else for(var o=e,i=t.length;i>o;o++)if(n(t[o]))return o;return r?0:t.length}function r(e,r){var n={start:0,end:0};return 0===r.length?n:(n.start=t(e,r,!0),n.end=t(e,r,!1),n)}function n(e){return l.lastIndex=0,l.test(e)}function o(e){var t=1;for(l.lastIndex=0,l.exec(e);0!==l.lastIndex;)t++,l.exec(e);return t}function i(e,t,r){for(var n=a(e),o=0,i=0,s=n;i<s.length;i++){var u=s[i];r.text=u,o=Math.max(o,t(r))}return o}function a(e){return e.split(l)}function s(e,t,r){return t.text=e,r(t)}function u(e,t,r,n){return t.text=e,r(t,n)}function g(e,t,r,n,o,i){i=i?i:function(e,t){return e.text};for(var g=[],l=a(e),f=0,d=[],p=0,h=l;p<h.length;p++){var m=h[p];if(o>0&&g.length>=o-1)d.push(m);else{var y=0===d.length?s(m,t,r):s(c+m,t,r);if(f+y>n){if(0===d.length){g.push(u(m,t,i,n)),f=0,d=[];continue}g.push(u(d.join(c),t,i,n)),f=0,d=[]}d.push(m),f+=y}}return g.push(u(d.join(c),t,i,n)),g}var c=" ",l=/[\s\n]+/g;e.find=r,e.hasBreakers=n,e.wordCount=o,e.getMaxWordWidth=i,e.splitByWidth=g}(t=e.WordBreaker||(e.WordBreaker={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(t){function r(){v||(v=$("<span/>"),$("body").append(v),C=d3.select($("body").get(0)).append("svg").style({height:"0px",width:"0px",position:"absolute"}).append("text"),S=$("<canvas/>").get(0).getContext("2d"),E=window.getComputedStyle(C.node()).fontFamily)}function n(){v&&v.remove&&v.remove(),v=null}function o(e){return r(),S.font=(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+" "+(e.fontFamily||E),S.measureText(e.text).width}function i(e){return r(),C.style(null),C.text(e.text).attr({visibility:"hidden","font-family":e.fontFamily||E,"font-variant":e.fontVariant,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,"white-space":e.whiteSpace||"nowrap"}),C.node().getBBox()}function a(e){return i(e).height}function s(r){var n=r.fontFamily+r.fontSize,o=e.ephemeralStorageService.getData(n);if(null==o){var i={fontFamily:r.fontFamily,fontSize:r.fontSize,text:"M"};o=t.measureSvgTextRect(i),o.height>0&&e.ephemeralStorageService.setData(n,o)}return o}function u(e){var t=s(e);return t.y+t.height}function g(e,t){void 0===t&&(t=!1);var r=s(e).height;return t&&(r*=.7),r}function c(e){return o(f(e))}function l(e){return{text:e.val()||e.text(),fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontWeight:e.css("font-weight"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),whiteSpace:e.css("white-space")}}function f(e){var t=window.getComputedStyle(e,null);return{text:e.textContent,fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontVariant:t.fontVariant,whiteSpace:t.whiteSpace}}function d(e){return getComputedStyle(e[0]).width}function p(t,n){r();var i=t.text.length;if(0===i)return t.text;var a=o(t);if(n>a)return t.text;for(var s=e.Prototype.inherit(t),u=s.text=b+s.text,g=1,c=u.length,l=b.length;c>=g;)if(l=(g+c)/2|0,s.text=u.substr(0,l),a=o(s),n>a)g=l+1;else{if(!(a>n))break;c=l-1}return s.text=u.substr(0,l),a=o(s),a>n&&l--,u.substr(b.length,l-b.length)+b}function h(e,t){var r=f(e),n=r.text,o=p(r,t);n!==o&&(e.textContent=o)}function m(e,t,r,n){void 0===n&&(n=0);var i=f(e),a=g(i)+n,s=Math.max(1,Math.floor(r/a)),u=d3.select(e),c=u.attr("y"),l=e.textContent;e.textContent=null;for(var d=jsCommon.WordBreaker.splitByWidth(l,i,o,t,s),h=0,m=d.length;m>h;h++)i.text=d[h],u.append("tspan").attr({x:0,dy:0===h?c:a}).text(p(i,t))}function y(e,t,r,n){void 0===n&&(n=0);var i=f(e),a=g(i)+n,s=Math.max(1,Math.floor(r/a)),u=e.textContent;e.textContent=null;var c=jsCommon.WordBreaker.splitByWidth(u,i,o,t,s);c=_.compact(c);var l=d3.select(e).selectAll(w.selector).data(c,function(e){return $.inArray(e,c)});l.enter().append("span").classed(w["class"],!0).text(function(e){return e}).style("width",jsCommon.PixelConverter.toString(t))}var v,C,S,E,b="",w=jsCommon.CssConstants.createClassAndSelector("overflowingText");t.removeSpanElement=n,t.measureSvgTextWidth=o,t.measureSvgTextRect=i,t.measureSvgTextHeight=a,t.estimateSvgTextBaselineDelta=u,t.estimateSvgTextHeight=g,t.measureSvgTextElementWidth=c,t.getMeasurementProperties=l,t.getSvgMeasurementProperties=f,t.getDivElementWidth=d,t.getTailoredTextOrDefault=p,t.svgEllipsis=h,t.wordBreak=m,t.wordBreakOverflowingText=y}(t=e.TextMeasurementService||(e.TextMeasurementService={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t,r=e.DOMConstants;!function(e){function t(e){return e===r.downArrowKeyCode||e===r.upArrowKeyCode||e===r.leftArrowKeyCode||e===r.rightArrowKeyCode}function n(e){return e===r.aKeyCode||e===r.cKeyCode||e===r.xKeyCode||e===r.vKeyCode}e.isArrowKey=t,e.isCtrlDefaultKey=n}(t=e.KeyUtils||(e.KeyUtils={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(t){this.timerFactory=e.TimerPromiseFactory.instance,this.delay=0,t&&(this.delay=t)}return t.prototype.run=function(e){var t=this;this.fn?this.fn=e:(this.fn=e,this.timerFactory.create(this.delay).done(function(){return t.timerComplete(t.fn)}))},t.prototype.timerComplete=function(e){e(),this.fn=null},t}();e.ThrottleUtility=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function e(){}return e.prototype.create=function(e){var t=$.Deferred();return window.setTimeout(function(){return t.resolve()},e),t},e.instance=new e,e}();e.TimerPromiseFactory=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){!function(e){e[e.OK=200]="OK",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge"}(e.HttpStatusCode||(e.HttpStatusCode={}));var t;e.HttpStatusCode;!function(e){e.ApplicationOctetStream="application/octet-stream",e.MultiPartFormData="multipart/form-data"}(t=e.HttpConstants||(e.HttpConstants={}));var r;!function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var r=e[0];if(g(r))return r;for(var n=0;n<e.length-1;n++){var o=new RegExp("\\{"+n+"\\}","gm");r=r.replace(o,e[n+1])}return r}function r(t,r){return e.normalizeCase(t)===e.normalizeCase(r)}function o(t,r){var n=e.normalizeCase(r);return 0===e.normalizeCase(t).indexOf(n)}function i(e,t){return 0===e.indexOf(t)}function a(e,t){return null==e?!1:-1!==e.toLowerCase().indexOf(t.toLowerCase().toString())}function s(t){return n.throwIfNullOrUndefined(t,e,"normalizeCase","value"),t.toUpperCase()}function u(e){return null==e||0===e.length}function g(t){return e.isNullOrEmpty(t)||e.isNullOrEmpty(t.trim())}function c(e){n.throwIfNullOrUndefined(e,this,"containsWhitespace","str");var t=/\s/;return t.test(e)}function l(e){return n.throwIfNullOrUndefined(e,this,"isWhitespace","str"),""===e.trim()}function f(e){return n.throwIfNullOrUndefined(e,this,"trimTrailingWhitespace","str"),e.replace(/\s+$/,"")}function d(e){return n.throwIfNullOrUndefined(e,this,"trimWhitespace","str"),e.replace(/^\s+/,"").replace(/\s+$/,"")}function p(e,t){return n.throwIfNullOrUndefined(e,this,"getLengthDifference","left"),n.throwIfNullOrUndefined(t,this,"getLengthDifference","right"),Math.abs(e.length-t.length)}function h(e,t){for(var r="",n=0;t>n;n++)r+=e;return r}function m(e,t,r){if(!t)return e;var n=S(t);return e.replace(new RegExp(n,"gi"),r)}function y(e){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];t[o]=!1}for(var i=[],a=0,s=e;a<s.length;a++){var u=s[a],g=u;if(t[g])for(var c=0;void 0!==t[g];)g=u+"."+ ++c;i.push(g),t[g]=!0}return i}function v(e,t){for(var r=0,n=t;e[n];)n=t+ ++r;return n}function C(t,r,n){if(!t||0===t.length)return"";null!==n&&void 0!==n||(n=Number.MAX_VALUE);for(var o=Math.min(n,t.length),i=[],a=0;2>a;a++)for(var s="{"+a+"}",u="_|_<"+a+">_|_",g=0;o>g;g++)t[g].indexOf(s)>-1&&(t[g]=t[g].replace(s,u),i.push({targetValue:s,replaceValue:u}));for(var c="",g=0;o>g;g++)c=0===g?t[g]:e.format(r.get("FilterRestatement_Comma"),c,t[g]);for(var g=0;g<i.length;g++)c=c.replace(i[g].replaceValue,i[g].targetValue);return c}function S(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function E(e){return e.replace(/[\<\>\:"\/\\\|\?*]/g,"")}function b(e){return JSON.stringify(e)}function _(e,t){var r=e.replace(/^[^A-Za-z]*/g,"").replace(/[ :\.\/\\\-\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000]/g,"_").replace(/[\W]/g,"");return r.length>0?r:t}function w(e){return e.replace(T,"")}var T=new RegExp("[<>]","g");e.format=t,e.equalIgnoreCase=r,e.startsWithIgnoreCase=o,e.startsWith=i,e.containsIgnoreCase=a,e.normalizeCase=s,e.isNullOrEmpty=u,e.isNullOrUndefinedOrWhiteSpaceString=g,e.containsWhitespace=c,e.isWhitespace=l,e.trimTrailingWhitespace=f,e.trimWhitespace=d,e.getLengthDifference=p,e.repeat=h,e.replaceAll=m,e.ensureUniqueNames=y,e.findUniqueName=v,e.constructCommaSeparatedList=C,e.escapeStringForRegex=S,e.normalizeFileName=E,e.stringifyAsPrettyJSON=b,e.deriveClsCompliantName=_,e.stripTagDelimiters=w}(r=e.StringExtensions||(e.StringExtensions={}));var n=function(){function n(){}return n.throwIfNullOrUndefined=function(t,r,o,i){null===t?n.throwException(e.Errors.argumentNull(n.getComponentName(r)+o+"."+i)):typeof t===n.Undefined&&n.throwException(e.Errors.argumentUndefined(n.getComponentName(r)+o+"."+i))},n.throwIfNullOrEmpty=function(t,r,o,i){n.throwIfNullOrUndefined(t,r,o,i),t.length||n.throwException(e.Errors.argumentOutOfRange(n.getComponentName(r)+o+"."+i))},n.throwIfNullOrEmptyString=function(t,r,o,i){n.throwIfNullOrUndefined(t,r,o,i),t.length<1&&n.throwException(e.Errors.argumentOutOfRange(n.getComponentName(r)+o+"."+i))},n.throwIfNullEmptyOrWhitespaceString=function(t,o,i,a){n.throwIfNullOrUndefined(t,o,i,a),r.isNullOrUndefinedOrWhiteSpaceString(t)&&n.throwException(e.Errors.argumentOutOfRange(n.getComponentName(o)+i+"."+a))},n.throwIfNotTrue=function(t,r,o,i){t||n.throwException(e.Errors.argument(i,n.getComponentName(r)+o+"."+i))},n.isString=function(e){return"string"==typeof e},n.isBoolean=function(e){return"boolean"==typeof e},n.isNumber=function(e){return"number"==typeof e},n.isDate=function(e){return n.isObject(e)&&e instanceof Date},n.isObject=function(e){return null!=e&&"object"==typeof e},n.isNullOrUndefined=function(e){return null===e||typeof e===n.Undefined},n.urlCombine=function(e,t){if(n.throwIfNullOrUndefined(e,null,"urlCombine","baseUrl"),n.throwIfNullOrUndefined(t,null,"urlCombine","path"),r.isNullOrUndefinedOrWhiteSpaceString(t))return e;if(r.isNullOrUndefinedOrWhiteSpaceString(e))return t;var o=e;return"/"===o.charAt(o.length-1)?"/"===t.charAt(0)&&(t=t.slice(1)):"/"!==t.charAt(0)&&(t="/"+t),o+t},n.getAbsoluteUri=function(e){n.throwIfNullOrUndefined(e,null,"getAbsoluteUri","path");var t=e;return t&&-1===t.indexOf("http")&&(t=n.urlCombine(clusterUri,t)),t},n.getStaticResourceUri=function(t){n.throwIfNullOrUndefined(t,null,"getStaticResourceUri","path");var r=t;return r&&-1===r.indexOf("http")&&(r=e.Utility.urlCombine(n.staticContentLocation,r)),r},n.getComponentName=function(e){return e?(typeof e).toString()+".":""},n.throwException=function(t){throw e.Trace.error(r.format("Throwing exception: {0}",JSON.stringify(t)),null==t.stack),t},n.createClassSelector=function(e){return n.throwIfNullOrEmptyString(e,null,"CreateClassSelector","className"),"."+e},n.createIdSelector=function(e){return n.throwIfNullOrEmptyString(e,null,"CreateIdSelector","id"),"#"+e},n.generateGuid=function(){var e="",t=0;for(t=0;32>t;t+=1){var r=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=r.toString(16)}return e},n.getCookieValue=function(e){for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var n=t[r],o=n.split("=");if(o.length>0&&o[0].trim()===e)return n.substr(n.indexOf("=")+1)}return null},n.getDomainForUrl=function(e){var t=n.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+t.prop("hostname")},n.getHostNameForUrl=function(e){var t=n.getHrefObjectFromUrl(e);return n.urlCombine(t.prop("hostname"),t.prop("pathname"))},n.getUrlWithoutQueryString=function(e){var t=n.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+n.urlCombine(t.prop("host"),t.prop("pathname"))},n.getProtocolFromUrl=function(e){return n.getHrefObjectFromUrl(e).prop("protocol").replace(":","")},n.getHrefObjectFromUrl=function(e){var t=$("<a>");return t=t.prop("href",e)},n.convertWcfToJsDictionary=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];t[n.Key]=n.Value}return t},n.getDateFromWcfJsonString=function(e,t){if(r.isNullOrEmpty(e))return null;var n=e.indexOf("("),o=e.indexOf(")");if(-1!==n&&-1!==o){var i=parseInt(e.substring(n+1,o),10);if(t)return new Date(i);var a=new Date(0);return a.setUTCMilliseconds(i),a}return null},n.getOuterHtml=function(e){return $("<div>").append(e).html()},n.compareInt=function(e,t){return e-t},n.getIndexOfMinValue=function(e){for(var t=0,r=e[0],n=0;n<e.length;n++)e[n]<r&&(r=e[n],t=n);return t},n.extractUrlFromCssBackgroundImage=function(e){return e.replace(/"/g,"").replace(/url\(|\)$/gi,"")},n.isValidImageDataUrl=function(e){var t=new RegExp("data:(image/(png|jpg|jpeg|gif|svg))");return t.test(e)},n.isLocalUrl=function(e){return _.startsWith(e,"data:")||_.startsWith(e,"blob:")},n.saveAsFile=function(e,r){var n=new Blob([e],{type:t.ApplicationOctetStream}),o=window.webkitURL||URL,i=o.createObjectURL(n),a=r||i;if(window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(n,a);var s=document.createElement("a");s.href=i,s.target="_blank",s.download=a,document.body.appendChild(s),s.click(),document.body.removeChild(s)},n.getType=function(t){n.throwIfNullEmptyOrWhitespaceString(t.__type,this,"getType","obj");var r=t.__type.split(":");return 2!==r.length&&e.Errors.argument("obj.__type","Type String not in expected format [Type]#[Namespace]: "+t.__type),r[1]!==n.TypeNamespace&&e.Errors.argument("obj.__type","Type Namespace not expected: "+r[1]),r[0]},n.isEventSupported=function(e,t){e="on"+e;var r=e in t;return r||(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(e,""),r="function"==typeof t[e],"undefined"!=typeof t[e]&&(t[e]=null),t.removeAttribute(e))),t=null,r},n.toPixel=function(t){return n.throwIfNullOrUndefined(t,this,"toPixel","pixelAmount"),t.toString()+e.CssConstants.pixelUnits},n.getPropertyCount=function(e){return n.throwIfNullOrUndefined(e,this,"getPropertyCount","object"),Object.getOwnPropertyNames(e).length},n.getFileExtension=function(e){if(e){var t=e.lastIndexOf(".");if(t>=0)return e.substr(t+1)}return""},n.extractFileNameFromPath=function(e){return e.replace(/^.*[\\\/]/,"")},n.canUseClipboard=function(){return"undefined"==typeof MSApp},n.is64BitOperatingSystem=function(){return-1!==navigator.userAgent.indexOf("WOW64")||-1!==navigator.userAgent.indexOf("Win64")},n.parseNumber=function(e,t){if(null===e)return null;if(void 0===e)return t;var r=Number(e);return isFinite(r)?r:isNaN(r)&&"number"!=typeof e&&"NaN"!==e?t:r},n.getURLParamValue=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},n.getLocalTimeZoneString=function(){var e,t=new Date(Date.UTC(2005,6,30,0,0,0,0)),r=-1*t.getTimezoneOffset(),n=new Date(Date.UTC(2005,12,30,0,0,0,0)),o=-1*n.getTimezoneOffset();return e=-720===r&&-720===o?"Dateline Standard Time":-660===r&&-660===o?"UTC-11":-660===r&&-660===o?"Samoa Standard Time":-600===r&&-600===o?"Hawaiian Standard Time":-480===r&&-540===o?"Alaskan Standard Time":-420===r&&-480===o?"Pacific Standard Time":-420===r&&-420===o?"US Mountain Standard Time":-360===r&&-420===o?"Mountain Standard Time":-360===r&&-360===o?"Central America Standard Time":-300===r&&-360===o?"Central Standard Time":-300===r&&-300===o?"SA Pacific Standard Time":-240===r&&-300===o?"Eastern Standard Time":-270===r&&-270===o?"Venezuela Standard Time":-240===r&&-240===o?"SA Western Standard Time":-240===r&&-180===o?"Central Brazilian Standard Time":-180===r&&-240===o?"Atlantic Standard Time":-180===r&&-180===o?"Montevideo Standard Time":-180===r&&-120===o?"E. South America Standard Time":-150===r&&-210===o?"Mid-Atlantic Standard Time":-120===r&&-120===o?"SA Eastern Standard Time":0===r&&0===o?"UTC":60===r&&0===o?"GMT Standard Time":60===r&&120===o?"Namibia Standard Time":120===r&&60===o?"Romance Standard Time":120===r&&120===o?"South Africa Standard Time":180===r&&120===o?"GTB Standard Time":180===r&&180===o?"E. Africa Standard Time":240===r&&180===o?"Russian Standard Time":240===r&&240===o?"Arabian Standard Time":270===r&&210===o?"Iran Standard Time":270===r&&270===o?"Afghanistan Standard Time":300===r&&240===o?"Pakistan Standard Time":300===r&&300===o?"West Asia Standard Time":330===r&&330===o?"India Standard Time":345===r&&345===o?"Nepal Standard Time":360===r&&300===o?"N. Central Asia Standard Time":360===r&&360===o?"Central Asia Standard Time":390===r&&390===o?"Myanmar Standard Time":420===r&&360===o?"North Asia Standard Time":420===r&&420===o?"SE Asia Standard Time":480===r&&420===o?"North Asia East Standard Time":480===r&&480===o?"China Standard Time":540===r&&480===o?"Yakutsk Standard Time":540===r&&540===o?"Tokyo Standard Time":570===r&&570===o?"Cen. Australia Standard Time":600===r&&600===o?"E. Australia Standard Time":600===r&&660===o?"AUS Eastern Standard Time":660===r&&600===o?"Tasmania Standard Time":660===r&&660===o?"West Pacific Standard Time":690===r&&690===o?"Central Pacific Standard Time":720===r&&660===o?"Magadan Standard Time":720===r&&720===o?"Fiji Standard Time":720===r&&780===o?"New Zealand Standard Time":780===r&&780===o?"Tonga Standard Time":"UTC"},n.TypeNamespace="http://schemas.microsoft.com/sqlbi/2013/01/NLRuntimeService",n.JsonContentType="application/json",n.JpegContentType="image/jpeg",n.XJavascriptContentType="application/x-javascript",n.JsonDataType="json",n.BlobDataType="blob",n.HttpGetMethod="GET",n.HttpPostMethod="POST",n.HttpPutMethod="PUT",n.HttpDeleteMethod="DELETE",n.HttpContentTypeHeader="Content-Type",n.HttpAcceptHeader="Accept",n.Undefined="undefined",n.staticContentLocation=window.location.protocol+"//"+window.location.host,n}();e.Utility=n;var o=function(){function e(){}return e.compareVersions=function(e,t){for(var r=e.split(".").map(parseFloat),n=t.split(".").map(parseFloat),o=Math.max(r.length,n.length),i=0;o>i;i++){var a=r[i]||0,s=n[i]||0;if(a>s)return 1;if(s>a)return-1}return 0},e}();e.VersionUtility=o;var i;!function(e){function t(e){return new r(e)}var r=function(){function e(t){this._name=t,this._start=e.begin(t)}return e.begin=function(e){return void 0!==window.performance&&void 0!==performance.mark?(console.time,e="Begin "+e,performance.mark(e),e):void 0},e.prototype.end=function(){if(void 0!==window.performance&&void 0!==performance.mark&&void 0!==performance.measure){var e=this._name,t="End "+e;performance.mark(t),performance.measure(e,this._start,t),console.timeEnd}},e}();e.PerfMarker=r,e.create=t}(i=e.PerformanceUtil||(e.PerformanceUtil={}));var a;!function(e){function t(e){var t,r,n;return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,20)}),function(){t||(t=!0,r=arguments,n=this,window.requestAnimationFrame(function(){t=!1,e.apply(n,r)}))}}e.deferUntilNextFrame=t}(a=e.DeferUtility||(e.DeferUtility={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(e,t,r,n){this.text=e,this.type=t,this.sessionId=r,this.requestId=n,this.timeStamp=new Date}return t.prototype.toString=function(){var r="";return r+=e.StringExtensions.format("{0} ({1}): {2}",t.traceTypeStrings[this.type],this.timeStamp.toUTCString(),this.text),this.requestId&&(r+="\n(Request id: "+this.requestId+")"),r},t.traceTypeStrings=["INFORMATION","VERBOSE","WARNING","ERROR","EXPECTEDERROR","UNEXPECTEDERROR","FATAL"],t}();e.TraceItem=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(t){function r(t){if(e.StringExtensions.isNullOrEmpty(t))return!1;var r=e.RegExpExtensions.run(a,t);return!(!r||0!==r.index)}function n(e){return r(e)}function o(t){if(e.StringExtensions.isNullOrEmpty(t))return[];for(var r,n=[],o=0;null!==(r=e.RegExpExtensions.run(a,t,o));){var i=r[0],s=r.index+i.length;n.push({start:r.index,end:s,text:i}),o=s}return n}function i(e){if(0!==e.indexOf("data:"))throw new Error("Expected data uri");var t=";base64,",r=e.indexOf(t);if(0>r)throw new Error("Expected base 64 content in data url");var n=r+t.length;return e.substr(n,e.length-n)}var a=/http[s]?:\/\/(\S)+/gi;t.isValidUrl=r,t.isValidImageUrl=n,t.findAllValidUrls=o,t.getBase64ContentFromDataUri=i}(t=e.UrlUtils||(e.UrlUtils={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(){var e=window.navigator.vendor||"",t=window.navigator.userAgent.toLowerCase();return e.toLowerCase().indexOf("google")>-1&&t.indexOf("chrome")>-1&&-1===t.indexOf("edge")&&-1===t.indexOf("opr")}function r(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("msie")>-1||e.indexOf("trident")>-1||e.indexOf("edge")>-1}function n(){var e=0;if("Microsoft Internet Explorer"===navigator.appName||window.navigator.userAgent.indexOf("MSIE")>=0){var t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),r=t.exec(window.navigator.userAgent);r&&(e=parseFloat(r[1]))}return e}e.isChrome=t,e.isInternetExplorerOrEdge=r,e.getInternetExplorerVersion=n}(t=e.BrowserUtils||(e.BrowserUtils={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){return(e&t)===t}function r(e,t){return e|=t}function n(e,t){return e&=~t}function o(e,t){return e[t]}e.hasFlag=t,e.setFlag=r,e.resetFlag=n,e.toString=o}(t=e.EnumExtensions||(e.EnumExtensions={}));var r;!function(e){function t(e,t){return-1!==e.indexOf(t,e.length-t.length)}e.endsWith=t}(r=e.StringExtensions||(e.StringExtensions={}));var n;!function(e){function t(e,t){return(e||t)&&!(e&&t)}e.XOR=t}(n=e.LogicExtensions||(e.LogicExtensions={}));var o;!function(e){function t(e,t){return e===t?!0:JSON.stringify(e)===JSON.stringify(t)}e.equals=t}(o=e.JsonComparer||(e.JsonComparer={}));var i;!function(e){function t(t){return(t-e.TextSizeMin)/r}e.TextSizeMin=8,e.TextSizeMax=40;var r=e.TextSizeMax-e.TextSizeMin;e.getScale=t}(i=e.TextSizeDefaults||(e.TextSizeDefaults={}));var a;!function(e){function t(e){return e+a}function r(e){return t(n(e))}function n(e){return i*e}function o(e){return e/i}var i=4/3,a="px";e.toString=t,e.fromPoint=r,e.fromPointToPixel=n,e.toPoint=o}(a=e.PixelConverter||(e.PixelConverter={}));var s;!function(e){function t(e,t,r){return e.lastIndex=r||0,e.exec(t)}e.run=t}(s=e.RegExpExtensions||(e.RegExpExtensions={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){var t=e.get(0).style,r=t.transform||t.webkitTransform;if(r){var n=r.match(/rotate\((-?\d+(?:\.\d*)?)deg\)/);if(n)return parseFloat(n[1])}return 0}function r(e){var t=e.get(0).style,r=t.transform||t.webkitTransform,n={x:0,y:0};if(r&&r.length>0){var o=r.match(/translate\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/);o&&(n.x=parseFloat(o[1]),n.y=parseFloat(o[2]))}return n}function n(e){return e?{left:parseFloat(e.css("padding-left"))||0,right:parseFloat(e.css("padding-right"))||0,
top:parseFloat(e.css("padding-top"))||0,bottom:parseFloat(e.css("padding-bottom"))||0}:void 0}e.getRotateAngleFromElement=t,e.getTranslateTransformFromElement=r,e.getPadding=n}(t=e.StyleUtils||(e.StyleUtils={}))}(t=e.utility||(e.utility={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t=function(){function t(){}return t.prototype.logTrace=function(t){if(DEBUG)switch(t.type){case e.TraceType.Information:break;case e.TraceType.UnexpectedError:case e.TraceType.Error:case e.TraceType.Fatal:break;case e.TraceType.ExpectedError:case e.TraceType.Warning:break;case e.TraceType.Verbose:}},t}();e.ConsoleTracer=t;var r;!function(r){function n(t,r){d(new e.TraceItem(t,e.TraceType.Warning,r))}function o(t,r,n){r&&(t=e.StringExtensions.format("{0}.\nStack:\n{1}",t,e.getStackTrace())),d(new e.TraceItem(t,e.TraceType.Error,n))}function i(t,r){d(new e.TraceItem(t,e.TraceType.Verbose,r))}function a(e){v.push(e)}function s(e){var t=v.indexOf(e);t>=0&&v.splice(t,1)}function u(){v=new Array(y)}function g(){m=-1}function c(){if(!(0>m)){for(var e=new Array(m+1),t=0;m>=t;t++)e[t]=h[t];return e}}function l(){s(y)}function f(){a(y)}function d(e){m+1>=p&&g(),h[++m]=e;for(var t=0,r=v.length;r>t;t++)v[t].logTrace(e)}var p=1e3,h=new Array(p),m=-1,y=new t,v=new Array(y);r.warning=n,r.error=o,r.verbose=i,r.addListener=a,r.removeListener=s,r.resetListeners=u,r.reset=g,r.getTraces=c,r.disableDefaultListener=l,r.enableDefaultListener=f}(r=e.Trace||(e.Trace={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){!function(e){e[e.Information=0]="Information",e[e.Verbose=1]="Verbose",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.ExpectedError=4]="ExpectedError",e[e.UnexpectedError=5]="UnexpectedError",e[e.Fatal=6]="Fatal"}(e.TraceType||(e.TraceType={}));e.TraceType}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(t){void 0===t&&(t=_.noop),e.requires(u,t)}function r(t,r){var n=powerbi.Prototype.inherit(g);if(!_.isEmpty(t)){var o=t.split("-",2);n.javaScriptFilesWithCallback[0].javascriptFile=i.concat("&mkt="+t+"&ur="+(o.length>1?o[1]:t))}e.requires(n,r)}function n(){a=!0,s&&(s.resolve(),s=void 0)}function o(){var e;return a?(e=$.Deferred(),e.resolve()):e=s=$.Deferred(),e.promise()}var i="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&s=1&onscriptload=globalMapControlLoaded",a=!1,s=null,u={javaScriptFiles:[powerbi.build+"/externals/pv/webclient.js"],cssFiles:[powerbi.build+"/externals/pv/Styles/_all.css"],javaScriptFilesWithCallback:[{javascriptFile:i,onLoadCallback:o}]};e.ensurePowerView=t;var g={javaScriptFilesWithCallback:[{javascriptFile:i,onLoadCallback:o}]};e.ensureMap=r,e.mapControlLoaded=n,e.waitForMapControlLoaded=o}(jsCommon||(jsCommon={}));var globalMapControlLoaded=function(){jsCommon.mapControlLoaded()},InJs;!function(e){!function(e){e[e.information=0]="information",e[e.verbose=1]="verbose",e[e.warning=2]="warning",e[e.error=3]="error",e[e.expectedError=4]="expectedError",e[e.unexpectedError=5]="unexpectedError",e[e.fatal=6]="fatal"}(e.TraceType||(e.TraceType={}));e.TraceType}(InJs||(InJs={}));

;var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.visitEntity=function(e,t){return this.visitDefault(e,t)},e.prototype.visitColumnRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitMeasureRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAggr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitPercentile=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchy=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchyLevel=function(e,t){return this.visitDefault(e,t)},e.prototype.visitPropertyVariationSource=function(e,t){return this.visitDefault(e,t)},e.prototype.visitSelectRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitBetween=function(e,t){return this.visitDefault(e,t)},e.prototype.visitIn=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitOr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitCompare=function(e,t){return this.visitDefault(e,t)},e.prototype.visitContains=function(e,t){return this.visitDefault(e,t)},e.prototype.visitExists=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNot=function(e,t){return this.visitDefault(e,t)},e.prototype.visitStartsWith=function(e,t){return this.visitDefault(e,t)},e.prototype.visitConstant=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateSpan=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateAdd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNow=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefaultValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnyValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitArithmetic=function(e,t){return this.visitDefault(e,t)},e.prototype.visitFillRule=function(e,t){return this.visitDefault(e,t)},e.prototype.visitResourcePackageItem=function(e,t){return this.visitDefault(e,t)},e.prototype.visitScopedEval=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefault=function(e,t){},e}();e.DefaultSQExprVisitorWithArg=t;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.DefaultSQExprVisitor=r;var i=function(){function e(){}return e.prototype.visitEntity=function(e){this.visitDefault(e)},e.prototype.visitColumnRef=function(e){e.source.accept(this)},e.prototype.visitMeasureRef=function(e){e.source.accept(this)},e.prototype.visitAggr=function(e){e.arg.accept(this)},e.prototype.visitPercentile=function(e){e.arg.accept(this)},e.prototype.visitHierarchy=function(e){e.arg.accept(this)},e.prototype.visitHierarchyLevel=function(e){e.arg.accept(this)},e.prototype.visitPropertyVariationSource=function(e){e.arg.accept(this)},e.prototype.visitSelectRef=function(e){this.visitDefault(e)},e.prototype.visitBetween=function(e){e.arg.accept(this),e.lower.accept(this),e.upper.accept(this)},e.prototype.visitIn=function(e){for(var t=e.args,r=0,i=t.length;i>r;r++)t[r].accept(this);for(var n=e.values,r=0,i=n.length;i>r;r++)for(var a=n[r],o=0,u=a.length;u>o;o++)a[o].accept(this)},e.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitCompare=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitContains=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitExists=function(e){e.arg.accept(this)},e.prototype.visitNot=function(e){e.arg.accept(this)},e.prototype.visitStartsWith=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitConstant=function(e){this.visitDefault(e)},e.prototype.visitDateSpan=function(e){e.arg.accept(this)},e.prototype.visitDateAdd=function(e){e.arg.accept(this)},e.prototype.visitNow=function(e){this.visitDefault(e)},e.prototype.visitDefaultValue=function(e){this.visitDefault(e)},e.prototype.visitAnyValue=function(e){this.visitDefault(e)},e.prototype.visitArithmetic=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitFillRule=function(e){e.input.accept(this);var t=e.rule,r=t.linearGradient2,i=t.linearGradient3;r&&this.visitLinearGradient2(r),i&&this.visitLinearGradient3(i)},e.prototype.visitLinearGradient2=function(e){this.visitFillRuleStop(e.min),this.visitFillRuleStop(e.max)},e.prototype.visitLinearGradient3=function(e){this.visitFillRuleStop(e.min),this.visitFillRuleStop(e.mid),this.visitFillRuleStop(e.max)},e.prototype.visitResourcePackageItem=function(e){this.visitDefault(e)},e.prototype.visitScopedEval=function(e){e.expression.accept(this);for(var t=0,r=e.scope;t<r.length;t++){var i=r[t];i.accept(this)}},e.prototype.visitDefault=function(e){},e.prototype.visitFillRuleStop=function(e){e.color.accept(this);var t=e.value;t&&t.accept(this)},e}();e.DefaultSQExprVisitorWithTraversal=i}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return new r(e)}e.createEnumType=t;var r=function(){function e(e){this.allMembers=e}return e.prototype.members=function(e){var t=this.allMembers;if(!e)return t;for(var r=[],i=0,n=t;i<n.length;i++){var a=n[i];_.contains(e,a.value)&&r.push(a)}return r},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){if(e===!0)return!1;var t=e;return!!t.nullable}e.nullable=t}(t=e.FillSolidColorTypeDescriptor||(e.FillSolidColorTypeDescriptor={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.urlType={misc:{imageUrl:!0}}}(t=e.ImageDefinition||(e.ImageDefinition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return!!(e.fill||e.fillRule||e.filter||e.expression||e.image||e.paragraphs)}e.isValid=t}(t=e.StructuralTypeDescriptor||(e.StructuralTypeDescriptor={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return e&g}function r(e){return(e&d)===e}function i(e){if(r(e))return null;var t=h[e];if(t){var i=t.lastIndexOf("_");if(i>0){var n=t.slice(0,i);h[n]&&(t=n)}}return t||null}function n(e,r){var i=v[e],n=h[i];if(null==n&&(n=h.Null),e&&r){var a=h[r];if(a){var o=t(a);o===v.Null?(a=n|a,h[a]&&(n=a)):o===e&&(n=a)}}return n}function a(e,t){return(e&y)===(t&y)}var o=jsCommon.EnumExtensions,u=function(){function e(e,t,r){this.underlyingType=e,this.category=t,o.hasFlag(e,h.Temporal)&&(this.temporalType=new c(e)),o.hasFlag(e,h.Geography)&&(this.geographyType=new l(e)),o.hasFlag(e,h.Miscellaneous)&&(this.miscType=new p(e)),o.hasFlag(e,h.Formatting)&&(this.formattingType=new f(e)),o.hasFlag(e,h.Enumeration)&&(this.enumType=r),o.hasFlag(e,h.Scripting)&&(this.scriptingType=new s(e))}return e.fromDescriptor=function(t){if(t=t||{},t.text)return e.fromExtendedType(h.Text);if(t.integer)return e.fromExtendedType(h.Integer);if(t.numeric)return e.fromExtendedType(h.Double);if(t.bool)return e.fromExtendedType(h.Boolean);if(t.dateTime)return e.fromExtendedType(h.DateTime);if(t.duration)return e.fromExtendedType(h.Duration);if(t.binary)return e.fromExtendedType(h.Binary);if(t.none)return e.fromExtendedType(h.None);if(t.scripting&&t.scripting.source)return e.fromExtendedType(h.ScriptSource);if(t.enumeration)return e.fromEnum(t.enumeration);if(t.temporal){if(t.temporal.year)return e.fromExtendedType(h.Year_Integer);if(t.temporal.month)return e.fromExtendedType(h.Month_Integer)}if(t.geography){if(t.geography.address)return e.fromExtendedType(h.Address);if(t.geography.city)return e.fromExtendedType(h.City);if(t.geography.continent)return e.fromExtendedType(h.Continent);if(t.geography.country)return e.fromExtendedType(h.Country);if(t.geography.county)return e.fromExtendedType(h.County);if(t.geography.region)return e.fromExtendedType(h.Region);if(t.geography.postalCode)return e.fromExtendedType(h.PostalCode_Text);if(t.geography.stateOrProvince)return e.fromExtendedType(h.StateOrProvince);if(t.geography.place)return e.fromExtendedType(h.Place);if(t.geography.latitude)return e.fromExtendedType(h.Latitude_Double);if(t.geography.longitude)return e.fromExtendedType(h.Longitude_Double)}if(t.misc){if(t.misc.image)return e.fromExtendedType(h.Image);if(t.misc.imageUrl)return e.fromExtendedType(h.ImageUrl);if(t.misc.webUrl)return e.fromExtendedType(h.WebUrl);if(t.misc.barcode)return e.fromExtendedType(h.Barcode_Text)}if(t.formatting){if(t.formatting.color)return e.fromExtendedType(h.Color);if(t.formatting.formatString)return e.fromExtendedType(h.FormatString);if(t.formatting.alignment)return e.fromExtendedType(h.Alignment);if(t.formatting.labelDisplayUnits)return e.fromExtendedType(h.LabelDisplayUnits);if(t.formatting.fontSize)return e.fromExtendedType(h.FontSize);if(t.formatting.labelDensity)return e.fromExtendedType(h.LabelDensity)}return t.extendedType?e.fromExtendedType(t.extendedType):e.fromExtendedType(h.Null)},e.fromExtendedType=function(r){r=r||h.Null;var n=t(r),a=i(r);return e.fromPrimitiveTypeAndCategory(n,a)},e.fromPrimitiveTypeAndCategory=function(t,r){t=t||v.Null,r=r||null;var i=t.toString();return r&&(i+="|"+r),e.typeCache[i]||(e.typeCache[i]=new e(n(t,r),r))},e.fromEnum=function(t){return new e(h.Enumeration,null,t)},e.isCompatibleTo=function(t,r){for(var i=e.fromDescriptor(t),n=0,a=r;n<a.length;n++){var o=a[n],u=e.fromDescriptor(o);if(u.isCompatibleFrom(i))return!0}return!1},e.prototype.isCompatibleFrom=function(e){var t=e.primitiveType;return this===e||this.primitiveType===t||t===v.Null},e.prototype.equals=function(e){return _.isEqual(this,e)},Object.defineProperty(e.prototype,"primitiveType",{get:function(){return t(this.underlyingType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendedType",{get:function(){return this.underlyingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryString",{get:function(){return this.category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.primitiveType===v.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numeric",{get:function(){return o.hasFlag(this.underlyingType,h.Numeric)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"integer",{get:function(){return this.primitiveType===v.Integer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bool",{get:function(){return this.primitiveType===v.Boolean},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateTime",{get:function(){return this.primitiveType===v.DateTime||this.primitiveType===v.Date||this.primitiveType===v.Time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.primitiveType===v.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binary",{get:function(){return this.primitiveType===v.Binary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return this.primitiveType===v.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporal",{get:function(){return this.temporalType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geography",{get:function(){return this.geographyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"misc",{get:function(){return this.miscType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatting",{get:function(){return this.formattingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enum",{get:function(){return this.enumType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scripting",{get:function(){return this.scriptingType},enumerable:!0,configurable:!0}),e.typeCache={},e}();e.ValueType=u;var s=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"source",{get:function(){return a(this.underlyingType,h.ScriptSource)},enumerable:!0,configurable:!0}),e}();e.ScriptType=s;var c=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"year",{get:function(){return a(this.underlyingType,h.Year)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return a(this.underlyingType,h.Month)},enumerable:!0,configurable:!0}),e}();e.TemporalType=c;var l=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"address",{get:function(){return a(this.underlyingType,h.Address)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return a(this.underlyingType,h.City)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"continent",{get:function(){return a(this.underlyingType,h.Continent)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"country",{get:function(){return a(this.underlyingType,h.Country)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"county",{get:function(){return a(this.underlyingType,h.County)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"region",{get:function(){return a(this.underlyingType,h.Region)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"postalCode",{get:function(){return a(this.underlyingType,h.PostalCode)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateOrProvince",{get:function(){return a(this.underlyingType,h.StateOrProvince)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"place",{get:function(){return a(this.underlyingType,h.Place)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitude",{get:function(){return a(this.underlyingType,h.Latitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return a(this.underlyingType,h.Longitude)},enumerable:!0,configurable:!0}),e}();e.GeographyType=l;var p=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"image",{get:function(){return a(this.underlyingType,h.Image)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return a(this.underlyingType,h.ImageUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return a(this.underlyingType,h.WebUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"barcode",{get:function(){return a(this.underlyingType,h.Barcode)},enumerable:!0,configurable:!0}),e}();e.MiscellaneousType=p;var f=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"color",{get:function(){return a(this.underlyingType,h.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatString",{get:function(){return a(this.underlyingType,h.FormatString)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return a(this.underlyingType,h.Alignment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplayUnits",{get:function(){return a(this.underlyingType,h.LabelDisplayUnits)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return a(this.underlyingType,h.FontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDensity",{get:function(){return a(this.underlyingType,h.LabelDensity)},enumerable:!0,configurable:!0}),e}();e.FormattingType=f,function(e){e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=2]="Decimal",e[e.Double=3]="Double",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=6]="Date",e[e.DateTime=7]="DateTime",e[e.DateTimeZone=8]="DateTimeZone",e[e.Time=9]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None"}(e.PrimitiveType||(e.PrimitiveType={}));var v=e.PrimitiveType;!function(e){e[e.Numeric=256]="Numeric",e[e.Temporal=512]="Temporal",e[e.Geography=1024]="Geography",e[e.Miscellaneous=2048]="Miscellaneous",e[e.Formatting=4096]="Formatting",e[e.Scripting=8192]="Scripting",e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=258]="Decimal",e[e.Double=259]="Double",e[e.Integer=260]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=518]="Date",e[e.DateTime=519]="DateTime",e[e.DateTimeZone=520]="DateTimeZone",e[e.Time=521]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None",e[e.Year=66048]="Year",e[e.Year_Text=66049]="Year_Text",e[e.Year_Integer=66308]="Year_Integer",e[e.Year_Date=66054]="Year_Date",e[e.Year_DateTime=66055]="Year_DateTime",e[e.Month=131584]="Month",e[e.Month_Text=131585]="Month_Text",e[e.Month_Integer=131844]="Month_Integer",e[e.Month_Date=131590]="Month_Date",e[e.Month_DateTime=131591]="Month_DateTime",e[e.Address=6554625]="Address",e[e.City=6620161]="City",e[e.Continent=6685697]="Continent",e[e.Country=6751233]="Country",e[e.County=6816769]="County",e[e.Region=6882305]="Region",e[e.PostalCode=6947840]="PostalCode",e[e.PostalCode_Text=6947841]="PostalCode_Text",e[e.PostalCode_Integer=6948100]="PostalCode_Integer",e[e.StateOrProvince=7013377]="StateOrProvince",e[e.Place=7078913]="Place",e[e.Latitude=7144448]="Latitude",e[e.Latitude_Decimal=7144706]="Latitude_Decimal",e[e.Latitude_Double=7144707]="Latitude_Double",e[e.Longitude=7209984]="Longitude",e[e.Longitude_Decimal=7210242]="Longitude_Decimal",e[e.Longitude_Double=7210243]="Longitude_Double",e[e.Image=13109259]="Image",e[e.ImageUrl=13174785]="ImageUrl",e[e.WebUrl=13240321]="WebUrl",e[e.Barcode=13305856]="Barcode",e[e.Barcode_Text=13305857]="Barcode_Text",e[e.Barcode_Integer=13306116]="Barcode_Integer",e[e.Color=19664897]="Color",e[e.FormatString=19730433]="FormatString",e[e.Alignment=20058113]="Alignment",e[e.LabelDisplayUnits=20123649]="LabelDisplayUnits",e[e.FontSize=20189443]="FontSize",e[e.LabelDensity=20254979]="LabelDensity",e[e.Enumeration=26214401]="Enumeration",e[e.ScriptSource=32776193]="ScriptSource"}(e.ExtendedType||(e.ExtendedType={}));var h=e.ExtendedType,g=255,d=65535,y=4294901760}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.Top=0]="Top",e[e.First=1]="First",e[e.Last=2]="Last",e[e.Sample=3]="Sample",e[e.Bottom=4]="Bottom"}(e.DataShapeBindingLimitType||(e.DataShapeBindingLimitType={}));e.DataShapeBindingLimitType;!function(e){e[e.None=0]="None",e[e.Before=1]="Before",e[e.After=2]="After"}(e.SubtotalType||(e.SubtotalType={}));e.SubtotalType}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){if(e){var t;return e.top&&(t={Top:{}},e.top.count&&(t.Top.Count=e.top.count)),e.bottom&&(t={Bottom:{}},e.bottom.count&&(t.Bottom.Count=e.bottom.count)),e.sample&&(t={Sample:{}},e.sample.count&&(t.Sample.Count=e.sample.count)),e.window&&(t={Window:{}},e.window.count&&(t.Window.Count=e.window.count)),t}}e.createFrom=t}(t=e.DataShapeBindingDataReduction||(e.DataShapeBindingDataReduction={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.schemas=e.schemas,e.links&&(this.links=e.links)}return e.prototype.schema=function(e){return this.schemas[e]},e}();e.FederatedConceptualSchema=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function i(r,i){if(!_.isEmpty(r)){for(var n=[],a=0,o=r.length;o>a;a++){var u=r[a],s=u.data,c=void 0;if(s&&s.length)for(var l=0,p=s.length;p>l;l++)c=t.SQExprBuilder.and(c,u.data[l].expr);c&&n.push(c)}return _.isEmpty(n)?void 0:e.DataViewScopeIdentity.filterFromExprs(n,i)}}function n(r,i){var n=r.data;if(n.length!==i.length)return!1;for(var a=0,o=n.length;o>a;a++){var u=r.data[a],s=u;if(s.expr){if(!e.DataViewScopeIdentity.equals(s,i[a]))return!1}else if(!t.DataViewScopeWildcard.matches(u,i[a]))return!1}return!0}function a(e,r){var i=e.data,n=i.length;if(n!==r.length)return!1;for(var a=0;n>a;a++){var o=e.data[a],u=void 0;if(o.expr)u=t.ScopeIdentityExtractor.getKeys(o.expr);else{if(!o.exprs)return!1;u=o.exprs}if(u&&!t.SQExprUtils.sequenceEqual(r[a],u))return!1}return!0}function o(e,t){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:e.id!==t.id?!1:e.metadata!==t.metadata?!1:!!u(e.data,t.data)}function u(e,t){if(e=e||null,t=t||null,e===t)return!0;if(!e!=!t)return!1;if(e.length!==t.length)return!1;for(var r=0,i=e.length;i>r;r++)if(!s(e[r],t[r]))return!1;return!0}function s(r,i){var n=r,a=i;return n.expr&&a.expr?e.DataViewScopeIdentity.equals(n,a):n.exprs&&a.exprs?t.DataViewScopeWildcard.equals(n,a):n.roles&&a.roles?t.DataViewRoleWildcard.equals(n,a):!1}function c(e){var t={};if(e.data){for(var r=[],i=0,n=e.data.length;n>i;i++)r.push(e.data[i].key);t.data=r}return e.metadata&&(t.metadata=e.metadata),e.id&&(t.id=e.id),JSON.stringify(t)}function l(e){var t=e.data;if(!t)return!1;for(var r=0,i=t;r<i.length;r++){var n=i[r],a=n;if(a.exprs||a.roles)return!0}return!1}function p(e){var t=e.data;if(_.isEmpty(t))return!1;for(var r=0,i=t;r<i.length;r++){var n=i[r];if(f(n))return!0}return!1}function f(e){return!_.isEmpty(e.roles)}r.filterFromSelector=i,r.matchesData=n,r.matchesKeys=a,r.equals=o,r.getKey=c,r.containsWildcard=l,r.hasRoleWildcard=p,r.isRoleWildcard=f}(r=t.Selector||(t.Selector={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){switch(e){case 0:return"Add";case 1:return"Subtract";case 2:return"Multiply";case 3:return"Divide"}throw new Error("Unexpected ArithmeticOperatorKind: "+e)}!function(e){e[e.Table=0]="Table",e[e.Pod=1]="Pod"}(e.EntitySourceType||(e.EntitySourceType={}));e.EntitySourceType;e.getArithmeticOperatorName=t,function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year",e[e.Decade=4]="Decade",e[e.Second=5]="Second",e[e.Minute=6]="Minute",e[e.Hour=7]="Hour"}(e.TimeUnit||(e.TimeUnit={}));e.TimeUnit;!function(e){e[e.Sum=0]="Sum",e[e.Avg=1]="Avg",e[e.Count=2]="Count",e[e.Min=3]="Min",e[e.Max=4]="Max",e[e.CountNonNull=5]="CountNonNull",e[e.Median=6]="Median",e[e.StandardDeviation=7]="StandardDeviation",e[e.Variance=8]="Variance"}(e.QueryAggregateFunction||(e.QueryAggregateFunction={}));e.QueryAggregateFunction;!function(e){e[e.Equal=0]="Equal",e[e.GreaterThan=1]="GreaterThan",e[e.GreaterThanOrEqual=2]="GreaterThanOrEqual",e[e.LessThan=3]="LessThan",e[e.LessThanOrEqual=4]="LessThanOrEqual"}(e.QueryComparisonKind||(e.QueryComparisonKind={}));e.QueryComparisonKind;!function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.Integer=3]="Integer",e[e.DateTime=4]="DateTime",e[e.Time=8]="Time",e[e.Date=20]="Date",e[e.Month=35]="Month",e[e.Year=67]="Year",e[e.YearAndMonth=128]="YearAndMonth",e[e.MonthAndDay=256]="MonthAndDay",e[e.Decade=515]="Decade",e[e.YearAndWeek=1024]="YearAndWeek",e[e.String=2048]="String",e[e.Boolean=4096]="Boolean",e[e.Table=8192]="Table",e[e.Range=16384]="Range"}(e.SemanticType||(e.SemanticType={}));e.SemanticType;!function(e){e[e.Default=0]="Default",e[e.Period=1]="Period"}(e.FilterKind||(e.FilterKind={}));e.FilterKind}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e,t,r){this.items=e,this._activeProjectionRefs=t,this._showAll=r}return e.prototype.all=function(){return this.items},Object.defineProperty(e.prototype,"activeProjectionRefs",{get:function(){return this._activeProjectionRefs},set:function(e){if(!_.isEmpty(e)){for(var t=this.items.map(function(e){return e.queryRef}),r=0,i=e;r<i.length;r++){var n=i[r];if(!_.contains(t,n))return}this._activeProjectionRefs=e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAll",{get:function(){return this._showAll},set:function(e){this._showAll=e},enumerable:!0,configurable:!0}),e.prototype.addActiveQueryReference=function(e){this._activeProjectionRefs?this._activeProjectionRefs.push(e):this._activeProjectionRefs=[e]},e.prototype.getLastActiveQueryReference=function(){return _.isEmpty(this._activeProjectionRefs)?void 0:this._activeProjectionRefs[this._activeProjectionRefs.length-1]},e.prototype.replaceQueryRef=function(e,t){for(var r=0,i=this.items;r<i.length;r++){var n=i[r];n.queryRef===e&&(n.queryRef=t)}},e.prototype.clone=function(){return new e(_.cloneDeep(this.items),_.clone(this._activeProjectionRefs),this._showAll)},e}();e.QueryProjectionCollection=t;var r;!function(e){function t(e){if(!e)return e;var t={};for(var r in e)t[r]=e[r].clone();return t}function r(e,t){return e?e[t]:void 0}e.clone=t,e.getRole=r}(r=e.QueryProjectionsByRole||(e.QueryProjectionsByRole={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Default=0]="Default",e[e.Verbose=1]="Verbose",e[e.WholeUnits=2]="WholeUnits",e[e.DataLabels=3]="DataLabels"}(e.DisplayUnitSystemType||(e.DisplayUnitSystemType={}));e.DisplayUnitSystemType}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(e){this.unit=e,this.sequence=[],this.min=new Date("9999-12-31T23:59:59.999"),this.max=new Date("0001-01-01T00:00:00.000")}return t.prototype.add=function(e){e<this.min&&(this.min=e),e>this.max&&(this.max=e),this.sequence.push(e)},t.prototype.extendToCover=function(e,r){for(var i=this.min;i>e;)i=t.addInterval(i,-this.interval,this.unit),this.sequence.splice(0,0,i);for(this.min=i,i=this.max;r>i;)i=t.addInterval(i,this.interval,this.unit),this.sequence.push(i);this.max=i},t.prototype.moveToCover=function(e,r){var i=t.getDelta(e,r,this.unit),n=Math.floor(i/this.interval);for(this.min=t.addInterval(this.min,n*this.interval,this.unit),this.sequence=[],this.sequence.push(this.min),this.max=this.min;this.max<r;)this.max=t.addInterval(this.max,this.interval,this.unit),this.sequence.push(this.max)},t.calculate=function(r,i,n,a){switch(a||(a=t.getIntervalUnit(r,i,n)),a){case e.DateTimeUnit.Year:return t.calculateYears(r,i,n);case e.DateTimeUnit.Month:return t.calculateMonths(r,i,n);case e.DateTimeUnit.Week:return t.calculateWeeks(r,i,n);case e.DateTimeUnit.Day:return t.calculateDays(r,i,n);case e.DateTimeUnit.Hour:return t.calculateHours(r,i,n);case e.DateTimeUnit.Minute:return t.calculateMinutes(r,i,n);case e.DateTimeUnit.Second:return t.calculateSeconds(r,i,n);case e.DateTimeUnit.Millisecond:return t.calculateMilliseconds(r,i,n)}},t.calculateYears=function(r,i,n){var a=e.NumericSequenceRange.calculateDataRange(r.getFullYear(),i.getFullYear(),!1),o=e.NumericSequence.calculate(e.NumericSequenceRange.calculate(0,a.max-a.min),n,0,null,null,[1,2,5]),u=Math.floor(a.min/o.interval)*o.interval,s=new Date(u,0,1),c=t.fromNumericSequence(s,o,e.DateTimeUnit.Year);return c},t.calculateMonths=function(r,i,n){var a=r.getFullYear(),o=i.getFullYear(),u=r.getMonth(),s=12*(o-a)+i.getMonth(),c=new Date(a,0,1),l=e.NumericSequence.calculateUnits(u,s,n,[1,2,3,6,12]),p=t.fromNumericSequence(c,l,e.DateTimeUnit.Month);return p},t.calculateWeeks=function(r,i,n){var a=0,o=r.getDay(),u=(o-a+7)%7,s=r.getDate()-u,c=new Date(r.getFullYear(),r.getMonth(),s),l=0,p=e.Double.ceilWithPrecision(t.getDelta(c,i,e.DateTimeUnit.Week)),f=e.NumericSequence.calculateUnits(l,p,n,[1,2,4,8]),v=t.fromNumericSequence(c,f,e.DateTimeUnit.Week);return v},t.calculateDays=function(r,i,n){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),o=0,u=e.Double.ceilWithPrecision(t.getDelta(r,i,e.DateTimeUnit.Day)),s=e.NumericSequence.calculateUnits(o,u,n,[1,2,7,14]),c=t.fromNumericSequence(a,s,e.DateTimeUnit.Day);return c},t.calculateHours=function(r,i,n){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),o=e.Double.floorWithPrecision(t.getDelta(a,r,e.DateTimeUnit.Hour)),u=e.Double.ceilWithPrecision(t.getDelta(a,i,e.DateTimeUnit.Hour)),s=e.NumericSequence.calculateUnits(o,u,n,[1,2,3,6,12,24]),c=t.fromNumericSequence(a,s,e.DateTimeUnit.Hour);return c},t.calculateMinutes=function(r,i,n){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours()),o=e.Double.floorWithPrecision(t.getDelta(a,r,e.DateTimeUnit.Minute)),u=e.Double.ceilWithPrecision(t.getDelta(a,i,e.DateTimeUnit.Minute)),s=e.NumericSequence.calculateUnits(o,u,n,[1,2,5,10,15,30,60,120,180,360,720,1440]),c=t.fromNumericSequence(a,s,e.DateTimeUnit.Minute);return c},t.calculateSeconds=function(r,i,n){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes()),o=e.Double.floorWithPrecision(t.getDelta(a,r,e.DateTimeUnit.Second)),u=e.Double.ceilWithPrecision(t.getDelta(a,i,e.DateTimeUnit.Second)),s=e.NumericSequence.calculateUnits(o,u,n,[1,2,5,10,15,30,60,120,300,600,900,1800,3600]),c=t.fromNumericSequence(a,s,e.DateTimeUnit.Second);return c},t.calculateMilliseconds=function(r,i,n){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()),o=t.getDelta(a,r,e.DateTimeUnit.Millisecond),u=t.getDelta(a,i,e.DateTimeUnit.Millisecond),s=e.NumericSequence.calculate(e.NumericSequenceRange.calculate(o,u),n,0),c=t.fromNumericSequence(a,s,e.DateTimeUnit.Millisecond);return c},t.addInterval=function(t,i,n){switch(i=Math.round(i),n){case e.DateTimeUnit.Year:return r.addYears(t,i);case e.DateTimeUnit.Month:return r.addMonths(t,i);case e.DateTimeUnit.Week:return r.addWeeks(t,i);case e.DateTimeUnit.Day:return r.addDays(t,i);case e.DateTimeUnit.Hour:return r.addHours(t,i);case e.DateTimeUnit.Minute:return r.addMinutes(t,i);case e.DateTimeUnit.Second:return r.addSeconds(t,i);case e.DateTimeUnit.Millisecond:return r.addMilliseconds(t,i)}},t.fromNumericSequence=function(e,r,i){for(var n=new t(i),a=0;a<r.sequence.length;a++){var o=r.sequence[a],u=t.addInterval(e,o,i);n.add(u)}return n.interval=r.interval,n.intervalOffset=r.intervalOffset,n},t.getDelta=function(t,r,i){var n=0;switch(i){case e.DateTimeUnit.Year:n=r.getFullYear()-t.getFullYear();break;case e.DateTimeUnit.Month:n=12*(r.getFullYear()-t.getFullYear())+r.getMonth()-t.getMonth();break;case e.DateTimeUnit.Week:n=(r.getTime()-t.getTime())/6048e5;break;case e.DateTimeUnit.Day:n=(r.getTime()-t.getTime())/864e5;break;case e.DateTimeUnit.Hour:n=(r.getTime()-t.getTime())/36e5;break;case e.DateTimeUnit.Minute:n=(r.getTime()-t.getTime())/6e4;break;case e.DateTimeUnit.Second:n=(r.getTime()-t.getTime())/1e3;break;case e.DateTimeUnit.Millisecond:n=r.getTime()-t.getTime()}return n},t.getIntervalUnit=function(r,i,n){n=Math.max(n,2);var a=t.getDelta(r,i,e.DateTimeUnit.Day);if(a>356&&a>=180*n)return e.DateTimeUnit.Year;if(a>60&&a>7*n)return e.DateTimeUnit.Month;if(a>14&&a>2*n)return e.DateTimeUnit.Week;var o=t.getDelta(r,i,e.DateTimeUnit.Hour);if(a>2&&o>12*n)return e.DateTimeUnit.Day;if(o>=24&&o>=n)return e.DateTimeUnit.Hour;var u=t.getDelta(r,i,e.DateTimeUnit.Minute);if(u>2&&u>=n)return e.DateTimeUnit.Minute;var s=t.getDelta(r,i,e.DateTimeUnit.Second);if(s>2&&s>=.8*n)return e.DateTimeUnit.Second;var c=t.getDelta(r,i,e.DateTimeUnit.Millisecond);if(c>0)return e.DateTimeUnit.Millisecond;var l=r;return 0!==l.getMilliseconds()?e.DateTimeUnit.Millisecond:0!==l.getSeconds()?e.DateTimeUnit.Second:0!==l.getMinutes()?e.DateTimeUnit.Minute:0!==l.getHours()?e.DateTimeUnit.Hour:1!==l.getDate()?e.DateTimeUnit.Day:0!==l.getMonth()?e.DateTimeUnit.Month:e.DateTimeUnit.Year},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t}();e.DateTimeSequence=t;var r;!function(e){function t(e){return e%4===0&&e%100!==0||e%400===0}function r(e,r){return t(e)?f[r]:p[r]}function i(e,r){var i=e.getFullYear(),n=e.getMonth(),a=e.getDate(),o=2===n&&29===a,u=new Date(e.getTime());return i+=r,o&&!t(i)&&(a=28),u.setFullYear(i,n,a),u}function n(e,t){var i=e.getFullYear(),n=e.getMonth(),a=e.getDate(),o=new Date(e.getTime());return i+=(t-t%12)/12,n+=t%12,n>11&&(n%=12,i++),a=Math.min(a,r(i,n)),o.setFullYear(i,n,a),o}function a(e,t){return o(e,7*t)}function o(e,t){var r=e.getFullYear(),i=e.getMonth(),n=e.getDate(),a=new Date(e.getTime());return a.setFullYear(r,i,n+t),a}function u(e,t){return new Date(e.getTime()+36e5*t)}function s(e,t){return new Date(e.getTime()+6e4*t)}function c(e,t){return new Date(e.getTime()+1e3*t)}function l(e,t){return new Date(e.getTime()+t)}var p=[31,28,31,30,31,30,31,31,30,31,30,31],f=[31,29,31,30,31,30,31,31,30,31,30,31];
e.addYears=i,e.addMonths=n,e.addWeeks=a,e.addDays=o,e.addHours=u,e.addMinutes=s,e.addSeconds=c,e.addMilliseconds=l}(r=e.DateUtils||(e.DateUtils={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(t,n){for(var a=[],o=3;i>o;o++){var u=t(o);u&&r(a,e.Double.pow10(o),u.title,u.format,n)}return a}function r(e,t,r,i,n){if(r||i){var a=t;if(e.length>0){var o=e[e.length-1];n&&(a=n(t,o.value,a)),o.applicableRangeMax=a}var u=new l;u.value=t,u.applicableRangeMin=a,u.applicableRangeMax=1e3*a,u.title=r,u.labelFormat=i,e.push(u)}}var i=24,n=1e15,a=1e-4,o="%",u="E+0",s="0.##"+u,c=/^([0\#,]*\.[0\#]+|[0\#,]+|g)$/i,l=function(){function t(){}return t.prototype.project=function(t){return this.value?e.Double.removeDecimalNoise(t/this.value):t},t.prototype.reverseProject=function(e){return this.value?e*this.value:e},t.prototype.isApplicableTo=function(t){t=Math.abs(t);var r=e.Double.getPrecision(t,3);return e.Double.greaterOrEqualWithPrecision(t,this.applicableRangeMin,r)&&e.Double.lessWithPrecision(t,this.applicableRangeMax,r)},t.prototype.isScaling=function(){return this.value>1},t}();e.DisplayUnit=l;var p=function(){function t(e){this.units=e?e:[]}return Object.defineProperty(t.prototype,"title",{get:function(){return this.displayUnit?this.displayUnit.title:void 0},enumerable:!0,configurable:!0}),t.prototype.update=function(e){void 0!==e&&(this.unitBaseValue=e,this.displayUnit=this.findApplicableDisplayUnit(e))},t.prototype.findApplicableDisplayUnit=function(e){for(var t=0,r=this.units;t<r.length;t++){var i=r[t];if(i.isApplicableTo(e))return i}},t.prototype.format=function(t,r,i,n){if(this.isFormatSupported(r)){if(i=this.getNumberOfDecimalsForFormatting(r,i),this.hasScientitifcFormat(r))return this.formatHelper(t,"",r,i,n);if(this.isScalingUnit()&&this.shouldRespectScalingUnit(r))return this.formatHelper(this.displayUnit.project(t),this.displayUnit.labelFormat,r,i,n);if(null!=i)return this.formatHelper(t,"",r,i,n)}return e.formattingService.formatValue(t,r)},t.prototype.isFormatSupported=function(e){return!t.UNSUPPORTED_FORMATS.test(e)},t.prototype.isPercentageFormat=function(e){return e&&e.indexOf(o)>=0},t.prototype.shouldRespectScalingUnit=function(e){return!this.isPercentageFormat(e)},t.prototype.getNumberOfDecimalsForFormatting=function(e,t){return t},t.prototype.isScalingUnit=function(){return this.displayUnit&&this.displayUnit.isScaling()},t.prototype.formatHelper=function(t,r,i,n,a){if("g"!==i&&"G"!==i||null==n||(i=e.visuals.valueFormatter.DefaultNumericFormat),i=e.NumberFormat.addDecimalsToFormat(i,n,a),i&&!e.formattingService.isStandardNumberFormat(i))return e.formattingService.formatNumberWithCustomOverride(t,i,r);i||(i="G"),r||(r="{0}");var o=e.formattingService.formatValue(t,i);return e.formattingService.format(r,[o])},t.prototype.formatSingleValue=function(t,r,i,n){return this.update(this.shouldUseValuePrecision(t)?e.Double.getPrecision(t,8):t),this.format(t,r,i,n)},t.prototype.shouldUseValuePrecision=function(e){if(0===this.units.length)return!0;for(var t=0,r=0;r<this.units.length;r++)if(this.units[r].isScaling()){t=this.units[r].applicableRangeMin;break}return Math.abs(e)<t},t.prototype.isScientific=function(e){return-n>e||e>n||e>-a&&a>e&&0!==e},t.prototype.hasScientitifcFormat=function(e){return e&&-1!==e.toUpperCase().indexOf("E")},t.prototype.supportsScientificFormat=function(e){return e?c.test(e):!0},t.prototype.shouldFallbackToScientific=function(e,t){return!this.hasScientitifcFormat(t)&&this.supportsScientificFormat(t)&&this.isScientific(e)},t.prototype.getScientificFormat=function(t,r,i,n){if(this.isFormatSupported(r)&&this.shouldFallbackToScientific(t,r)){var a=e.NumberFormat.getNumericFormat(t,r);return i&&(a=e.NumberFormat.addDecimalsToFormat(a?a:"0",Math.abs(i),n)),a?a+u:s}return r},t.UNSUPPORTED_FORMATS=/^(p\d*)|(.*\%)|(e\d*)$/i,t}();e.DisplayUnitSystem=p;var f=function(e){function t(){e.call(this,[])}return __extends(t,e),t}(p);e.NoDisplayUnitSystem=f;var v=function(e){function r(t){e.call(this,r.getUnits(t))}return __extends(r,e),r.prototype.format=function(t,r,i,n){return r=this.getScientificFormat(t,r,i,n),e.prototype.format.call(this,t,r,i,n)},r.reset=function(){r.units=null},r.getUnits=function(e){return r.units||(r.units=t(e,function(e,t,r){return e-t>=1e3?e/10:r}),r.units[r.units.length-1].applicableRangeMax=1/0),r.units},r}(p);e.DefaultDisplayUnitSystem=v;var h=function(e){function r(t){e.call(this,r.getUnits(t))}return __extends(r,e),r.reset=function(){r.units=null},r.getUnits=function(e){return r.units||(r.units=t(e),r.units[r.units.length-1].applicableRangeMax=1/0),r.units},r.prototype.format=function(t,r,i,n){return r=this.getScientificFormat(t,r,i,n),e.prototype.format.call(this,t,r,i,n)},r}(p);e.WholeUnitsDisplayUnitSystem=h;var g=function(e){function i(t){e.call(this,i.getUnits(t))}return __extends(i,e),i.prototype.isFormatSupported=function(e){return!i.UNSUPPORTED_FORMATS.test(e)},i.getUnits=function(e){if(!i.units){var n=[],a=function(e,t,r){return-1===e&&e-t>=1e3?e/10:r},o=e(-1);r(n,i.AUTO_DISPLAYUNIT_VALUE,o.title,o.format,a),o=e(0),r(n,i.NONE_DISPLAYUNIT_VALUE,o.title,o.format,a),i.units=n.concat(t(e,a)),i.units[i.units.length-1].applicableRangeMax=1/0}return i.units},i.prototype.format=function(t,r,i,n){return r=this.getScientificFormat(t,r,i,n),e.prototype.format.call(this,t,r,i,n)},i.AUTO_DISPLAYUNIT_VALUE=0,i.NONE_DISPLAYUNIT_VALUE=1,i.UNSUPPORTED_FORMATS=/^(e\d*)$/i,i}(p);e.DataLabelsDisplayUnitSystem=g}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(){}return t.calculate=function(r,i,n,a,o,u){var s=new t;if(i=void 0===i?10:e.Double.ensureInRange(i,t.MIN_COUNT,t.MAX_COUNT),void 0===a&&(a=e.Double.MIN_EXP),void 0===o&&(o=!1),void 0===n&&(n=1),void 0===u&&(u=[1,2,5]),r.forcedSingleStop)return s.interval=r.getSize(),s.intervalOffset=s.interval-(r.forcedSingleStop-r.min),s.min=r.min,s.max=r.max,s.sequence=[r.forcedSingleStop],s;var c=0,l=0,p=9,f=n>0&&!r.hasFixedMin,v=n>0&&!r.hasFixedMax,h=r.getSize(),g=e.Double.log10(h),d=e.Double.log10(u[0]);g-=d;var y=e.Double.log10(i);g-=y,g=Math.max(g,a-d+1);var m=void 0;if(0!==c){var x=e.Double.pow10(g),S=e.Double.floorToPrecision(r.min,x),E=e.Double.ceilToPrecision(r.max,x),w=e.NumericSequenceRange.calculateFixedRange(S,E);w.shrinkByStep(r,c),l=w.min,p=w.max,m=Math.floor(w.getSize()/c)}else{var b=void 0;for(b=0;3>b;b++){for(var D=g+b,x=e.Double.pow10(D),S=e.Double.floorToPrecision(r.min,x),E=e.Double.ceilToPrecision(r.max,x),C=u.length,T=e.Double.pow10(D-1),V=0;C>V;V++){var _=u[V]*T,w=e.NumericSequenceRange.calculateFixedRange(S,E,o);if(w.shrinkByStep(r,_),f&&r.min===w.min&&n>=1&&(w.min-=_),v&&r.max===w.max&&n>=1&&(w.max+=_),m=e.Double.ceilWithPrecision(w.getSize()/_),i>=m||2===b&&V===C-1||1===i&&2===m&&(_>r.getSize()||r.min<0&&r.max>0&&2*_>=r.getSize())){c=_,l=w.min,p=w.max;break}}if(0!==c)break}}(m>32*i||m>t.MAX_COUNT)&&(m=Math.min(32*i,t.MAX_COUNT),c=(p-l)/m),s.min=l,s.max=p,s.interval=c,s.intervalOffset=l-r.min,s.maxAllowedMargin=n,s.canExtendMin=f,s.canExtendMax=v;var F=e.Double.getPrecision(c,0);s.precision=F;var P=[],M=e.Double.roundToPrecision(l,F);P.push(M);for(var V=0;m>V;V++)M=e.Double.roundToPrecision(M+c,F),P.push(M);return s.sequence=P,s.trimMinMax(r.min,r.max),s},t.calculateUnits=function(r,i,n,a){n=e.Double.ensureInRange(n,t.MIN_COUNT,t.MAX_COUNT),r===i&&(i=r+1);for(var o=0,u=0,s=0;s<a.length;s++){u=a[s];var c=e.Double.ceilWithPrecision(i/u),l=e.Double.floorWithPrecision(r/u);if(o=c-l,n>=o)break}var p=-r;p%=u;var f=new t;f.sequence=[];for(var v=r+p;f.sequence.push(v),!(v>=i);v+=u);return f.interval=u,f.intervalOffset=p,f.min=f.sequence[0],f.max=f.sequence[f.sequence.length-1],f},t.prototype.trimMinMax=function(e,t){var r=(e-this.min)/this.interval,i=(this.max-t)/this.interval,n=.001;(!this.canExtendMin||r>this.maxAllowedMargin&&r>n)&&(this.min=e),(!this.canExtendMax||i>this.maxAllowedMargin&&i>n)&&(this.max=t)},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t}();e.NumericSequence=t}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(){}return t.prototype._ensureIncludeZero=function(){this.includeZero&&(this.min>0&&!this.hasFixedMin&&(this.min=0),this.max<0&&!this.hasFixedMax&&(this.max=0))},t.prototype._ensureNotEmpty=function(){if(this.min===this.max)if(this.min){var r=this.min,i=e.Double.log10(Math.abs(r)),n=void 0;i>=0&&4>i?(n=.5,this.forcedSingleStop=r):(n=e.Double.pow10(i)/2,this.forcedSingleStop=null),this.min=r-n,this.max=r+n}else this.min=0,this.max=t.DEFAULT_MAX,this.hasFixedMin=!0,this.hasFixedMax=!0},t.prototype._ensureDirection=function(){if(this.min>this.max){var e=this.min;this.min=this.max,this.max=e}},t.prototype.getSize=function(){return this.max-this.min},t.prototype.shrinkByStep=function(e,t){var r=this.min/t,i=e.min/t,n=Math.floor(i-r);this.min+=n*t,r=this.max/t,i=e.max/t,n=Math.ceil(i-r),this.max+=n*t},t.calculate=function(i,n,a,o,u){var s=new t;return s.includeZero=!!u,s.hasDataRange=r.hasValue(i)&&r.hasValue(n),s.hasFixedMin=r.hasValue(a),s.hasFixedMax=r.hasValue(o),i=e.Double.ensureInRange(i,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),n=e.Double.ensureInRange(n,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),s.hasFixedMin&&s.hasFixedMax?(s.min=a,s.max=o):s.hasFixedMin?(s.min=a,s.max=n>a?n:a):s.hasFixedMax?(s.min=o>i?i:o,s.max=o):s.hasDataRange?(s.min=i,s.max=n):(s.min=0,s.max=0),s._ensureIncludeZero(),s._ensureNotEmpty(),s._ensureDirection(),0===s.min?s.hasFixedMin=!0:0===s.max&&(s.hasFixedMax=!0),s},t.calculateDataRange=function(e,i,n){return r.hasValue(e)&&r.hasValue(i)?t.calculate(e,i,null,null,n):t.calculateFixedRange(0,t.DEFAULT_MAX)},t.calculateFixedRange=function(e,r,i){var n=new t;return n.hasDataRange=!1,n.includeZero=i,n.min=e,n.max=r,n._ensureIncludeZero(),n._ensureNotEmpty(),n._ensureDirection(),n.hasFixedMin=!0,n.hasFixedMax=!0,n},t.DEFAULT_MAX=10,t.MIN_SUPPORTED_DOUBLE=-1e307,t.MAX_SUPPORTED_DOUBLE=1e307,t}();e.NumericSequenceRange=t;var r;!function(e){function t(e){return void 0!==e&&null!==e}e.hasValue=t}(r=e.ValueUtil||(e.ValueUtil={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){function r(e){var t=w[e];return t?b[t]||e:e}function i(e){var t=-1===e?"Auto":e.toString(),r=b["DisplayUnitSystem_E"+t+"_Title"],i=0>=e?"{0}":b["DisplayUnitSystem_E"+t+"_LabelFormat"];return r||i?{title:r,format:i}:void 0}function n(e){return b[e]}function a(t){return e.NumberFormat.getCustomFormatMetadata(t)}function o(t){D=t,e.DefaultDisplayUnitSystem.reset(),e.WholeUnitsDisplayUnitSystem.reset()}function u(e,t){void 0===t&&(t=!1);var r=t?D.beautify(e):e;return{format:function(e){return null==e?D["null"]:m(e,r)}}}function s(t){var r=t.allowFormatBeautification?D.beautify(t.format):t.format;if(f(t)){var i=p(t.displayUnitSystemType),n=!!t.formatSingleValues;i.update(Math.max(Math.abs(t.value||0),Math.abs(t.value2||0)));var a,o=null!=t.precision;if(o?a=-t.precision:i.displayUnit&&i.displayUnit.value>1&&(a=-C),t.detectAxisPrecision){o=!0;var s=t.value;i.displayUnit&&i.displayUnit.value>0&&(s/=i.displayUnit.value),a=e.Double.isInteger(s)?0:e.Double.log10(s)}return{format:function(t){var u=x(t,!0);return E.isNullOrUndefinedOrWhiteSpaceString(u)?(t&&!i.isScalingUnit()&&Math.abs(t)<T&&!o&&(t=e.Double.roundToPrecision(t)),n?i.formatSingleValue(t,r,a,o):i.format(t,r,a,o)):u},displayUnit:i.displayUnit,options:t}}if(v(t.value,t.value2,t.tickCount)){var c=e.DateTimeSequence.getIntervalUnit(t.value,t.value2,t.tickCount);return{format:function(t){if(null==t)return D["null"];var r=e.formattingService.dateFormatString(c);return m(t,r)},options:t}}return u(r)}function c(e,t,r){return null==e?D["null"]:m(e,r?D.beautify(t):t)}function l(e,t,r,i){if(!(t&&t.type&&t.type.dateTime)&&e instanceof Date){var n=h(F,null,!1);return m(e,n,i)}return m(e,h(t,r),i)}function p(t){if(null==t)return new e.DefaultDisplayUnitSystem(D.describe);switch(t){case e.DisplayUnitSystemType.Default:return new e.DefaultDisplayUnitSystem(D.describe);case e.DisplayUnitSystemType.WholeUnits:return new e.WholeUnitsDisplayUnitSystem(D.describe);case e.DisplayUnitSystemType.Verbose:return new e.NoDisplayUnitSystem;case e.DisplayUnitSystemType.DataLabels:return new e.DataLabelsDisplayUnitSystem(D.describe);default:return new e.DefaultDisplayUnitSystem(D.describe)}}function f(t){var r=t.value,i=t.value2,n=t.format;if(t.formatSingleValues&&n&&Math.abs(r)<V){var a=!e.NumberFormat.isStandardFormat(n);if(a){var o=e.NumberFormat.getCustomFormatMetadata(n,!0).precision;if(_>o)return!1}else if(e.Double.isInteger(r))return!1}return"number"==typeof r||"number"==typeof i?!0:void 0}function v(e,t,r){return e instanceof Date&&t instanceof Date&&void 0!==r&&null!==r}function h(r,i,n){if(r){if(i){var a=e.DataViewObjects.getValue(r.objects,i);if(a)return a}if(!n){var o=r.type;if(o){if(o.dateTime)return t.DefaultDateFormat;if(o.integer)return t.DefaultIntegerFormat;if(o.numeric)return t.DefaultNumericFormat}}}}function g(e,t){var r;if(!e)return null;var i=e.length;if(i>0){r=e[0];for(var n=i-1,a=1,o=n;o>a;a++){var u=e[a];r=E.format(D.restatementComma,r,u)}if(i>1){var u=e[n];r=E.format(t,r,u)}}else r=null;return r}function d(e){return g(e,D.restatementCompoundAnd)}function y(e){return g(e,D.restatementCompoundOr)}function m(t,r,i){var n=x(t,i?i:!1);return E.isNullOrUndefinedOrWhiteSpaceString(n)?e.formattingService.formatValue(t,r):n}function x(e,t){return null==e&&t?D["null"]:e===!0?D["true"]:e===!1?D["false"]:"number"==typeof e&&isNaN(e)?D.NaN:e===Number.NEGATIVE_INFINITY?D.negativeInfinity:e===Number.POSITIVE_INFINITY?D.infinity:""}function S(e){var t=p(e);return t.units}var E=jsCommon.StringExtensions,w={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"};t.DefaultIntegerFormat="g",t.DefaultNumericFormat="#,0.00",t.DefaultDateFormat="d";var b={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",RestatementComma:"{0}, {1}",RestatementCompoundAnd:"{0} and {1}",RestatementCompoundOr:"{0} or {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",Funnel_PercentOfFirst:"Percent of first",Funnel_PercentOfPrevious:"Percent of previous",Funnel_PercentOfFirst_Highlight:"Percent of first (highlighted)",Funnel_PercentOfPrevious_Highlight:"Percent of previous (highlighted)",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories"};t.getLocalizedString=n;var D={"null":b.NullValue,"true":b.BooleanTrue,"false":b.BooleanFalse,NaN:b.NaNValue,infinity:b.InfinityValue,negativeInfinity:b.NegativeInfinityValue,beautify:function(e){return r(e)},describe:function(e){return i(e)},restatementComma:b.RestatementComma,restatementCompoundAnd:b.RestatementCompoundAnd,restatementCompoundOr:b.RestatementCompoundOr},C=2,T=1e3,V=1e4,_=2,F={displayName:"",type:e.ValueType.fromPrimitiveTypeAndCategory(e.PrimitiveType.DateTime)};t.getFormatMetadata=a,t.setLocaleOptions=o,t.createDefaultFormatter=u,t.create=s,t.format=c,t.formatVariantMeasureValue=l,t.getFormatString=h,t.formatListAnd=d,t.formatListOr=y,t.getDisplayUnits=S}(r=t.valueFormatter||(t.valueFormatter={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(!_.isEmpty(e)){var r=e[0];if(r.values&&r.values.length>0)for(var n=0,a=r.values.length;a>n;++n){var o=r.values[n];if(o&&o.source&&i(o.source,t))return n}}return-1}function r(e,t){if(!_.isEmpty(e))for(var r=0,n=e.length;n>r;r++)if(i(e[r].source,t))return r;return-1}function i(e,t){var r=e.roles;return r&&r[t]}function n(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&_.any(e.metadata.columns,function(e){return e.roles&&void 0!==e.roles[t]})}function a(e,t){return e&&e.source&&e.source.roles&&e.source.roles[t]===!0}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=r,e.hasRole=i,e.hasRoleInDataView=n,e.hasRoleInValueColumn=a}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){return new n(e)}var i=e.data.DataRoleHelper;t.createIDataViewCategoricalReader=r;var n=function(){function e(e){this.dataView=e;var t;e&&(t=e.categorical);var r;t&&(r=this.categories=t.categories),this.hasValidCategories=!_.isEmpty(r);var i;if(t&&(i=t.values),this.hasAnyValidValues=!1,null!=i){var n=e.categorical.values.grouped();if(n.length>0){this.hasAnyValidValues=!0,this.grouped=n;for(var a={},o=n[0].values,u=0,s=o.length;s>u;u++){var c=o[u].source.roles;for(var l in c)c[l]&&(a[l]||(a[l]=[]),a[l].push(u))}this.valueRoleIndexMapping=a}}this.hasAnyValidValues&&(this.dataHasDynamicSeries=!!this.dataView.categorical.values.source)}return e.prototype.hasCategories=function(){return this.hasValidCategories},e.prototype.getCategoryCount=function(){return this.hasValidCategories?this.categories[0].values.length:0},e.prototype.getCategoryValues=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.values:void 0}},e.prototype.getCategoryValue=function(e,t){if(this.hasValidCategories){var r=this.getCategoryFromRole(e);return r?r.values[t]:void 0}},e.prototype.getCategoryColumn=function(e){return this.hasValidCategories?this.getCategoryFromRole(e):void 0},e.prototype.getCategoryMetadataColumn=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.source:void 0}},e.prototype.getCategoryColumnIdentityFields=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.identityFields:void 0}},e.prototype.getCategoryDisplayName=function(e){if(this.hasValidCategories){var t=this.getCategoryColumn(e);if(t&&t.source)return t.source.displayName}},e.prototype.hasCompositeCategories=function(){return this.hasValidCategories?this.categories.length>1:void 0},e.prototype.hasCategoryWithRole=function(e){return-1!==i.getCategoryIndexOfRole(this.categories,e)},e.prototype.getCategoryObjects=function(e,t){if(this.hasValidCategories){var r=this.getCategoryFromRole(e);if(r&&r.objects)return r.objects[t]}},e.prototype.getCategoryFromRole=function(e){var t=this.categories;return t[i.getCategoryIndexOfRole(t,e)]},e.prototype.hasValues=function(e){return this.valueRoleIndexMapping&&!_.isEmpty(this.valueRoleIndexMapping[e])},e.prototype.hasHighlights=function(e){return this.hasValues(e)?!_.isEmpty(this.grouped[0].values[this.valueRoleIndexMapping[e][0]].highlights):!1},e.prototype.getValue=function(e,t,r){return void 0===r&&(r=0),this.hasValues(e)?this.dataHasDynamicSeries?this.getValueInternal(e,t,r,0,!1):this.getValueInternal(e,t,0,r,!1):void 0},e.prototype.getHighlight=function(e,t,r){return void 0===r&&(r=0),this.hasValues(e)?this.dataHasDynamicSeries?this.getValueInternal(e,t,r,0,!0):this.getValueInternal(e,t,0,r,!0):void 0},e.prototype.getAllValuesForRole=function(e,t,r){if(void 0===r&&(r=0),this.hasValues(e)){for(var i=[],n=0,a=this.valueRoleIndexMapping[e].length;a>n;n++)i.push(this.getValueInternal(e,t,r,n,!1));return i}},e.prototype.getAllHighlightsForRole=function(e,t,r){if(void 0===r&&(r=0),this.hasValues(e)){for(var i=[],n=0,a=this.valueRoleIndexMapping[e].length;a>n;n++)i.push(this.getValueInternal(e,t,r,n,!0));return i}},e.prototype.getValueInternal=function(e,t,r,i,n){if(this.hasValues(e)){var a=this.valueRoleIndexMapping[e][i],o=this.grouped[r].values[a];return n?o.highlights[t]:o.values[t]}},e.prototype.getFirstNonNullValueForCategory=function(e,t){if(this.hasValues(e)){if(!this.dataHasDynamicSeries)return this.getValue(e,t);for(var r=0,i=this.grouped.length;i>r;r++){var n=this.getValue(e,t,r);if(null!=n)return n}}},e.prototype.getMeasureQueryName=function(e){return this.hasValues(e)?this.grouped[0].values[this.valueRoleIndexMapping[e][0]].source.queryName:void 0},e.prototype.getValueColumn=function(e,t){return void 0===t&&(t=0),this.hasValues(e)?this.dataHasDynamicSeries?this.grouped[t].values[this.valueRoleIndexMapping[e][0]]:this.grouped[0].values[this.valueRoleIndexMapping[e][t]]:void 0},e.prototype.getValueMetadataColumn=function(e,t){void 0===t&&(t=0);var r=this.getValueColumn(e,t);return r?r.source:void 0},e.prototype.getAllValueMetadataColumnsForRole=function(e,t){if(void 0===t&&(t=0),this.hasValues(e)){for(var r=[],i=0,n=this.valueRoleIndexMapping[e].length;n>i;i++){var a=this.grouped[t].values[this.valueRoleIndexMapping[e][i]].source;r.push(a)}return r}},e.prototype.getValueDisplayName=function(e,t){if(this.hasValues(e)){var r=this.getValueColumn(e,t);if(r&&r.source)return r.source.displayName}},e.prototype.hasDynamicSeries=function(){return this.dataHasDynamicSeries},e.prototype.getSeriesCount=function(e){if(this.hasAnyValidValues){if(this.dataHasDynamicSeries)return this.grouped.length;var t=e&&this.valueRoleIndexMapping[e];return t?t.length:1}},e.prototype.getSeriesObjects=function(e){return this.hasAnyValidValues?this.grouped[e].objects:void 0},e.prototype.getSeriesValueColumns=function(){return this.hasAnyValidValues?this.dataView.categorical.values:void 0},e.prototype.getSeriesValueColumnGroup=function(e){return this.hasAnyValidValues?this.grouped[e]:void 0},e.prototype.getSeriesMetadataColumn=function(){return this.hasAnyValidValues?this.dataView.categorical.values.source:void 0},e.prototype.getSeriesColumnIdentityFields=function(){return this.hasAnyValidValues?this.dataView.categorical.values.identityFields:void 0},e.prototype.getSeriesName=function(e){return this.hasAnyValidValues?this.grouped[e].name:void 0},e.prototype.getSeriesDisplayName=function(){return this.hasAnyValidValues&&this.dataHasDynamicSeries?this.dataView.categorical.values.source.displayName:void 0},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=e.Prototype.inherit,n=e.Prototype.inheritSingle,a=e.visuals.valueFormatter;!function(r){function o(e,t,r,i,n,a){var o=e,u=e.categorical;if(u){var c=s(u,e.metadata,r,n,a);if(c){var l=h(i,c.roleName,c.categories);if(l.length>=2){var p=_.chain(a[c.roleName]).filter(function(e){return e.suppressConcat}).map(function(e){return e.queryRef}).value();o=f(e,t,c.roleName,l,p)}}}return o}function u(e,t,r,n){var a;if(!_.isEmpty(n.categories)&&n.categories.length>=2){var o=i(e.columns),u=i(e,function(e){e.columns=o}),s={metadata:u,categorical:n};a=f(s,t,r,n.categories,[])}else a={metadata:e,categorical:n};return a}function s(r,i,n,a,o){var u,s=t.DataViewSelectTransform.createRoleKindFromMetadata(a,i),p=t.DataViewSelectTransform.projectionsFromSelects(a,o),f=e.DataViewAnalysis.chooseDataViewMappings(p,n,s).supportedMappings,v=!_.isEmpty(f)&&_.every(f,function(e){return!!e.categorical});if(v){var h=c(f);if(h&&l(h,f)){var g=_.filter(r.categories,function(e){return e.source.roles&&!!e.source.roles[h]});if(g.length>=2){var d=_.every(g,function(e){return e.values.length===g[0].values.length});d&&(u={roleName:h,categories:g})}}}return u}function c(e){var t,r=_.chain(e).map(function(e){var t=p(e.categorical);return 1===t.length?t[0]:void 0}).uniq().value(),i=1===r.length&&!_.isUndefined(r[0]);return i&&(t=r[0]),t}function l(e,t){var r=_.every(t,function(t){return!_.isEmpty(t.conditions)&&_.every(t.conditions,function(t){return t[e]&&1===t[e].max})});return r}function p(t){var r=[];return e.DataViewMapping.visitCategoricalCategories(t.categories,{visitRole:function(e){r.push(e)}}),r}function f(e,r,i,a,o){var u=t.DataViewObjectDescriptors.findFormatString(r),s=v(a,o,u),c=_.map(a,function(e){return e.source}),l=g(i,c,o),p=n(e);d(p,l);var f=y(a,l,s),h=e.categorical,m=_.difference(h.categories,a);m.push(f);var x=n(h);return x.categories=m,p.categorical=x,p}function v(e,t,r){for(var i=[],n=0,o=e;n<o.length;n++)for(var u=o[n],s=a.getFormatString(u.source,r),c=0,l=u.values.length;l>c;c++)if(!_.contains(t,u.source.queryName)){var p=u.values&&u.values[c],f=a.format(p,s);i[c]=void 0===i[c]?f:f+" "+i[c]}return i}function h(e,t,r){var i;if(e){for(var n={},a=0,o=r;a<o.length;a++){var u=o[a];u.source.roles[t]&&(n[u.source.index]=u)}var s=e[t];i=_.chain(s).map(function(e){return n[e]}).filter(function(e){return!!e}).value()}else i=_.filter(r,function(e){return e.source.roles[t]});return i}function g(t,r,i){for(var n,a=0,o=r;a<o.length;a++){var u=o[a];_.contains(i,u.queryName)||(n=null==n?u.displayName:u.displayName+" "+n)}var s={};s[t]=!0;var c={displayName:n,roles:s,type:e.ValueType.fromPrimitiveTypeAndCategory(e.PrimitiveType.Text)},l=_.last(r);return void 0!==l.isMeasure&&(c.isMeasure=l.isMeasure),c.queryName=l.queryName,c}function d(e,t){var r=n(e.metadata.columns);r.push(t);var i=n(e.metadata);i.columns=r,e.metadata=i}function y(e,t,r){var i={source:t,values:r},n=e[0];return n.identity&&(i.identity=n.identity),n.identityFields&&(i.identityFields=n.identityFields),n.objects&&(i.objects=n.objects),i}r.detectAndApply=o,r.applyToPlayChartCategorical=u}(r=t.DataViewConcatenateCategoricalColumns||(t.DataViewConcatenateCategoricalColumns={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t){var i=e.categorical;i&&r(i,t);var n=e.table;n&&a(n,t);var u=e.matrix;u&&o(u,t);var c=e.tree;c&&s(c,t);var l=e.single;l&&d(l,t)}function r(e,t){i(e.categories,t),n(e.values,t)}function i(e,t){e&&(p(e,t),f(e,t),v(e,t),g(e,t))}function n(e,t){if(e){p(e,t,0),f(e,t,0),v(e,t,0);var r=e;h(r,t);var i=r.group;if(i)for(var n=0,a=i.select;n<a.length;n++){var o=a[n];p(o,t,1),f(o,t,1)}}}function a(e,t){var r=e.rows;p(r,t),f(r,t),v(r,t),g(r,t)}function o(e,t){u(e.rows,t),u(e.columns,t),u(e.values,t)}function u(e,t){e&&(f(e,t),v(e,t),g(e,t))}function s(e,t){c(e.nodes,t),l(e.values,t)}function c(e,t){e&&(f(e,t),g(e,t))}function l(e,t){e&&f(e,t)}function p(e,t,r){var i=e.bind;i&&(null!=r?t.visitRole(i.to,r):t.visitRole(i.to))}function f(e,t,r){var i=e["for"];i&&(null!=r?t.visitRole(i["in"],r):t.visitRole(i["in"]))}function v(e,t,r){var i=e.select;if(i)for(var n=0,a=i;n<a.length;n++){var o=a[n];p(o,t,r),f(o,t,r)}}function h(e,t){if(e){var r=e.group;r&&(t.visitRole(r.by),g(r,t))}}function g(e,t){if(t.visitReduction){var r=e.dataReductionAlgorithm;r&&t.visitReduction(r)}}function d(e,t){t.visitRole(e.role)}e.visitMapping=t,e.visitCategorical=r,e.visitCategoricalCategories=i,e.visitCategoricalValues=n,e.visitTable=a,e.visitMatrixItems=u,e.visitTreeNodes=c,e.visitTreeValues=l,e.visitGrouped=h}(t=e.DataViewMapping||(e.DataViewMapping={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=e.Prototype.inheritSingle;!function(t){function r(e){var t=_.filter(e.dataRoles,function(e){return!_.isEmpty(e.requiredTypes)});n(e.dataview,e.dataViewMappings,t)}function n(e,t,r){if(!_.isEmpty(t)&&!_.isEmpty(r)){for(var i=a(e.metadata.columns,r),n=o(e.metadata.columns,r),u={},s=0,v=t;s<v.length;s++){var g=v[s];for(var d in g)null!=e[d]&&(u[d]=!0)}u.categorical&&c(e.categorical,i,n),u.table&&l(e.table,i,n),u.tree&&p(e.tree.root,i,n),u.matrix&&f(e.matrix,i,n),u.single&&h(e,t,r,n)}}function a(e,t){if(!e||!t)return function(){return!1};for(var r={},i=0,n=e;i<n.length;i++){var a=n[i],o=a.roles;if(o)for(var u=0,s=t;u<s.length;u++){var c=s[u];if(o[c.name]){r[a.index]=!0;break}}}return function(e){return isNaN(e)?!1:!!r[e]}}function o(e,t){if(!e||!t)return function(){return!0};for(var r=[],i=0,n=e;i<n.length;i++){var a=n[i],o=u(a,t);o&&(r[a.index]=o)}return function(e,t){return r[e]?r[e](t):!0}}function u(e,t){var r=s(e,t);if(!_.isEmpty(r))return function(e){return d(e,r)}}function s(t,r){var i=[],n=t&&t.roles;if(!n)return i;for(var a=0,o=r;a<o.length;a++){var u=o[a];if(n[u.name])for(var s=0,c=u.requiredTypes;s<c.length;s++){var l=c[s],p=e.ValueType.fromDescriptor(l);i.push(p)}}return i}function c(e,t,r){var i=e&&e.values;if(i){var n=i.grouped();if(n)for(var a=0,o=n;a<o.length;a++)for(var u=o[a],s=u.values,c=0,l=s;c<l.length;c++){var p=l[c],f=p.source.index;if(t(f))for(var v=0,h=p.values.length;h>v;v++)p.values=g(p.values,v,f,r)}}}function l(e,t,r){var i=e&&e.columns;if(i){for(var n=[],a=0,o=i;a<o.length;a++){var u=o[a];t(u.index)&&n.push(u.index)}for(var s=e.rows,c=0,l=s.length;l>c;c++)for(var p=0,f=n;p<f.length;p++){var v=f[p];s[c]=g(s[c],v,v,r)}}}function p(e,t,r){if(e.values)for(var i in e.values)t(i)&&("object"==typeof e.values[i]&&"value"in e.values[i]?e.values[i]=g(e.values[i],"value",i,r):e.values=g(e.values,i,i,r));else if(e.children)for(var n=0,a=e.children;n<a.length;n++){var o=a[n];p(o,t,r)}}function f(e,t,r){var i=e&&e.rows&&e.rows.root;i&&v(e,i,t,r)}function v(e,t,r,i){if(t.values)for(var n in t.values){var a=t.values[n],o=a.valueSourceIndex||0,u=e.valueSources[o].index;_.isNumber(u)&&r(u)&&(t.values[n]=g(a,"value",u,i))}else if(t.children)for(var s=0,c=t.children;s<c.length;s++){var l=c[s];v(e,l,r,i)}}function h(e,t,r,i){if(e.single){for(var n=[],a=0,o=r;a<o.length;a++){var u=o[a];u.name&&n.push(u.name)}for(var s=e.metadata.columns,c=0,l=t;c<l.length;c++){var p=l[c],f=p.single.role;if(-1!==n.indexOf(f)){var v=y(s,f);return void(v&&(e.single=g(e.single,"value",v.index,i)))}}}}function g(e,t,r,n){if(e){var a=e[t];return null===a||n(r,a)||(e=i(e),e[t]=null),e}}function d(e,t){for(var r=0,i=t;r<i.length;r++){var n=i[r];if(n.numeric||n.integer)return"number"==typeof e}return!1}function y(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r],a=n&&n.roles;if(a&&a[t])return n}}t.apply=r,t.filterVariantMeasures=n,t.generateMetadataColumnFilter=a,t.generateValueFilter=o,t.getColumnRequiredTypes=s,t.normalizeVariant=g}(r=t.DataViewNormalizeValues||(t.DataViewNormalizeValues={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,i){if(!e)return i;var n=e[t.objectName],a=n;return r.getValue(a,t.propertyName,i)}function i(e,t,r){if(e&&e[t]){var i=e[t];return i}return r}function n(e,t){if(e&&e[t]){var r=e[t];return r}}function a(e,r,i){var n=t(e,r);return n&&n.solid?n.solid.color:i}function o(e){return _.isArray(e)}e.getValue=t,e.getObject=i,e.getUserDefinedObjects=n,e.getFillColor=a,e.isUserDefined=o}(t=e.DataViewObjects||(e.DataViewObjects={}));var r;!function(e){function t(e,t,r){if(!e)return r;var i=e[t];return void 0===i?r:i}function r(t,r,i){var n=e.getValue(t,r);return n&&n.solid?n.solid.color:i}e.getValue=t,e.getFillColorByPropertyName=r}(r=e.DataViewObject||(e.DataViewObject={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.JsonComparer;!function(t){function n(t,r,i){var n=t[r];n||(t[r]=n=[]);for(var a=0,o=n.length;o>a;a++){var u=n[a];if(e.Selector.equals(u.selector,i))return u;
}var s={selector:i,properties:{}};return n.push(s),s}function a(e,t,r,n){var a=c(e,t,r);a&&i.deleteSingleProperty(a,n)}function o(e,t,r,i){n(e,t.objectName,r).properties[t.propertyName]=i}function u(e,t,r){var i=s(e,t,r);if(i)return i[t.propertyName]}function s(e,t,r){var i=c(e,t.objectName,r);if(i)return i.properties}function c(t,r,i){if(t){var n=t[r];if(n)for(var a=0,o=n.length;o>a;a++){var u=n[a];if(e.Selector.equals(u.selector,i))return u}}}function l(t,i){return t instanceof e.SemanticFilter&&i instanceof e.SemanticFilter?e.SemanticFilter.isSameFilter(t,i):r.equals(t,i)}function p(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!l(e[r],t[r]))return!1;return!0}function f(t,r){if(r.bool)return"boolean"!=typeof t&&(t=!1),e.SQExprBuilder["boolean"](t);if(r.text||r.scripting&&r.scripting.source)return e.SQExprBuilder.text(t);if(r.numeric){if($.isNumeric(t))return e.SQExprBuilder["double"](+t)}else if(r.fill){if(t)return{solid:{color:e.SQExprBuilder.text(t)}}}else{if(r.formatting)return r.formatting.labelDisplayUnits?e.SQExprBuilder["double"](+t):e.SQExprBuilder.text(t);if(r.enumeration)return $.isNumeric(t)?e.SQExprBuilder["double"](+t):e.SQExprBuilder.text(t);if(r.misc)t=t?e.SQExprBuilder.text(t):null;else if(r.image&&t){var i=t,n={name:e.SQExprBuilder.text(i.name),url:e.SQExprBuilder.text(i.url)};return i.scaling&&(n.scaling=e.SQExprBuilder.text(i.scaling)),n}}return t}function v(e){var t={};for(var r in e){var i=e[r];if(!_.isEmpty(i)){for(var n=[],a=0,o=i;a<o.length;a++){var u=o[a];n.push({properties:h(u.properties),selector:u.selector})}t[r]=n}}return t}function h(e){return _.clone(e)}t.ensure=n,t.deleteProperty=a,t.setValue=o,t.getValue=u,t.getPropertyContainer=s,t.getObjectDefinition=c,t.propertiesAreEqual=l,t.allPropertiesAreEqual=p,t.encodePropertyValue=f,t.clone=v}(t=e.DataViewObjectDefinitions||(e.DataViewObjectDefinitions={}));var i;!function(e){function t(e,t){delete e.properties[t]}e.deleteSingleProperty=t}(i=e.DataViewObjectDefinition||(e.DataViewObjectDefinition={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){function r(t){return a(t,function(t){var r=e.ValueType.fromDescriptor(t.type).formatting;return r&&r.formatString})}function i(e){return a(e,function(e){var t=e.type;return t&&!!t.filter})}function n(e){return a(e,function(e){var t=e.type;return t&&!!t.expression&&t.expression.defaultValue})}function a(e,t){if(e)for(var r in e){var i=e[r].properties;for(var n in i)if(t(i[n]))return{objectName:r,propertyName:n}}}t.findFormatString=r,t.findFilterOutput=i,t.findDefaultValue=n}(r=t.DataViewObjectDescriptors||(t.DataViewObjectDescriptors={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(t,r,i){for(var n,a=0,o=i.length;o>a;a++){var u=i[a],s=u.name,c=e.DataViewObjectEvaluator.run(t,r[s],u.properties);c&&(n||(n={}),n[s]=c)}return n}function i(e){var t={data:[]};if(e)for(var r in e)for(var i=e[r],a=0,o=i.length;o>a;a++){var u=i[a];n(t,u.selector).objects.push({name:r,properties:u.properties})}return t}function n(t,r){if(!r)return t.metadataOnce||(t.metadataOnce={objects:[]}),t.metadataOnce;var i;r.data?i=t.data:r.metadata?(t.metadata||(t.metadata=[]),i=t.metadata):r.id&&(t.userDefined||(t.userDefined=[]),i=t.userDefined);for(var n=0,a=i;n<a.length;n++){var o=a[n];if(e.Selector.equals(r,o.selector))return o}var u={selector:r,objects:[]};return i.push(u),u}function a(e,t,r,i){i&&(o(e,t,r,i),u(e,t,r,i))}function o(t,r,i,n){var a=e.DataViewObjectDescriptors.findFormatString(r);if(a)for(var o=0,u=n.length;u>o;o++){var l=n[o];l&&c(t,a,l.queryName,l.format||s(i,o))}}function u(t,r,i,n){var a=e.DataViewObjectDescriptors.findDefaultValue(r);if(a)for(var o=0,u=n;o<u.length;o++){var s=u[o];s&&l(t,a,s.queryName,s.defaultValue)}}function s(e,t){for(var r=0,i=e.length;i>r;r++){var n=e[r];if(n&&n.index===t)return n.format}}function c(t,r,i,n){n&&p(t,r,{metadata:i},e.SQExprBuilder.text(n))}function l(e,t,r,i){i&&p(e,t,{metadata:r},i)}function p(e,t,r,i){var n;if(r){var a=e.metadata;a||(a=e.metadata=[]),n=a}else{var o=e.metadataOnce;o||(o=e.metadataOnce={selector:r,objects:[]}),n=[o]}var u,s=f(n,r);if(s){var c=s.objects;if(u=v(c,t.objectName)){if(u.properties[t.propertyName])return}else u={name:t.objectName,properties:{}},c.push(u)}else u={name:t.objectName,properties:{}},n.push({selector:r,objects:[u]});u.properties[t.propertyName]=i}function f(t,r){for(var i=0,n=t.length;n>i;i++){var a=t[i];if(e.Selector.equals(a.selector,r))return a}}function v(e,t){for(var r=0,i=e.length;i>r;r++){var n=e[r];if(n.name===t)return n}}t.evaluateDataViewObjects=r,t.groupObjectsBySelector=i,t.addImplicitObjects=a}(t=e.DataViewObjectEvaluationUtils||(e.DataViewObjectEvaluationUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function i(e,t,r){if(t){var i,a=t.properties;for(var o in r){var u=r[o],s=a[o];if(s){var c=n(e,s,u);void 0!==c&&(i||(i={}),i[o]=c)}}return i}}function n(r,i,n){var u=i.type;if(u&&u.expression)return n;var l=v(r,n,e.ValueType.fromDescriptor(i.type));return void 0!==l||n instanceof t.RuleEvaluation?l:a(r,n,u)||o(r,n,u)||s(r,n,u)||c(r,n,u)||n}function a(t,r,i){var n=i.fill;if(n)return n&&n.solid&&n.solid.color&&r.solid?{solid:{color:v(t,r.solid.color,e.ValueType.fromExtendedType(e.ExtendedType.Color))}}:void 0}function o(e,t,r){if(r.fillRule){if(t.linearGradient2){var i=t.linearGradient2;return{linearGradient2:{min:u(e,i.min),max:u(e,i.max)}}}if(t.linearGradient3){var n=t.linearGradient3;return{linearGradient3:{min:u(e,n.min),mid:u(e,n.mid),max:u(e,n.max)}}}}}function u(e,t){var r={color:v(e,t.color,h)},i=v(e,t.value,g);return null!=i&&(r.value=i),r}function s(t,r,i){if(i.image&&r){var n={name:v(t,r.name,d),url:v(t,r.url,e.ValueType.fromDescriptor(e.ImageDefinition.urlType))};return r.scaling&&(n.scaling=v(t,r.scaling,d)),n}}function c(e,t,r){return r.paragraphs&&t?f(e,t,l):void 0}function l(e,t){var r,i=t.textRuns,n=f(e,i,p);return i!==n&&(r=_.clone(t),r.textRuns=n),r||t}function p(e,t){var r,i=t.value,n=v(e,i,d);return void 0!==n&&(r=_.clone(t),r.value=n),r||t}function f(e,t,r){for(var i,n=0,a=t.length;a>n;n++){var o=t[n],u=r(e,o);i||o===u||(i=_.take(t,n)),i&&i.push(u)}return i||t}function v(e,r,i){return r instanceof t.SQExpr?y.evaluate(r,e):r instanceof t.RuleEvaluation?r.evaluate(e):void 0}var h=e.ValueType.fromDescriptor({formatting:{color:!0}}),g=e.ValueType.fromDescriptor({numeric:!0}),d=e.ValueType.fromDescriptor({text:!0});r.run=i,r.evaluateProperty=n;var y=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.evaluate=function(e,r){return null!=e?e.accept(t.instance,r):void 0},t.prototype.visitColumnRef=function(e,t){return t.getExprValue(e)},t.prototype.visitConstant=function(e,t){return e.value},t.prototype.visitMeasureRef=function(e,t){return t.getExprValue(e)},t.prototype.visitAggr=function(e,t){return t.getExprValue(e)},t.prototype.visitFillRule=function(e,t){var r=e.input.accept(this,t);if(void 0!==r){var i=t.getColorAllocator(e);if(i)return i.color(r)}},t.prototype.visitSelectRef=function(e,t){return t.getExprValue(e)},t.instance=new t,t}(t.DefaultSQExprVisitorWithArg)}(r=t.DataViewObjectEvaluator||(t.DataViewObjectEvaluator={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=e.Prototype.inherit;!function(e){function r(e){var r=e.categorical;if(!r)return null;var n=r.categories;if(!n||1!==n.length)return null;var a=r.values;if(_.isEmpty(a)||a.source)return null;for(var o=n[0],u=o.identity,s=o.values,c=[],l=[],p=0,f=s.length;f>p;p++)for(var v=s[p],h=u[p],g=0,d=a.length;d>g;g++){var y=a[g],m=i(y.source);if(y.identity)return null;m.groupName=v;var x={source:m,values:[y.values[p]],identity:h,min:y.min,max:y.max,subtotal:y.subtotal},S=y.highlights;S&&(x.highlights=[S[p]]),c.push(m),l.push(x)}var E=i(e.metadata);return E.columns=c,a=t.DataViewTransform.createValueColumns(l,o.identityFields,o.source),{metadata:E,categorical:{values:a},matrix:e.matrix}}e.apply=r}(r=t.DataViewPivotCategorical||(t.DataViewPivotCategorical={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){function r(t,r){r.columnHierarchyRewritten||(t.columns=e.Prototype.inherit(t.columns));var o=t.columns;r.rowHierarchyRewritten||(t.rows=e.Prototype.inherit(t.rows));var u=t.rows;if(!(o.levels.length>1)){var s={level:0},c=o.root.children,l=c.length,p=u.levels.length;if(l>0){var f=0,v=function(e){if(e.values){s.values||(s.values={});for(var t=0;l>t;t++)s.values[f++]=e.values[t];delete e.values}if(l>1){e.children||(e.children=[]);for(var r=0;l>r;r++){var i={level:p},n=c[r];i.levelSourceIndex=n.levelSourceIndex,e.isSubtotal&&(i.isSubtotal=!0),e.children.push(i)}}};r.hierarchyTreesRewritten?i(u.root,v):t.columns.root=a(u.root,v)}else r.hierarchyTreesRewritten||(t.columns.root=n(u.root));if(l>1){var h={sources:o.levels[0].sources};u.levels.push(h),o.levels.length=0}if(r.hierarchyTreesRewritten)t.columns.root=u.root,t.rows.root={children:[s]};else{var g=e.Prototype.inherit(t.rows.root);g.children=[s],t.rows.root=g}t.columns.levels=u.levels,t.rows.levels=[]}}function i(e,t){var r=e.children;if(r&&r.length>0)for(var n=0,a=r.length;a>n;n++)i(r[n],t);else t(e)}function n(e){return a(e)}function a(t,r){var i=e.Prototype.inherit(t),n=t.children;if(n&&n.length>0){for(var o=[],u=0,s=n.length;s>u;u++){var c=a(n[u],r);o.push(c)}i.children=o}else r&&r(i);return i}t.apply=r,t.cloneTree=n,t.cloneTreeExecuteOnLeaf=a}(r=t.DataViewPivotMatrix||(t.DataViewPivotMatrix={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){for(var t=new Array(e),r=0;e>r;r++)t[r]=null;return t}function i(t,r,i){var n=e.Prototype.inherit(t);return n[i]=r[i],n}var n;!function(n){function a(e){if(e.categorical){var t=e.categorical;if(t.categories&&1===t.categories.length&&(!t.values||!t.values.source))return o(e.metadata,t)}}function o(r,i){var n=i.categories[0],a=n.values,o=a.length;if(0!==o){var s=i.values?i.values.grouped()[0].values:[],c=t.createCategoricalDataViewBuilder().withCategories(i.categories).withGroupedValues(u(n,a,o,s)).build();return r=e.Prototype.inherit(r),r.columns=c.metadata.columns,{metadata:r,categorical:c.categorical}}}function u(e,t,n,a){for(var o=r(n),u=a.length,s=[],c=0;n>c;c++){for(var l=[],p=0;u>p;p++){var f=a[p],v=f.highlights,h={values:i(o,f.values,c)};v&&(h.highlights=i(o,v,c)),l.push(h)}s.push(l)}return{groupColumn:{source:e.source,identityFrom:{fields:e.identityFields,identities:e.identity},values:e.values},valueColumns:_.map(a,function(e){return{source:e.source}}),data:s}}n.apply=a}(n=t.DataViewSelfCrossJoin||(t.DataViewSelfCrossJoin={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=jsCommon.ArrayExtensions,n=e.data.DataShapeBindingDataReduction,a=e.Prototype.inheritSingle;!function(r){function o(e,t,r,i){t&&1===t.length&&r.categorical&&r.categorical.dataReductionAlgorithm&&e&&s(e,r)&&(e.Primary.Groupings=[e.Secondary.Groupings[0],e.Primary.Groupings[0]],e.Secondary=void 0,e.DataReduction={Primary:n.createFrom(r.categorical.dataReductionAlgorithm),DataVolume:r.categorical.dataVolume||i})}function u(e){return e&&e.Groupings&&1===e.Groupings.length&&!_.isEmpty(e.Groupings[0].Projections)&&!e.Groupings[0].Subtotal&&_.isEmpty(e.Groupings[0].SuppressedProjections)}function s(e,t){return u(e.Primary)&&u(e.Secondary)&&1===e.Secondary.Groupings[0].Projections.length?!e.DataReduction||!e.DataReduction.Primary&&!e.DataReduction.Secondary:!1}function c(e,r,n,a){if(!l(r,n,e,a))return e;var o={metadata:{columns:i.copy(e.metadata.columns)}};if(e.single&&(o.single=e.single),e.table&&(o.table=e.table),e.matrix){var u=p(e.matrix);if(!_.isEmpty(u.valueSources)){var s=t.utils.DataViewMatrixUtils.containsCompositeGroup(u.columns);s||(o.categorical=f(u,o.metadata.columns))}}return o}function l(r,i,n,a){if(_.isEmpty(r)||_.isEmpty(i)||!n)return!1;var o=t.DataViewSelectTransform.createRoleKindFromMetadata(r,n.metadata),u=t.DataViewSelectTransform.projectionsFromSelects(r,a),s=e.DataViewAnalysis.chooseDataViewMappings(u,i,o).supportedMappings;if(!s||1!==s.length)return!1;var c=s[0].categorical;if(!c)return!1;var l=n.matrix;if(!l)return!1;if(!l.rows||!l.rows.levels||2!==l.rows.levels.length)return!1;var p=[],f=[],v=function(t,r){var i=u[t];if(i)for(var n=0,a=i.all();n<a.length;n++){var s=a[n];o[s.queryRef]===e.VisualDataRoleKind.Grouping&&r.push(s.queryRef)}};if(e.DataViewMapping.visitCategoricalCategories(c.categories,{visitRole:function(e){v(e,p)}}),e.DataViewMapping.visitCategoricalValues(c.values,{visitRole:function(e){v(e,f)}}),_.isEmpty(p)||_.isEmpty(f))return!1;for(var h=0,g=l.columns.levels;h<g.length;h++)for(var d=g[h],y=0,m=d.sources;y<m.length;y++){var x=m[y];if(!x.isMeasure)return!1}return!0}function p(e){var t=e.rows,r=t.root,i=r.children,n=[],o=t.levels[0],u=r.childIdentityFields,s={},c=[],l=t.levels[1],p=_.isEmpty(i)?void 0:i[0].childIdentityFields,f=e.valueSources.length,v=function(e){var t=s[e.key];return t};if(i)for(var h=function(e){var t=e.identity.key,r=s[t];void 0===r&&(r=c.length,s[t]=r,c.push(e))},g=0,d=i;g<d.length;g++){var y=d[g];n.push(y);for(var m=0,x=y.children;m<x.length;m++){var S=x[m];h(S)}}for(var E=new Array(c.length),w=0;w<n.length;++w)for(var y=i[w],b=0,D=y.children;b<D.length;b++){var S=D[b],C=v(S.identity);E[C]||(E[C]=new Array(n.length)),E[C][w]=S.values}var T={root:{children:_.map(n,function(e){var t=a(e);return t.level=0,t.children=void 0,t.childIdentityFields=void 0,t}),childIdentityFields:u},levels:[o]};if(f>0){for(var V=_.map(e.columns.root.children,function(e){var t={level:1};return e.levelSourceIndex&&(t.levelSourceIndex=e.levelSourceIndex),t}),C=0;C<T.root.children.length;++C)T.root.children[C].children=V;T.levels.push(e.columns.levels[0])}var F={root:{children:_.map(c,function(e){var t=a(e);return t.level=0,t.children=void 0,t.childIdentityFields=void 0,t}),childIdentityFields:p},levels:[l]};if(f>0)for(var C=0;C<c.length;++C){for(var P=F.root.children[C],M={},w=0;w<n.length;++w)for(var R=E[C]&&E[C][w],A=0;f>A;++A){var N=w*f+A;M[N]=R?R[A]:0===A?{value:null}:{value:null,valueSourceIndex:A}}P.values=M}var I={rows:F,columns:T,valueSources:e.valueSources};return I}function f(e,t){for(var r=e.columns.root.children.length,i=e.valueSources,n=i.length,a=v(e),o=[],u=0;r>u;++u){var s=e.columns.root.children[u],c={values:[],identity:s.identity,name:s.value||null};o.push(c);for(var l=0;n>l;++l){var p=i[l],f={};for(var h in p)f[h]=p[h];f.groupName=c.name,t.push(f);var g={source:f,values:[],identity:c.identity};c.values.push(g);for(var d=l+u*n,y=0,m=e.rows.root.children;y<m.length;y++){var x=m[y],S=x.values[d].value;g.values.push(S)}}}for(var E=[],w=0,b=o;w<b.length;w++)for(var c=b[w],l=0;n>l;++l)E.push(c.values[l]);E.grouped=function(){return o},E.identityFields=e.columns.root.childIdentityFields,E.source=e.columns.levels[0].sources[0];var D={categories:a,values:E};return D}function v(e){for(var t=_.map(e.rows.root.children,function(e){return e.identity}),r=e.rows.root.childIdentityFields,i=e.rows.levels[0].sources,n=[],a=0,o=i.length;o>a;a++){var u=_.map(e.rows.root.children,function(e){var t=e.levelValues;return void 0!==t?t[a].value:void 0});n.push({source:i[a],values:u,identity:t,identityFields:r})}return n}r.pivotBinding=o,r.unpivotResult=c}(r=t.DataViewPivotCategoricalToPrimaryGroups||(t.DataViewPivotCategoricalToPrimaryGroups={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=e.Prototype.inherit,n=e.Prototype.inheritSingle,a=jsCommon.ArrayExtensions,o=jsCommon.EnumExtensions;!function(r){function u(e){var r=e.prototype,i=e.objectDescriptors,n=e.dataViewMappings,a=e.transforms,o=a&&a.roles&&a.roles.activeItems,u=e.colorAllocatorFactory,l=e.dataRoles;if(!r)return c(i,a,u);if(!a)return[r];r=t.DataViewPivotCategoricalToPrimaryGroups.unpivotResult(r,a.selects,n,o);var p=s(r,a,i,n,u,l);return p=t.DataViewRegression.run({dataViewMappings:n,visualDataViews:p,dataRoles:l,objectDescriptors:i,objectDefinitions:a.objects,colorAllocatorFactory:u,transformSelects:a.selects,metadata:r.metadata,projectionActiveItems:o})}function s(e,t,r,i,n,a){var o=[],u=t.splits;if(_.isEmpty(u))o.push(l(e,r,i,t,n,a));else for(var s=0,c=u;s<c.length;s++){var p=c[s],f=l(e,r,i,t,n,a,p.selects);o.push(f)}return o}function c(e,t,r){if(t&&t.objects){var i={metadata:{columns:[]}};return R(i,0,e,t.objects,t.selects,r),[i]}return[]}function l(e,r,n,a,o,u,s){var c=p(n),l=i(e);l.metadata=i(e.metadata);var v=a.roles&&a.roles.ordering,h=a.roles&&a.roles.activeItems;return l=f(l,c,n,a.selects,v,s),R(l,c,r,a.objects,a.selects,o),l=t.DataViewConcatenateCategoricalColumns.detectAndApply(l,r,n,v,a.selects,h),t.DataViewNormalizeValues.apply({dataview:l,dataViewMappings:n,dataRoles:u}),l}function p(e){if(!e)return 0;for(var t=0,r=0,i=e;r<i.length;r++){var n=i[r];n.categorical&&(t|=1),n.matrix&&(t|=2),n.single&&(t|=4),n.table&&(t|=8),n.tree&&(t|=16)}return t}function f(e,r,i,n,a,u){var s=[];if(n&&(e.metadata.columns=v(e.metadata.columns,n,s)),e.categorical&&o.hasFlag(r,1)&&(e.categorical=g(e.categorical,s,u),e=se(e,i)),e.matrix&&o.hasFlag(r,2)){var c={rowHierarchyRewritten:!1,columnHierarchyRewritten:!1,hierarchyTreesRewritten:!1};e.matrix=m(e.matrix,s,i,a,c),le(e.matrix,i)&&t.DataViewPivotMatrix.apply(e.matrix,c)}return e.table&&o.hasFlag(r,8)&&(e.table=d(e.table,s,a)),e}function v(e,t,r){if(!t)return e;for(var n=i(e),a=0,o=e.length;o>a;a++){var u=e[a],s=t[u.index];if(s){var c=n[a]=i(u);s.roles&&(c.roles=s.roles),s.type&&(c.type=s.type),c.format=h(s,c),s.displayName&&(c.displayName=s.displayName),s.queryName&&(c.queryName=s.queryName),s.kpi&&(c.kpi=s.kpi),s.sort&&(c.sort=s.sort),s.discourageAggregationAcrossGroups&&(c.discourageAggregationAcrossGroups=s.discourageAggregationAcrossGroups),r.push({from:u,to:c})}}return n}function h(e,t){return e.format||t.format}function g(t,r,n){function a(e){var t=P(e.source,r);if(t){var n=i(e);return n.source=t,n}}var o=i(t),u=e.Prototype.overrideArray(t.categories,a);u&&(o.categories=u);var s=e.Prototype.overrideArray(t.values,a),c=s||t.values;if(c){if(c.source)if(n&&!n[c.source.index])c.source=void 0;else{var l=P(c.source,r);l&&(c.source=l)}if(n)for(var p=c.length-1;p>=0;p--)n[c[p].source.index]||c.splice(p,1);var f,v=!!c.source;if(v){f=i(c.grouped());for(var h=0,g=void 0,p=0,d=c.length;d>p;p++){var y=c[p];g&&y.identity===g.identity||(g=i(f[h]),f[h]=g,g.values=[],h++),g.values.push(y)}}else f=[{values:c}];c.grouped=function(){return f},o.values=c}return o}function d(t,r,n){var a=i(t),o=function(e){return P(e,r)},u=e.Prototype.overrideArray(t.columns,o);if(u&&(a.columns=u),!n)return a;var s=y(n,r);if(!s)return a;for(var c=u.slice(0),l=Object.keys(s),p=0,f=l.length;f>p;p++){var v=c[s[l[p]]];p===u.length?u.push(v):u[p]=v}var h=e.Prototype.overrideArray(a.rows,function(e){for(var t=[],r=0,i=l.length;i>r;++r)t[r]=e[s[l[r]]];return t});return h&&(a.rows=h),a}function y(e,t){var r=Object.keys(e);if(1===r.length){var i=r[0],n=_.map(t,function(e){return e.from.index}),a=e[i];return T(n,a)}}function m(r,n,a,o,u){function s(e){return P(e,n)}function c(t){var r=null,i=e.Prototype.overrideArray(t.levels,function(t){var r=null,i=e.Prototype.overrideArray(t.sources,s);return i&&(r=M(r,t,function(e){return e.sources=i})),r});return i&&(r=M(r,t,function(e){return e.levels=i})),r}var l=_.find(a,function(e){return!!e.matrix}),p=l.matrix,f=i(r),v=c(f.rows);v&&(f.rows=v,u.rowHierarchyRewritten=!0);var h=c(f.columns);h&&(f.columns=h,u.columnHierarchyRewritten=!0);var g=e.Prototype.overrideArray(f.valueSources,s);if(g){f.valueSources=g;var d=p.values;if(o&&g.length>1&&d&&d["for"]){var y=h.levels.length;if(y>0){var m=C(d,o,g,n);if(m){var E=Object.keys(m),w=E.length;h.root=t.DataViewPivotMatrix.cloneTree(h.root),1===y?x(h.root,m):F(h.root,y-2,function(e){return x(e,m)}),f.rows.root=t.DataViewPivotMatrix.cloneTreeExecuteOnLeaf(f.rows.root,function(e){if(e.values){for(var t={},r=Object.keys(e.values).length/w,i=0,n=r;n>i;i++)for(var a=i*w,o=0;w>o;o++)t[a+o]=e.values[a+m[E[o]]];e.values=t}}),u.hierarchyTreesRewritten=!0}}}}return S(f,p,o),f}function x(e,t){for(var r=Object.keys(t),i=r.length,n=e.children,a=n.slice(0),o=0,u=i;u>o;o++){var s=a[t[r[o]]];o===n.length?n.push(s):n[o]=s}}function S(t,r,i){var a;if(t&&r&&i){var o;e.DataViewMapping.visitMatrixItems(r.rows,{visitRole:function(e,r){o=E(o||t.rows,e,i)}});var u;e.DataViewMapping.visitMatrixItems(r.columns,{visitRole:function(e,r){u=E(u||t.columns,e,i)}}),(o||u)&&(a=n(t),a.rows=o||a.rows,a.columns=u||a.columns)}return a}function E(e,r,i){var a,o=i[r],u=o&&o.length>=2;if(u&&!_.isEmpty(e.levels))for(var s=e.levels.length-1;s>=0;s--){var c=e.levels[s],l=w(c,r,i);if(l){_.isUndefined(a)&&(a=n(e),a.levels=n(e.levels),a.root=t.utils.DataViewMatrixUtils.inheritMatrixNodeHierarchy(e.root,s,!0));var p=n(e.levels[s]);a.levels[s]=b(p,l),D(a.root,s,l)}}return a}function w(e,r,i){var n,a=e.sources;if(a&&a.length>=2){var o=t.utils.DataViewMetadataColumnUtils.joinMetadataColumnsAndProjectionOrder(a,i,r);if(o&&o.length>=2){var u=_.sortBy(o,function(e){return e.projectionOrderIndex});n=T(_.map(o,function(e){return e.sourceIndex}),_.map(u,function(e){return e.sourceIndex}))}}return n}function b(e,t){var r=e.sources;e.sources=r.slice(0);for(var i=Object.keys(t),n=0,a=i.length;a>n;n++){var o=i[n],u=t[o];e.sources[o]=r[u]}return e}function D(e,t,r){var i=V(r);return F(e,t,function(e){var t=e.levelValues;if(!_.isEmpty(t)){for(var r=_.sortBy(t,function(e){return i[e.levelSourceIndex]}),a=0,o=r.length;o>a;a++){var u=n(r[a]);u.levelSourceIndex=i[u.levelSourceIndex],r[a]=u}e.levelValues=r;var s=_.last(r);e.value!==s.value&&(e.value=s.value),(e.levelSourceIndex||0)!==s.levelSourceIndex&&(e.levelSourceIndex=s.levelSourceIndex)}}),e}function C(e,t,r,i){var n=e["for"]["in"],a=t[n],o=_.chain(i).filter(function(e){return _.contains(r,e.to)}).map(function(e){return e.from.index}).value();return T(o,a)}function T(e,t){if(!a.sequenceEqual(e,t,function(e,t){return e===t})){for(var r={},i=0,n=t.length;n>i;++i){var o=t[i];r[i]=e.indexOf(o)}return r}}function V(e){var t={};for(var r in e){var i=e[r],n=parseInt(r,10);t[i]=n}return t}function F(e,t,r){if(e.level===t)return void r(e);var i=e.children;if(i&&i.length>0)for(var n=0,a=i.length;a>n;n++)F(i[n],t,r)}function P(e,t){for(var r=0,i=t.length;i>r;r++){var n=t[r];if(n.from===e)return n.to}}function M(e,t,r){return e||(e=i(t)),r&&r(e),e}function R(e,r,i,n,a,o){if(i){var u=t.DataViewObjectEvaluationUtils.groupObjectsBySelector(n);t.DataViewObjectEvaluationUtils.addImplicitObjects(u,i,e.metadata.columns,a);var s=u.metadataOnce,c=u.data;s&&N(e,a,i,s.objects,c,o);var l=u.metadata;if(l)for(var p=0,f=l.length;f>p;p++){var v=l[p],h=v.objects,g=L(e,a,h,o);ee(e,a,i,v.selector,h,g)}for(var p=0,f=c.length;f>p;p++){var d=c[p],h=d.objects,g=L(e,a,h,o);q(e,r,a,i,d.selector,d.rules,h,g)}var y=u.userDefined;y&&A(e,a,i,y,o)}}function A(e,r,i,n,a){var o=e.metadata.objects;o||(o=e.metadata.objects={});for(var u=0,s=n;u<s.length;u++){var c=s[u],l=c.selector.id,p=L(e,r,c.objects,a),f=t.createStaticEvalContext(p,e,r),v=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(f,i,c.objects);for(var h in v){var g=v[h],d=o[h];d||(d=o[h]=[]),d.push({id:l,object:g})}}}function N(e,r,i,n,a,o){var u=L(e,r,n,o),s=t.createStaticEvalContext(u,e,r),c=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(s,i,n);if(c){e.metadata.objects=c;for(var l in c){var p=c[l],f=i[l];for(var v in p){var h=f.properties[v],g=h.rule;if(g){var d=I(e,o,g,l,p[v],h.type);d&&a.push(d)}}}}}function I(e,t,r,i,n,a){var o=r.output;if(o){var u=re(e,o.selector);if(u)return a.fillRule?O(e,t,r,u,i,n):void 0}}function O(e,r,i,n,a,o){var u=Q(e,r,i.inputRole,1,o);if(u){var s=new t.ColorRuleEvaluation(i.inputRole,u),c={};return c[i.output.property]={solid:{color:s}},{selector:n,rules:[s],objects:[{name:a,properties:c}]}}}function Q(e,t,r,i,n){return n.linearGradient2?U(e,t,r,i,n,n.linearGradient2):n.linearGradient3?j(e,t,r,i,n,n.linearGradient3):void 0}function U(e,t,r,i,n,a){if(a=n.linearGradient2,void 0===a.min.value||void 0===a.max.value){var o=ne(e,r,i);if(!o)return;void 0===a.min.value&&(a.min.value=o.min),void 0===a.max.value&&(a.max.value=o.max)}return t.linearGradient2(n.linearGradient2)}function j(e,t,r,i,n,a){var o;if(a=n.linearGradient3,void 0===a.min.value||void 0===a.mid.value||void 0===a.max.value){var u=ne(e,r,i);if(!u)return;if(o=void 0===a.min.value&&void 0===a.max.value&&void 0!==a.mid.value,void 0===a.min.value&&(a.min.value=u.min),void 0===a.max.value&&(a.max.value=u.max),void 0===a.mid.value){var s=(a.max.value+a.min.value)/2;a.mid.value=s}}return t.linearGradient3(n.linearGradient3,o)}function L(e,r,i,n){for(var a=t.createColorAllocatorCache(),o=t.createStaticEvalContext(),u=0,s=i.length;s>u;u++){var c=i[u].properties;for(var l in c){var p=c[l];if(p&&p.solid&&p.solid.color&&23===p.solid.color.kind){var f=p.solid.color,v=ie(r,f.input);if(!v)continue;var h=t.DataViewObjectEvaluator.evaluateProperty(o,he,f.rule),g=Q(e,n,v,0,h);g&&a.register(f,g)}}}return a}function q(e,r,i,n,a,u,s,c){var l=t.Selector.containsWildcard(a),p=e.categorical;p&&o.hasFlag(r,1)&&(W(p,n,a,u,l,s,c),Y(p,n,a,u,l,s,c));var f=e.matrix;if(f&&o.hasFlag(r,2)){var v=K(f,n,a,u,l,s,c);v&&(e.matrix=v)}var h=e.table;if(h&&o.hasFlag(r,8)){var g=H(h,a),d=J(h,i,n,g,u,l,s,c);d&&(e.table=d)}}function H(e,r){return t.Selector.hasRoleWildcard(r)&&(r=k(e,r)),r}function k(e,r){for(var i={data:[],id:r.id,metadata:r.metadata},n=0,a=r.data;n<a.length;n++){var o=a[n];if(t.Selector.isRoleWildcard(o)){var u=o.roles,s=G(e.columns,u),c=e.identityFields;if(s&&c){i.data.push(t.DataViewScopeWildcard.fromExprs(c));continue}}B(i.data,o)&&i.data.push(o)}return i}function B(e,t){return _.isEmpty(e)?!0:!_.any(e,function(e){return e.key===t.key})}function G(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r],a=n.roles;if(!a||!_.any(t,function(e){return a[e]}))return!1}return!0}function W(e,r,i,n,a,o,u){if(e.categories&&0!==e.categories.length){var s=te(e,i);if(s){var c,l=s.identities,p=t.createCategoricalEvalContext(u,e);if(l){for(var f=0,v=l.length;v>f;f++){var h=l[f];if(a||t.Selector.matchesData(i,[h])){p.setCurrentRowIndex(f);var g=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(p,r,o);if(g&&(s.column.objects||(s.column.objects=[],s.column.objects.length=v),s.column.objects[f]=g),!a)return!0;c=!0}}return c}}}}function Y(r,i,n,a,o,u,s){var c=r.values;if(c&&c.identityFields&&t.Selector.matchesKeys(n,[c.identityFields])){var l=c.grouped();if(l){for(var p,f=t.createCategoricalEvalContext(s,r),v=0,h=l.length;h>v;v++){var g=l[v],d=n.metadata,y=g.values;if(o||t.Selector.matchesData(n,[g.identity])){var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(f,i,u);if(m)if(d)for(var x=0,S=y.length;S>x;x++){var E=y[x],w=E.source;if(w.queryName===d){var b=e.Prototype.inherit(w);b.objects=m,E.source=b,p=!0;break}}else g.objects=m,oe(c,l),p=!0;if(!o)return!0}}return p}}}function K(e,r,i,a,o,u,s){var c=t.createMatrixEvalContext(s,e),l=z(c,e.rows,r,i,a,o,u),p=z(c,e.columns,r,i,a,o,u);if(l||p){var f=n(e);return l&&(f.rows=l),p&&(f.columns=p),f}}function z(e,t,r,i,a,o,u){if(t){var s=t.root;if(s){var c=X(e,s,r,i,a,o,u);if(c){var l=n(t);return l.root=c,l}}}}function X(e,r,i,a,o,u,s){var c=r.children;if(c){var l,p,f=r.childIdentityFields;f&&(p=t.Selector.matchesKeys(a,[f]));for(var v=0,h=c.length;h>v;v++){var g=c[v],d=g.identity,y=null;if(p){if(u||t.Selector.matchesData(a,[d])){var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(e,i,s);m&&(y=n(g),y.objects=m)}}else y=X(e,g,i,a,o,u,s);if(y&&(l||(l=Z(r)),l.children[v]=y,!u))break}return l}}function Z(e){if(Object.getPrototypeOf(e)!==Object.prototype)return e;var t=n(e);return t.children=i(e.children),t}function J(e,r,i,a,o,u,s,c){var l=t.createTableEvalContext(c,e,r),p=$(l,e.columns,e.rows,e.identity,e.identityFields,i,a,o,u,s);if(p){var f=n(e);return f.rows=p,f}}function $(e,r,i,a,o,u,s,c,l,p){if(!_.isEmpty(a)&&!_.isEmpty(o)&&s.metadata&&t.Selector.matchesKeys(s,[o])){var f=_.findIndex(r,function(e){return e.queryName===s.metadata});if(!(0>f)){for(var v,h=r.length,g=0,d=a.length;d>g;g++){var y=a[g];if(l||t.Selector.matchesData(s,[y])){e.setCurrentRowIndex(g);var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(e,u,p);if(m){v||(v=n(i));var x=v[g]=n(v[g]),S=x.objects;S||(x.objects=S=new Array(h)),S[f]=m}if(!l)break}}return v}}}function ee(e,r,i,n,a,o){for(var u=e.metadata.columns,s=n.metadata,c=t.createStaticEvalContext(o,e,r),l=0,p=u.length;p>l;l++){var f=u[l];if(f.queryName===s){var v=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(c,i,a);v&&(f.objects=v)}}}function te(e,r){var i=e.categories[0];if(i.identityFields&&t.Selector.matchesKeys(r,[i.identityFields])){var n=i.identity,a=i,o=r.metadata;if(o){var u=e.values;if(u)for(var s=0,c=u.length;c>s;s++){var l=u[s];if(l.source.queryName===o){a=l;break}}}return{column:a,identities:n}}}function re(e,r){if(1===r.length){var i=e.categorical;if(i){var n=i.categories;if(n&&1===n.length){var a=n[0],o=a.source.roles,u=a.identityFields;if(o&&u&&o[r[0]])return{data:[t.DataViewScopeWildcard.fromExprs(u)]}}}}}function ie(e,r){if(t.SQExpr.isSelectRef(r))return r.expressionName;if(e)for(var i=0,n=e.length;n>i;i++){var a=e[i],o=a.expr;if(o&&t.SQExpr.equals(r,a.expr))return a.queryName}}function ne(e,t,r){for(var i=e.metadata.columns,n=0,a=i.length;a>n;n++){var o=i[n];if(1===r){var u=o.roles;if(!u||!u[t])continue}else if(o.queryName!==t)continue;var s=o.aggregates;if(s){var c=s.min;if(void 0===c&&(c=s.minLocal),void 0!==c){var l=s.max;if(void 0===l&&(l=s.maxLocal),void 0!==l)return{min:c,max:l}}}}}function ae(e,t,r){void 0===e&&(e=[]);var i=e;return oe(e),t&&(i.identityFields=t),r&&(i.source=r),i}function oe(e,t){e.grouped=t?function(){return t}:function(){return ue(e)}}function ue(e){for(var t,r=[],i=0,n=e.length;n>i;i++){var a=e[i];if(!t||t.identity!==a.identity){if(t={values:[]},a.identity){t.identity=a.identity;var o=a.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}r.push(t)}t.values.push(a)}return r}function se(e,r){var i;switch(ce(e.categorical,r)){case 1:i=t.DataViewPivotCategorical.apply(e);break;case 2:i=t.DataViewSelfCrossJoin.apply(e)}return i||e}function ce(e,t){if(e&&!_.isEmpty(t)){var r=e.categories;if(r&&1===r.length){var i=e.values;if(!_.isEmpty(i)&&!i.grouped().some(function(e){return!!e.identity}))for(var n=r[0].source.roles,a=0,o=t.length;o>a;a++){var u=t[a].categorical;if(u&&ve(n,u.values)){var s=u.categories,c=pe(n,s)||fe(n,s);return c?2:1}}}}}function le(e,t){if(e&&!_.isEmpty(t)){var r=e.rows.levels;if(!(r.length<1)){var i=e.rows.root.children;if(i&&0!==i.length)for(var n=r[0].sources[0].roles,a=0,o=t.length;o>a;a++){var u=t[a].matrix;if(u&&!fe(n,u.rows)&&fe(n,u.columns))return!0}}}}function pe(e,t){return e&&t&&t.bind?e[t.bind.to]:void 0}function fe(e,t){return e&&t&&t["for"]?e[t["for"]["in"]]:void 0}function ve(e,t){return e&&t&&t.group?e[t.group.by]:void 0}var he={type:{fillRule:{}}};r.apply=u,r.forEachNodeAtLevel=F,r.transformObjects=R,r.createValueColumns=ae,r.setGrouped=oe}(r=t.DataViewTransform||(t.DataViewTransform={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return function(t){return t.get(e)}}function r(e,t){return"function"==typeof e?e(t):"string"==typeof e?e:void 0}e.createDisplayNameGetter=t,e.getDisplayName=r}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Week=2]="Week",e[e.Day=3]="Day",e[e.Hour=4]="Hour",e[e.Minute=5]="Minute",e[e.Second=6]="Second",e[e.Millisecond=7]="Millisecond"}(e.DateTimeUnit||(e.DateTimeUnit={}));e.DateTimeUnit}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){var t=i.visit(e,l.instance);
return t}function r(t){return e.aggregate(n(t),t.aggregate)}function n(t){return e.columnRef(a(t),t.name)}function a(t){return e.entity(t.schema,t.entity,t.entityVar)}function o(t){return e.aggregate(a(t),t.aggregate)}function u(t){return e.aggregate(s(t),t.aggregate)}function s(t){return e.hierarchyLevel(c(t),t.level)}function c(t){return e.hierarchy(a(t),t.name)}e.fieldExpr=t,e.fromColumnAggr=r,e.fromColumn=n,e.fromEntity=a,e.fromEntityAggr=o,e.fromHierarchyLevelAggr=u,e.fromHierarchyLevel=s,e.fromHierarchy=c;var l=function(){function t(){}return t.prototype.visitColumn=function(e){return n(e)},t.prototype.visitColumnAggr=function(e){return r(e)},t.prototype.visitColumnHierarchyLevelVariation=function(t){return e.propertyVariationSource(this.visitEntity(t.source),t.source.name,t.level.name)},t.prototype.visitEntity=function(e){return a(e)},t.prototype.visitEntityAggr=function(e){return o(e)},t.prototype.visitHierarchy=function(e){return c(e)},t.prototype.visitHierarchyLevel=function(e){return s(e)},t.prototype.visitHierarchyLevelAggr=function(e){return u(e)},t.prototype.visitMeasure=function(t){return e.measureRef(this.visitEntity(t),t.name)},t.prototype.visitPercentile=function(t){var r=e.fieldExpr(t.arg);return e.percentile(r,t.k,t.exclusive)},t.prototype.visitPercentOfGrandTotal=function(t){var r=e.fieldExpr(t.baseExpr);return e.arithmetic(r,e.scopedEval(r,[]),3)},t.prototype.visitSelectRef=function(t){return e.selectRef(t.expressionName)},t.instance=new t,t}()}(t=e.SQExprBuilder||(e.SQExprBuilder={}));var r;!function(e){function t(e){return e.accept(n.instance)}e.asFieldPattern=t}(r=e.SQExprConverter||(e.SQExprConverter={}));var i,n=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype.visitColumnRef=function(e){var t=e.source.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.ref,{column:r}}},i.prototype.visitMeasureRef=function(e){var t=e.source.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.ref,{measure:r}}},i.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),{entity:t}},i.prototype.visitAggr=function(e){var t=e.arg.accept(this);if(t&&t.column){var r=t.column;return r.aggregate=e.func,{columnAggr:r}}if(t&&t.columnAggr){var r=t.columnAggr;return r.aggregate=e.func,{columnAggr:r}}if(t&&t.hierarchyLevel){var r=t.hierarchyLevel;return r.aggregate=e.func,{hierarchyLevelAggr:r}}var i=e.arg.accept(a.instance);if(i&&i.entity){var r=i.entity;return r.aggregate=e.func,{entityAggr:r}}},i.prototype.visitPercentile=function(e){return{percentile:{arg:e.arg.accept(this),k:e.k,exclusive:e.exclusive}}},i.prototype.visitHierarchy=function(e){var t=e.arg.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.hierarchy,{hierarchy:r}}},i.prototype.visitHierarchyLevel=function(e){var t=e.arg.accept(o.instance);if(t){var r;return t.hierarchy&&(r={entity:t.hierarchy.entity,schema:t.hierarchy.schema,name:t.hierarchy.name,level:e.level}),t.variation?{columnHierarchyLevelVariation:{source:{entity:t.variation.column.entity,schema:t.variation.column.schema,name:t.variation.column.name},level:r,variationName:t.variation.variationName}}:{hierarchyLevel:r}}},i.prototype.visitArithmetic=function(r){var i={percentOfGrandTotal:{baseExpr:r.left.accept(this)}};return e.SQExpr.equals(r,t.fieldExpr(i))?i:void 0},i.prototype.visitSelectRef=function(e){return{selectRef:{expressionName:e.expressionName}}},i.instance=new i,i}(e.DefaultSQExprVisitor),a=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),{entity:t}},r.prototype.visitPropertyVariationSource=function(t){var r=t.arg;if(r instanceof e.SQEntityExpr){var i={schema:r.schema,entity:r.entity,name:t.property};return r.variable&&(i.entityVar=r.variable),{variation:{column:i,variationName:t.name}}}},r.instance=new r,r}(e.DefaultSQExprVisitor),o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitHierarchy=function(e){var t,r,i=e.arg.accept(a.instance);return i.variation?(t={name:e.hierarchy,schema:i.variation.column.schema,entity:i.variation.column.entity},r=i.variation):t={name:e.hierarchy,schema:i.entity.schema,entity:i.entity.entity},{hierarchy:t,variation:r}},t.instance=new t,t}(e.DefaultSQExprVisitor);!function(i){function n(t,i){var n=t instanceof e.SQExpr?r.asFieldPattern(t):t;return n.column?a(n.column,i):n.columnAggr?o(n.columnAggr,i):n.columnHierarchyLevelVariation?u(n.columnHierarchyLevelVariation,i):n.entity?s(n.entity,i):n.entityAggr?c(n.entityAggr,i):n.hierarchy?l(n.hierarchy,i):n.hierarchyLevel?p(n.hierarchyLevel,i):n.hierarchyLevelAggr?f(n.hierarchyLevelAggr,i):n.measure?v(n.measure,i):n.percentile?g(n.percentile,i):n.percentOfGrandTotal?d(n.percentOfGrandTotal,i):n.selectRef?h(n.selectRef,i):void 0}function a(e,t){return t.visitColumn(e)}function o(e,t){return t.visitColumnAggr(e)}function u(e,t){return t.visitColumnHierarchyLevelVariation(e)}function s(e,t){return t.visitEntity(e)}function c(e,t){return t.visitEntityAggr(e)}function l(e,t){return t.visitHierarchy(e)}function p(e,t){return t.visitHierarchyLevel(e)}function f(e,t){return t.visitHierarchyLevelAggr(e)}function v(e,t){return t.visitMeasure(e)}function h(e,t){return t.visitSelectRef(e)}function g(e,t){return t.visitPercentile(e)}function d(e,t){return t.visitPercentOfGrandTotal(e)}function y(e){return t.columnRef(t.entity(e.schema,e.entity,e.entityVar),e.name)}function m(e){return n(e,_.instance)}function x(e){return n(e,F.instance)}function S(e){return void 0!==(e.column||e.columnAggr||e.measure)}function E(e){return i.visit(e,M.instance)}function w(e){var t=e.hierarchy;return t?t.name:void 0}function b(e){return e.columnHierarchyLevelVariation?e.columnHierarchyLevelVariation.source:e.column||e.measure||e.columnAggr}function D(e){var t=E(e);return t?t:T(e).entity}function C(e){var t=i.toFieldExprEntityItemPattern(e);return t.schema}function T(e){return i.visit(e,P.instance)}function V(e){return i.visit(e,P.instance)}i.visit=n,i.toColumnRefSQExpr=y,i.getAggregate=m,i.isAggregation=x,i.hasFieldExprName=S,i.getPropertyName=E,i.getHierarchyName=w,i.getColumnRef=b,i.getFieldExprName=D,i.getSchema=C,i.toFieldExprEntityPattern=T,i.toFieldExprEntityItemPattern=V;var _=function(){function r(){}return r.prototype.visitColumn=function(e){},r.prototype.visitColumnAggr=function(e){return e.aggregate},r.prototype.visitColumnHierarchyLevelVariation=function(e){},r.prototype.visitEntity=function(e){},r.prototype.visitEntityAggr=function(e){return e.aggregate},r.prototype.visitHierarchy=function(e){},r.prototype.visitHierarchyLevel=function(e){},r.prototype.visitHierarchyLevelAggr=function(e){return e.aggregate},r.prototype.visitMeasure=function(e){},r.prototype.visitSelectRef=function(e){},r.prototype.visitPercentile=function(e){},r.prototype.visitPercentOfGrandTotal=function(r){return e.SQExprInfo.getAggregate(t.fieldExpr(r.baseExpr))},r.instance=new r,r}(),F=function(){function e(){}return e.prototype.visitColumn=function(e){return!1},e.prototype.visitColumnAggr=function(e){return!0},e.prototype.visitColumnHierarchyLevelVariation=function(e){return!1},e.prototype.visitEntity=function(e){return!1},e.prototype.visitEntityAggr=function(e){return!0},e.prototype.visitHierarchy=function(e){return!1},e.prototype.visitHierarchyLevel=function(e){return!1},e.prototype.visitHierarchyLevelAggr=function(e){return!0},e.prototype.visitMeasure=function(e){return!0},e.prototype.visitSelectRef=function(e){return!1},e.prototype.visitPercentile=function(e){return!0},e.prototype.visitPercentOfGrandTotal=function(e){return!0},e.instance=new e,e}(),P=function(){function e(){}return e.prototype.visitColumn=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitColumnAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitColumnHierarchyLevelVariation=function(t){return e.toEntityItemExprPattern(t.source)},e.prototype.visitEntity=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitEntityAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchy=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchyLevel=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchyLevelAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitMeasure=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitSelectRef=function(e){},e.prototype.visitPercentile=function(e){return i.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return i.visit(e.baseExpr,this)},e.toEntityItemExprPattern=function(e){var t={schema:e.schema,entity:e.entity};return e.entityVar&&(t.entityVar=e.entityVar),t},e.instance=new e,e}(),M=function(){function e(){}return e.prototype.visitColumn=function(e){return e.name},e.prototype.visitColumnAggr=function(e){return e.name},e.prototype.visitColumnHierarchyLevelVariation=function(e){},e.prototype.visitEntity=function(e){},e.prototype.visitEntityAggr=function(e){},e.prototype.visitHierarchy=function(e){},e.prototype.visitHierarchyLevel=function(e){},e.prototype.visitHierarchyLevelAggr=function(e){},e.prototype.visitMeasure=function(e){return e.name},e.prototype.visitSelectRef=function(e){},e.prototype.visitPercentile=function(e){return i.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return i.visit(e.baseExpr,this)},e.instance=new e,e}()}(i=e.FieldExprPattern||(e.FieldExprPattern={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(t,r){if(!r||0===r.length)return{dataView:t,isValid:!0};if(t)for(var u=0,s=r;u<s.length;u++){var l=s[u];if(c(t,l))return{dataView:t,isValid:!0};if(l.categorical&&t.categorical)return i(t,l);if(l.tree&&t.tree)return a(t,l.tree);if(l.single&&t.single)return n(t,l.single);if(l.table&&t.table)return o(t,l.table)}else if(e.ScriptResultUtil.findScriptResult(r))return{dataView:t,isValid:!0};return{isValid:!1}}function i(t,r){var i=r.categorical,n=t.categorical;if(!n)return{isValid:!1};var a;if(i.rowCount&&(a=i.rowCount.supported,a&&a.max)){var o=void 0,u=n.categories,s=a.max,c=void 0;if(u)for(var p=0,f=u.length;f>p;p++){var v=u[p];if(c=v.values.length,void 0!==s&&c>s){var h=C.range(v.values,0,s-1);o=o||{categories:[]},o.categories.push({source:v.source,values:h})}}if(n.values&&n.values.length>0&&s&&(c||(c=n.values[0].values.length),void 0!==s&&c>s)){o=o||{},o.values=e.data.DataViewTransform.createValueColumns();for(var p=0,f=n.values.length;f>p;p++){var g=n.values[p],d={source:g.source,values:C.range(g.values,0,s-1)};void 0!==g.min&&(d.min=g.min),void 0!==g.max&&(d.max=g.max),void 0!==g.subtotal&&(d.subtotal=g.subtotal),o.values.push(d)}}o&&(t={metadata:t.metadata,categorical:o})}return l(t,r)?{dataView:t,isValid:!0}:null}function n(e,t){return e.single?{dataView:e,isValid:!0}:{isValid:!1}}function a(e,t){var r=e.metadata;return null==g(u(r.columns),t.depth)?{dataView:e,isValid:!0}:{isValid:!1}}function o(e,t){return e.table?{dataView:e,isValid:!0}:{isValid:!1}}function u(e){for(var t=0,r=0,i=e.length;i>r;r++)e[r].isMeasure||++t;return t}function s(e){for(var t=0,r=0,i=e.length;i>r;r++)e[r].isMeasure&&++t;return t}function c(e,t,r){return t&&e?t.scriptResult&&!h(e.scriptResult,t.scriptResult)?!1:t.categorical&&!l(e,t.categorical,r)?!1:t.tree&&!f(e,t.tree)?!1:t.single&&!p(e.single,t.single)?!1:!t.table||v(e.table,t.table,r):!1}function l(e,t,r){var i=e.categorical;if(!i)return!1;if(t.rowCount){var n=t.rowCount.supported;if(r&&t.rowCount.preferred&&(n=t.rowCount.preferred),n){var a=0;if(i.values&&i.values.length?a=i.values[0].values.length:i.categories&&i.categories.length&&(a=i.categories[0].values.length),null!=g(a,n))return!1}}return!0}function p(e,t){return!!e}function f(e,t){var r=e.metadata;return null==g(u(r.columns),t.depth)}function v(e,t,r){if(!e)return!1;if(t.rowCount){var i=t.rowCount.supported;if(r&&t.rowCount.preferred&&(i=t.rowCount.preferred),i){var n=0;if(e.rows&&e.rows.length&&(n=e.rows.length),null!=g(n,i))return!1}}return!0}function h(e,t){return e?!!e.imageBase64:!1}function g(e,t,r){return t?!r&&void 0!==t.min&&t.min>e?V.conditionRangeTooSmall:void 0!==t.max&&t.max<e?V.conditionRangeTooLarge:void 0:void 0}function d(t,r,i,n){if(t&&void 0!==t.kind){var a=t.kind,o=i[r];if(o)for(var u=o.all(),s=0,c=u;s<c.length;s++){var l=c[s];if(n[l.queryRef]!==a)switch(a){case e.VisualDataRoleKind.Measure:return V.conditionKindExpectedMeasure;case e.VisualDataRoleKind.Grouping:return V.conditionKindExpectedGrouping;case e.VisualDataRoleKind.GroupingOrMeasure:return V.conditionKindExpectedGroupingOrMeasure}}}}function y(e,t,r,i,n){var a=[],o=[];if(!_.isEmpty(t))for(var u=0,s=t.length;s>u;u++){var c=t[u],l=c.conditions,p=c.requiredProperties,f=x(p,i,n),v=[];if(_.isEmpty(l))v.push({});else for(var h=0,g=l.length;g>h;h++){var d=l[h],y=m(e,d,r);if(_.isEmpty(y))v.push(d);else for(var S=0,E=y;S<E.length;S++){var w=E[S];w.mappingIndex=u,w.conditionIndex=h,o.push(w)}}if(!_.isEmpty(v)&&f){var b=_.cloneDeep(c),D=_.filter(v,function(e){return Object.keys(e).length>0});_.isEmpty(D)||(b.conditions=D),a.push(b)}}return{supportedMappings:C.emptyToNull(a),mappingErrors:C.emptyToNull(o)}}function m(e,t,r){for(var i=Object.keys(t),n=[],a=0,o=i.length;o>a;a++){var u=i[a],s=e[u]&&!_.isEmpty(e[u].activeProjectionRefs),c=t[u],l=S(u,e,s),p=g(l,c);null!=p&&n.push({code:p,roleName:u});var f=d(c,u,e,r);null!=f&&n.push({code:f,roleName:u})}return n}function x(t,r,i){if(_.isEmpty(t))return!0;if(!r||!i)return!1;var n=e.data.createStaticEvalContext();return _.every(t,function(t){var a=null,o=r[t.objectName];o&&(a=o.properties[t.propertyName]);var u=T.getValue(i,t,null);return a&&u?e.data.DataViewObjectEvaluator.evaluateProperty(n,a,u):!1})}function S(e,t,r){var i=t[e];return i?r?1:i.all().length:0}function E(t,r){if(t&&r&&t.categorical&&r.categorical){var i=t.categorical.categories,n=r.categorical.categories;if(i&&n&&i.length===n.length){for(var a=0,o=i.length;o>a;a++){var u=i[a].identity,s=n[a].identity,c=w(u);if(c!==w(s))return!1;for(var l=0;c>l;l++)if(!e.DataViewScopeIdentity.equals(u[l],s[l]))return!1}return!0}}return!1}function w(e){return e?e.length:0}function b(e,t){return e||t?e&&t?e.displayName!==t.displayName?!1:e.queryName!==t.queryName?!1:e.isMeasure!==t.isMeasure?!1:e.type!==t.type?!1:e.sort===t.sort:!1:!0}function D(e,r){if(!e&&!r)return!0;if(!e||!r)return!1;var i=e.columns.length,n=r.columns.length;if(i!==n)return!1;for(var a=0;n>a;a++)if(!t.areMetadataColumnsEquivalent(e.columns[a],r.columns[a]))return!1;return!0}var C=jsCommon.ArrayExtensions,T=e.data.DataViewObjectDefinitions;!function(e){e[e.conditionRangeTooLarge=0]="conditionRangeTooLarge",e[e.conditionRangeTooSmall=1]="conditionRangeTooSmall",e[e.conditionKindExpectedMeasure=2]="conditionKindExpectedMeasure",e[e.conditionKindExpectedGrouping=3]="conditionKindExpectedGrouping",e[e.conditionKindExpectedGroupingOrMeasure=4]="conditionKindExpectedGroupingOrMeasure"}(t.DataViewMappingMatchErrorCode||(t.DataViewMappingMatchErrorCode={}));var V=t.DataViewMappingMatchErrorCode;t.validateAndReshape=r,t.countGroups=u,t.countMeasures=s,t.supports=c,t.validateRange=g,t.chooseDataViewMappings=y,t.getPropertyCount=S,t.hasSameCategoryIdentity=E,t.areMetadataColumnsEquivalent=b,t.isMetadataEquivalent=D}(t=e.DataViewAnalysis||(e.DataViewAnalysis={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.ArrayExtensions,i=jsCommon.Lazy;!function(e){function t(e){return new a(e)}function n(e,t){return e.key&&t.key&&e.key===t.key&&r.sequenceEqual(e.roles,t.roles,function(e,t){return e===t})}e.fromRoles=t,e.equals=n;var a=function(){function e(e){var t=this;this._roles=e,this._key=new i(function(){return JSON.stringify(t.roles)})}return Object.defineProperty(e.prototype,"roles",{get:function(){return this._roles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),e}()}(t=e.DataViewRoleWildcard||(e.DataViewRoleWildcard={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t,i){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:r.SQExpr.equals(e.expr,t.expr,i)}function n(e,t){if(!_.isEmpty(e)){for(var r=[],i=0,n=e;i<n.length;i++){var o=n[i];r.push(o.expr)}return a(r,t)}}function a(t,i){if(!_.isEmpty(t)){for(var n,a=0,o=t;a<o.length;a++){var u=o[a],s=r.ScopeIdentityExtractor.getInExpr(u);n=n?r.SQExprBuilder.or(n,s):s||u}return n&&i&&(n=e.data.SQExprBuilder.not(n)),e.data.SemanticFilter.fromSQExpr(n)}}t.equals=i,t.filterFromIdentity=n,t.filterFromExprs=a}(t=e.DataViewScopeIdentity||(e.DataViewScopeIdentity={}));var r;!function(e){function t(e){return new i(e)}var r=jsCommon.Lazy;e.createDataViewScopeIdentity=t;var i=function(){function t(t){this._expr=t,this._key=new r(function(){return e.SQExprShortSerializer.serialize(t)})}return Object.defineProperty(t.prototype,"expr",{get:function(){return this._expr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(r=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.Lazy;!function(t){function i(t,r){var i=e.ScopeIdentityExtractor.getKeys(r.expr);return i?e.SQExprUtils.sequenceEqual(t.exprs,i):!1}function n(t,r){return t.key===r.key&&e.SQExprUtils.sequenceEqual(t.exprs,r.exprs)}function a(e){return new o(e)}t.matches=i,t.equals=n,t.fromExprs=a;var o=function(){function t(t){this._exprs=t,this._key=new r(function(){return e.SQExprShortSerializer.serializeArray(t)})}return Object.defineProperty(t.prototype,"exprs",{get:function(){return this._exprs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(t=e.DataViewScopeWildcard||(e.DataViewScopeWildcard={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(){return new r}e.createColorAllocatorCache=t;var r=function(){function e(){this.cache=[]}return e.prototype.get=function(e){for(var t=0,r=this.cache;t<r.length;t++){var i=r[t];if(i.key===e)return i.allocator}},e.prototype.register=function(e,t){return this.cache.push({key:e,allocator:t}),this},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function i(r){var i=r.dataViewMappings,n=r.visualDataViews,a=r.dataRoles,o=r.objectDescriptors,u=r.objectDefinitions,s=r.colorAllocatorFactory,c=r.transformSelects,l=r.projectionActiveItems,p=r.metadata;if(!_.isEmpty(n)&&c&&p){var f=t.DataViewSelectTransform.createRoleKindFromMetadata(c,p),v=t.DataViewSelectTransform.projectionsFromSelects(c,l);if(!f||!v||_.isEmpty(i)||!o||!u)return n;var h=e.DataViewAnalysis.chooseDataViewMappings(v,i,f,o,u).supportedMappings;if(h){var g=_.find(h,function(e){return e.usage&&e.usage.regression});if(g){for(var d=[],y=0,m=n;y<m.length;y++){var x=m[y],S=this.linearRegressionTransform(x,a,g,o,u,s);S&&d.push(S)}_.isEmpty(d)||n.push.apply(n,d)}}}return n}function n(t,r,i,n,u,s){if(t.categorical){var c=o(0,t.categorical,r),l=o(1,t.categorical,r);if(!_.isEmpty(c)&&!_.isEmpty(l)){var f=c[0].source,d=l[0].source,y=!0;if(i.usage&&i.usage.regression&&t.metadata.objects){var m=i.usage.regression,x=m.combineSeries;x&&(y=e.DataViewObjects.getValue(t.metadata.objects,x,!0))}var S=v(c,l,y,!1),E=a(S);if(E){var w,b=E.xMin,D=E.xMax,C=g(l)||g(c);if(C){var T=v(c,l,y,!0);w=a(T),w?(b=_.min([b,w.xMin]),D=_.max([D,w.xMax])):C=!1}for(var V=[],F=0,P=E.lineDefs;F<P.length;F++){var M=P[F];V.push(p(M,+b,+D))}var R;if(C){R=[];for(var A=0,N=w.lineDefs;A<N.length;A++){var M=N[A];R.push(p(M,+b,+D))}}var I;if(y)I=["combinedRegressionSeries"];else if(t.categorical.values.source){var O=t.categorical.values.grouped();I=_.map(O,function(e){return e.name})}else I=_.map(l,function(e){return e.source.queryName});var Q=h(f,d,I,[b,D],V,R,t,i,n,u,s);return Q}}}}function a(e){for(var t,r,i=[],n=0,a=e;n<a.length;n++){var o=a[n],u=o.xValues,p=o.yValues;if(_.isEmpty(u)||_.isEmpty(p))return;var f=s(u);if(!f)return;var v=s(p);if(!v)return;var h=c(u,p),g=h.xValues[0],d=h.xValues[h.xValues.length-1],y=l(h.xValues,h.yValues);t=_.min([t,g]),r=_.max([r,d]),i.push(y)}return{lineDefs:i,xMin:t,xMax:r}}function o(e,t,r){var i=u(e,t.values,r);if(!_.isEmpty(i))return i;var n=t.categories;if(!_.isEmpty(n)){var a=n[0];return i=u(e,[a],r),_.isEmpty(i)?void 0:i}}function u(e,t,r){return _.isEmpty(t)?void 0:_.filter(t,function(t){var i=function(i){if(!t.source.roles[i])return"continue";var n=_.find(r,function(e){return e.name===i});return n&&n.cartesianKind===e?{value:!0}:void 0};for(var n in t.source.roles){var a=i(n);if("object"==typeof a)return a.value}return!1})}function s(e){var t=_.find(e,function(e){return null!=e});if(null!=t){var r=typeof t;if(!_.some(e,function(e){return null!=e&&typeof e!==r}))return r}}function c(e,t){var r=_.zip(e,t),i=_.chain(r).filter(function(e){return null!=e[0]&&null!=e[1]}).sortBy(function(e){return e[0]}).unzip().value(),n=i[0],a=i[1];return{xValues:n,yValues:a}}function l(e,t){var r=_.sum(e)/e.length,i=_.sum(t)/t.length,n=_.chain(e).map(function(e){return Math.pow(e-r,2)}).sum(),a=_.chain(e).map(function(e,n){return(e-r)*(t[n]-i)}).sum(),o=a/n,u=i-r*o;return{slope:o,intercept:u}}function p(e,t,r){return[t*e.slope+e.intercept,r*e.slope+e.intercept]}function f(e,t){if(t){var r=e;if(r.highlights)return r.highlights}return e.values}function v(e,t,r,i){for(var n=[],a=_.map(e,function(e){return f(e,i)}),o=_.map(t,function(e){return f(e,i)}),u=e.length>1,s=0;s<o.length;s++){var c=u?a[s]:a[0],l=o[s];r&&n.length>0?(n[0].xValues=n[0].xValues.concat(c),n[0].yValues=n[0].yValues.concat(l)):n.push({xValues:c,yValues:l})}return n}function h(e,i,n,a,o,u,s,c,l,p,f){var v,h,g=c.categorical.categories["for"]["in"],m=c.categorical.values.group;if(m&&!_.isEmpty(m.select)&&(v=m.select[0]["for"]?m.select[0]["for"]["in"]:m.select[0].bind.to,h=m.by),v&&h){var x=(T={},T[g]=!0,T),S=(V={},V[v]=!0,V),E=(F={},F[h]=!0,F),w=[];for(var b in o){var D={values:o[b]};u&&(D.highlights=u[b]),w.push([D])}var C=t.createCategoricalDataViewBuilder().withCategory({source:{displayName:e.displayName,queryName:d,type:e.type,isMeasure:!1,roles:x},values:a,identityFrom:{fields:[t.SQExprBuilder.columnRef(t.SQExprBuilder.entity("s","RegressionEntity"),"RegressionCategories")]}}).withGroupedValues({groupColumn:{source:{displayName:i.displayName+"Regression",queryName:y,type:i.type,isMeasure:i.isMeasure,roles:E},values:n,identityFrom:{fields:[t.SQExprBuilder.columnRef(t.SQExprBuilder.entity("s","RegressionEntity"),"RegressionSeries")]}},valueColumns:[{source:{displayName:i.displayName,queryName:r.regressionYQueryName,type:i.type,isMeasure:i.isMeasure,roles:S}}],data:w}).build();return t.DataViewTransform.transformObjects(C,1,l,p,[],f),C;var T,V,F}}function g(e){return _.any(e,function(e){var t=e;return null!=t.highlights})}var d="RegressionX",y="RegressionSeries";r.regressionYQueryName="RegressionY",r.run=i,r.linearRegressionTransform=n}(r=t.DataViewRegression||(t.DataViewRegression={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function i(e,r){for(var i={},n=0,a=e;n<a.length;n++){var o=a[n];if(o){var u=o.roles;if(u)for(var s in u)if(u[s]){var c=i[s];c||(c=i[s]=new t.QueryProjectionCollection([])),c.all().push({queryRef:o.queryName}),r&&r[s]&&(c.activeProjectionRefs=_.map(r[s],function(e){return e.queryRef}))}}}return i}function n(t,r){for(var i={},n=0,a=r.columns;n<a.length;n++){var o=a[n];if(!(!o.index&&0!==o.index||o.index<0||o.index>=t.length)){var u=t[o.index];if(u){var s=u.queryName;s&&void 0===i[s]&&(i[s]=o.isMeasure?e.VisualDataRoleKind.Measure:e.VisualDataRoleKind.Grouping)}}}return i}r.projectionsFromSelects=i,r.createRoleKindFromMetadata=n}(r=t.DataViewSelectTransform||(t.DataViewSelectTransform={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t){return new n(e,t)}function r(e,t){return i(e.values,t)||i(e.categories,t)}function i(e,t){if(e)for(var r=0,i=e;r<i.length;r++){var n=i[r],a=n.source.roles;if(a&&a[t])return n}}e.createCategoricalEvalContext=t;var n=function(){function e(e,t){this.colorAllocatorProvider=e,this.dataView=t,this.columnsByRole={}}return e.prototype.getColorAllocator=function(e){return this.colorAllocatorProvider.get(e)},e.prototype.getExprValue=function(e){},e.prototype.getRoleValue=function(e){var t=this.columnsByRole,i=t[e];if(i||(i=t[e]=r(this.dataView,e)),i){var n=this.index;return null!=n?i.values[this.index]:void 0}},e.prototype.setCurrentRowIndex=function(e){this.index=e},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,i){return new r(e,t,i)}e.createTableEvalContext=t;var r=function(){function t(e,t,r){this.colorAllocatorProvider=e,this.dataView=t,this.selectTransforms=r}return t.prototype.getColorAllocator=function(e){return this.colorAllocatorProvider.get(e)},t.prototype.getExprValue=function(t){var r=this.rowIdx;if(null!=r)return e.getExprValueFromTable(t,this.selectTransforms,this.dataView,r)},t.prototype.getRoleValue=function(e){},t.prototype.setCurrentRowIndex=function(e){this.rowIdx=e},t}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.evaluate=function(e){},e}();e.RuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(e){function t(t,r){e.call(this),this.inputRole=t,this.allocator=r}return __extends(t,e),t.prototype.evaluate=function(e){var t=e.getRoleValue(this.inputRole);return void 0!==t?this.allocator.color(t):void 0},t}(e.RuleEvaluation);e.ColorRuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){var r,i=e.Prototype.inherit,n=e.Prototype.inheritSingle,a=jsCommon.ArrayExtensions;!function(e){function t(e,t){if(e)if(r(e))for(var i=0,n=0,a=e;n<a.length;n++){var u=a[n];u&&(i=o(u,i,[],t))}else o(e,0,[],t)}function r(e){return a.isArrayOrInheritedArray(e)}function o(e,t,r,i){if(r.push(e),_.isEmpty(e.children))i(e,t,r),t++;else for(var n=e.children,a=0,u=n;a<u.length;a++){var s=u[a];s&&(t=o(s,t,r,i))}return r.pop(),t}function u(e,t,r){var a=e,o=_.isUndefined(e.level),s=o||e.level<=t;if(s){var c=r?n:i,l=c(e),p=o||e.level<t;if(p&&!_.isEmpty(e.children)){l.children=c(e.children);for(var f=0,v=l.children.length;v>f;f++)l.children[f]=u(l.children[f],t,r)}a=l}return a}function s(e){var t=!1;if(e)if(c(e))t=s(e.rows)||s(e.columns);else{var r=e.levels;if(!_.isEmpty(r))for(var i=0,n=r;i<n.length;i++){var a=n[i];if(a.sources&&a.sources.length>=2){var o=a.sources[0].isMeasure;if(!o){t=!0;break}}}}return t}function c(e){return"rows"in e&&"columns"in e&&"valueSources"in e}e.forEachLeafNode=t,e.inheritMatrixNodeHierarchy=u,e.containsCompositeGroup=s}(r=t.DataViewMatrixUtils||(t.DataViewMatrixUtils={}))}(r=t.utils||(t.utils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var r=e.roles;return r&&r[t]}function r(e,r,i){var n=[];if(!_.isEmpty(e)){for(var a=r[i],o={},u=0,s=a.length;s>u;u++){var c=a[u];o[c]=u}for(var l=0,p=e.length;p>l;l++){var f=e[l];if(t(f,i)){var v={metadataColumn:f,sourceIndex:l,projectionOrderIndex:o[f.index]};n.push(v)}}}return n}e.isForRole=t,e.joinMetadataColumnsAndProjectionOrder=r}(t=e.DataViewMetadataColumnUtils||(e.DataViewMetadataColumnUtils={}))}(t=e.utils||(e.utils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.findProperty=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.properties))return r.properties.withName(t)},e.prototype.findHierarchy=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.hierarchies))return r.hierarchies.withName(t)},e.prototype.findHierarchyByVariation=function(e,t,r,i){var n=this.entities.withName(e);if(n&&!_.isEmpty(n.properties)){var a=n.properties.withName(t);if(a){var o=a.column;if(o&&!_.isEmpty(o.variations)){var u=o.variations.withName(r);if(u){var s=u.navigationProperty?u.navigationProperty.targetEntity:n;if(!s||_.isEmpty(s.hierarchies))return;return s.hierarchies.withName(i)}}}}},e.prototype.findPropertyWithKpi=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.properties))for(var i=0,n=r.properties;i<n.length;i++){var a=n[i];if(a&&a.measure&&a.measure.kpi&&(a.measure.kpi.status===t||a.measure.kpi.goal===t))return a}},e}();e.ConceptualSchema=t,function(e){e[e.None=0]="None",e[e.Address=1]="Address",e[e.City=2]="City",e[e.Company=3]="Company",e[e.Continent=4]="Continent",e[e.Country=5]="Country",e[e.County=6]="County",e[e.Date=7]="Date",e[e.Image=8]="Image",e[e.ImageUrl=9]="ImageUrl",e[e.Latitude=10]="Latitude",e[e.Longitude=11]="Longitude",e[e.Organization=12]="Organization",e[e.Place=13]="Place",e[e.PostalCode=14]="PostalCode",e[e.Product=15]="Product",e[e.StateOrProvince=16]="StateOrProvince",e[e.WebUrl=17]="WebUrl"}(e.ConceptualDataCategory||(e.ConceptualDataCategory={}));e.ConceptualDataCategory}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,r=jsCommon.StringExtensions,i=e.data.FieldExprPattern;!function(t){function n(e){return e&&1===e.length?e[0].scriptResult:void 0}function a(t){var r=n(t);if(r){var i=t[0].metadata.objects,a=e.DataViewObjects.getValue(i,r.script.source),o=e.DataViewObjects.getValue(i,r.script.provider);return{source:a,provider:o}}}function o(t,r){var i=n(t);if(i&&r){var a=e.data.DataViewObjectDefinitions.getValue(r,i.script.source,null),o=e.data.DataViewObjectDefinitions.getValue(r,i.script.provider,null);return{source:a?a.value:null,provider:o?o.value:null}}}function u(e,t,n){var a={VariableName:"dataset",Columns:[]};if(e&&t&&!_.isEmpty(t)){var o=[],u=[];for(var c in e)for(var l=0,p=e[c].all();l<p.length;l++){var f=p[l],v=t.withName(f.queryRef);if(v){var h={QueryName:v.name,Name:i.visit(v.expr,new s(n))};u.push(h),o.push(h.Name)}}o=r.ensureUniqueNames(o);for(var g=0;g<o.length;g++){var h=u[g];h.Name=o[g]}a.Columns=u}return a}t.findScriptResult=n,t.extractScriptResult=a,t.extractScriptResultFromVisualConfig=o,t.getScriptInput=u;var s=function(){function e(e){this.federatedSchema=e}return e.prototype.visitColumn=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitColumnAggr=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitColumnHierarchyLevelVariation=function(t){return e.getVariationLevelName(t,this.federatedSchema)},e.prototype.visitEntity=function(e){return e.entity},e.prototype.visitEntityAggr=function(e){return e.entity},e.prototype.visitHierarchy=function(t){return e.getNameForHierarchy(t,this.federatedSchema)},e.prototype.visitHierarchyLevel=function(e){},e.prototype.visitHierarchyLevelAggr=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitMeasure=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitSelectRef=function(e){return i.visit(e,this)},e.prototype.visitPercentile=function(e){return i.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return i.visit(e.baseExpr,this)},e.getNameForHierarchy=function(e,t){var r=t.schema(e.schema),i=r.findHierarchy(e.entity,e.name);return i?i.name:void 0},e.getNameForProperty=function(e,t){var r=t.schema(e.schema),i=r.findProperty(e.entity,e.name);return i?i.name:void 0},e.getVariationLevelName=function(e,t){var r=e.source,i=t.schema(r.schema).findProperty(r.entity,r.name);if(i)for(var n=i.column.variations,a=0,o=n;a<o.length;a++){
var u=o[a];if(u.name===e.variationName)for(var s=0,c=u.defaultHierarchy.levels;s<c.length;s++){var l=c[s];if(l.name===e.level.level)return l.column.name}}},e}()}(t=e.ScriptResultUtil||(e.ScriptResultUtil={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){function r(t,r){!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,r.metadata),r.metadata.segment||delete t.metadata.segment,t.table&&r.table&&i(t.table,r.table),t.categorical&&r.categorical&&n(t.categorical,r.categorical),t.tree&&r.tree&&o(t.tree.root,r.tree.root,!0),t.matrix&&r.matrix&&o(t.matrix.rows.root,r.matrix.rows.root,!1)}function i(e,t){if(!_.isEmpty(t.rows)){var r=t.lastMergeIndex+1;a(e.rows,t.rows,r),t.identity&&a(e.identity,t.identity,r)}}function n(e,t){if(e.categories&&t.categories)for(var r=t.categories.length,i=0;r>i;i++){var n=t.categories[i],o=e.categories[i],u=t.lastMergeIndex+1;n.values&&a(o.values,n.values,u),n.identity&&a(o.identity,n.identity,u)}if(e.values&&t.values)for(var s=t.values.length,c=0;s>c;c++){var l=t.values[c],p=e.values[c];!p.values&&l.values&&(p.values=[]);var u=t.lastMergeIndex+1;l.values&&a(p.values,l.values,u),l.highlights&&a(p.highlights,l.highlights,u)}}function a(e,t,r){if(r>=t.length)return t;var i=[];return void 0!==r&&(i=t.splice(0,r)),Array.prototype.push.apply(e,t),i}function o(e,t,r){if(t.children&&0!==t.children.length){if(r&&(!e.children||0===e.children.length))return void(e.children=t.children);var i=u(t.children),n=e.children[e.children.length-1],s=a(e.children,t.children,i);s.length>0&&o(n,s[s.length-1],r)}}function u(e){if(0===e.length)return 0;for(var t=0;t<e.length;t++){var r=e[t];if(!r.isMerge)break}return t}t.mergeDataViews=r,t.mergeTables=i,t.mergeCategorical=n,t.mergeTreeNodes=o}(r=t.DataViewMerger||(t.DataViewMerger={}))}(r=t.segmentation||(t.segmentation={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,r=function(){function r(){}return r.prototype.visitColumnRef=function(t){var r=t.source,i=r.accept(this);return r===i?t:new e.SQColumnRefExpr(i,t.ref)},r.prototype.visitMeasureRef=function(t){var r=t.source,i=r.accept(this);return r===i?t:new e.SQMeasureRefExpr(i,t.ref)},r.prototype.visitAggr=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQAggregationExpr(i,t.func)},r.prototype.visitSelectRef=function(e){return e},r.prototype.visitPercentile=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQPercentileExpr(i,t.k,t.exclusive)},r.prototype.visitHierarchy=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQHierarchyExpr(i,t.hierarchy)},r.prototype.visitHierarchyLevel=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQHierarchyLevelExpr(i,t.level)},r.prototype.visitPropertyVariationSource=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQPropertyVariationSourceExpr(i,t.name,t.property)},r.prototype.visitEntity=function(e){return e},r.prototype.visitAnd=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQAndExpr(i,a)},r.prototype.visitBetween=function(t){var r=t.arg,i=r.accept(this),n=t.lower,a=n.accept(this),o=t.upper,u=o.accept(this);return r===i&&n===a&&o===u?t:new e.SQBetweenExpr(i,a,u)},r.prototype.visitIn=function(r){for(var i,n=r.args,a=this.rewriteAll(n),o=r.values,u=0,s=o.length;s>u;u++){var c=o[u],l=this.rewriteAll(c);c===l||i||(i=t.take(o,u)),i&&i.push(l)}return n!==a||i?new e.SQInExpr(a,i||o):r},r.prototype.rewriteAll=function(e){for(var r,i=0,n=e.length;n>i;i++){var a=e[i],o=a.accept(this);a===o||r||(r=t.take(e,i)),r&&r.push(o)}return r||e},r.prototype.visitOr=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQOrExpr(i,a)},r.prototype.visitCompare=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQCompareExpr(t.comparison,i,a)},r.prototype.visitContains=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQContainsExpr(i,a)},r.prototype.visitExists=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQExistsExpr(i)},r.prototype.visitNot=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQNotExpr(i)},r.prototype.visitStartsWith=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQStartsWithExpr(i,a)},r.prototype.visitConstant=function(e){return e},r.prototype.visitDateSpan=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQDateSpanExpr(t.unit,i)},r.prototype.visitDateAdd=function(t){var r=t.arg,i=r.accept(this);return r===i?t:new e.SQDateAddExpr(t.unit,t.amount,i)},r.prototype.visitNow=function(e){return e},r.prototype.visitDefaultValue=function(e){return e},r.prototype.visitAnyValue=function(e){return e},r.prototype.visitArithmetic=function(t){var r=t.left,i=r.accept(this),n=t.right,a=n.accept(this);return r===i&&n===a?t:new e.SQArithmeticExpr(i,a,t.operator)},r.prototype.visitScopedEval=function(t){var r=t.expression,i=r.accept(this),n=t.scope,a=this.rewriteAll(n);return r===i&&n===a?t:new e.SQScopedEvalExpr(i,a)},r.prototype.visitFillRule=function(t){var r=t.input,i=r.accept(this),n=t.rule,a=n.linearGradient2,o=a;a&&(o=this.visitLinearGradient2(a));var u=n.linearGradient3,s=u;if(u&&(s=this.visitLinearGradient3(u)),r!==i||a!==o||u!==s){var c={};return o&&(c.linearGradient2=o),s&&(c.linearGradient3=s),new e.SQFillRuleExpr(i,c)}return t},r.prototype.visitLinearGradient2=function(e){var t=e.min,r=this.visitFillRuleStop(t),i=e.max,n=this.visitFillRuleStop(i);return t!==r||i!==n?{min:r,max:n}:e},r.prototype.visitLinearGradient3=function(e){var t=e.min,r=this.visitFillRuleStop(t),i=e.mid,n=this.visitFillRuleStop(i),a=e.max,o=this.visitFillRuleStop(a);return t!==r||i!==n||a!==o?{min:r,mid:n,max:o}:e},r.prototype.visitFillRuleStop=function(e){var t=e.color,r=e.color.accept(this),i=e.value,n=i;if(i&&(n=i.accept(this)),t!==r||i!==n){var a={color:r};return n&&(a.value=n),a}return e},r.prototype.visitResourcePackageItem=function(e){return e},r}();e.SQExprRewriter=r}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(e){return e.accept(new i)}t.run=r;var i=function(t){function r(){t.call(this)}return __extends(r,t),r.prototype.visitCompare=function(t){if(t.comparison!==e.QueryComparisonKind.Equal)return this.visitUnsupported(t);if(!this.isSupported(t.left)||!this.isSupported(t.right))return this.visitUnsupported(t);var r=this.isComparand(t.left),i=this.isComparand(t.right);if(r===i)return this.visitUnsupported(t);var n=r?t.left:t.right,a=r?t.right:t.left,o=this.current;return o?(o.add(n,a),t):e.SQExprBuilder.inExpr([n],[[a]])},r.prototype.visitOr=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var t;return this.current||(t=this.current=new n),e.left.accept(this),e.right.accept(this),t?(this.current=null,t.complete()||e):e},r.prototype.visitAnd=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var r=this.current;return r?(r.cancel(),e):t.prototype.visitAnd.call(this,e)},r.prototype.visitUnsupported=function(e){var t=this.current;return t&&t.cancel(),e},r.prototype.isSupported=function(t){return t instanceof e.SQCompareExpr||t instanceof e.SQColumnRefExpr||t instanceof e.SQConstantExpr||t instanceof e.SQHierarchyLevelExpr||t instanceof e.SQOrExpr||t instanceof e.SQAndExpr},r.prototype.isComparand=function(t){return t instanceof e.SQColumnRefExpr||t instanceof e.SQHierarchyLevelExpr},r}(e.SQExprRewriter),n=function(){function t(){}return t.prototype.add=function(t,r){if(!this.cancelled){if(this.operand&&!e.SQExpr.equals(t,this.operand))return void this.cancel();this.operand=t;var i=this.values;i||(i=this.values=[]),i.push(r)}},t.prototype.cancel=function(){this.cancelled=!0},t.prototype.complete=function(){return!this.cancelled&&this.operand?e.SQExprBuilder.inExpr([this.operand],_.map(this.values,function(e){return[e]})):void 0},t}()}(t=e.EqualsToInRewriter||(e.EqualsToInRewriter={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(e){function t(e,t){var r=e.conditions(),n=r[0];if(n){var a=new i(t);if(n.accept(a))return a.getResult()}}function r(e){var t=e.expr.accept(new n);return t?t.value:void 0}e.asScopeIdsContainer=t,e.getFirstComparandValue=r}(r=t.SQExprConverter||(t.SQExprConverter={}));var i=function(r){function i(e){r.call(this),this.isRoot=!0,this.isNot=!1,this.keyExprsCount=null,this.valueExprs=[],this.fieldExprs=[];for(var i=0,n=e;i<n.length;i++){var a=n[i];this.fieldExprs.push(t.SQExprBuilder.removeEntityVariables(a))}}return __extends(i,r),i.prototype.getResult=function(){for(var t=this.valueExprs,r=[],n=this.keyExprsCount||1,a=0,o=n,u=t.length;u>a&&u>=o;){var s=t.slice(a,o),c=i.getScopeIdentity(this.fieldExprs,s);jsCommon.ArrayExtensions.isInArray(r,c,e.DataViewScopeIdentity.equals)||r.push(c),a+=n,o+=n}return{isNot:this.isNot,scopeIds:r}},i.getScopeIdentity=function(e,r){for(var i,n=0,a=e.length;a>n;n++){var o=t.SQExprBuilder.equal(e[n],r[n]);i=i?t.SQExprBuilder.and(i,o):o}return t.createDataViewScopeIdentity(i)},i.prototype.visitOr=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,e.left.accept(this)&&e.right.accept(this))},i.prototype.visitNot=function(e){return this.isRoot?(this.isNot=!0,e.arg.accept(this)):this.unsupportedSQExpr()},i.prototype.visitConstant=function(t){return this.isRoot&&t.type.primitiveType===e.PrimitiveType.Null?this.unsupportedSQExpr():(this.valueExprs.push(t),!0)},i.prototype.visitCompare=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,e.comparison!==t.QueryComparisonKind.Equal?this.unsupportedSQExpr():e.left.accept(this)&&e.right.accept(this))},i.prototype.visitIn=function(e){this.keyExprsCount=0;var t;this.isRoot=!1;for(var r=0,i=e.args;r<i.length;r++){var n=i[r];if(t=n.accept(this),!t)return this.unsupportedSQExpr();this.keyExprsCount++}if(this.keyExprsCount!==this.fieldExprs.length)return this.unsupportedSQExpr();for(var a=e.values,o=0,u=a;o<u.length;o++)for(var s=u[o],c=(s.length,0),l=s;c<l.length;c++){var p=l[c];if(t=p.accept(this),!t)return this.unsupportedSQExpr()}return t},i.prototype.visitColumnRef=function(e){if(this.isRoot)return this.unsupportedSQExpr();var r=t.SQExprBuilder.removeEntityVariables(e);return null!==this.keyExprsCount?t.SQExpr.equals(this.fieldExprs[this.keyExprsCount],r):t.SQExpr.equals(this.fieldExprs[0],r)},i.prototype.visitDefaultValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},i.prototype.visitAnyValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},i.prototype.visitDefault=function(e){return this.unsupportedSQExpr()},i.prototype.unsupportedSQExpr=function(){return!1},i}(t.DefaultSQExprVisitor),n=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype.visitAnd=function(e){return e.left.accept(this)||e.right.accept(this)},r.prototype.visitCompare=function(e){if(e.comparison===t.QueryComparisonKind.Equal){if(e.right instanceof t.SQConstantExpr)return e.right;if(e.left instanceof t.SQConstantExpr)return e.left}},r}(t.DefaultSQExprVisitor)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.ArrayExtensions;!function(t){function i(e){var t=new a;return e.accept(t),t.malformed?null:r.emptyToNull(t.keys)}function n(t){var i=new a;if(t.accept(i),!i.malformed){var n=r.emptyToNull(i.keys),o=r.emptyToNull(i.values);return n&&o?e.SQExprBuilder.inExpr(n,[o]):void 0}}t.getKeys=i,t.getInExpr=n;var a=function(t){function r(){t.apply(this,arguments),this.keys=[],this.values=[]}return __extends(r,t),r.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?void this.visitDefault(t):(t.left.accept(this),void t.right.accept(this))},r.prototype.visitColumnRef=function(e){this.keys.push(e)},r.prototype.visitHierarchyLevel=function(e){this.keys.push(e)},r.prototype.visitConstant=function(e){this.values.push(e)},r.prototype.visitArithmetic=function(e){this.keys.push(e)},r.prototype.visitDefault=function(e){this.malformed=!0},r}(e.DefaultSQExprVisitor)}(t=e.ScopeIdentityExtractor||(e.ScopeIdentityExtractor={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e+"M"}function r(e){return e+"D"}function i(e){return e+"L"}function n(e){var t=new Date(e.getTime()-6e4*e.getTimezoneOffset()),r=t.toISOString();return jsCommon.StringExtensions.endsWith(r,"Z")&&(r=r.substr(0,r.length-1)),"datetime'"+r+"'"}function a(e){return"'"+e.replace(s,"''")+"'"}function o(){return"null"}function u(e){return e?"true":"false"}var s=/'/g;e.decimal=t,e["double"]=r,e.integer=i,e.dateTime=n,e.text=a,e.nullEncoding=o,e["boolean"]=u}(t=e.PrimitiveValueEncoding||(e.PrimitiveValueEncoding={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){return new a(e)}function i(e,r){var i=t.SQExprBuilder.removeAggregate(e).getMetadata(r);return i||(i=e.getMetadata(r)),i}var n=e.data.QueryAggregateFunction;t.createSQAggregationOperations=r;var a=function(){function r(e){this.datetimeMinMaxSupported=e}return r.prototype.getSupportedAggregates=function(r,a,o){var u=i(r,a);if(!u)return[];var s=u.type,c=u.kind,l=u.idOnEntityKey;if(!s)return[];if(1===c)return[];if(s.numeric||s.integer){var p=[n.Sum,n.Avg,n.Min,n.Max,n.Count,n.CountNonNull,n.StandardDeviation,n.Variance],f=t.SQExprConverter.asFieldPattern(r),v=t.FieldExprPattern.toFieldExprEntityItemPattern(f),h=a.schema(v.schema);return h.capabilities.supportsMedian&&p.push(n.Median),p}var g=[];this.datetimeMinMaxSupported&&s.dateTime&&(_.isEmpty(o)||e.ValueType.isCompatibleTo(s,o))&&(g.push(n.Min),g.push(n.Max));var d=t.SQExprInfo.getAggregate(r)===n.Count;return l&&!d||g.push(n.Count),g.push(n.CountNonNull),g},r.prototype.isSupportedAggregate=function(e,t,r,i){var n=this.getSupportedAggregates(e,t,i);return _.contains(n,r)},r.prototype.createExprWithAggregate=function(e,r,i,n,a){var o;return o=null!=a&&this.isSupportedAggregate(e,r,a,n)?a:e.getDefaultAggregate(r,i),void 0!==o&&(e=t.SQExprBuilder.aggregate(e,o)),e},r}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function a(r,i){var n=e.FieldExprPattern.toFieldExprEntityItemPattern(i),a=i.hierarchyLevel||i.hierarchyLevelAggr;return a?t.getConceptualHierarchyLevel(r,n.schema,n.entity,a.name,a.level):void 0}function o(e,t,r,i,n){var a=e.schema(t),o=a.findHierarchy(r,i);return o?o.levels.withName(n):void 0}function u(t,r){if(t instanceof e.SQHierarchyExpr){var i=t;if(t.arg instanceof e.SQEntityExpr){var n=t.arg;return r.schema(n.schema).findHierarchy(n.entity,i.hierarchy)}if(t.arg instanceof e.SQPropertyVariationSourceExpr){var a=t.arg,o=a.arg;return r.schema(o.schema).findHierarchyByVariation(o.entity,a.property,a.name,i.hierarchy)}}}function s(e,t,a){return r.convert(t,e)||n.expand(t,e)||!a&&i.expand(t,e)||t}function c(t,r){if(r instanceof e.SQHierarchyExpr||r instanceof e.SQHierarchyLevelExpr)return!0;var i=r.getConceptualProperty(t);if(i){var n=i.column;if(n&&n.variations&&n.variations.length>0)return!0}return!1}function l(t){var r=e.SQExprConverter.asFieldPattern(t);if(r.columnHierarchyLevelVariation){var i=e.SQExprBuilder.entity(r.columnHierarchyLevelVariation.source.schema,r.columnHierarchyLevelVariation.source.entity);return e.SQExprBuilder.columnRef(i,r.columnHierarchyLevelVariation.source.name)}}function p(t){var r=e.SQExprConverter.asFieldPattern(t),i=r.hierarchyLevel;if(i){var n=e.SQExprBuilder.entity(i.schema,i.entity,i.entityVar);return e.SQExprBuilder.hierarchy(n,i.name)}}function f(t){if(t.arg instanceof e.SQHierarchyExpr){var r=t.arg;return r.arg instanceof e.SQPropertyVariationSourceExpr?r.arg:void 0}}function v(t,r,i){if(!(r instanceof e.SQHierarchyLevelExpr&&i instanceof e.SQHierarchyLevelExpr))return!1;var n=r,a=i;if(!e.SQExpr.equals(n.arg,a.arg))return!1;var o=e.SQExprUtils.indexOfExpr(t,n),u=e.SQExprUtils.indexOfExpr(t,a);return-1!==o&&-1!==u&&u>o}function h(e,t,r){for(var i=0;i<t.length&&v(e,t[i],r);)i++;return i}t.getConceptualHierarchyLevelFromExpr=a,t.getConceptualHierarchyLevel=o,t.getConceptualHierarchy=u,t.expandExpr=s,t.isHierarchyOrVariation=c,t.getSourceVariationExpr=l,t.getSourceHierarchy=p,t.getHierarchySourceAsVariationSource=f,t.areHierarchyLevelsOrdered=v,t.getInsertionIndex=h}(t=e.SQHierarchyExprUtils||(e.SQHierarchyExprUtils={}));var r;!function(r){function i(r,i){if(r instanceof e.SQHierarchyExpr){var n=r,a=t.getConceptualHierarchy(n,i);if(a)return _.map(a.levels,function(t){return e.SQExprBuilder.hierarchyLevel(r,t.name)})}}r.convert=i}(r=e.SQExprHierarchyToHierarchyLevelConverter||(e.SQExprHierarchyToHierarchyLevelConverter={}));var i;!function(t){function r(t,r){var i=[];if(t instanceof e.SQHierarchyLevelExpr){var n=e.SQExprConverter.asFieldPattern(t);if(n.hierarchyLevel){var a=e.FieldExprPattern.toFieldExprEntityItemPattern(n),o=r.schema(a.schema).findHierarchy(a.entity,n.hierarchyLevel.name);if(o)for(var u=o.levels,s=0,c=u;s<c.length;s++){var l=c[s];if(l.name===n.hierarchyLevel.level){i.push(t);break}i.push(e.SQExprBuilder.hierarchyLevel(e.SQExprBuilder.hierarchy(e.SQExprBuilder.entity(a.schema,a.entity,a.entityVar),o.name),l.name))}}}return _.isEmpty(i)?void 0:i}t.expand=r}(i||(i={}));var n;!function(t){function r(t,r){var i,n=t.getConceptualProperty(r);if(n){var a=n.column;if(a&&a.variations&&a.variations.length>0){var o=a.variations,u=o[0],s=e.SQExprConverter.asFieldPattern(t),c=e.FieldExprPattern.toFieldExprEntityItemPattern(s);if(i=[],u.defaultHierarchy)for(var l=e.SQExprBuilder.hierarchy(e.SQExprBuilder.propertyVariationSource(e.SQExprBuilder.entity(c.schema,c.entity,c.entityVar),u.name,n.name),u.defaultHierarchy.name),p=0,f=u.defaultHierarchy.levels;p<f.length;p++){var v=f[p];i.push(e.SQExprBuilder.hierarchyLevel(l,v.name))}}}return i}t.expand=r}(n||(n={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(t,r){for(var n=[],a=0,o=r.length;o>a;a++){var u=r[a];u instanceof e.SQHierarchyLevelExpr?i(t,n,u,a):n.push({expr:u,children:null,selectQueryIndex:a})}return n}function i(t,r,i,n){var a=!0,o=e.SQHierarchyExprUtils.getSourceVariationExpr(i)||e.SQHierarchyExprUtils.getSourceHierarchy(i),u=_.last(r);if(u&&u.children&&e.SQExpr.equals(u.expr,o)){var s=e.SQHierarchyExprUtils.expandExpr(t,i.arg);if(s instanceof Array){var c=s;a=!e.SQHierarchyExprUtils.areHierarchyLevelsOrdered(c,_.last(u.children),i)}}a?r.push({expr:o,children:[i],selectQueryIndex:n}):u.children.push(i)}t.groupExprs=r}(t=e.SQExprGroupUtils||(e.SQExprGroupUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){return e.integer||e.numeric?t.QueryAggregateFunction.Sum:t.QueryAggregateFunction.Count}function i(e){switch(e){case 6:return t.QueryAggregateFunction.Avg;case 3:return t.QueryAggregateFunction.CountNonNull;case 7:return t.QueryAggregateFunction.Count;case 5:return t.QueryAggregateFunction.Max;case 4:return t.QueryAggregateFunction.Min;case 2:return t.QueryAggregateFunction.Sum;default:return}}var n=jsCommon.StringExtensions,a=function(){function n(e){this._kind=e}return n.equals=function(e,t,r){return U.run(e,t,r)},n.prototype.validate=function(e,t,r){var i=new L(e,t,r);return this.accept(i),i.errors},n.prototype.accept=function(e,t){},Object.defineProperty(n.prototype,"kind",{get:function(){return this._kind},enumerable:!0,configurable:!0}),n.isColumn=function(e){return 1===e.kind},n.isConstant=function(e){return 16===e.kind},n.isEntity=function(e){return 0===e.kind},n.isHierarchy=function(e){return 5===e.kind},n.isHierarchyLevel=function(e){return 6===e.kind},n.isAggregation=function(e){return 3===e.kind},n.isMeasure=function(e){return 2===e.kind},n.isSelectRef=function(e){return 28===e.kind},n.isResourcePackageItem=function(e){return 24===e.kind},n.prototype.getMetadata=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r)return r.column||r.columnAggr||r.measure?this.getMetadataForProperty(r,e):r.hierarchyLevel||r.hierarchyLevelAggr?this.getMetadataForHierarchyLevel(r,e):r.columnHierarchyLevelVariation?this.getMetadataForVariation(r,e):r.percentOfGrandTotal?this.getMetadataForPercentOfGrandTotal():n.getMetadataForEntity(r,e)},n.prototype.getDefaultAggregate=function(e,n){void 0===n&&(n=!1);var a=this.getConceptualProperty(e)||this.getHierarchyLevelConceptualProperty(e);if(a){var o;if(a&&0===a.kind){var u=a.column?a.column.defaultAggregate:null;(a.type.integer||a.type.numeric)&&1!==u&&(o=i(u),void 0===o&&(o=r(a.type))),void 0===o&&n&&(o=t.QueryAggregateFunction.CountNonNull)}return o}},n.prototype.getKeyColumns=function(e){var t=H.getColumnRefSQExpr(e,this);if(t){var r=[],i=this.getPropertyKeys(e);if(i&&i.length>0)for(var n=0,a=i.length;a>n;n++)r.push(O.columnRef(t.source,i[n].name));else r.push(t);return r}},n.prototype.hasGroupOnKeys=function(e){var t=H.getColumnRefSQExpr(e,this);if(t){var r=this.getPropertyKeys(e);if(!r||r.length<1)return!1;if(r.length>1)return!0;var i=O.columnRef(t.source,r[0].name);return!n.equals(i,this)}},n.prototype.getPropertyKeys=function(e){var t=this.getConceptualProperty(e)||this.getHierarchyLevelConceptualProperty(e);if(t)return t.column?t.column.keys:void 0},n.prototype.getConceptualProperty=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(r),n=t.FieldExprPattern.getPropertyName(r);return n?e.schema(i.schema).findProperty(i.entity,n):void 0}},n.prototype.getTargetEntityForVariation=function(e,t){var r=this.getConceptualProperty(e);if(r&&r.column&&!_.isEmpty(r.column.variations))for(var i=r.column.variations,n=0,a=i;n<a.length;n++){var o=a[n];if(o.name===t)return o.navigationProperty.targetEntity.name}},n.prototype.getTargetEntity=function(e){return k.getEntityExpr(e,this)},n.prototype.getHierarchyLevelConceptualProperty=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r){var i=r.hierarchyLevel||r.hierarchyLevelAggr;if(i){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(r),a=e.schema(n.schema).findHierarchy(n.entity,i.name);if(a){var o=a.levels.withName(i.level);if(o)return o.column}}}},n.prototype.getMetadataForVariation=function(e,r){var i=e.columnHierarchyLevelVariation,n=t.FieldExprPattern.toFieldExprEntityItemPattern(e),a=r.schema(n.schema).findProperty(n.entity,i.source.name);if(a&&a.column&&a.column.variations)for(var o=0,u=a.column.variations;o<u.length;o++){var s=u[o];if(s.defaultHierarchy&&s.defaultHierarchy.levels)for(var c=0,l=s.defaultHierarchy.levels;c<l.length;c++){var p=l[c];if(p.name===i.level.level){var f=p.column;return{kind:1===f.kind?1:0,type:f.type,format:f.format,idOnEntityKey:f.column?f.column.idOnEntityKey:!1,defaultAggregate:f.column?f.column.defaultAggregate:null}}}}},n.prototype.getMetadataForHierarchyLevel=function(e,t){var r=this.getHierarchyLevelConceptualProperty(t);if(r)return this.getPropertyMetadata(e,r)},n.prototype.getMetadataForPercentOfGrandTotal=function(){return{kind:1,format:"#,##0.##%",type:e.ValueType.fromExtendedType(e.ExtendedType.Double)}},n.prototype.getPropertyMetadata=function(r,i){var n=i.format,a=i.type,o=r.columnAggr||r.hierarchyLevelAggr;if(o)switch(o.aggregate){case t.QueryAggregateFunction.Count:case t.QueryAggregateFunction.CountNonNull:a=e.ValueType.fromExtendedType(e.ExtendedType.Integer),n=void 0;break;case t.QueryAggregateFunction.Avg:a.integer&&(a=e.ValueType.fromExtendedType(e.ExtendedType.Double))}return{kind:1===i.kind||o&&void 0!==o.aggregate?1:0,type:a,format:n,idOnEntityKey:i.column?i.column.idOnEntityKey:!1,aggregate:o?o.aggregate:void 0,defaultAggregate:i.column?i.column.defaultAggregate:null}},n.prototype.getMetadataForProperty=function(e,t){var r=this.getConceptualProperty(t);if(r)return this.getPropertyMetadata(e,r)},n.getMetadataForEntity=function(r,i){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(r),a=i.schema(n.schema).entities.withName(n.entity);if(a&&r.entityAggr)switch(r.entityAggr.aggregate){case t.QueryAggregateFunction.Count:case t.QueryAggregateFunction.CountNonNull:return{kind:1,type:e.ValueType.fromExtendedType(e.ExtendedType.Integer),format:void 0,idOnEntityKey:!1,aggregate:r.entityAggr.aggregate}}},n}();t.SQExpr=a,t.defaultAggregateForDataType=r,t.defaultAggregateToQueryAggregateFunction=i;var o=function(e){function t(t,r,i){e.call(this,0),this.schema=t,this.entity=r,i&&(this.variable=i)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitEntity(this,t)},t}(a);t.SQEntityExpr=o;var u=function(e){function t(t,r,i){e.call(this,22),this.left=t,this.right=r,this.operator=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitArithmetic(this,t)},t}(a);t.SQArithmeticExpr=u;var s=function(e){function t(t,r){e.call(this,25),this.expression=t,this.scope=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitScopedEval(this,t)},t.prototype.getMetadata=function(e){return this.expression.getMetadata(e)},t}(a);t.SQScopedEvalExpr=s;var c=function(e){function t(t,r,i){e.call(this,t),this.source=r,this.ref=i}return __extends(t,e),t}(a);t.SQPropRefExpr=c;var l=function(e){function t(t,r){e.call(this,1,t,r)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitColumnRef(this,t)},t}(c);t.SQColumnRefExpr=l;var p=function(e){function t(t,r){e.call(this,2,t,r)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitMeasureRef(this,t)},t}(c);t.SQMeasureRefExpr=p;var f=function(e){function t(t,r){e.call(this,3),this.arg=t,this.func=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAggr(this,t)},t}(a);t.SQAggregationExpr=f;var v=function(e){function t(t,r,i){e.call(this,27),this.arg=t,this.k=r,this.exclusive=i}return __extends(t,e),t.prototype.getMetadata=function(e){var t=this.arg.getMetadata(e);return t?{kind:1,type:t.type}:void 0},t.prototype.accept=function(e,t){return e.visitPercentile(this,t)},t}(a);t.SQPercentileExpr=v;var h=function(e){function t(t,r,i){e.call(this,4),this.arg=t,this.name=r,this.property=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitPropertyVariationSource(this,t)},t}(a);t.SQPropertyVariationSourceExpr=h;var g=function(e){function t(t,r){e.call(this,5),this.arg=t,this.hierarchy=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitHierarchy(this,t)},t}(a);t.SQHierarchyExpr=g;var d=function(e){function t(t,r){e.call(this,6),this.arg=t,this.level=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitHierarchyLevel(this,t)},t}(a);t.SQHierarchyLevelExpr=d;var y=function(e){function t(t){e.call(this,28),this.expressionName=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitSelectRef(this,t)},t}(a);t.SQSelectRefExpr=y;var m=function(e){function t(t,r){e.call(this,7),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAnd(this,t)},t}(a);t.SQAndExpr=m;var x=function(e){function t(t,r,i){e.call(this,8),this.arg=t,this.lower=r,this.upper=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitBetween(this,t)},t}(a);t.SQBetweenExpr=x;var S=function(e){function t(t,r){e.call(this,9),this.args=t,this.values=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitIn(this,t)},t}(a);t.SQInExpr=S;var E=function(e){function t(t,r){e.call(this,10),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitOr(this,t)},t}(a);t.SQOrExpr=E;var w=function(e){function t(t,r,i){e.call(this,12),this.comparison=t,this.left=r,this.right=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitCompare(this,t)},t}(a);t.SQCompareExpr=w;var b=function(e){function t(t,r){e.call(this,11),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitContains(this,t)},t}(a);t.SQContainsExpr=b;var D=function(e){function t(t,r){e.call(this,13),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitStartsWith(this,t)},t}(a);t.SQStartsWithExpr=D;var C=function(e){function t(t){e.call(this,14),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitExists(this,t)},t}(a);t.SQExistsExpr=C;var T=function(e){function t(t){e.call(this,15),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNot(this,t)},t}(a);t.SQNotExpr=T;var V=function(e){function t(t,r,i){e.call(this,16),this.type=t,this.value=r,this.valueEncoded=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitConstant(this,t)},t.prototype.getMetadata=function(e){return{kind:1,type:this.type}},t}(a);t.SQConstantExpr=V;var F=function(e){function t(t,r){e.call(this,17),this.unit=t,this.arg=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateSpan(this,t)},t}(a);t.SQDateSpanExpr=F;var P=function(e){function t(t,r,i){e.call(this,18),this.unit=t,this.arg=i,this.amount=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateAdd(this,t)},t}(a);t.SQDateAddExpr=P;var M=function(e){function t(){e.call(this,19)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNow(this,t)},t}(a);t.SQNowExpr=M;var R=function(e){function t(){e.call(this,21)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDefaultValue(this,t)},t}(a);t.SQDefaultValueExpr=R;var A=function(e){function t(){e.call(this,20)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAnyValue(this,t)},t}(a);t.SQAnyValueExpr=A;var N=function(e){function t(t,r){e.call(this,23),this.input=t,this.rule=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitFillRule(this,t)},t}(a);t.SQFillRuleExpr=N;var I=function(e){function t(t,r,i){e.call(this,24),this.packageName=t,this.packageType=r,this.itemName=i}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitResourcePackageItem(this,t)},t}(a);t.SQResourcePackageItemExpr=I;var O;!function(r){function i(e,t,r){return new o(e,t,r)}function n(e,t){return new l(e,t)}function c(e,t){return new p(e,t)}function O(e,t){return new f(e,t)}function Q(e){return new y(e)}function U(e,t,r){return new v(e,t,r)}function j(e,t,r){return new u(e,t,r)}function L(e,t){return new s(e,t)}function q(e,t){return new g(e,t)}function H(e,t,r){return new h(e,t,r)}function k(e,t){return new d(e,t)}function B(e,t){return e?t?new m(e,t):e:t}function Y(e,t,r){return new x(e,t,r)}function Z(e,t){return new S(e,t)}function J(e,t){if(!e)return t;if(!t)return e;if(e instanceof S&&t instanceof S){var r=$(e,t);if(r)return r}return new E(e,t)}function $(e,t){if(e.args&&t.args){var i=e.args.length,n=t.args.length;if(i===n){for(var o=0;i>o;++o)if(!a.equals(e.args[o],t.args[o]))return;var u=e.values.concat(t.values);return r.inExpr(e.args,u)}}}function ee(e,t,r){return new w(e,t,r)}function te(e,t){return new b(e,t)}function re(e){return new C(e)}function ie(e,r){return ee(t.QueryComparisonKind.Equal,e,r)}function ne(e){return new T(e)}function ae(e,t){return new D(e,t)}function oe(){return new V(e.ValueType.fromExtendedType(e.ExtendedType.Null),null,t.PrimitiveValueEncoding.nullEncoding())}function ue(){return new M}function se(){return new R}function ce(){return new A}function le(r){return new V(e.ValueType.fromExtendedType(e.ExtendedType.Boolean),r,t.PrimitiveValueEncoding["boolean"](r))}function pe(e,t,r){return new P(e,t,r)}function fe(r,i){return void 0===i&&(i=t.PrimitiveValueEncoding.dateTime(r)),new V(e.ValueType.fromExtendedType(e.ExtendedType.DateTime),r,i);
}function ve(e,t){return new F(e,t)}function he(r,i){return void 0===i&&(i=t.PrimitiveValueEncoding.decimal(r)),new V(e.ValueType.fromExtendedType(e.ExtendedType.Decimal),r,i)}function ge(r,i){return void 0===i&&(i=t.PrimitiveValueEncoding["double"](r)),new V(e.ValueType.fromExtendedType(e.ExtendedType.Double),r,i)}function de(r,i){return void 0===i&&(i=t.PrimitiveValueEncoding.integer(r)),new V(e.ValueType.fromExtendedType(e.ExtendedType.Integer),r,i)}function ye(r,i){return new V(e.ValueType.fromExtendedType(e.ExtendedType.Text),r,i||t.PrimitiveValueEncoding.text(r))}function me(t,r){return null==t?oe():_.isBoolean(t)?le(t):_.isString(t)?ye(t):_.isNumber(t)?r.integer&&e.Double.isInteger(t)?de(t):ge(t):t instanceof Date?fe(t):void 0}function xe(e,t){return G.rewrite(e,t)}function Se(e){return W.rewrite(e)}function Ee(e){return X.rewrite(e)}function we(e){return z.rewrite(e)}function be(e){return K.rewrite(e)}function De(e,t){return new N(e,t)}function Ce(e,t,r){return new I(e,t,r)}r.entity=i,r.columnRef=n,r.measureRef=c,r.aggregate=O,r.selectRef=Q,r.percentile=U,r.arithmetic=j,r.scopedEval=L,r.hierarchy=q,r.propertyVariationSource=H,r.hierarchyLevel=k,r.and=B,r.between=Y,r.inExpr=Z,r.or=J,r.compare=ee,r.contains=te,r.exists=re,r.equal=ie,r.not=ne,r.startsWith=ae,r.nullConstant=oe,r.now=ue,r.defaultValue=se,r.anyValue=ce,r["boolean"]=le,r.dateAdd=pe,r.dateTime=fe,r.dateSpan=ve,r.decimal=he,r["double"]=ge,r.integer=de,r.text=ye,r.typedConstant=me,r.setAggregate=xe,r.removeAggregate=Se,r.setPercentOfGrandTotal=Ee,r.removePercentOfGrandTotal=we,r.removeEntityVariables=be,r.fillRule=De,r.resourcePackageItem=Ce}(O=t.SQExprBuilder||(t.SQExprBuilder={}));var Q;!function(e){function t(e){return q.getAggregate(e)}e.getAggregate=t}(Q=t.SQExprInfo||(t.SQExprInfo={}));var U=function(){function e(e){this.ignoreCase=e}return e.run=function(t,r,i){return t=t||null,r=r||null,t===r?!0:!t!=!r?!1:i?t.accept(e.ignoreCaseInstance,r):t.accept(e.instance,r)},e.prototype.visitColumnRef=function(e,t){return t instanceof l&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitMeasureRef=function(e,t){return t instanceof p&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitAggr=function(e,t){return t instanceof f&&e.func===t.func&&this.equals(e.arg,t.arg)},e.prototype.visitPercentile=function(e,t){return t instanceof v&&e.exclusive===t.exclusive&&e.k===t.k&&this.equals(e.arg,t.arg)},e.prototype.visitHierarchy=function(e,t){return t instanceof g&&e.hierarchy===t.hierarchy&&this.equals(e.arg,t.arg)},e.prototype.visitHierarchyLevel=function(e,t){return t instanceof d&&e.level===t.level&&this.equals(e.arg,t.arg)},e.prototype.visitPropertyVariationSource=function(e,t){return t instanceof h&&e.name===t.name&&e.property===t.property&&this.equals(e.arg,t.arg)},e.prototype.visitSelectRef=function(e,t){return t instanceof y&&e.expressionName===t.expressionName},e.prototype.visitBetween=function(e,t){return t instanceof x&&this.equals(e.arg,t.arg)&&this.equals(e.lower,t.lower)&&this.equals(e.upper,t.upper)},e.prototype.visitIn=function(e,t){if(!(t instanceof S&&this.equalsAll(e.args,t.args)))return!1;var r=e.values,i=t.values;if(r.length!==i.length)return!1;for(var n=0,a=r.length;a>n;n++)if(!this.equalsAll(r[n],i[n]))return!1;return!0},e.prototype.visitEntity=function(e,t){return t instanceof o&&e.schema===t.schema&&e.entity===t.entity&&this.optionalEqual(e.variable,t.variable)},e.prototype.visitAnd=function(e,t){return t instanceof m&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitOr=function(e,t){return t instanceof E&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitCompare=function(e,t){return t instanceof w&&e.comparison===t.comparison&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitContains=function(e,t){return t instanceof b&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitDateSpan=function(e,t){return t instanceof F&&e.unit===t.unit&&this.equals(e.arg,t.arg)},e.prototype.visitDateAdd=function(e,t){return t instanceof P&&e.unit===t.unit&&e.amount===t.amount&&this.equals(e.arg,t.arg)},e.prototype.visitExists=function(e,t){return t instanceof C&&this.equals(e.arg,t.arg)},e.prototype.visitNot=function(e,t){return t instanceof T&&this.equals(e.arg,t.arg)},e.prototype.visitNow=function(e,t){return t instanceof M},e.prototype.visitDefaultValue=function(e,t){return t instanceof R},e.prototype.visitAnyValue=function(e,t){return t instanceof A},e.prototype.visitResourcePackageItem=function(e,t){return t instanceof I&&e.packageName===t.packageName&&e.packageType===t.packageType&&e.itemName===t.itemName},e.prototype.visitStartsWith=function(e,t){return t instanceof D&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitConstant=function(e,t){return t instanceof V&&e.type===t.type?e.type.text&&this.ignoreCase?n.equalIgnoreCase(e.valueEncoded,t.valueEncoded):e.valueEncoded===t.valueEncoded:!1},e.prototype.visitFillRule=function(e,t){if(t instanceof N&&this.equals(e.input,t.input)){var r=e.rule,i=t.rule;if(r===i)return!0;var n=r.linearGradient2,a=i.linearGradient2;if(n&&a)return this.visitLinearGradient2(n,a);var o=r.linearGradient3,u=i.linearGradient3;if(o&&u)return this.visitLinearGradient3(o,u)}return!1},e.prototype.visitLinearGradient2=function(e,t){return this.equalsFillRuleStop(e.min,t.min)&&this.equalsFillRuleStop(e.max,t.max)},e.prototype.visitLinearGradient3=function(e,t){return this.equalsFillRuleStop(e.min,t.min)&&this.equalsFillRuleStop(e.mid,t.mid)&&this.equalsFillRuleStop(e.max,t.max)},e.prototype.equalsFillRuleStop=function(e,t){return this.equals(e.color,t.color)?e.value?this.equals(e.value,t.value):e.value===t.value:!1},e.prototype.visitArithmetic=function(e,t){return t instanceof u&&e.operator===t.operator&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitScopedEval=function(e,t){return t instanceof s&&this.equals(e.expression,t.expression)&&this.equalsAll(e.scope,t.scope)},e.prototype.optionalEqual=function(e,t){return e&&t?e===t:!0},e.prototype.equals=function(e,t){return e.accept(this,t)},e.prototype.equalsAll=function(e,t){var r=e.length;if(r!==t.length)return!1;for(var i=0;r>i;i++)if(!this.equals(e[i],t[i]))return!1;return!0},e.instance=new e(!1),e.ignoreCaseInstance=new e(!0),e}(),j=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitDefault=function(e){return e},t}(t.DefaultSQExprVisitor),L=function(e){function r(t,r,i){e.call(this),this.schema=t,this.aggrUtils=r,i&&(this.errors=i)}return __extends(r,e),r.prototype.visitIn=function(t){for(var r=e.prototype.visitIn.call(this,t),i=r.args,n=r.values,a=0,o=n;a<o.length;a++)for(var u=o[a],s=0,c=u.length;c>s;++s)this.validateCompatibleType(i[s],u[s]);return r},r.prototype.visitCompare=function(t){var r=e.prototype.visitCompare.call(this,t);return this.validateCompatibleType(r.left,r.right),r},r.prototype.visitColumnRef=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(r),n=this.validateEntity(i.schema,i.entity);if(n){var a=n.properties.withName(r.column.name);a&&0===a.kind&&this.isQueryable(r)||this.register(3)}}return e},r.prototype.visitMeasureRef=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(r),n=this.validateEntity(i.schema,i.entity);if(n){var a=n.properties.withName(r.measure.name);a&&1===a.kind&&this.isQueryable(r)||this.register(4)}}return e},r.prototype.visitAggr=function(t){var r=e.prototype.visitAggr.call(this,t),i=H.getColumnRefSQExpr(this.schema,r.arg);return i&&(this.aggrUtils.isSupportedAggregate(t,this.schema,t.func,null)||this.register(0)),r},r.prototype.visitHierarchy=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var i=r.hierarchy;i?this.validateHierarchy(i.schema,i.entity,i.name):this.register(5)}return e},r.prototype.visitHierarchyLevel=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var i=r.hierarchyLevel;i?this.validateHierarchyLevel(i.schema,i.entity,i.name,i.level):r.columnHierarchyLevelVariation||this.register(6)}return e},r.prototype.visitPercentile=function(e){if(e.arg.accept(this),_.isEmpty(this.errors)){var t=e.arg.getMetadata(this.schema);t&&0===t.kind&&t.type&&(t.type.integer||t.type.numeric)||this.register(10)}return e},r.prototype.visitEntity=function(e){return this.validateEntity(e.schema,e.entity),e},r.prototype.visitContains=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},r.prototype.visitStartsWith=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},r.prototype.visitArithmetic=function(e){return this.validateArithmeticTypes(e.left,e.right),e},r.prototype.visitScopedEval=function(e){return e},r.prototype.validateOperandsAndTypeForStartOrContains=function(e,t){e instanceof l?this.visitColumnRef(e):e instanceof d?this.visitHierarchyLevel(e):this.register(7),t instanceof V&&t.type.text?this.validateCompatibleType(e,t):this.register(8)},r.prototype.validateArithmeticTypes=function(e,r){t.SQExprUtils.supportsArithmetic(e,this.schema)||this.register(7),t.SQExprUtils.supportsArithmetic(r,this.schema)||this.register(8)},r.prototype.validateCompatibleType=function(e,t){var r=e.getMetadata(this.schema),i=r&&r.type,n=t.getMetadata(this.schema),a=n&&n.type;i&&a&&!i.isCompatibleFrom(a)&&this.register(9)},r.prototype.validateEntity=function(e,t){var r=this.schema.schema(e);if(r){var i=r.entities.withName(t);if(i)return i;this.register(2)}else this.register(1)},r.prototype.validateHierarchy=function(e,t,r){var i=this.validateEntity(e,t);if(i){var n=i.hierarchies.withName(r);if(n)return n;this.register(5)}},r.prototype.validateHierarchyLevel=function(e,t,r,i){var n=this.validateHierarchy(e,t,r);if(n){var a=n.levels.withName(i);if(a)return a;this.register(6)}},r.prototype.register=function(e){this.errors||(this.errors=[]),this.errors.push(e)},r.prototype.isQueryable=function(e){var r=t.FieldExprPattern.toFieldExprEntityItemPattern(e);if(e.hierarchyLevel||e.hierarchyLevelAggr){var i=t.SQHierarchyExprUtils.getConceptualHierarchyLevelFromExpr(this.schema,e);return i&&1!==i.column.queryable}return 1!==this.schema.schema(r.schema).findProperty(r.entity,t.FieldExprPattern.getPropertyName(e)).queryable},r}(t.SQExprRewriter);t.SQExprValidationVisitor=L;var q=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func},t.prototype.visitDefault=function(e){},t.getAggregate=function(e){var r=new t;return e.accept(r)},t}(t.DefaultSQExprVisitor),H=function(e){function r(t){e.call(this),this.schema=t}return __extends(r,e),r.prototype.visitColumnRef=function(e){return e},r.prototype.visitHierarchyLevel=function(e){var r=e.level,i=e.arg,n=i.accept(this);if(i&&i.arg instanceof h){var a=i.arg,o=n.getTargetEntityForVariation(this.schema,a.name);if(n&&o){var u=n.source.schema,s=O.entity(u,o),c=this.schema.schema(u).findHierarchy(o,i.hierarchy);if(c)for(var p=0,f=c.levels;p<f.length;p++){var v=f[p];if(v.name===r)return new l(s,v.column.name)}}}else{var g=i.arg,d=t.SQHierarchyExprUtils.getConceptualHierarchyLevel(this.schema,g.schema,g.entity,i.hierarchy,e.level);if(d)return new l(i.arg,d.column.name)}},r.prototype.visitHierarchy=function(e){return e.arg.accept(this)},r.prototype.visitPropertyVariationSource=function(e){var t=e.property;return new l(e.arg,t)},r.prototype.visitAggr=function(e){return e.arg.accept(this)},r.prototype.visitDefault=function(e){},r.getColumnRefSQExpr=function(e,t){var i=new r(e);return t.accept(i)},r}(t.DefaultSQExprVisitor),k=function(e){function r(t){e.call(this),this.schema=t}return __extends(r,e),r.prototype.visitEntity=function(e){return e},r.prototype.visitColumnRef=function(e){return r.getEntity(e)},r.prototype.visitHierarchyLevel=function(e){var t=r.getColumnRefSQExpr(this.schema,e);return r.getEntity(t)},r.prototype.visitHierarchy=function(e){return e.arg.accept(this)},r.prototype.visitPropertyVariationSource=function(e){var t=r.getColumnRefSQExpr(this.schema,e);return r.getEntity(t)},r.prototype.visitAggr=function(e){var t=r.getColumnRefSQExpr(this.schema,e);return r.getEntity(t)},r.prototype.visitMeasureRef=function(e){return e.source.accept(this)},r.getColumnRefSQExpr=function(e,t){var r=new H(e);return t.accept(r)},r.getEntity=function(e){var r=t.SQExprConverter.asFieldPattern(e),i=r.column;return O.entity(i.schema,i.entity,i.entityVar)},r.getEntityExpr=function(e,t){var i=new r(e);return t.accept(i)},r}(t.DefaultSQExprVisitor),B=function(e){function t(t){e.call(this),this.func=t}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func===this.func?e:new f(e.arg,this.func)},t.prototype.visitColumnRef=function(e){return new f(e,this.func)},t.rewrite=function(e,r){var i=new t(r);return e.accept(i)},t}(j),G=function(){function e(e,t){this.sqExpr=e,this.aggregate=t}return e.rewrite=function(r,i){return t.FieldExprPattern.visit(r,new e(r,i))},e.prototype.visitPercentOfGrandTotal=function(e){return e.baseExpr=t.SQExprConverter.asFieldPattern(B.rewrite(O.fieldExpr(e.baseExpr),this.aggregate)),O.fieldExpr({percentOfGrandTotal:e})},e.prototype.visitColumn=function(e){return this.defaultRewrite()},e.prototype.visitColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitColumnHierarchyLevelVariation=function(e){return this.defaultRewrite()},e.prototype.visitSelectRef=function(e){return this.defaultRewrite()},e.prototype.visitEntity=function(e){return this.defaultRewrite()},e.prototype.visitEntityAggr=function(e){return this.defaultRewrite()},e.prototype.visitHierarchy=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevel=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevelAggr=function(e){return this.defaultRewrite()},e.prototype.visitMeasure=function(e){return this.defaultRewrite()},e.prototype.visitPercentile=function(e){return this.defaultRewrite()},e.prototype.defaultRewrite=function(){return B.rewrite(this.sqExpr,this.aggregate)},e}(),W=function(){function e(e){this.sqExpr=e}return e.rewrite=function(r){return t.FieldExprPattern.visit(r,new e(r))},e.prototype.visitPercentOfGrandTotal=function(t){return e.rewrite(O.fieldExpr(t.baseExpr))},e.prototype.visitColumn=function(e){return this.defaultRewrite()},e.prototype.visitColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitColumnHierarchyLevelVariation=function(e){return this.defaultRewrite()},e.prototype.visitSelectRef=function(e){return this.defaultRewrite()},e.prototype.visitEntity=function(e){return this.defaultRewrite()},e.prototype.visitEntityAggr=function(e){return this.defaultRewrite()},e.prototype.visitHierarchy=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevel=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevelAggr=function(e){return this.defaultRewrite()},e.prototype.visitMeasure=function(e){return this.defaultRewrite()},e.prototype.visitPercentile=function(e){return this.defaultRewrite()},e.prototype.defaultRewrite=function(){return Y.rewrite(this.sqExpr)},e}(),Y=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.arg},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(j),K=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitEntity=function(e){return e.variable?O.entity(e.schema,e.entity):e},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(t.SQExprRewriter),z=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.rewrite=function(e){return e.accept(r.instance)},r.prototype.visitDefault=function(e){var r=t.SQExprConverter.asFieldPattern(e);return r&&r.percentOfGrandTotal&&(e=O.fieldExpr(r.percentOfGrandTotal.baseExpr)),e},r.instance=new r,r}(j),X=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.rewrite=function(e){return e.accept(r.instance)},r.prototype.visitDefault=function(e){var r=t.SQExprConverter.asFieldPattern(e);return r&&!r.percentOfGrandTotal&&(e=O.fieldExpr({percentOfGrandTotal:{baseExpr:t.SQExprConverter.asFieldPattern(e)}})),e},r.instance=new r,r}(j)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,i=jsCommon.ArrayExtensions,n=jsCommon.StringExtensions;!function(r){function a(e,t){var r=e.getMetadata(t),i=r&&r.type;return r&&i?i.numeric||i.dateTime||i.duration:!1}function o(e,r){for(var i=0,n=e.length;n>i;i++)if(t.SQExpr.equals(e[i],r))return i;return-1}function u(e,r){var i=e.length;if(i!==r.length)return!1;for(var n=0;i>n;n++)if(!t.SQExpr.equals(e[n],r[n]))return!1;return!0}function s(e,t,r){for(var i={},a=0,o=e.length;o>a;a++)i[e[a].name]=!0;return n.findUniqueName(i,r||c(t))}function c(e,t){return void 0===t&&(t="select"),e?e.accept(R.instance,t):t}function l(e){return e.accept(A.instance)}function p(e){return e.accept(I.instance)}function f(e){return e.accept(N.instance)}function v(e,t){var r=g(e,t);return r&&r.discourageQueryAggregateUsage}function h(e,t){var r=E(e,t);return r?r.aggregateBehavior:void 0}function g(e,r){var i=t.SQExprConverter.asFieldPattern(e);if(i){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(i),a=r.schema(n.schema);return a?a.capabilities:void 0}}function d(e,t){var r=m(e,t);if(r)return r.kpiValue.measure.kpi.statusMetadata;var i=x(e,t);return i?i.kpiValue.measure.kpi.trendMetadata:void 0}function y(e,t){var r=t.schema(e.schema).entities.withName(e.entity);return r}function m(e,t){var r=e.getConceptualProperty(t);if(r){var i=r.kpiValue;return i&&i.measure.kpi.status===r?r:void 0}}function x(e,t){var r=e.getConceptualProperty(t);if(r){var i=r.kpiValue;return i&&i.measure.kpi.trend===r?r:void 0}}function S(e,t){var r=E(e,t);return r?r.defaultValue:void 0}function E(e,r){if(e&&r){var i=t.SQExprConverter.asFieldPattern(e);if(i){var n=i.column;if(n){if(r.schema(n.schema)&&i.column.name){var a=r.schema(n.schema).findProperty(n.entity,i.column.name);if(a)return a.column}}else{var o=i.hierarchyLevel;if(o){var u=t.FieldExprPattern.toFieldExprEntityItemPattern(i),s=u.schema;if(r.schema(s)){var c=r.schema(s).findHierarchy(u.entity,o.name);if(c){var l=c.levels.withName(o.level);if(l&&l.column)return l.column.column}}}}}}}function w(e,t){if(!_.isEmpty(e)&&t){for(var r=[],i=0,n=e;i<n.length;i++){var a=n[i],o=S(a,t);o&&r.push(o)}return r}}function b(e,r){for(var i=[],n=0;n<e.length;n++)i.push(t.SQExprBuilder.compare(t.QueryComparisonKind.Equal,e[n],r[n]));if(!_.isEmpty(i)){for(var a,o=0,u=i;o<u.length;o++){var s=u[o];a=t.SQExprBuilder.and(a,s)}return a}}function D(e){var t=[];if(e){var r=e.from();if(void 0!==r)for(var i=0,n=r.keys();i<n.length;i++){var a=n[i],o=r.entity(a);t.indexOf(o.entity)<0&&t.push(o.entity)}}return t}function C(e,t,r){return V(e,t,r,0,2)||V(e,r,t,2,0)}function T(e,t,r){return V(e,t,r,2,0)||V(e,r,t,0,2)}function V(e,t,i,n,a){var o=r.getConceptualEntity(t,e);if(_.isEmpty(o.navigationProperties))return!1;var u=r.getConceptualEntity(i,e),s=[];for(s.push(o);!_.isEmpty(s);){var c=s.shift(),l=c.navigationProperties;if(!_.isEmpty(l))for(var p=0,f=l;p<f.length;p++){var v=f[p];if(v.isActive&&v.targetMultiplicity===a&&v.sourceMultiplicity===n){if(v.targetEntity===u)return!0;s.push(v.targetEntity)}}}return!1}function F(e,t,i){var n=r.getConceptualEntity(t,e),a=r.getConceptualEntity(i,e),o=n.navigationProperties,u=a.navigationProperties;return _.isEmpty(o)&&_.isEmpty(u)?!1:P(o,a)||P(u,n)}function P(e,t){if(_.isEmpty(e))return!1;for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.isActive&&n.targetEntity===t&&0===n.sourceMultiplicity&&0===n.targetMultiplicity)return!0}return!1}function M(e,t){for(var r=i.copy(e),n=0,a=t;n<a.length;n++){var u=a[n];-1===o(r,u)&&r.push(u)}return r}r.supportsArithmetic=a,r.indexOfExpr=o,r.sequenceEqual=u,r.uniqueName=s,r.defaultName=c,r.isMeasure=l,r.isAnyValue=p,r.isDefaultValue=f,r.discourageAggregation=v,r.getAggregateBehavior=h,r.getSchemaCapabilities=g,r.getKpiMetadata=d,r.getConceptualEntity=y,r.getDefaultValue=S,r.getDefaultValues=w,r.getDataViewScopeIdentityComparisonExpr=b,r.getActiveTablesNames=D,r.isRelatedToMany=C,r.isRelatedToOne=T,r.isRelatedOneToOne=F,r.concatUnique=M;var R=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype.visitEntity=function(e){return e.entity},i.prototype.visitColumnRef=function(e){return e.source.accept(this)+"."+e.ref},i.prototype.visitMeasureRef=function(e,t){return e.source.accept(this)+"."+e.ref},i.prototype.visitAggr=function(e,r){return t.QueryAggregateFunction[e.func]+"("+e.arg.accept(this)+")"},i.prototype.visitPercentile=function(e,t){var r=e.exclusive?"Percentile.Exc(":"Percentile.Inc(";return r+e.arg.accept(this)+", "+e.k+")"},i.prototype.visitArithmetic=function(t,r){return e.data.getArithmeticOperatorName(t.operator)+"("+t.left.accept(this)+", "+t.right.accept(this)+")"},i.prototype.visitConstant=function(e){return"const"},i.prototype.visitDefault=function(e,t){return t||"expr"},i.instance=new i,i}(t.DefaultSQExprVisitorWithArg),A=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitMeasureRef=function(e){return!0},t.prototype.visitAggr=function(e){return!0},t.prototype.visitArithmetic=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t}(t.DefaultSQExprVisitor),N=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype.visitCompare=function(e){return e.comparison!==t.QueryComparisonKind.Equal?!1:e.right.accept(this)},r.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},r.prototype.visitDefaultValue=function(e){return!0},r.prototype.visitDefault=function(e){return!1},r.instance=new r,r}(t.DefaultSQExprVisitor),I=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype.visitCompare=function(e){return e.comparison!==t.QueryComparisonKind.Equal?!1:e.right.accept(this)},r.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},r.prototype.visitAnyValue=function(e){return!0},r.prototype.visitDefault=function(e){return!1},r.instance=new r,r}(t.DefaultSQExprVisitor)}(r=t.SQExprUtils||(t.SQExprUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(e){this.exprRewriter=e}return t.prototype.rewriteFrom=function(t){for(var r={},i=t,n=i.keys(),a=0,o=n.length;o>a;a++){var u=n[a],s=i.entity(u),c=e.SQExprBuilder.entity(s.schema,s.entity,u),l=c.accept(this.exprRewriter);r[u]={schema:l.schema,entity:l.entity}}return new e.SQFrom(r)},t.prototype.rewriteSelect=function(e,t){return this.rewriteNamedSQExpressions(e,t)},t.prototype.rewriteGroupBy=function(e,t){return _.isEmpty(e)?void 0:this.rewriteNamedSQExpressions(e,t)},t.prototype.rewriteNamedSQExpressions=function(t,r){var i=this;return _.map(t,function(t){return{name:t.name,expr:e.SQExprRewriterWithSourceRenames.rewrite(t.expr.accept(i.exprRewriter),r)}})},t.prototype.rewriteOrderBy=function(t,r){if(!_.isEmpty(t)){for(var i=[],n=0,a=t.length;a>n;n++){var o=t[n],u=e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),r);i.push({direction:o.direction,expr:u})}return i}},t.prototype.rewriteWhere=function(t,r){var i=this;if(!_.isEmpty(t)){for(var n=[],a=0,o=t.length;o>a;a++){var u=t[a],s={condition:e.SQExprRewriterWithSourceRenames.rewrite(u.condition.accept(this.exprRewriter),r)};u.target&&(s.target=_.map(u.target,function(t){return e.SQExprRewriterWithSourceRenames.rewrite(t.accept(i.exprRewriter),r)})),n.push(s)}return n}},t}();e.SemanticQueryRewriter=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,r=function(){function r(e,t,r,i,n){this.fromValue=e,this.whereItems=t,this.orderByItems=r,this.selectItems=i,this.groupByItems=n}return r.create=function(){return r.empty||(r.empty=new r(new n,null,null,[],null)),r.empty},r.createWithTrimmedFrom=function(e,t,i,n,a){var o=new u(e.keys());if(t)for(var s=0,c=t.length;c>s;s++){var l=t[s];l.condition.accept(o);var p=l.target;if(p)for(var f=0,v=p.length;v>f;f++)p[f]&&p[f].accept(o)}if(i)for(var s=0,c=i.length;c>s;s++)i[s].expr.accept(o);for(var s=0,c=n.length;c>s;s++)n[s].expr.accept(o);if(a)for(var s=0,c=a.length;c>s;s++)a[s].expr.accept(o);for(var h=o.result(),s=0,c=h.length;c>s;s++)e.remove(h[s]);return new r(e,t,i,n,a)},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.select=function(e){return _.isEmpty(arguments)?this.getSelect():this.setSelect(e)},r.prototype.getSelect=function(){return r.createNamedExpressionArray(this.selectItems)},r.createNamedExpressionArray=function(e){return t.extendWithName(_.map(e,function(e){return{name:e.name,expr:e.expr}}))},r.prototype.setSelect=function(e){var t=this.fromValue.clone(),i=r.rewriteExpressionsWithSourceRenames(e,t);return r.createWithTrimmedFrom(t,this.whereItems,this.orderByItems,i,this.groupByItems)},r.rewriteExpressionsWithSourceRenames=function(e,t){for(var r=[],i=0,n=e.length;n>i;i++){var o=e[i];r.push({name:o.name,expr:a.rewrite(o.expr,t)})}return r},r.prototype.removeSelect=function(t){for(var i=this.selectItems,n=[],a=0,o=i.length;o>a;a++){var u=i[a];e.SQExpr.equals(u.expr,t)||n.push(u)}return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,this.orderByItems,n,this.groupByItems)},r.prototype.removeOrderBy=function(t){for(var i=this.orderBy(),n=i.length-1;n>=0;n--)e.SQExpr.equals(i[n].expr,t)&&i.splice(n,1);return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,i,this.selectItems,this.groupByItems)},r.prototype.selectNameOf=function(t){var r=e.SQExprUtils.indexOfExpr(_.map(this.selectItems,function(e){return e.expr}),t);return r>=0?this.selectItems[r].name:void 0},r.prototype.setSelectAt=function(e,t){if(!(e>=this.selectItems.length)){var i=this.select(),n=this.fromValue.clone(),o=i[e].name;return i[e]={name:o,expr:a.rewrite(t,n)},r.createWithTrimmedFrom(n,this.whereItems,this.orderByItems,i,this.groupByItems)}},r.prototype.addSelect=function(e,t){var i=this.select(),n=this.fromValue.clone();return i.push(this.createNamedExpr(i,n,e,t)),r.createWithTrimmedFrom(n,this.whereItems,this.orderByItems,i,this.groupByItems)},r.prototype.createNamedExpr=function(t,r,i,n){return{name:e.SQExprUtils.uniqueName(t,i,n),expr:a.rewrite(i,r)}},r.prototype.groupBy=function(e){return _.isEmpty(arguments)?this.getGroupBy():this.setGroupBy(e)},r.prototype.getGroupBy=function(){return r.createNamedExpressionArray(this.groupByItems)},r.prototype.setGroupBy=function(e){var t=this.fromValue.clone(),i=r.rewriteExpressionsWithSourceRenames(e,t);return r.createWithTrimmedFrom(t,this.whereItems,this.orderByItems,this.selectItems,i)},r.prototype.addGroupBy=function(e){var t=this.groupBy(),i=this.fromValue.clone();return t.push(this.createNamedExpr(t,i,e)),r.createWithTrimmedFrom(i,this.whereItems,this.orderByItems,this.selectItems,t)},r.prototype.orderBy=function(e){return _.isEmpty(arguments)?this.getOrderBy():this.setOrderBy(e)},r.prototype.getOrderBy=function(){var e=[],t=this.orderByItems;if(t)for(var r=0,i=t.length;i>r;r++){var n=t[r];e.push({expr:n.expr,direction:n.direction})}return e},r.prototype.setOrderBy=function(e){for(var t=[],i=this.fromValue.clone(),n=0,o=e.length;o>n;n++){var u=e[n];t.push({expr:a.rewrite(u.expr,i),direction:u.direction})}return r.createWithTrimmedFrom(i,this.whereItems,t,this.selectItems,this.groupByItems)},r.prototype.where=function(e){return _.isEmpty(arguments)?this.getWhere():this.setWhere(e)},r.prototype.getWhere=function(){var e=[],t=this.whereItems;if(t)for(var r=0,i=t.length;i>r;r++)e.push(t[r]);return e},r.prototype.setWhere=function(e){for(var t=[],i=this.fromValue.clone(),n=0,o=e.length;o>n;n++){var u=e[n],s={condition:a.rewrite(u.condition,i)},c=u.target;if(c){s.target=[];for(var l=0,p=c.length;p>l;l++)if(c[l]){var f=a.rewrite(c[l],i);s.target.push(f)}}t.push(s)}return r.createWithTrimmedFrom(i,t,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.addWhere=function(e){for(var t=this.where(),i=e.where(),n=this.fromValue.clone(),o=0,u=i.length;u>o;o++){var s=i[o],c={condition:a.rewrite(s.condition,n)};s.target&&(c.target=_.map(s.target,function(e){return a.rewrite(e,n)})),t.push(c)}return r.createWithTrimmedFrom(n,t,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.rewrite=function(t){var i=new e.SemanticQueryRewriter(t),n=i.rewriteFrom(this.fromValue),a=i.rewriteWhere(this.whereItems,n),o=i.rewriteOrderBy(this.orderByItems,n),u=i.rewriteSelect(this.selectItems,n),s=i.rewriteGroupBy(this.groupByItems,n);return r.createWithTrimmedFrom(n,a,o,u,s)},r}();e.SemanticQuery=r;var i=function(){function r(e,t){this.fromValue=e,this.whereItems=t}return r.fromSQExpr=function(e){var t=new n,i=a.rewrite(e,t),o=[{condition:i}];return new r(t,o)},r.getDefaultValueFilter=function(t){return r.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.defaultValue())},r.getAnyValueFilter=function(t){return r.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.anyValue())},r.getDataViewScopeIdentityComparisonFilters=function(t,i){if(t instanceof Array){var n=Array.apply(null,Array(t.length)).map(function(){return i});return r.fromSQExpr(e.SQExprUtils.getDataViewScopeIdentityComparisonExpr(t,n))}return r.fromSQExpr(e.SQExprBuilder.equal(t,i))},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.conditions=function(){for(var e=[],t=this.whereItems,r=0,i=t.length;i>r;r++){var n=t[r];e.push(n.condition)}return e},r.prototype.where=function(){for(var e=[],t=this.whereItems,r=0,i=t.length;i>r;r++)e.push(t[r]);return e},r.prototype.rewrite=function(t){var i=new e.SemanticQueryRewriter(t),n=i.rewriteFrom(this.fromValue),a=i.rewriteWhere(this.whereItems,n);return new r(n,a)},r.prototype.validate=function(t,r,i){var n=new e.SQExprValidationVisitor(t,r,i);return this.rewrite(n),n.errors},r.merge=function(e){if(_.isEmpty(e))return null;if(1===e.length)return e[0];for(var i=e[0],n=i.from(),a=t.take(i.whereItems,i.whereItems.length),o=1,u=e.length;u>o;o++)r.applyFilter(e[o],n,a);return new r(n,a)},r.isDefaultFilter=function(t){return t&&1===t.where().length?e.SQExprUtils.isDefaultValue(t.where()[0].condition):!1},r.isAnyFilter=function(t){return t&&1===t.where().length?e.SQExprUtils.isAnyValue(t.where()[0].condition):!1},r.isSameFilter=function(e,t){return jsCommon.JsonComparer.equals(e,t)?!(r.isDefaultFilter(e)&&r.isAnyFilter(t)||r.isAnyFilter(e)&&r.isDefaultFilter(t)):!1},r.applyFilter=function(e,t,r){for(var i=e.whereItems,n=0;n<i.length;n++){var o=i[n],u={condition:a.rewrite(o.condition,t)};o.target&&(u.target=_.map(o.target,function(e){return a.rewrite(e,t)})),r.push(u)}},r}();e.SemanticFilter=i;var n=function(){function e(e){this.items=e||{}}return e.prototype.keys=function(){return Object.keys(this.items)},e.prototype.entity=function(e){return this.items[e]},e.prototype.ensureEntity=function(e,t){for(var r=this.keys(),i=0,n=r.length;n>i;i++){var a=r[i],o=this.items[a];if(o&&e.entity===o.entity&&e.schema===o.schema)return{name:a}}for(var u=t||this.candidateName(e.entity),s=u,c=2;this.items[s];)s=u+c++;return this.items[s]=e,{name:s,"new":!0}},e.prototype.remove=function(e){delete this.items[e]},e.prototype.candidateName=function(e){var t=e.lastIndexOf(".");return t>=0&&t!==e.length-1&&(e=e.substr(t+1)),e.substring(0,1).toLowerCase()},e.prototype.clone=function(){var t=new e;return $.extend(t.items,this.items),t},e}();e.SQFrom=n;var a=function(r){function i(e){r.call(this),this.renames=e}return __extends(i,r),i.prototype.visitEntity=function(t){var i=this.renames[t.entity];return i?new e.SQEntityExpr(t.schema,t.entity,i):r.prototype.visitEntity.call(this,t)},i.prototype.rewriteFilter=function(e){var t=void 0;e.target&&(t=this.rewriteArray(e.target));var r=e.condition.accept(this);if(e.condition===r&&e.target===t)return e;
var i={condition:r};return t&&(i.target=t),i},i.prototype.rewriteArray=function(e){for(var r,i=0,n=e.length;n>i;i++){var a=e[i],o=a.accept(this);a===o||r||(r=t.take(e,i)),r&&r.push(o)}return r||e},i.rewrite=function(e,t){var r=o.run(e,t),n=new i(r);return e.accept(n)},i}(e.SQExprRewriter);e.SQExprRewriterWithSourceRenames=a;var o=function(e){function t(t){e.call(this),this.from=t,this.renames={}}return __extends(t,e),t.run=function(e,r){var i=new t(r);return e.accept(i),i.renames},t.prototype.visitEntity=function(e){var t=this.from.entity(e.variable);if(!t||t.schema!==e.schema||t.entity!==e.entity){var r=this.from.ensureEntity({schema:e.schema,entity:e.entity},e.variable);this.renames[e.entity]=r.name}},t}(e.DefaultSQExprVisitorWithTraversal),u=function(e){function t(t){e.call(this),this.keys=t}return __extends(t,e),t.prototype.visitEntity=function(e){var t=this.keys.indexOf(e.variable);t>=0&&this.keys.splice(t,1)},t.prototype.result=function(){return this.keys},t}(e.DefaultSQExprVisitorWithTraversal)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(){return new s}function i(e,r,i,n){var a=e.identities;return a?a[r]:t.createDataViewScopeIdentity(u.equal(e.fields[0],u.typedConstant(i,n)))}function n(e,t){_.contains(e,t)||e.push(t)}function a(e,t,r){var i=t.values;e.values=i;var n=t.highlights;n&&(e.highlights=n);var a;void 0!==t.minLocal&&(a||(a={}),a.minLocal=t.minLocal),void 0!==t.maxLocal&&(a||(a={}),a.maxLocal=t.maxLocal),a&&(e.source.aggregates=a,_.extend(e,a))}var o=e.data.DataViewTransform,u=e.data.SQExprBuilder;t.createCategoricalDataViewBuilder=r;var s=function(){function e(){this.categories=[],this.staticMeasureColumns=[],this.dynamicMeasureColumns=[],this.columnIndex=0}return e.prototype.withCategory=function(e){var t=e.values,r=e.identityFrom,n=e.source.type,a={source:e.source,identityFields:e.identityFrom.fields,identity:e.identityFrom.identities||[],values:t};if(!e.identityFrom.identities)for(var o=0,u=t.length;u>o;o++)a.identity.push(i(r,o,t[o],n));return this.categories||(this.categories=[]),this.categories.push(a),this},e.prototype.withCategories=function(e){return _.isEmpty(this.categories)?this.categories=e:Array.prototype.push.apply(this.categories,e),this},e.prototype.withValues=function(e){for(var t=e.columns,r=0,i=t;r<i.length;r++){var n=i[r];this.staticMeasureColumns.push(n.source)}return this.staticSeriesValues=t,this},e.prototype.withGroupedValues=function(e){var t=e.groupColumn;this.dynamicSeriesMetadata={column:t.source,identityFrom:t.identityFrom,values:t.values};for(var r=e.valueColumns,i=0,n=r;i<n.length;i++){var a=n[i];this.dynamicMeasureColumns.push(a.source)}return this.dynamicSeriesValues=e.data,this},e.prototype.fillData=function(e){var t=_.first(this.categories),r=t&&t.values?t.values.length:0;if(this.hasDynamicSeries())for(var i=0;i<this.dynamicSeriesMetadata.values.length;i++)for(var n=this.dynamicSeriesValues[i],o=0,u=this.dynamicMeasureColumns.length;u>o;o++){var s=i*u+o;a(e[s],n[o],r)}if(this.hasStaticSeries())for(var c=this.hasDynamicSeries()?this.dynamicSeriesValues.length*this.dynamicMeasureColumns.length:0,o=0,u=this.staticMeasureColumns.length;u>o;o++)a(e[c+o],this.staticSeriesValues[o],r)},e.prototype.build=function(){for(var e=[],t={},r=this.categories,a=this.dynamicSeriesMetadata,u=0,s=r;u<s.length;u++){var c=s[u];n(e,c.source)}if(this.hasDynamicSeries()){n(e,a.column),t.values=o.createValueColumns([],a.identityFrom.fields,a.column);for(var l=a.values,p=0;p<l.length;p++)for(var f=l[p],v=i(a.identityFrom,p,f,a.column.type),h=0,g=this.dynamicMeasureColumns;h<g.length;h++){var d=g[h],y=_.clone(d);y.groupName=f,n(e,y),t.values.push({source:y,values:[],identity:v})}if(this.hasStaticSeries()){var m=t.values.grouped();t.values.grouped=function(){return m},this.appendStaticMeasureColumns(e,t.values)}}else t.values=o.createValueColumns(),this.appendStaticMeasureColumns(e,t.values);var x=this.categories;_.isEmpty(x)||(t.categories=x),this.fillData(t.values);var S={metadata:{columns:e},categorical:t};return this.isLegalDataView(S)?S:void 0},e.prototype.appendStaticMeasureColumns=function(e,t){if(!_.isEmpty(this.staticMeasureColumns))for(var r=0,i=this.staticMeasureColumns;r<i.length;r++){var a=i[r];n(e,a),t.push({source:a,values:[]})}},e.prototype.isLegalDataView=function(t){return!(this.hasDynamicSeries()&&this.hasStaticSeries()&&e.isVisualDataView(t.metadata.columns))},e.isVisualDataView=function(e){return!_.isEmpty(e)&&_.any(e,function(e){return!!e.queryName})},e.prototype.hasDynamicSeries=function(){return!!this.dynamicSeriesMetadata},e.prototype.hasStaticSeries=function(){return!!this.staticSeriesValues},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e,r,i){return new c(e||t.createColorAllocatorCache(),r||{metadata:{columns:[]}},i)}function i(e,t,r,i){var n=r.rows;if(!(_.isEmpty(n)||n.length<=i)){var o=r.columns,u=a(e,t);if(!(0>u))for(var s=0,c=o.length;c>s;s++)if(u===o[s].index)return n[i][s]}}function n(e,t,r){var i=a(e.arg,t);if(!(0>i))for(var n=0,u=r.length;u>n;n++){var s=r[n],c=s.aggregates;if(i===s.index&&c){var l=o(c,e.func);if(void 0!==l)return l}}}function a(e,t){var r;s.isSelectRef(e)&&(r=e.expressionName);for(var i=0,n=t.length;n>i;i++){var a=t[i];if(a&&a.queryName)if(r){if(a.queryName===r)return i}else if(s.equals(a.expr,e))return i}return-1}function o(e,r){switch(r){case t.QueryAggregateFunction.Min:return u(e.min,e.minLocal);case t.QueryAggregateFunction.Max:return u(e.max,e.maxLocal)}}function u(e,t){return void 0!==e?e:t}var s=e.data.SQExpr;t.createStaticEvalContext=r;var c=function(){function e(e,t,r){this.colorAllocatorCache=e,this.dataView=t,this.selectTransforms=r}return e.prototype.getColorAllocator=function(e){return this.colorAllocatorCache.get(e)},e.prototype.getExprValue=function(e){var t=this.dataView,r=this.selectTransforms;if(t&&r){if(s.isAggregation(e)){var a=n(e,r,t.metadata.columns);if(void 0!==a)return a}return t.table?i(e,r,t.table,0):void 0}},e.prototype.getRoleValue=function(e){},e}();t.getExprValueFromTable=i}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(t,r){return e.createStaticEvalContext(t)}e.createMatrixEvalContext=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,r=jsCommon.StringExtensions,i=jsCommon.Formatting,n=jsCommon.RegExpExtensions;!function(e){function t(e,t){for(var i=t.length,n=0;i>n;n++){var a="\\"+t[n],o=String.fromCharCode(57344+n);e=r.replaceAll(e,a,o)}return e}function i(e,t){for(var i=t.length,n=0;i>n;n++){var a=String.fromCharCode(57344+n),o=t[n];e=r.replaceAll(e,a,o)}return r.replaceAll(e,"\\","")}function n(e,t){e=r.replaceAll(e,'"',"'");for(var i=0;;i++){var n=e.indexOf("'");if(0>n)break;var a=e.indexOf("'",n+1);if(0>a)break;var o=e.substring(n,a+1);t.push(o.substring(1,a-n));var u=String.fromCharCode(57600+i);e=e.replace(o,u)}return e}function a(e,t){for(var r=t.length,i=0;r>i;i++){var n=String.fromCharCode(57600+i),a=t[i];e=e.replace(n,a)}return e}e.preserveEscaped=t,e.restoreEscaped=i,e.preserveLiterals=n,e.restoreLiterals=a}(t||(t={}));var a,o=/({{)|(}})|{(\d+[^}]*)}/g,u="0",s="#",c="E",l=[u,s],p=new RegExp(l.join("|"),"g"),f=function(){function e(){}return e.prototype.formatValue=function(e,t,r){if(void 0===e||null===e)return"";var i=this.getCulture(r);return a.canFormat(e)?a.format(e,t,i):v.canFormat(e)?v.format(e,t,i):e.toString()},e.prototype.format=function(e,t,r){var i=this;if(!e)return"";var n=e.replace(o,function(e,n,a,o){if(n)return"{";if(a)return"}";var u=o.split(":"),s=parseInt(u[0],10),c=u[1];return i.formatValue(t[s],c,r)});return n},e.prototype.isStandardNumberFormat=function(e){return v.isStandardFormat(e)},e.prototype.formatNumberWithCustomOverride=function(e,t,r,i){var n=this.getCulture(i);return v.formatWithCustomOverride(e,t,r,n)},e.prototype.dateFormatString=function(e){return this._dateTimeScaleFormatInfo||this.initialize(),this._dateTimeScaleFormatInfo.getFormatString(e)},e.prototype.setCurrentCulture=function(e){this._currentCultureSelector!==e&&(this._currentCulture=this.getCulture(e),this._currentCultureSelector=e,this._dateTimeScaleFormatInfo=new h(this._currentCulture))},e.prototype.getCulture=function(e){if(null==e)return null==this._currentCulture&&this.initialize(),this._currentCulture;var t=Globalize.findClosestCulture(e);return t||(t=Globalize.culture("en-US")),t},e.prototype.initialize=function(){var e=this.getCurrentCulture();this.setCurrentCulture(e);var t=this.getUrlParam("calendar");if(t){var r=this._currentCulture,i=r.calendars[t];i&&(r.calendar=i)}},e.prototype.getCurrentCulture=function(){var e=this.getUrlParam("language");return e?e:powerbi&&powerbi.common&&powerbi.common.cultureInfo?powerbi.common.cultureInfo:window.navigator.userLanguage||window.navigator.language||Globalize.culture().name},e.prototype.getUrlParam=function(e){var t=window.location.search.match(RegExp("[?&]"+e+"=([^&]*)"));return t?t[1]:void 0},e}();!function(e){function n(e){var t=e instanceof Date;return t}function a(e,t,r){t=t||"G";var i=1===t.length;try{return i?o(e,t,r):u(e,t,r)}catch(n){return o(e,"G",r)}}function o(e,t,r){var n=r.calendar.patterns;l(r.calendar);var a=i.findDateFormat(e,t,r.name);return t=1===a.format.length?n[a.format]:a.format,r=Globalize.culture("en-US"),Globalize.format(a.value,t,r)}function u(e,i,n){var a,o=[];if(i=t.preserveEscaped(i,"\\dfFghHKmstyz:/%'\""),i=t.preserveLiterals(i,o),i=r.replaceAll(i,'"',"'"),i.indexOf("F")>-1){i=r.replaceAll(i,"FFFF","FFF");var u=e.getMilliseconds();if(u%10>=1&&(i=r.replaceAll(i,"FFF","fff")),i=r.replaceAll(i,"FFF","FF"),u%100/10>=1&&(i=r.replaceAll(i,"FF","ff")),i=r.replaceAll(i,"FF","F"),u%1e3/100>=1&&(i=r.replaceAll(i,"F","f")),i=r.replaceAll(i,"F",""),""===i||"%"===i)return""}return i=s(i),a=Globalize.format(e,i,n),a=c(a,n.calendar),a=t.restoreLiterals(a,o),a=t.restoreEscaped(a,"\\dfFghHKmstyz:/%'\"")}function s(e){return e===p?f:(p=e,e=i.fixDateTimeFormat(e),f=e,e)}function c(e,t){var r=t[":"];if(":"===r)return e;for(var i="",n=e.length,a=0;n>a;a++){var o=e.charAt(a);switch(o){case":":i+=r;break;default:i+=o}}return i}function l(e){var t=e.patterns;void 0===t.g&&(t.g=t.f.replace(t.D,t.d),t.G=t.F.replace(t.D,t.d))}var p,f;e.canFormat=n,e.format=a}(a||(a={}));var v;!function(i){function a(e,t){if(!t||void 0===e)return e;var r="{0:"+t+"}";return e.replace("{0}",r)}function o(e,t){if(null==t)return t;if(h(t)){var r=i.getComponents(t),n=r.positive,a=r.negative,o=r.zero;return e>0?l(e,n):0===e?l(e,o):l(e,a)}return l(e,t)}function l(e,t){var r=n.run(I,t);return r?r[0]:t}function f(e,t,r){if(null==t)return e;if(null==e&&(e=u),h(e)){for(var n=i.getComponents(e),a=n.positive,o=n.negative,s=n.zero,c=[a,o,s],l=0;l<c.length;l++)c[l]=v(c[l],t,r);return c.join(i.NumberFormatComponentsDelimeter)}return v(e,t,r)}function v(e,t,i){if(t=Math.abs(t),t>=0){var a=i?u:s,o=r.repeat(a,Math.abs(t)),c=n.run(N,e);if(c){var l=e.substr(0,c.index),p=e.substr(c.index+1,c[1].length),f=e.substr(c.index+c[0].length);if(i)p=o;else{var v=o.length-p.length;v>0?p+=o.slice(-v):0>v&&(p=p.slice(0,v))}return p.length>0&&(p=Q+p),l+p+f}if(o.length>0)return e.replace(O,"$1"+Q+o)}return e}function h(e){return-1!==e.indexOf(i.NumberFormatComponentsDelimeter)}function g(e){var t={hasNegative:!1,positive:e,negative:e,zero:e},r=e.split(i.NumberFormatComponentsDelimeter),n=r.length;return n>1&&(t.hasNegative=!0,t.positive=t.zero=r[0],t.negative=r[1],n>2&&(t.zero=r[2])),t}function d(e){var t="number"==typeof e;return t}function y(e){return R.test(e)}function m(e,t,r){t=t||"G";try{return y(t)?S(e,t,r):E(e,t,r)}catch(i){return Globalize.format(e,void 0,r)}}function x(e,t,r,i){return E(e,t,i,r)}function S(e,t,i){var n,a=t.length>1?parseInt(t.substr(1,t.length-1),10):void 0,o=i.numberFormat,u=t.charAt(0);switch(u){case"e":case"E":void 0===a&&(a=6);var s=r.repeat("0",a);t="0."+s+u+"+000",n=E(e,t,i);break;case"f":case"F":n=void 0!==a?e.toFixed(a):e.toFixed(o.decimals),n=F(n,o);break;case"g":case"G":var c=Math.abs(e);if(0===c||c>=1e-4&&1e15>c)n=void 0!==a?e.toPrecision(a):e.toString();else{if("number"!=typeof e)return String(e);n=void 0!==a?e.toExponential(a):e.toExponential(),n=n.replace("e","E")}n=F(n,o);break;case"r":case"R":n=e.toString(),n=F(n,o);break;case"x":case"X":if(n=e.toString(16),"X"===u&&(n=n.toUpperCase()),void 0!==a){var l=n.length,p=0>e;p&&l--;var f=a-l,v=void 0;f>0&&(v=r.repeat("0",f)),n=p?"-"+v+n.substr(1):v+n}n=F(n,o);break;default:n=Globalize.format(e,t,i)}return n}function E(r,o,u,s){var c,l=u.numberFormat;if(!isFinite(r))return Globalize.format(r,void 0);var p=g(o);o=r>0?p.positive:0===r?p.zero:p.negative,p.hasNegative&&(r=Math.abs(r));var f=b(o,!0);f.hasEscapes&&(o=t.preserveEscaped(o,"\\0#.,%"));var v=[];if(f.hasQuotes&&(o=t.preserveLiterals(o,v)),f.hasE&&!s){var h=n.run(M,o);if(h){var d=o.substr(0,h.index),y=o.substr(h.index+2),m=D(d,f),x=C(d,f);if(1!==x&&(r*=x),"number"!=typeof r)return String(r);var S=r.toExponential(m),E=S.indexOf("e"),V=S.substr(0,E),_=S.substr(E+1),F=T(V,d,l),P=T(_,y,l);"+"===P.charAt(0)&&"+"!==h[0].charAt(1)&&(P=P.substr(1));var R=h[0].charAt(0);c=F+R+P}}if(void 0===c){var A=void 0,N=!1,m=D(o,f),x=C(o,f);if(1!==x&&(r*=x),r=parseFloat(w(r,m)),s){var I=i.getNumericFormat(r,o);s=a(s,I),A=e.formattingService.format(s,[r],u.name),N=!0}else A=w(r,m);c=T(A,o,l,s,N)}return f.hasQuotes&&(c=t.restoreLiterals(c,v)),f.hasEscapes&&(c=t.restoreEscaped(c,"\\0#.,%")),U=f,c}function w(t,i){var n="",a=0;i>16&&(a=i-16,i=16);var o=e.Double.log10(Math.abs(t));if(16>o){if(o>0){var u=16-o;i>u&&(a+=i-u,i=u)}n=t.toFixed(i)}else if(16===o)n=t.toFixed(0),a+=i,a>0&&(n+=".");else{if("number"!=typeof t)return String(t);n=t.toExponential(15);var s=n.indexOf("e");if(s>0){var c=n.indexOf("."),l=n.substr(0,s),p=n.substr(s+1),f=parseInt(p,10)-(l.length-c-1);n=l.replace(".","")+r.repeat("0",f),i>0&&(n=n+"."+r.repeat("0",i))}}return a>0&&(n+=r.repeat("0",a)),n}function b(e,t,r){if(void 0!==U&&e===U.format)return U;for(var i={format:e,hasEscapes:!1,hasQuotes:!1,hasE:!1,hasCommas:!1,hasDots:!1,hasPercent:!1,hasPermile:!1,precision:void 0,scale:void 0},n=0,a=e.length;a>n;n++){var o=e.charAt(n);switch(o){case"\\":i.hasEscapes=!0;break;case"'":case'"':i.hasQuotes=!0;break;case"e":case"E":i.hasE=!0;break;case",":i.hasCommas=!0;break;case".":i.hasDots=!0;break;case"%":i.hasPercent=!0;break;case"":i.hasPermile=!0}}var u=g(e);return t&&(i.precision=D(u.positive,i)),r&&(i.scale=C(u.positive,i)),i}function D(e,t){if(t.precision>-1)return t.precision;var r=0;if(t.hasDots){var i=e.indexOf(".");if(i>-1){for(var n=e.length,a=i;n>a;a++){var o=e.charAt(a);if(o.match(p)&&r++,o===c)break}r=Math.min(19,r)}}return t.precision=r,r}function C(e,t){if(t.scale>-1)return t.scale;var r=1;if(t.hasPercent&&e.indexOf("%")>-1&&(r=100*r),t.hasPermile&&e.indexOf("")>-1&&(r=1e3*r),t.hasCommas){var i=e.indexOf(".");-1===i&&(i=e.length);for(var n=i-1;n>-1;n--){var a=e.charAt(n);if(","!==a)break;r/=1e3}}return t.scale=r,r}function T(e,t,r,i,n){var a=!!i,o=t.split(".",2);if(2===o.length){var u=o[0],s=o[1],c="";i&&(c=i.replace(P,""),e=e.replace(c,""));var l=r["."],p=n?l:".",f=e.split(p,2),v=1===f.length?f[0]+c:f[0],h=2===f.length?f[1]+c:"";h=h.replace(A,"");var g=V(v,u,r,a),d=_(h,s,a);return d.fmtOnly||""===d.value?g+d.value:g+l+d.value}return V(e,t,r,a)}function V(e,t,r,i){var n=t.indexOf(","),a=n>-1&&n<Math.max(t.lastIndexOf("0"),t.lastIndexOf("#"))&&r[","],o=0,c=0,l=r.groupSizes||[3],p=l[0],f=r[","],v="",h=e.charAt(0);"+"!==h&&"-"!==h||(v=r[h],e=e.substr(1));for(var g="0"===e,d="",y="",m=e.length-1,x=!0,S=t.length-1;S>-1;S--){var E=t.charAt(S);switch(E){case u:case s:x=!1,""!==y&&(d=y+d,y=""),i||((m>-1||E===u)&&a&&(o===p?(d=f+d,c++,c<l.length&&(p=l[c]),o=1):o++),m>-1?(g&&E===s||(d=e.charAt(m)+d),m--):E!==s&&(d=E+d));break;case",":break;default:y=E+y}}if(!i){if(m>-1&&""!==d)if(a)for(;m>-1;)o===p?(d=f+d,c++,c<l.length&&(p=l[c]),o=1):o++,d=e.charAt(m)+d,m--;else d=e.substr(0,m+1)+d;return v+y+d}return x?v+y+d:v+y+e+d}function _(e,t,r){var i=0,n=t.length,a=e.length;if(r){var o=t.charAt(n-1);return o.match(p)?{value:e,fmtOnly:""===e}:{value:e+o,fmtOnly:""===e}}for(var c="",l=!0,f=0;n>f;f++){var v=t.charAt(f);if(a>i)switch(v){case u:case s:c+=e[i++],l=!1;break;default:c+=v}else v!==s&&(c+=v,l=l&&v!==u)}return{value:c,fmtOnly:l}}function F(e,t){var r=t["+"],i=t["-"],n=t["."],a=t[","];if("+"===r&&"-"===i&&"."===n&&","===a)return e;for(var o=e.length,u="",s=0;o>s;s++){var c=e.charAt(s);switch(c){case"+":u+=r;break;case"-":u+=i;break;case".":u+=n;break;case",":u+=a;break;default:u+=c}}return u}var P=/\{.+\}/,M=/e[+-]*[0#]+/i,R=/^[a-z]\d{0,2}$/i,A=/0+$/,N=/\.([0#]*)/g,I=/[0#,\.]+[0,#]*/g,O=/(0|#)([^(0|#)]*)$/,Q=".";i.NumberFormatComponentsDelimeter=";",i.getNumericFormat=o,i.addDecimalsToFormat=f,i.hasFormatComponents=h,i.getComponents=g;var U;i.canFormat=d,i.isStandardFormat=y,i.format=m,i.formatWithCustomOverride=x,i.getCustomFormatMetadata=b}(v=e.NumberFormat||(e.NumberFormat={}));var h=function(){function t(e){var t=e.calendar,r=t.patterns,i=t.months.namesAbbr,n=i&&i[0],a=r.Y,o=r.M,u=r.f,s=r.T,c=r.t,l=u.indexOf(",")>-1?", ":" ",p=0===a.indexOf("yyyy'")&&a.length>6&&"'"===a[6];this.YearPattern=p?a.substr(0,7):"yyyy";var f=u.indexOf("yy"),v=u.indexOf("MMMM");this.MonthPattern=n&&v>-1?f>v?"MMM yyyy":"yyyy MMM":a,this.DayPattern=n?o.replace("MMMM","MMM"):o;var h=u.indexOf("mm"),g=u.indexOf("tt"),d=g>-1?c.replace(":mm ",""):c;switch(this.HourPattern=h>f?this.DayPattern+l+d:d+l+this.DayPattern,this.MinutePattern=c,this.SecondPattern=s,this.MillisecondPattern=s.replace("ss","ss.fff"),e.name){case"fi-FI":this.DayPattern=this.DayPattern.replace("'ta'",""),this.HourPattern=this.HourPattern.replace("'ta'","")}}return t.prototype.getFormatString=function(t){switch(t){case e.DateTimeUnit.Year:return this.YearPattern;case e.DateTimeUnit.Month:return this.MonthPattern;case e.DateTimeUnit.Week:case e.DateTimeUnit.Day:return this.DayPattern;case e.DateTimeUnit.Hour:return this.HourPattern;case e.DateTimeUnit.Minute:return this.MinutePattern;case e.DateTimeUnit.Second:return this.SecondPattern;case e.DateTimeUnit.Millisecond:return this.MillisecondPattern}},t}();e.formattingService=new f}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(e){return JSON.stringify(e.accept(n.instance))}function i(e){for(var r="[",i=0,n=e.length;n>i;i++)i>0&&(r+=","),r+=t.serialize(e[i]);return r+"]"}t.serialize=r,t.serializeArray=i;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){return{col:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitMeasureRef=function(e){return{measure:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitAggr=function(e){return{agg:{a:e.arg.accept(this),f:e.func}}},t.prototype.visitEntity=function(e){return{e:e.entity}},t.prototype.visitHierarchyLevel=function(e){return{h:e.arg.accept(this),l:e.level}},t.prototype.visitHierarchy=function(e){return{e:e.arg.accept(this),h:e.hierarchy}},t.prototype.visitPropertyVariationSource=function(e){return{e:e.arg.accept(this),n:e.name,p:e.property}},t.prototype.visitAnd=function(e){return{and:{l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitCompare=function(e){return{comp:{k:e.comparison,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitConstant=function(e){return{"const":{t:e.type.primitiveType,v:e.value}}},t.prototype.visitArithmetic=function(e){return{arithmetic:{o:e.operator,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitScopedEval=function(e){return{scopedEval:{e:e.expression.accept(this),s:i(e.scope)}}},t.prototype.visitDefault=function(e){},t.instance=new t,t}(e.DefaultSQExprVisitor)}(t=e.SQExprShortSerializer||(e.SQExprShortSerializer={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r=e.data.Selector,i=function(){function t(e,t){this.selector=e,this.highlight=t,this.key=JSON.stringify({selector:e?r.getKey(e):null,highlight:t}),this.keyWithoutHighlight=JSON.stringify({selector:e?r.getKey(e):null})}return t.prototype.equals=function(e){return this.selector&&e.selector?this.highlight===e.highlight&&r.equals(this.selector,e.selector):!this.selector==!e.selector&&this.highlight===e.highlight},t.prototype.includes=function(t,r){void 0===r&&(r=!1);var i=this.selector,n=t.selector;if(!i||!n)return!1;var a=i.data,o=n.data;if(!a&&i.metadata&&i.metadata!==n.metadata)return!1;if(!r&&this.highlight!==t.highlight)return!1;if(a){if(!o)return!1;if(a.length>0)for(var u=0,s=a.length;s>u;u++){var c=a[u];if(!o.some(function(t){return e.DataViewScopeIdentity.equals(c,t)}))return!1}}return!0},t.prototype.getKey=function(){return this.key},t.prototype.getKeyWithoutHighlight=function(){return this.keyWithoutHighlight},t.prototype.hasIdentity=function(){return this.selector&&!!this.selector.data},t.prototype.getSelector=function(){return this.selector},t.prototype.getSelectorsByColumn=function(){return this.selectorsByColumn},t.createNull=function(e){return void 0===e&&(e=!1),new t(null,e)},t.createWithId=function(e,r){void 0===r&&(r=!1);var i=null;return e&&(i={data:[e]}),new t(i,r)},t.createWithMeasure=function(e,r){void 0===r&&(r=!1);var i={metadata:e},n=new t(i,r);return n.selectorsByColumn={metadata:e},n},t.createWithIdAndMeasure=function(e,r,i){void 0===i&&(i=!1);var n={};e&&(n.data=[e]),r&&(n.metadata=r),e||r||(n=null);var a=new t(n,i);return a},t.createWithIdAndMeasureAndCategory=function(e,t,r,i){void 0===i&&(i=!1);var n=this.createWithIdAndMeasure(e,t,i);return n.selector&&(n.selectorsByColumn={},e&&r&&(n.selectorsByColumn.dataMap={},n.selectorsByColumn.dataMap[r]=e),t&&(n.selectorsByColumn.metadata=t)),n},t.createWithIds=function(e,r,i){void 0===i&&(i=!1);var n=null,a=t.idArray(e,r);return a&&(n={data:a}),new t(n,i)},t.createWithIdsAndMeasure=function(e,r,i,n){void 0===n&&(n=!1);var a={},o=t.idArray(e,r);return o&&(a.data=o),i&&(a.metadata=i),e||r||i||(a=null),new t(a,n)},t.createWithSelectorForColumnAndMeasure=function(e,t,r){void 0===r&&(r=!1);var i,n=Object.keys(e);i=2===n.length?this.createWithIdsAndMeasure(e[n[0]],e[n[1]],t,r):1===n.length?this.createWithIdsAndMeasure(e[n[0]],null,t,r):this.createWithIdsAndMeasure(null,null,t,r);var a={};return _.isEmpty(e)||(a.dataMap=e),t&&(a.metadata=t),e||t||(a=null),i.selectorsByColumn=a,i},t.createWithHighlight=function(e){var r=new t(e.getSelector(),!0);return r.selectorsByColumn=e.selectorsByColumn,r},t.idArray=function(e,t){if(e||t){var r=[];return e&&r.push(e),t&&t!==e&&r.push(t),r}},t}();t.SelectionId=i;var n=function(){function e(){}return e.builder=function(){return new e},e.prototype.withCategory=function(e,t){return e&&e.source&&e.source.queryName&&e.identity&&(this.ensureDataMap()[e.source.queryName]=e.identity[t]),this},e.prototype.withSeries=function(e,t){return e&&e.source&&e.source.queryName&&t&&(this.ensureDataMap()[e.source.queryName]=t.identity),this},e.prototype.withMeasure=function(e){return this.measure=e,this},e.prototype.createSelectionId=function(){return i.createWithSelectorForColumnAndMeasure(this.ensureDataMap(),this.measure)},e.prototype.ensureDataMap=function(){return this.dataMap||(this.dataMap={}),this.dataMap},e}();t.SelectionIdBuilder=n}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));

;var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},powerbi;!function(e){var t;!function(e){var t=function(){function e(e,t){this.x=e||0,this.y=t||0}return e}();e.Point=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e,t,i,a){this.left=e||0,this.top=t||0,this.width=i||0,this.height=a||0}return e}();e.Rect=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t,i,a,r){return void 0===a&&(a=!1),void 0===r&&(r=o.Top),t?new c(e):new s(e,r,i,a)}var a=jsCommon.CssConstants.createClassAndSelector,r=jsCommon.PixelConverter;!function(e){e[e.Box=0]="Box",e[e.Circle=1]="Circle",e[e.Line=2]="Line"}(t.LegendIcon||(t.LegendIcon={}));t.LegendIcon;!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Right=2]="Right",e[e.Left=3]="Left",e[e.None=4]="None",e[e.TopCenter=5]="TopCenter",e[e.BottomCenter=6]="BottomCenter",e[e.RightCenter=7]="RightCenter",e[e.LeftCenter=8]="LeftCenter"}(t.LegendPosition||(t.LegendPosition={}));var o=t.LegendPosition;t.legendProps={show:"show",position:"position",titleText:"titleText",showTitle:"showTitle",labelColor:"labelColor",fontSize:"fontSize"},t.createLegend=i;var n;!function(e){function t(e){switch(e){case o.Left:case o.LeftCenter:return!0;default:return!1}}function i(e){switch(e){case o.Top:case o.TopCenter:return!0;default:return!1}}function a(t,i){var a=i.getMargins(),r=i.getOrientation();t.style({"margin-left":e.isLeft(r)?a.width+"px":null,"margin-top":e.isTop(r)?a.height+"px":null})}e.isLeft=t,e.isTop=i,e.positionChartArea=a}(n=t.Legend||(t.Legend={}));var s=function(){function i(e,i,a,r){this.legendDataStartIndex=0,this.arrowPosWindow=1,this.lastCalculatedWidth=0,this.visibleLegendWidth=0,this.visibleLegendHeight=0,this.legendFontSizeMarginDifference=0,this.legendFontSizeMarginValue=0,this.svg=d3.select(e.get(0)).append("svg").style("position","absolute"),this.svg.style("display","inherit"),this.svg.classed("legend",!0),a&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.group=this.svg.append("g").attr("id","legendGroup"),this.interactivityService=a,this.isScrollable=r,this.element=e,this.changeOrientation(i),this.parentViewport={height:0,width:0},this.calculateViewport(),this.updateLayout()}return i.prototype.updateLayout=function(){var e=this.viewport,t=this.orientation;this.svg.attr({height:e.height||(t===o.None?0:this.parentViewport.height),width:e.width||(t===o.None?0:this.parentViewport.width)});var i=t===o.Right||t===o.RightCenter,a=t===o.Bottom||t===o.BottomCenter;this.svg.style({"margin-left":i?this.parentViewport.width-e.width+"px":null,"margin-top":a?this.parentViewport.height-e.height+"px":null})},i.prototype.calculateViewport=function(){switch(this.orientation){case o.Top:case o.Bottom:case o.TopCenter:case o.BottomCenter:var e=r.fromPointToPixel(this.data&&this.data.fontSize?this.data.fontSize:i.DefaultFontSizeInPt),t=i.TopLegendHeight+(e-i.DefaultFontSizeInPt);return void(this.viewport={height:t,width:0});case o.Right:case o.Left:case o.RightCenter:case o.LeftCenter:var a=this.lastCalculatedWidth?this.lastCalculatedWidth:this.parentViewport.width*i.LegendMaxWidthFactor;return void(this.viewport={height:0,width:a});case o.None:this.viewport={height:0,width:0}}},i.prototype.getMargins=function(){return this.viewport},i.prototype.isVisible=function(){return this.orientation!==o.None},i.prototype.changeOrientation=function(e){e?this.orientation=e:this.orientation=o.Top,this.svg.attr("orientation",e)},i.prototype.getOrientation=function(){return this.orientation},i.prototype.drawLegend=function(t,i){for(var a=e.Prototype.inherit(t),r=[],o=0,n=t.dataPoints;o<n.length;o++){var s=n[o];r.push(e.Prototype.inherit(s))}a.dataPoints=r,this.setTooltipToLegendItems(a),this.drawLegendInternal(a,i,!0)},i.prototype.drawLegendInternal=function(a,n,s){this.parentViewport=n,this.data=a,this.interactivityService&&this.interactivityService.applySelectionStateToData(a.dataPoints),0===a.dataPoints.length&&this.changeOrientation(o.None),this.getOrientation()===o.None&&(a.dataPoints=[]);var l=this.element.children(".mapControl");l.length>0&&!this.isTopOrBottom(this.orientation)&&l.css("display","inline-block"),this.calculateViewport();var c=this.calculateLayout(a,s),u=c.title,h=u?[u]:[],d=this.interactivityService&&e.visuals.dataHasSelection(a.dataPoints),p=this.group;if(this.isCentered(this.orientation)){var g=0;this.isTopOrBottom(this.orientation)?(g=Math.max(0,(this.parentViewport.width-this.visibleLegendWidth)/2),p.attr("transform",t.SVGUtil.translate(g,0))):(g=Math.max((this.parentViewport.height-this.visibleLegendHeight)/2),p.attr("transform",t.SVGUtil.translate(0,g)))}else p.attr("transform",null);var m=p.selectAll(i.LegendTitle.selector).data(h);m.enter().append("text").classed(i.LegendTitle["class"],!0),m.style({fill:a.labelColor,"font-size":r.fromPoint(a.fontSize),"font-family":i.DefaultTitleFontFamily}).text(function(e){return e.text}).attr({x:function(e){return e.x},y:function(e){return e.y}}).append("title").text(a.title),m.exit().remove();var f=a.dataPoints.slice(this.legendDataStartIndex,this.legendDataStartIndex+c.numberOfItems),y=e.TextMeasurementService.estimateSvgTextHeight(i.getTextProperties(!1,"",this.data.fontSize))/i.LegendIconRadiusFactor;y=this.legendFontSizeMarginValue>i.DefaultTextMargin&&y>i.LegendIconRadius?y:i.LegendIconRadius;var v=p.selectAll(i.LegendItem.selector).data(f,function(e){return e.identity.getKey()+(null!=e.layerNumber?e.layerNumber:"")}),b=v.enter().append("g").classed(i.LegendItem["class"],!0);if(b.append("circle").classed(i.LegendIcon["class"],!0),b.append("text").classed(i.LegendText["class"],!0),b.append("title").text(function(e){return e.tooltip}),b.style({"font-family":i.DefaultFontFamily}),v.select(i.LegendIcon.selector).attr({cx:function(e,t){return e.glyphPosition.x},cy:function(e){return e.glyphPosition.y},r:y}).style({fill:function(e){return d&&!e.selected?t.LegendBehavior.dimmedLegendColor:e.color}}),v.select("title").text(function(e){return e.tooltip}),v.select(i.LegendText.selector).attr({x:function(e){return e.textPosition.x},y:function(e){return e.textPosition.y}}).text(function(e){return e.label}).style({fill:a.labelColor,"font-size":r.fromPoint(a.fontSize)}),this.interactivityService){var C=v.select(i.LegendIcon.selector),S={legendItems:v,legendIcons:C,clearCatcher:this.clearCatcher};this.interactivityService.bind(a.dataPoints,new t.LegendBehavior,S,{isLegend:!0})}v.exit().remove(),this.drawNavigationArrows(c.navigationArrows),this.updateLayout()},i.prototype.normalizePosition=function(e){this.legendDataStartIndex>=e.length&&(this.legendDataStartIndex=e.length-1),this.legendDataStartIndex<0&&(this.legendDataStartIndex=0)},i.prototype.calculateTitleLayout=function(t){var a=0,r=!_.isEmpty(t);if(r){var o=this.isTopOrBottom(this.orientation),n=void 0;if(o){var s=this.legendFontSizeMarginValue>i.DefaultTextMargin?i.TextAndIconPadding+this.legendFontSizeMarginDifference:i.TextAndIconPadding,l=i.TextAndIconPadding+i.LegendIconRadius,c=i.LegendIconRadius+s+l;n=this.parentViewport.width*i.LegendMaxWidthFactor-c-i.LegendEdgeMariginWidth}else n=this.legendFontSizeMarginValue<i.DefaultTextMargin?i.MaxTitleLength:i.MaxTitleLength+i.DefaultMaxLegendFactor*this.legendFontSizeMarginDifference;var u=i.getTextProperties(!0,t,this.data.fontSize),h=t;return a=e.TextMeasurementService.measureSvgTextWidth(u),a>n&&(h=e.TextMeasurementService.getTailoredTextOrDefault(u,n),u.text=h,a=e.TextMeasurementService.measureSvgTextWidth(u)),o?a+=i.TitlePadding:h=e.TextMeasurementService.getTailoredTextOrDefault(u,this.viewport.width),{x:0,y:0,text:h,width:a,height:e.TextMeasurementService.estimateSvgTextHeight(u)}}return null},i.prototype.calculateLayout=function(e,t){var a=e.dataPoints;if(0===e.dataPoints.length)return{startIndex:null,numberOfItems:0,title:null,navigationArrows:[]};this.legendFontSizeMarginValue=r.fromPointToPixel(this.data&&void 0!==this.data.fontSize?this.data.fontSize:i.DefaultFontSizeInPt),this.legendFontSizeMarginDifference=this.legendFontSizeMarginValue-i.DefaultTextMargin,this.normalizePosition(a),this.legendDataStartIndex<a.length&&(a=a.slice(this.legendDataStartIndex));var o,n,s=this.calculateTitleLayout(e.title);return this.isTopOrBottom(this.orientation)?(o=this.isScrollable?this.calculateHorizontalNavigationArrowsLayout(s):[],n=this.calculateHorizontalLayout(a,s,o)):(o=this.isScrollable?this.calculateVerticalNavigationArrowsLayout(s):[],n=this.calculateVerticalLayout(a,s,o,t)),{numberOfItems:n,title:s,navigationArrows:o}},i.prototype.updateNavigationArrowLayout=function(e,t,i){0===this.legendDataStartIndex&&e.shift();var a=this.arrowPosWindow;this.arrowPosWindow=i,e&&e.length>0&&this.arrowPosWindow===t&&(this.arrowPosWindow=a,e.length=e.length-1)},i.prototype.calculateHorizontalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,o=this.viewport.height/2-a/2,n=[],s=e?e.x+e.width:0,l=t.SVGUtil.createArrow(r,a,180),c=t.SVGUtil.createArrow(r,a,0);return n.push({x:s,y:o,path:l.path,rotateTransform:l.transform,type:1}),n.push({x:this.parentViewport.width-r,y:o,path:c.path,rotateTransform:c.transform,type:0}),n},i.prototype.calculateVerticalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,o=this.viewport.height/2,n=[],s=o+a/2,l=t.SVGUtil.createArrow(r,a,270),c=t.SVGUtil.createArrow(r,a,90),u=e?e.height:0;return n.push({x:s,y:r+u,path:l.path,rotateTransform:l.transform,type:1}),n.push({x:s,y:this.parentViewport.height-a,path:c.path,rotateTransform:c.transform,type:0}),n},i.calculateHorizontalLegendItemsWidths=function(t,a,r,o){var n=t.length,s=n>0?a/n|0:0,l=s-r;l<i.MaxTextLength&&(l=i.MaxTextLength,s=l+r),s>a&&(s=a,l=s-r);for(var c=0,u=[],h=0,d=t;h<d.length;h++){var p=d[h],g=i.getTextProperties(!1,p.label,o),m=e.TextMeasurementService.measureSvgTextWidth(g),f=m+r,y=f>s,v=y?s:f;if(c+=v,c>=a){0===u.length?(u.push({dataPoint:p,textProperties:g,desiredWidth:f,desiredOverMaxWidth:!0,width:f}),c=a):c-=v;break}u.push({dataPoint:p,textProperties:g,desiredWidth:f,desiredOverMaxWidth:y,width:f})}var b=_.filter(u,function(e){return e.desiredOverMaxWidth}),C=b.length;if(C>0)for(var S=a-c,x=0,w=b;x<w.length;x++){var P=w[x],D=S/C,L=s+D,T=void 0;P.desiredWidth<=L?(P.desiredOverMaxWidth=!1,T=P.desiredWidth-s):(P.width=L,T=L-s),S-=T,C--}return u},i.prototype.calculateHorizontalLayout=function(t,a,r){var o=4+i.LegendIconRadius,n=this.legendFontSizeMarginDifference>0,s=n?i.TextAndIconPadding+this.legendFontSizeMarginDifference:i.TextAndIconPadding,l=s/(i.LegendIconRadiusFactor/2)+o,c=0,u=2*i.LegendIconRadius+1.5*s,h=t.length,d=i.getTextProperties(!1,"",this.data.fontSize),p=this.viewport.height/2,g=p+e.TextMeasurementService.estimateSvgTextHeight(d)/2-e.TextMeasurementService.estimateSvgTextBaselineDelta(d);a&&(c+=a.width,a.y=p+a.height/2-e.TextMeasurementService.estimateSvgTextBaselineDelta(i.getTextProperties(!0,a.text,this.data.fontSize))),this.legendDataStartIndex>0&&(c+=i.LegendArrowOffset);var m=t.length,f=this.parentViewport.width-c,y=i.calculateHorizontalLegendItemsWidths(t,f,u,this.data.fontSize);h=y.length,h!==m&&(f-=i.LegendArrowOffset,y=i.calculateHorizontalLegendItemsWidths(t,f,u,this.data.fontSize),h=y.length);for(var v=0,b=y;v<b.length;v++){var C=b[v],S=C.dataPoint;if(S.glyphPosition={x:c+i.LegendIconRadius+this.legendFontSizeMarginDifference/i.LegendIconRadiusFactor,y:this.viewport.height*i.LegendIconYRatio},S.textPosition={x:c+l,y:g},C.desiredOverMaxWidth){var x=C.width-u,w=e.TextMeasurementService.getTailoredTextOrDefault(C.textProperties,x);S.label=w}c+=C.width}return this.visibleLegendWidth=c,this.updateNavigationArrowLayout(r,m,h),h},i.prototype.calculateVerticalLayout=function(t,a,r,o){var n=this,s=this.legendFontSizeMarginDifference>0,l=s?this.legendFontSizeMarginDifference:0,c=20+l,u=15+l,h=4+l,d=c,p=i.TextAndIconPadding+i.LegendIconRadius+this.legendFontSizeMarginDifference/i.LegendIconRadiusFactor,g=2*p,m=o?this.parentViewport.width*i.LegendMaxWidthFactor-g-i.LegendEdgeMariginWidth:this.lastCalculatedWidth-g-i.LegendEdgeMariginWidth,f=t.length,y=0,v=this.parentViewport.height;a&&(d+=u,a.x=i.TextAndIconPadding,a.y=u,y=a.width||0),this.legendDataStartIndex>0&&(d+=i.LegendArrowOffset);for(var b=t.length,C=0;b>C;C++){var S=t[C],x=i.getTextProperties(!1,S.label,this.data.fontSize);S.glyphPosition={x:p,y:d+h-e.TextMeasurementService.estimateSvgTextBaselineDelta(x)},S.textPosition={x:g,y:d+h};var w=e.TextMeasurementService.measureSvgTextWidth(x);if(w>y&&(y=w),w>m){var P=e.TextMeasurementService.getTailoredTextOrDefault(x,m);S.label=P}if(d+=c,d>v){f=C;break}}return o?m>y?this.lastCalculatedWidth=this.viewport.width=Math.ceil(y+g+i.LegendEdgeMariginWidth):this.lastCalculatedWidth=this.viewport.width=Math.ceil(this.parentViewport.width*i.LegendMaxWidthFactor):this.viewport.width=this.lastCalculatedWidth,this.visibleLegendHeight=d,r.forEach(function(e){return e.x=n.lastCalculatedWidth/2}),this.updateNavigationArrowLayout(r,b,f),f},i.prototype.drawNavigationArrows=function(e){var a=this,r=this.group.selectAll(i.NavigationArrow.selector).data(e);r.enter().append("g").on("click",function(e){var t=a.legendDataStartIndex;a.legendDataStartIndex=0===e.type?t+a.arrowPosWindow:t-a.arrowPosWindow,a.drawLegendInternal(a.data,a.parentViewport,!1)}).classed(i.NavigationArrow["class"],!0).append("path"),r.attr("transform",function(e){return t.SVGUtil.translate(e.x,e.y)}).select("path").attr({d:function(e){return e.path},transform:function(e){return e.rotateTransform}}),r.exit().remove()},i.prototype.isTopOrBottom=function(e){switch(e){case o.Top:case o.Bottom:case o.BottomCenter:case o.TopCenter:return!0;default:return!1}},i.prototype.isCentered=function(e){switch(e){case o.BottomCenter:case o.LeftCenter:case o.RightCenter:case o.TopCenter:return!0;default:return!1}},i.prototype.reset=function(){},i.getTextProperties=function(e,t,a){return{text:t,fontFamily:e?i.DefaultTitleFontFamily:i.DefaultFontFamily,fontSize:r.fromPoint(a||i.DefaultFontSizeInPt)}},i.prototype.setTooltipToLegendItems=function(e){for(var t=0,i=e.dataPoints;t<i.length;t++){var a=i[t];a.tooltip=a.label}},i.DefaultFontSizeInPt=8,i.LegendIconRadius=5,i.LegendIconRadiusFactor=5,i.MaxTextLength=60,i.MaxTitleLength=80,i.TextAndIconPadding=5,i.TitlePadding=15,i.LegendEdgeMariginWidth=10,i.LegendMaxWidthFactor=.3,i.TopLegendHeight=24,i.DefaultTextMargin=r.fromPointToPixel(i.DefaultFontSizeInPt),i.DefaultMaxLegendFactor=i.MaxTitleLength/i.DefaultTextMargin,i.LegendIconYRatio=.52,i.LegendArrowOffset=10,i.LegendArrowHeight=15,i.LegendArrowWidth=7.5,i.DefaultFontFamily="wf_segoe-ui_normal",i.DefaultTitleFontFamily="wf_segoe-ui_Semibold",i.LegendItem=a("legendItem"),i.LegendText=a("legendText"),i.LegendIcon=a("legendIcon"),i.LegendTitle=a("legendTitle"),i.NavigationArrow=a("navArrow"),i}();t.SVGLegend=s;var l,c=function(){function i(e){this.legendContainerParent=d3.select(e.get(0))}return i.prototype.getMargins=function(){return{height:i.LegendHeight,width:0}},i.prototype.drawLegend=function(e){var t=e.dataPoints;if(!(t.length<1)){var a=this.legendContainerParent.select(i.LegendContainerSelector);if(a.empty()){if(!t.length)return;var r=$("<div></div>").height(this.getMargins().height).addClass(i.LegendContainerClass);$(this.legendContainerParent[0]).prepend(r),a=d3.select(r.get(0))}this.legendContainerDiv=a,this.drawTitle(t),this.drawLegendItems(t)}},i.prototype.reset=function(){this.legendContainerDiv&&(this.legendContainerDiv.remove(),this.legendContainerDiv=null)},i.prototype.isVisible=function(){return!0},i.prototype.changeOrientation=function(e){},i.prototype.getOrientation=function(){return o.Top},i.prototype.drawTitle=function(e){var t=this.legendContainerDiv.selectAll("div."+i.LegendTitleClass),a=t.data([e[0]]),r=a.enter(),o=r.append("div").attr("class",i.LegendTitleClass);o.filter(function(e){return e.iconOnlyOnLabel}).append("span").attr("class",i.legendIconClass).html(i.legendPlaceSelector),o.append("span"),a.filter(function(e){return e.iconOnlyOnLabel}).select("span."+i.legendIconClass).style(i.legendColorCss,function(e){return e.color}),a.select("span:last-child").text(function(e){return e.category})},i.prototype.drawLegendItems=function(t){this.ensureLegendTableCreated();var a=[t],r=this.legendContainerDiv.select("tbody").selectAll("tr").data(a),o=r.enter(),n=o.append("tr"),s=n.selectAll("td").data(function(e){return e},function(e){return e.label}).enter().append("td").attr("class",i.LegendItem),l=s.append("span");l.filter(function(e){return!e.iconOnlyOnLabel}).append("span").html(i.legendPlaceSelector).attr("class",i.legendIconClass).attr("white-space","nowrap").style({"font-size":"20px","margin-bottom":"7px"}),l.append("span").attr("class",i.legendItemNameClass),l.append("span").attr("class",i.legendItemMeasureClass);var c=r.selectAll("td").data(function(e){return e},function(e){return e.label});c.select("span."+i.legendItemNameClass).html(function(t){return e.visuals.TextUtil.removeBreakingSpaces(t.label)}),c.select("span."+i.legendItemMeasureClass).html(function(e){return"&nbsp;"+e.measure}),c.select("span."+i.legendIconClass).style("color",function(e){return e.color}),c.exit().remove()},i.prototype.ensureLegendTableCreated=function(){if(this.legendContainerDiv.select("div table").empty()){var e=this.legendContainerDiv.append("div").append("table");e.style("table-layout","fixed").append("tbody"),this.setPanGestureOnLegend(e)}},i.prototype.setPanGestureOnLegend=function(e){var i=$(this.legendContainerParent[0]).width(),a=d3.scale.linear().domain([0,i]).range([0,i]),r=d3.behavior.zoom().scaleExtent([1,1]).x(a).on("zoom",function(){if($(e[0]).width()>i){var a=r.translate(),o=a[0],n=a[1];o=Math.min(o,0),o=Math.max(o,i-$(e[0]).width()),r.translate([o,n]),e.style("-ms-transform",function(){return t.SVGUtil.translateXWithPixels(o)}),e.style("-webkit-transform",function(){return t.SVGUtil.translateXWithPixels(o)}),e.style("transform",function(){return t.SVGUtil.translateXWithPixels(o)})}});this.legendContainerDiv?this.legendContainerDiv.call(r):e.call(r)},i.LegendHeight=70,i.LegendContainerClass="interactive-legend",i.LegendContainerSelector=".interactive-legend",i.LegendTitleClass="title",i.LegendItem="item",i.legendPlaceSelector="",i.legendIconClass="icon",i.legendColorCss="color",i.legendItemNameClass="itemName",i.legendItemMeasureClass="itemMeasure",i}();!function(e){function i(e,i){if(null==i[t.legendProps.show]&&(i[t.legendProps.show]=!0),i[t.legendProps.show]===!1&&(e.dataPoints=[]),i[t.legendProps.show]===!0&&null==i[t.legendProps.position]&&(i[t.legendProps.position]=t.legendPosition.top),void 0!==i[t.legendProps.fontSize]&&(e.fontSize=i[t.legendProps.fontSize]),void 0!==i[t.legendProps.labelColor]){var a=i[t.legendProps.labelColor];null!=a&&(e.labelColor=a.solid.color)}i[t.legendProps.showTitle]===!1?e.title="":void 0!==i[t.legendProps.titleText]&&(e.title=i[t.legendProps.titleText])}e.DefaultLegendLabelFillColor="#666666",e.update=i}(l=t.LegendData||(t.LegendData={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.linear="linear",t.log="log",t.type=e.createEnumType([{value:t.linear,displayName:function(e){return e.get("Visual_Axis_Linear")}},{value:t.log,displayName:function(e){return e.get("Visual_Axis_Log")}}])}(i=t.axisScale||(t.axisScale={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.showBoth="showBoth",t.showTitleOnly="showTitleOnly",t.showUnitOnly="showUnitOnly",t.type=e.createEnumType([{value:t.showTitleOnly,displayName:function(e){return e.get("Visual_Axis_ShowTitleOnly")}},{value:t.showUnitOnly,displayName:function(e){return e.get("Visual_Axis_ShowUnitOnly")}},{value:t.showBoth,displayName:function(e){return e.get("Visual_Axis_ShowBoth")}}])}(i=t.axisStyle||(t.axisStyle={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.scalar="Scalar",t.categorical="Categorical",t.both="Both",t.type=e.createEnumType([{value:t.scalar,displayName:function(e){return e.get("Visual_Axis_Scalar")}},{value:t.categorical,displayName:function(e){return e.get("Visual_Axis_Categorical")}}])}(i=t.axisType||(t.axisType={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.rectangle="rectangle",t.oval="oval",t.line="line",t.arrow="arrow",t.triangle="triangle",t.type=e.createEnumType([{value:t.rectangle,displayName:"rectangle"},{value:t.oval,displayName:"oval"},{value:t.line,displayName:"line"},{value:t.arrow,displayName:"arrow"},{value:t.triangle,displayName:"triangle"}])}(i=t.basicShapeType||(t.basicShapeType={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.normal="Normal",t.fit="Fit",t.fill="Fill",t.type=e.createEnumType([{value:t.normal,displayName:function(e){return e.get("Visual_ImageScalingType_Normal")}},{value:t.fit,displayName:function(e){return e.get("Visual_ImageScalingType_Fit")}},{value:t.fill,displayName:function(e){return e.get("Visual_ImageScalingType_Fill")}}])}(i=t.imageScalingType||(t.imageScalingType={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.insideEnd="InsideEnd",t.insideCenter="InsideCenter",t.outsideEnd="OutsideEnd",t.insideBase="InsideBase",t.type=e.createEnumType([{value:t.insideEnd,displayName:function(e){return e.get("Visual_LabelPosition_InsideEnd")}},{value:t.outsideEnd,displayName:function(e){return e.get("Visual_LabelPosition_OutsideEnd")}},{value:t.insideCenter,displayName:function(e){return e.get("Visual_LabelPosition_InsideCenter")}},{value:t.insideBase,displayName:function(e){return e.get("Visual_LabelPosition_InsideBase")}}])}(i=t.labelPosition||(t.labelPosition={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.category="Category",t.data="Data",t.both="Both",t.type=e.createEnumType([{value:t.category,displayName:function(e){return e.get("Visual_LabelStyle_Category")}},{value:t.data,displayName:function(e){return e.get("Visual_LabelStyle_DataValue")}},{value:t.both,displayName:function(e){return e.get("Visual_LabelStyle_Both")}}])}(i=t.labelStyle||(t.labelStyle={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.top="Top",t.bottom="Bottom",t.left="Left",t.right="Right",t.topCenter="TopCenter",t.bottomCenter="BottomCenter",t.leftCenter="LeftCenter",t.rightCenter="RightCenter",t.type=e.createEnumType([{value:t.top,displayName:function(e){return e.get("Visual_LegendPosition_Top")}},{value:t.bottom,displayName:function(e){return e.get("Visual_LegendPosition_Bottom")}},{value:t.left,displayName:function(e){return e.get("Visual_LegendPosition_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_LegendPosition_Right")}},{value:t.topCenter,displayName:function(e){return e.get("Visual_LegendPosition_TopCenter")}},{value:t.bottomCenter,displayName:function(e){return e.get("Visual_LegendPosition_BottomCenter")}},{value:t.leftCenter,displayName:function(e){return e.get("Visual_LegendPosition_LeftCenter")}},{value:t.rightCenter,displayName:function(e){return e.get("Visual_LegendPosition_RightCenter")}}])}(i=t.legendPosition||(t.legendPosition={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.positive="Positive",t.negative="Negative",t.type=e.createEnumType([{value:t.positive,displayName:function(e){return e.get("Visual_KPI_Direction_Positive")}},{value:t.negative,displayName:function(e){return e.get("Visual_KPI_Direction_Negative")}}])}(i=t.kpiDirection||(t.kpiDirection={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.dashed="dashed",t.solid="solid",t.dotted="dotted",t.type=e.createEnumType([{value:t.dashed,displayName:function(e){return e.get("Visual_LineStyle_Dashed")}},{value:t.solid,displayName:function(e){return e.get("Visual_LineStyle_Solid")}},{value:t.dotted,displayName:function(e){return e.get("Visual_LineStyle_Dotted")}}])}(i=t.lineStyle||(t.lineStyle={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(e){return[t.topOnly,t.topBottom,t.frame].some(function(t){return t===e})}function a(e){return[t.rightOnly,t.leftRight,t.frame].some(function(t){return t===e})}function r(e){return[t.bottomOnly,t.topBottom,t.frame].some(function(t){return t===e})}function o(e){return[t.leftOnly,t.leftRight,t.frame].some(function(t){return t===e})}t.none="None",t.bottomOnly="BottomOnly",t.topOnly="TopOnly",t.leftOnly="LeftOnly",t.rightOnly="RightOnly",t.topBottom="TopBottom",t.leftRight="LeftRight",t.frame="Frame",t.showTop=i,t.showRight=a,t.showBottom=r,t.showLeft=o,t.type=e.createEnumType([{value:t.none,displayName:function(e){return e.get("Visual_Outline_none")}},{value:t.bottomOnly,displayName:function(e){return e.get("Visual_Outline_bottom_only")}},{value:t.topOnly,displayName:function(e){return e.get("Visual_Outline_top_only")}},{value:t.leftOnly,displayName:function(e){return e.get("Visual_Outline_LeftOnly")}},{value:t.rightOnly,displayName:function(e){return e.get("Visual_Outline_RightOnly")}},{value:t.topBottom,displayName:function(e){return e.get("Visual_Outline_top_Bottom")}},{value:t.leftRight,displayName:function(e){return e.get("Visual_Outline_leftRight")}},{value:t.frame,displayName:function(e){return e.get("Visual_Outline_frame")}}])}(i=t.outline||(t.outline={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.back="back",t.front="front",t.type=e.createEnumType([{value:t.back,displayName:function(e){return e.get("Visual_Reference_Line_Behind")}},{value:t.front,displayName:function(e){return e.get("Visual_Reference_Line_InFront")}}])}(i=t.referenceLinePosition||(t.referenceLinePosition={}));var a;!function(t){t.left="left",t.right="right",t.type=e.createEnumType([{value:t.left,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Right")}}])}(a=t.referenceLineDataLabelHorizontalPosition||(t.referenceLineDataLabelHorizontalPosition={}));var r;!function(t){t.above="above",t.under="under",t.type=e.createEnumType([{value:t.above,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Above")}},{value:t.under,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Under")}}])}(r=t.referenceLineDataLabelVerticalPosition||(t.referenceLineDataLabelVerticalPosition={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.type=e.createEnumType([{value:0,displayName:function(e){return e.get("Slicer_Orientation_Vertical")}},{value:1,displayName:function(e){return e.get("Slicer_Orientation_Horizontal")}}])}(i=t.slicerOrientation||(t.slicerOrientation={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.left="Left",t.right="Right",t.type=e.createEnumType([{value:t.left,displayName:function(e){return e.get("Visual_yAxis_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_yAxis_Right")}}])}(i=t.yAxisPosition||(t.yAxisPosition={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return t||!e?0:e.getDuration()}e.MinervaAnimationDuration=250,e.MaxDataPointsToAnimate=1e3,e.GetAnimationDuration=t}(t=e.AnimatorCommon||(e.AnimatorCommon={}));var i=function(){function e(e){e&&e.duration&&(this.animationDuration=e.duration),this.animationDuration=this.animationDuration>=0?this.animationDuration:t.MinervaAnimationDuration}return e.prototype.getDuration=function(){return this.animationDuration},e.prototype.animate=function(e){return null},e.prototype.getEasing=function(){return"cubic-in-out"},e}();e.BaseAnimator=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(t){var i={failed:!0,shapes:null},a=t.viewModel,r=this.previousViewModel,o=a.categories.length*a.series.length;return o>e.AnimatorCommon.MaxDataPointsToAnimate?i:(r&&(a.hasHighlights&&!r.hasHighlights?i=this.animateNormalToHighlighted(t):a.hasHighlights&&r.hasHighlights?i=this.animateHighlightedToHighlighted(t):!a.hasHighlights&&r.hasHighlights&&(i=this.animateHighlightedToNormal(t))),this.previousViewModel=a,i)},i.prototype.animateNormalToHighlighted=function(t){var i=t.viewModel,a=t.itemCS,r=t.series.selectAll(a.selector),o=r.data(function(e){return e.data},function(e){return e.key}),n=i.hasHighlights;return o.enter().append("rect").attr("class",function(e){return a["class"].concat(e.highlight?" highlight":"")}).attr(t.layout.shapeLayoutWithoutHighlights),o.style("fill",function(e){return e.color}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,!1,n)}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout),o.exit().remove(),{failed:!1,shapes:o}},i.prototype.animateHighlightedToHighlighted=function(e){var t=this.animateDefaultShapes(e.viewModel,e.series,e.layout,e.itemCS);return{failed:!1,shapes:t}},i.prototype.animateHighlightedToNormal=function(t){var i=t.itemCS,a=t.series.selectAll(i.selector),r=a.data(function(e){return e.data},function(e){return e.key}),o=t.interactivityService&&t.interactivityService.hasSelection();return r.enter().append("rect").attr("class",function(e){return i["class"].concat(e.highlight?" highlight":"")}),r.style("fill",function(e){return e.color}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,t.selected,!t.selected)}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,o,!1)}),r.exit().transition().duration(this.animationDuration).attr(o?t.layout.zeroShapeLayout:t.layout.shapeLayoutWithoutHighlights).remove(),{failed:!1,shapes:r}},i.prototype.animateDefaultShapes=function(t,i,a,r){var o=i.selectAll(r.selector),n=o.data(function(e){return e.data},function(e){return e.key});return n.enter().append("rect").attr("class",function(e){return r["class"].concat(e.highlight?" highlight":"")}),n.style("fill",function(e){return e.color}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,!1,t.hasHighlights)}).transition().duration(this.animationDuration).attr(a.shapeLayout),n.exit().remove(),n},i}(e.BaseAnimator);e.WebColumnChartAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){
return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return a.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio})),a.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)}).style("stroke-dasharray",function(i){return e.DonutChart.drawStrokeForDonutChart(t.radius,t.innerArcRadiusRatio,i,t.sliceWidthRatio,i.data.highlightRatio)}).style("stroke-width",function(e){return e.data.strokeWidth}).attr(t.layout.shapeLayout).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),a.exit().remove(),e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=this.animateDefaultHighlightShapes(t);return e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToNormal=function(t){var i=t.interactivityService&&t.interactivityService.hasSelection(),a=this.animationDuration,r=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,function(e){return e.data.identity.getKey()});r.enter().insert("path").classed("slice",!0).each(function(e){this._current=e}),e.DonutChart.isSingleColor(t.viewModel.dataPoints),r.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,t.data.selected,!t.data.selected)}).style("stroke-dasharray",function(i){return e.DonutChart.drawStrokeForDonutChart(t.radius,t.innerArcRadiusRatio,i,t.sliceWidthRatio)}).style("stroke-width",function(e){return e.data.strokeWidth}).transition().duration(a).attr(t.layout.shapeLayout).transition().duration(0).delay(a).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,i,!1)}),r.exit().remove();var o=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return o.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio})),o.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(!1,!0,!1,!0)}).style("stroke-dasharray",function(i){return e.DonutChart.drawStrokeForDonutChart(t.radius,t.innerArcRadiusRatio,i,t.sliceWidthRatio,i.data.highlightRatio)}).style("stroke-width",function(e){return e.data.strokeWidth}).transition().duration(a).attr(i?t.layout.zeroShapeLayout:t.layout.shapeLayout).remove(),o.exit().remove(),e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:r,highlightShapes:o}},i.prototype.animateDefaultShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,function(e){return e.data.identity.getKey()});return i.enter().insert("path").classed("slice",!0).each(function(e){this._current=e}),e.DonutChart.isSingleColor(t.viewModel.dataPoints),i.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,t.viewModel.hasHighlights)}).style("stroke-dasharray",function(i){return e.DonutChart.drawStrokeForDonutChart(t.radius,t.innerArcRadiusRatio,i,t.sliceWidthRatio)}).style("stroke-width",function(e){return e.data.strokeWidth}).transition().duration(this.animationDuration).attr(t.layout.shapeLayout),i.exit().remove(),i},i.prototype.animateDefaultHighlightShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return i.enter().insert("path").classed("slice-highlight",!0).each(function(e){this._current=e}),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter(function(e){return null!=e.data.highlightRatio})),i.style("fill",function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value}).style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)}).style("stroke-dasharray",function(i){return e.DonutChart.drawStrokeForDonutChart(t.radius,t.innerArcRadiusRatio,i,t.sliceWidthRatio,i.data.highlightRatio)}).style("stroke-width",function(e){return e.data.strokeWidth}).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),i.exit().remove(),i},i}(e.BaseAnimator);e.WebDonutChartAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(i){function a(e){i.call(this,e)}return __extends(a,i),a.prototype.animate=function(e){var t={failed:!0,shapes:null,dataLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},a.prototype.animateNormalToHighlighted=function(e){var i=e.viewModel,a=e.layout,r=!0,o=!1;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var n=e.shapeGraphicsContext.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i.slices,function(e){return e.key});n.enter().append("rect").attr("class",function(e){return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars["class"]}).attr(a.shapeLayoutWithoutHighlights),n.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,o,r)}).transition().duration(this.animationDuration).attr(a.shapeLayout),n.exit().remove(),this.animatePercentBars(e);var s=this.animateDefaultDataLabels(e);return{failed:!1,shapes:n,dataLabels:s}},a.prototype.animateHighlightedToHighlighted=function(e){var t=e.viewModel,i=e.layout;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var a=this.animateDefaultShapes(t,t.slices,e.shapeGraphicsContext,i);this.animatePercentBars(e);var r=this.animateDefaultDataLabels(e);return{failed:!1,shapes:a,dataLabels:r}},a.prototype.animateHighlightedToNormal=function(e){var i=e.viewModel,a=e.layout,r=e.interactivityService?e.interactivityService.hasSelection():!1;this.animateDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var o=e.shapeGraphicsContext.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i.slices,function(e){return e.key});o.enter().append("rect").attr("class",function(e){return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars["class"]}),o.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!e.selected)}).transition().duration(this.animationDuration).attr(a.shapeLayoutWithoutHighlights).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!1)});var n=o.exit();n.transition().duration(this.animationDuration).attr(r?a.zeroShapeLayout:a.shapeLayoutWithoutHighlights).remove(),this.animatePercentBars(e);var s=this.animateDefaultDataLabels(e);return{failed:!1,shapes:o,dataLabels:s}},a.prototype.animateDefaultAxis=function(e,i,a){var r=d3.scale.ordinal().domain(i.categoryLabels).rangeBands([i.rangeStart,i.rangeEnd],i.barToSpaceRatio,a?i.barToSpaceRatio:t.FunnelChart.PercentBarToBarRatio),o=d3.svg.axis().scale(r).orient("right").tickPadding(t.FunnelChart.TickPadding).innerTickSize(t.FunnelChart.InnerTickSize);e.classed("axis",!0).transition().duration(this.animationDuration).attr("transform",t.SVGUtil.translate(0,i.margin.top)).call(o)},a.prototype.animateDefaultShapes=function(e,i,a,r){var o=e.hasHighlights,n=a.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i,function(e){return e.key});return n.enter().append("rect").attr("class",function(e){return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars["class"]}),n.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!1,o)}}).transition().duration(this.animationDuration).attr(r.shapeLayout),n.exit().remove(),n},a.prototype.animateDefaultDataLabels=function(e){var i;return e.viewModel.dataLabelsSettings.show&&e.viewModel.canShowDataLabels?i=t.dataLabelUtils.drawDefaultLabelsForFunnelChart(e.viewModel.slices,e.labelGraphicsContext,e.labelLayout,!0,this.animationDuration):t.dataLabelUtils.cleanDataLabels(e.labelGraphicsContext),i},a.prototype.animatePercentBars=function(e){var i=e.viewModel,a=e.isHidingPercentBars;if(a||!i.slices||(i.hasHighlights?i.slices.length/2:i.slices.length)<2)return void this.animatePercentBarComponents([],e);var r=[i.slices[i.hasHighlights?1:0],i.slices[i.slices.length-1]],o=t.FunnelChart.getFunnelSliceValue(r[0]);if(0>=o)return void this.animatePercentBarComponents([],e);var n=r.map(function(e,i){return{value:t.FunnelChart.getFunnelSliceValue(e),percent:0===i?1:t.FunnelChart.getFunnelSliceValue(e)/o,isTop:0===i}});this.animatePercentBarComponents(n,e)},a.prototype.animateToFunnelPercent=function(e,t,i){return e.data(t).transition().duration(this.animationDuration).attr(i)},a.prototype.animatePercentBarComponents=function(i,a){var r=a.percentGraphicsContext,o=a.layout,n=[{percent:0,value:0,isTop:!0},{percent:0,value:0,isTop:!1}],s=r.selectAll(t.FunnelChart.Selectors.percentBar.mainLine.selector).data(i);this.animateToFunnelPercent(s.exit(),n,o.percentBarLayout.mainLine).remove(),s.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.mainLine["class"],!0).data(n).attr(o.percentBarLayout.mainLine),this.animateToFunnelPercent(s,i,o.percentBarLayout.mainLine);var l=r.selectAll(t.FunnelChart.Selectors.percentBar.leftTick.selector).data(i);this.animateToFunnelPercent(l.exit(),n,o.percentBarLayout.leftTick).remove(),l.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.leftTick["class"],!0).data(n).attr(o.percentBarLayout.leftTick),this.animateToFunnelPercent(l,i,o.percentBarLayout.leftTick);var c=r.selectAll(t.FunnelChart.Selectors.percentBar.rightTick.selector).data(i);this.animateToFunnelPercent(c.exit(),n,o.percentBarLayout.rightTick).remove(),c.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.rightTick["class"],!0).data(n).attr(o.percentBarLayout.rightTick),this.animateToFunnelPercent(c,i,o.percentBarLayout.rightTick);var u=r.selectAll(t.FunnelChart.Selectors.percentBar.text.selector).data(i);this.animateToFunnelPercent(u.exit(),n,o.percentBarLayout.text).remove(),u.enter().append("text").classed(t.FunnelChart.Selectors.percentBar.text["class"],!0).data(n).attr(o.percentBarLayout.text),this.animateToFunnelPercent(u,i,o.percentBarLayout.text).text(function(i){return e.formattingService.formatValue(i.percent,t.valueFormatter.getLocalizedString("Percentage1"))}),t.SVGUtil.flushAllD3TransitionsIfNeeded(a.visualInitOptions)},a}(t.BaseAnimator);t.WebFunnelAnimator=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null,majorLabels:null,minorLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a,t.layout),o=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,function(e){return e.key+"highlight"});o.enter().append("rect").attr("class",t.layout.highlightShapeClass).attr(t.layout.shapeLayout),o.style("fill",function(t){return e.Treemap.getFill(t,!0)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,i,a,!0)}).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),o.exit().remove();var n=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),s=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:r,highlightShapes:o,majorLabels:n,minorLabels:s}},i.prototype.animateHighlightedToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a,t.layout);t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,function(e){return e.key+"highlight"});var o=this.animateDefaultHighlightShapes(t.shapeGraphicsContext,t.highlightNodes,i,a,t.layout),n=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),s=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:r,highlightShapes:o,majorLabels:n,minorLabels:s}},i.prototype.animateHighlightedToNormal=function(t){var i=t.interactivityService?t.interactivityService.hasSelection():!1,a=t.shapeGraphicsContext.selectAll("."+e.Treemap.TreemapNodeClassName).data(t.nodes,function(e){return e.key});a.enter().append("rect").attr("class",t.layout.shapeClass),a.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,!1)}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,t.selected,!t.selected)}).attr(t.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,i,!1)}),a.exit().remove();var r=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.nodes,function(e){return e.key+"highlight"});r.enter().append("rect").attr("class",t.layout.highlightShapeClass),r.style("fill",function(t){return e.Treemap.getFill(t,!0)}).style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.selected,!0,t.selected,!t.selected)}).transition().duration(this.animationDuration).attr(i?t.layout.zeroShapeLayout:t.layout.shapeLayout).remove(),r.exit().remove();var o=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),n=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:a,highlightShapes:r,majorLabels:o,minorLabels:n}},i.prototype.animateDefaultShapes=function(t,i,a,r,o){var n=!1,s=t.selectAll("."+e.Treemap.TreemapNodeClassName).data(i,function(e){return e.key});return s.enter().append("rect").attr("class",o.shapeClass),s.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,n)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,a,r,n)}).attr(o.shapeLayout),s.exit().remove(),s},i.prototype.animateDefaultHighlightShapes=function(t,i,a,r,o){var n=!0,s=t.selectAll("."+e.Treemap.HighlightNodeClassName).data(i,function(e){return e.key+"highlight"});return s.enter().append("rect").attr("class",o.highlightShapeClass),s.transition().duration(this.animationDuration).style("fill",function(t){return e.Treemap.getFill(t,n)}).style("fill-opacity",function(t){return e.Treemap.getFillOpacity(t,a,r,n)}).attr(o.highlightShapeLayout),s.exit().remove(),s},i.prototype.animateDefaultMajorLabels=function(t,i,a,r){var o=t.selectAll("."+e.Treemap.MajorLabelClassName).data(i,function(e){return e.key});return o.enter().append("text").attr("class",r.majorLabelClass),o.text(r.majorLabelText).style("fill",function(){return a.labelColor}).transition().duration(this.animationDuration).attr(r.majorLabelLayout),o.exit().remove(),o},i.prototype.animateDefaultMinorLabels=function(t,i,a,r){var o=t.selectAll("."+e.Treemap.MinorLabelClassName).data(i,function(e){return e.key});return o.enter().append("text").attr("class",r.minorLabelClass),o.text(r.minorLabelText).style("fill",function(){return a.labelColor}).transition().duration(this.animationDuration).attr(r.minorLabelLayout),o.exit().remove(),o},i}(e.BaseAnimator);e.WebTreemapAnimator=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.StandardObjectProperties={axisEnd:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),description:e.data.createDisplayNameGetter("Visual_Axis_EndDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0},suppressFormatPainterCopy:!0},axisScale:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Scale"),type:{enumeration:t.axisScale.type}},axisStart:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),description:e.data.createDisplayNameGetter("Visual_Axis_StartDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0},suppressFormatPainterCopy:!0},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{enumeration:t.axisStyle.type}},axisType:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Type"),type:{enumeration:t.axisType.type}},backColor:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColor"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColor_Desc"),type:{fill:{solid:{color:!0}}}},dataColor:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),description:e.data.createDisplayNameGetter("Visual_LabelsFillDescription"),type:{fill:{solid:{color:!0}}}},dataLabelColor:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Color"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Color_Description"),type:{fill:{solid:{color:!0}}}},dataLabelDecimalPoints:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Decimal_Points"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},dataLabelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}},suppressFormatPainterCopy:!0},dataLabelHorizontalPosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Horizontal_Position"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Horizontal_Position_Description"),type:{enumeration:t.referenceLineDataLabelHorizontalPosition.type}},dataLabelShow:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Show_Description"),type:{bool:!0}},dataLabelVerticalPosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Vertical_Position"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Vertical_Position_Description"),type:{enumeration:t.referenceLineDataLabelVerticalPosition.type}},defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fontColor:{displayName:e.data.createDisplayNameGetter("Visual_FontColor"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColor_Desc"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{formatting:{fontSize:!0}}},formatString:{type:{formatting:{formatString:!0}}},image:{type:{image:{}}},labelColor:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleColor"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),description:e.data.createDisplayNameGetter("Visual_PrecisionDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},legendPosition:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),description:e.data.createDisplayNameGetter("Visual_LegendPositionDescription"),type:{enumeration:t.legendPosition.type}},legendTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendName"),description:e.data.createDisplayNameGetter("Visual_LegendNameDescription"),type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},outline:{displayName:e.data.createDisplayNameGetter("Visual_Outline"),type:{enumeration:t.outline.type}},outlineColor:{displayName:e.data.createDisplayNameGetter("Visual_OutlineColor"),description:e.data.createDisplayNameGetter("Visual_OutlineColor_Desc"),type:{fill:{solid:{color:!0}}}},outlineWeight:{displayName:e.data.createDisplayNameGetter("Visual_OutlineWeight"),description:e.data.createDisplayNameGetter("Visual_OutlineWeight_Desc"),type:{numeric:!0}},show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},showLegendTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),description:e.data.createDisplayNameGetter("Visual_LegendShowTitleDescription"),type:{bool:!0}},referenceLinePosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Arrange"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Arrange_Description"),type:{enumeration:t.referenceLinePosition.type}},referenceLineStyle:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Background_Transparency"),description:e.data.createDisplayNameGetter("Visual_Background_TransparencyDescription"),type:{numeric:!0}},yAxisPosition:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),description:e.data.createDisplayNameGetter("Visual_YAxis_PositionDescription"),type:{enumeration:t.yAxisPosition.type}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.animatedTextObjectDescs={general:{properties:{formatString:e.StandardObjectProperties.formatString}}},e.animatedNumberCapabilities={objects:e.animatedTextObjectDescs,dataViewMappings:[{single:{role:"Values"}}],supportsSelection:!1}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.basicShapeCapabilities={objects:{line:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Line"),properties:{lineColor:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_LineColor"),type:{fill:{solid:{color:!0}}}},transparency:t.StandardObjectProperties.transparency,weight:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Weight"),type:{numeric:!0}},roundEdge:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_RoundEdges"),type:{numeric:!0}}}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),properties:{show:t.StandardObjectProperties.show,fillColor:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_FillColor"),type:{fill:{solid:{color:!0}}}},transparency:t.StandardObjectProperties.transparency}},rotation:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Rotate"),properties:{angle:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Rotate"),type:{numeric:!0}}}},general:{properties:{shapeType:{type:{text:!0},suppressFormatPainterCopy:!0}}}},suppressDefaultTitle:!0,suppressDefaultPadding:!0,canRotate:!1,supportsSelection:!1},t.basicShapeProps={general:{shapeType:{objectName:"general",propertyName:"shapeType"}},line:{transparency:{objectName:"line",propertyName:"transparency"},weight:{objectName:"line",propertyName:"weight"},roundEdge:{objectName:"line",propertyName:"roundEdge"},lineColor:{objectName:"line",propertyName:"lineColor"}},fill:{transparency:{objectName:"fill",propertyName:"transparency"},fillColor:{objectName:"fill",propertyName:"fillColor"},show:{objectName:"fill",propertyName:"show"}},rotation:{angle:{objectName:"rotation",propertyName:"angle"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(i){return void 0===i&&(i=!1),{dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:i?e.data.createDisplayNameGetter("Visual_YAxis"):e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:i?e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"):e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},valueAxis:{displayName:i?e.data.createDisplayNameGetter("Visual_XAxis"):e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,intersection:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Intersection"),type:{numeric:!0},placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto")},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:i?e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"):e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),properties:{show:{type:{bool:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),
type:{bool:!0}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,showSeries:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),showAll:{displayName:e.data.createDisplayNameGetter("Visual_LabelSeriesShowAll"),type:{bool:!0}},fontSize:t.StandardObjectProperties.fontSize}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0},Gradient:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},Y:{min:0,max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0},Gradient:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},Y:{min:0,max:1},Gradient:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{"for":{"in":"regression.X"}},values:{group:{by:"regression.Series",select:[{"for":{"in":"regression.Y"}}]}}}}],supportsHighlight:!0,sorting:{"default":{}},drilldown:{roles:["Category"]}}}t.getColumnChartCapabilities=i,t.columnChartProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},general:{formatString:{objectName:"general",propertyName:"formatString"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.comboChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Category"),description:e.data.createDisplayNameGetter("Role_ComboChart_CategoryDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Series")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y"),description:e.data.createDisplayNameGetter("Role_ComboChart_YDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Y2",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y2"),description:e.data.createDisplayNameGetter("Role_ComboChart_Y2Description"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString,visualType1:{type:{text:!0}},visualType2:{type:{text:!0}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,axisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ColumnTitle"),type:{none:!0}},position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,secShow:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ShowSecondary"),type:{bool:!0}},secAxisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_LineTitle"),type:{none:!0}},secPosition:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{enumeration:t.yAxisPosition.type}},secAxisScale:t.StandardObjectProperties.axisScale,secStart:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),description:e.data.createDisplayNameGetter("Visual_Axis_StartDescription"),type:{numeric:!0}},secEnd:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),description:e.data.createDisplayNameGetter("Visual_Axis_EndDescription"),type:{numeric:!0}},secShowAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},secAxisStyle:t.StandardObjectProperties.axisStyle,secLabelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,secLabelPrecision:t.StandardObjectProperties.labelPrecision}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:$.extend({},t.StandardObjectProperties.defaultColor,{displayName:e.data.createDisplayNameGetter("Visual_DefaultColumnColor")}),showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),properties:{show:{type:{bool:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0},Y2:{min:1}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Y2:{min:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{"for":{"in":"Y2"}}]},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{"for":{"in":"regression.X"}},values:{group:{by:"regression.Series",select:[{"for":{"in":"regression.Y"}}]}}}}],supportsHighlight:!0,sorting:{"default":{}},drilldown:{roles:["Category"]}},t.comboChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},valueAxis:{secShow:{objectName:"valueAxis",propertyName:"secShow"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},dataPoint:{showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.donutChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details"),description:e.data.createDisplayNameGetter("Role_DisplayName_DetailsDonutChartDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DetailLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:$.extend({},t.StandardObjectProperties.fontSize,{suppressFormatPainterCopy:!0}),labelStyle:{displayName:e.data.createDisplayNameGetter("Visual_LabelStyle"),type:{enumeration:t.labelStyle.type}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Y"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:1}}}}],sorting:{"default":{}},supportsHighlight:!0,drilldown:{roles:["Category"]}},t.donutChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.dataDotChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{"for":{"in":"Y"},dataReductionAlgorithm:{top:{}}}]}}}]}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.filledMapCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),description:e.data.createDisplayNameGetter("Role_DisplayName_LocationFilledMapDescription"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LatitudeFilledMapDescription"),preferredTypes:[{geography:{latitude:!0}}]},{name:"X",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LongitudeFilledMapDescription"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),type:{fillRule:{}},rule:{inputRole:"Size",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Size",direction:2}]}},drilldown:{roles:["Category"]}},t.filledMapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}},labels:{show:{objectName:"labels",propertyName:"show"},color:{objectName:"labels",propertyName:"color"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.funnelChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group"),description:e.data.createDisplayNameGetter("Role_DisplayName_GroupFunnelDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],dataViewMappings:[{conditions:[{Category:{max:0},Gradient:{max:0}},{Category:{max:1},Y:{max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{"for":{"in":"Y"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}},rowCount:{preferred:{min:1}}}}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelPosition:{displayName:e.data.createDisplayNameGetter("Visual_Position"),type:{enumeration:t.labelPosition.type},suppressFormatPainterCopy:!0},labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize}},percentBarLabel:{displayName:e.data.createDisplayNameGetter("Visual_PercentBarLabel"),description:e.data.createDisplayNameGetter("Visual_PercentBarLabelDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}}},supportsHighlight:!0,sorting:{"default":{}},drilldown:{roles:["Category"]}},t.funnelChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.gaugeRoleNames={y:"Y",minValue:"MinValue",maxValue:"MaxValue",targetValue:"TargetValue"},t.gaugeCapabilities={dataRoles:[{name:t.gaugeRoleNames.y,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.minValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MinValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_MinValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.maxValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MaxValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_MaxValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.targetValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_TargetValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_TargetValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},axis:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis"),properties:{min:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Min"),type:{numeric:!0}},max:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Max"),type:{numeric:!0}},target:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Target"),type:{numeric:!0}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,fontSize:t.StandardObjectProperties.fontSize}},calloutValue:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_CalloutValue"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:t.StandardObjectProperties.fill,target:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Target"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{conditions:[{Y:{max:1},MinValue:{max:1},MaxValue:{max:1},TargetValue:{max:1}}],categorical:{values:{select:[{bind:{to:"Y"}},{bind:{to:"MinValue"}},{bind:{to:"MaxValue"}},{bind:{to:"TargetValue"}}]}}}],supportsSelection:!1},t.gaugeProps={dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"},target:{objectName:"dataPoint",propertyName:"target"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.imageVisualCapabilities={objects:{general:{properties:{imageUrl:{type:{misc:{imageUrl:!0}}}}},imageScaling:{displayName:e.data.createDisplayNameGetter("Visual_Image_Scaling_Type"),properties:{imageScalingType:{displayName:e.data.createDisplayNameGetter("Visual_Image_Scaling_Type"),type:{enumeration:t.imageScalingType.type}}}}},suppressDefaultTitle:!0,supportsSelection:!1}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.scriptVisualCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],dataViewMappings:[{scriptResult:{dataInput:{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{top:{}}}}},script:{source:{objectName:"script",propertyName:"source"},provider:{objectName:"script",propertyName:"provider"}}}}],objects:{script:{properties:{provider:{type:{text:!0}},source:{type:{scripting:{source:!0}}}}}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.consoleWriterCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YDescription")}],dataViewMappings:[{categorical:{categories:{"for":{"in":"Category"}}}}]}}(i=t.samples||(t.samples={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.converter=function(e){return window.console.log("converter"),window.console.log(e),{}},e.prototype.init=function(e){var t=d3.select(e.element.get(0)).append("div");t.append("h1").text("ConsoleWriter"),t.append("p").text("This IVisual writes messages passed to it to the javscript console output. Check your console for the actual messages passed. For more information, click below");var i=t.append("a");i.attr("href","http://microsoft.github.io/PowerBI-visuals/modules/powerbi.html").text("Online help"),window.console.log("init"),window.console.log(e)},e.prototype.onResizing=function(e){},e.prototype.update=function(e){window.console.log("update"),window.console.log(e)},e}();e.ConsoleWriter=t}(t=e.samples||(e.samples={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.lineChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),properties:{show:t.StandardObjectProperties.show,lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),type:{bool:!0}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,
position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,showSeries:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),showAll:{displayName:e.data.createDisplayNameGetter("Visual_LabelSeriesShowAll"),type:{bool:!0}},fontSize:t.StandardObjectProperties.fontSize,labelDensity:{displayName:e.data.createDisplayNameGetter("Visual_LabelDensity"),type:{formatting:{labelDensity:!0}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{"for":{"in":"Y"}}],dataReductionAlgorithm:{top:{}}}}}},{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{"for":{"in":"regression.X"}},values:{group:{by:"regression.Series",select:[{"for":{"in":"regression.Y"}}]}}}}],sorting:{"default":{}}},t.lineChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},trend:{show:{objectName:"trend",propertyName:"show"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},labels:{labelDensity:{objectName:"labels",propertyName:"labelDensity"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.mapCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),description:e.data.createDisplayNameGetter("Role_DisplayName_LocationMapDescription"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LatitudeMapDescription"),preferredTypes:[{geography:{latitude:!0}}]},{name:"X",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LongitudeMapDescription"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Size"),description:e.data.createDisplayNameGetter("Role_DisplayName_SizeDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}}},dataViewMappings:[{conditions:[{Category:{min:1,max:1},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:0}},{Category:{min:1,max:1},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}},{conditions:[{Category:{max:0},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:0}},{Category:{max:0},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{select:[{bind:{to:"X"}},{bind:{to:"Y"}}],dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Size"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Size",direction:2}]}},drilldown:{roles:["Category"]}},t.mapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.multiRowCardCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldsDescription")}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},cardTitle:{displayName:e.data.createDisplayNameGetter("Visual_CardTitle"),description:e.data.createDisplayNameGetter("Visual_CardTitleDescription"),properties:{color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},dataLabels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},card:{displayName:e.data.createDisplayNameGetter("Card_ToolTip"),properties:{outline:{displayName:e.data.createDisplayNameGetter("Visual_Outline"),type:{enumeration:t.outline.type}},outlineColor:{displayName:e.data.createDisplayNameGetter("Visual_OutlineColor"),description:e.data.createDisplayNameGetter("Visual_OutlineColor_Desc"),type:{fill:{solid:{color:!0}}}},outlineWeight:{displayName:e.data.createDisplayNameGetter("Visual_OutlineWeight"),description:e.data.createDisplayNameGetter("Visual_OutlineWeight_Desc"),type:{numeric:!0}},barShow:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarShow"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarShow_Desc"),type:{bool:!0}},barColor:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarColor"),type:{fill:{solid:{color:!0}}}},barWeight:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarWeight"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarWeight_Desc"),type:{numeric:!0}},cardPadding:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_CardPadding"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_CardBackground"),type:{numeric:!0}},cardBackground:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{}}},rowCount:{preferred:{min:1}}}}],sorting:{"default":{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0},t.multiRowCardProps={card:{outline:{objectName:"card",propertyName:"outline"},outlineColor:{objectName:"card",propertyName:"outlineColor"},outlineWeight:{objectName:"card",propertyName:"outlineWeight"},barShow:{objectName:"card",propertyName:"barShow"},barColor:{objectName:"card",propertyName:"barColor"},barWeight:{objectName:"card",propertyName:"barWeight"},cardPadding:{objectName:"card",propertyName:"cardPadding"},cardBackground:{objectName:"card",propertyName:"cardBackground"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.textboxCapabilities={objects:{general:{properties:{paragraphs:{type:{paragraphs:{}},suppressFormatPainterCopy:!0}}}},suppressDefaultTitle:!0,supportsSelection:!1}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.cheerMeterCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,requiredTypes:[{numeric:!0},{integer:!0}],displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YDescription")}],dataViewMappings:[{categorical:{categories:{"for":{"in":"Category"}}}}],dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:t.StandardObjectProperties.fill}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.scatterChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details"),description:e.data.createDisplayNameGetter("Role_DisplayName_DetailsScatterChartDescription")},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"X",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_X"),description:e.data.createDisplayNameGetter("Role_DisplayName_XScatterChartDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:0},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YScatterChartDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Size"),description:e.data.createDisplayNameGetter("Role_DisplayName_SizeDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Play",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Play")}],objects:{dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),properties:{show:t.StandardObjectProperties.show,lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},xAxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_X"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Y"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},colorBorder:{displayName:e.data.createDisplayNameGetter("Visual_ColorBorder"),properties:{show:t.StandardObjectProperties.show}},fillPoint:{displayName:e.data.createDisplayNameGetter("Visual_FillPoint"),properties:{show:t.StandardObjectProperties.show}},colorByCategory:{displayName:e.data.createDisplayNameGetter("Visual_ColorByCategory"),properties:{show:t.StandardObjectProperties.show}},currentFrameIndex:{properties:{index:{type:{numeric:!0}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0},Play:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:1},Play:{max:0}}],categorical:{categories:{"for":{"in":"Category"}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}}]}},rowCount:{preferred:{min:2}},dataReductionAlgorithm:{sample:{}},dataVolume:4}},{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0},Play:{min:1,max:1}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:1},Play:{min:1,max:1}}],matrix:{rows:{select:[{bind:{to:"Play"}},{bind:{to:"Category"}}],dataReductionAlgorithm:{bottom:{count:5e3}}},columns:{"for":{"in":"Series"},dataReductionAlgorithm:{top:{count:60}}},values:{select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}}]}}},{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:0},Gradient:{max:0},Play:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:0},Gradient:{max:1},Play:{max:0}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{"for":{"in":"regression.X"}},values:{group:{by:"regression.Series",select:[{"for":{"in":"regression.Y"}}]}},dataReductionAlgorithm:{sample:{}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Play",direction:1}]}},drilldown:{roles:["Category"]}},t.scatterChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},trend:{show:{objectName:"trend",propertyName:"show"}},colorBorder:{show:{objectName:"colorBorder",propertyName:"show"}},fillPoint:{show:{objectName:"fillPoint",propertyName:"show"}},colorByCategory:{show:{objectName:"colorByCategory",propertyName:"show"}},currentFrameIndex:{index:{objectName:"currentFrameIndex",propertyName:"index"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.slicerCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Field"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldDescription")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{filter:{type:{filter:{}}},selfFilter:{type:{filter:{}}},defaultValue:{type:{expression:{defaultValue:!0}}},formatString:t.StandardObjectProperties.formatString,outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,orientation:{displayName:e.data.createDisplayNameGetter("Slicer_Orientation"),type:{enumeration:t.slicerOrientation.type}},count:{type:{integer:!0}},selfFilterEnabled:{type:{bool:!0}}}},selection:{displayName:e.data.createDisplayNameGetter("Visual_SelectionControls"),properties:{selectAllCheckboxEnabled:{displayName:e.data.createDisplayNameGetter("Visual_SelectAll"),type:{bool:!0}},singleSelect:{displayName:e.data.createDisplayNameGetter("Visual_SingleSelect"),type:{bool:!0}}}},header:{displayName:e.data.createDisplayNameGetter("Visual_Header"),properties:{show:t.StandardObjectProperties.show,fontColor:t.StandardObjectProperties.fontColor,background:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}},outline:t.StandardObjectProperties.outline,textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},items:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Items"),properties:{fontColor:t.StandardObjectProperties.fontColor,background:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}},outline:t.StandardObjectProperties.outline,textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Values:{max:1}}],categorical:{categories:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{}}},includeEmptyGroups:!0}}],sorting:{"default":{}},suppressDefaultTitle:!0,disableVisualDetails:!0},t.slicerProps={general:{outlineColor:{objectName:"general",propertyName:"outlineColor"},outlineWeight:{objectName:"general",propertyName:"outlineWeight"},orientation:{objectName:"general",propertyName:"orientation"},count:{objectName:"general",propertyName:"count"},selfFilterEnabled:{objectName:"general",propertyName:"selfFilterEnabled"}},selection:{selectAllCheckboxEnabled:{objectName:"selection",propertyName:"selectAllCheckboxEnabled"},singleSelect:{objectName:"selection",propertyName:"singleSelect"}},header:{show:{objectName:"header",propertyName:"show"},fontColor:{objectName:"header",propertyName:"fontColor"},background:{objectName:"header",propertyName:"background"},outline:{objectName:"header",propertyName:"outline"},textSize:{objectName:"header",propertyName:"textSize"}},items:{fontColor:{objectName:"items",propertyName:"fontColor"},background:{objectName:"items",propertyName:"background"},outline:{objectName:"items",propertyName:"outline"},textSize:{objectName:"items",propertyName:"textSize"}},selectedPropertyIdentifier:{objectName:"general",propertyName:"selected"},filterPropertyIdentifier:{objectName:"general",propertyName:"filter"},selfFilterPropertyIdentifier:{objectName:"general",propertyName:"filter"},formatString:{objectName:"general",propertyName:"formatString"},defaultValue:{objectName:"general",propertyName:"defaultValue"}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.tableCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString,columnWidth:{type:{numeric:!0}},totals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Totals"),suppressFormatPainterCopy:!0},autoSizeColumnWidth:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Adjust_Column_Width"),suppressFormatPainterCopy:!0},textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},grid:{displayName:e.data.createDisplayNameGetter("Visual_Grid"),properties:{outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,gridVertical:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Desc"),type:{bool:!0}},gridVerticalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Color"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridVerticalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Weight"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Weight_Desc"),type:{numeric:!0}},gridHorizontal:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Desc"),type:{bool:!0}},gridHorizontalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridHorizontalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight_Desc"),type:{numeric:!0}},rowPadding:{displayName:e.data.createDisplayNameGetter("Visual_RowPadding"),description:e.data.createDisplayNameGetter("Visual_RowPadding_Desc"),type:{numeric:!0}},imageHeight:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight"),description:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight_Desc"),type:{numeric:!0}}}},columnHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},values:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_Values"),properties:{outline:t.StandardObjectProperties.outline,backColor:{type:{fill:{solid:{color:!0}}}},fontColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},backColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},fontColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},backColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},urlIcon:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_UrlIcon"),description:e.data.createDisplayNameGetter("Visual_Tablix_UrlIcon_Desc"),type:{bool:!0}}}},total:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_TotalGrand"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}}},dataViewMappings:[{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{count:500}}},rowCount:{preferred:{min:1}}}}],sorting:{custom:{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.matrixRoleNames={rows:"Rows",columns:"Columns",values:"Values"},t.matrixCapabilities={dataRoles:[{name:t.matrixRoleNames.rows,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Rows"),description:e.data.createDisplayNameGetter("Role_DisplayName_RowsDescription")},{name:t.matrixRoleNames.columns,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Columns"),description:e.data.createDisplayNameGetter("Role_DisplayName_ColumnsDescription")},{name:t.matrixRoleNames.values,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString,columnWidth:{type:{numeric:!0}},rowSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_TotalRow"),suppressFormatPainterCopy:!0},columnSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_TotalColumn"),suppressFormatPainterCopy:!0},autoSizeColumnWidth:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Adjust_Column_Width"),suppressFormatPainterCopy:!0},textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},grid:{displayName:e.data.createDisplayNameGetter("Visual_Grid"),
properties:{outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,gridVertical:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Desc"),type:{bool:!0}},gridVerticalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Color"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridVerticalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Weight"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Weight_Desc"),type:{numeric:!0}},gridHorizontal:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Desc"),type:{bool:!0}},gridHorizontalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridHorizontalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight_Desc"),type:{numeric:!0}},rowPadding:{displayName:e.data.createDisplayNameGetter("Visual_RowPadding"),description:e.data.createDisplayNameGetter("Visual_RowPadding_Desc"),type:{numeric:!0}},imageHeight:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight"),description:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight_Desc"),type:{numeric:!0}}}},columnHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},rowHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_RowHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},values:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_Values"),properties:{outline:t.StandardObjectProperties.outline,fontColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},backColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},fontColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},backColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}}}},subTotals:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_TotalSub"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}}},dataViewMappings:[{conditions:[{Rows:{max:0},Columns:{max:0},Values:{min:1}},{Rows:{min:1},Columns:{min:0},Values:{min:0}},{Rows:{min:0},Columns:{min:1},Values:{min:0}}],matrix:{rows:{"for":{"in":"Rows"},dataReductionAlgorithm:{window:{count:500}}},columns:{"for":{"in":"Columns"},dataReductionAlgorithm:{top:{count:100}}},values:{"for":{"in":"Values"}}}}],filterMappings:{measureFilter:{targetRoles:[t.matrixRoleNames.rows]}},sorting:{custom:{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.treemapRoles={group:"Group",details:"Details",values:"Values",gradient:"Gradient"},t.treemapCapabilities={dataRoles:[{name:"Group",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group"),description:e.data.createDisplayNameGetter("Role_DisplayName_GroupTreemapDescription")},{name:"Details",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details")},{name:"Values",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:{type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Group"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Group:{max:1},Details:{max:0},Gradient:{max:1}},{Group:{max:1},Details:{min:1,max:1},Values:{max:1},Gradient:{max:0}}],categorical:{categories:{"for":{"in":"Group"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Details",select:[{bind:{to:"Values"}},{bind:{to:"Gradient"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],supportsHighlight:!0,sorting:{custom:{},implicit:{clauses:[{role:"Values",direction:2}]}},drilldown:{roles:["Group"]}},t.treemapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}},labels:{show:{objectName:"labels",propertyName:"show"},color:{objectName:"labels",propertyName:"color"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.cardCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldsDescription")}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointLabel"),properties:{color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,fontSize:t.StandardObjectProperties.fontSize}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabel"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},wordWrap:{displayName:e.data.createDisplayNameGetter("Visual_WordWrap"),properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Values:{max:1}}],single:{role:"Values"}}],suppressDefaultTitle:!0,supportsSelection:!1},t.cardProps={categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"},color:{objectName:"categoryLabels",propertyName:"color"},fontSize:{objectName:"categoryLabels",propertyName:"fontSize"}},labels:{color:{objectName:"labels",propertyName:"color"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},fontSize:{objectName:"labels",propertyName:"fontSize"}},wordWrap:{show:{objectName:"wordWrap",propertyName:"show"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.waterfallChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Category"),description:e.data.createDisplayNameGetter("Role_DisplayName_CategoryWaterfallDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,requiredTypes:[{numeric:!0},{integer:!0}],displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize}},sentimentColors:{displayName:e.data.createDisplayNameGetter("Waterfall_SentimentColors"),properties:{increaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_IncreaseLabel"),type:{fill:{solid:{color:!0}}}},decreaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_DecreaseLabel"),type:{fill:{solid:{color:!0}}}},totalFill:{displayName:e.data.createDisplayNameGetter("Waterfall_TotalLabel"),type:{fill:{solid:{color:!0}}}}}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{bind:{to:"Y"}}]}}}],drilldown:{roles:["Category"]}},t.waterfallChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},sentimentColors:{increaseFill:{objectName:"sentimentColors",propertyName:"increaseFill"},decreaseFill:{objectName:"sentimentColors",propertyName:"decreaseFill"},totalFill:{objectName:"sentimentColors",propertyName:"totalFill"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.KPIStatusWithHistoryCapabilities={dataRoles:[{name:"Indicator",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Indicator"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_IndicatorDescription")},{name:"TrendLine",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_TrendLine"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Trendline_Description")},{name:"Goal",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goal"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_GoalDescription")}],dataViewMappings:[{conditions:[{Indicator:{max:1},TrendLine:{max:1},Goal:{max:2}}],categorical:{categories:{"for":{"in":"TrendLine"},dataReductionAlgorithm:{top:{}}},values:{select:[{bind:{to:"Indicator"}},{bind:{to:"Goal"}}]}}}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},indicator:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Indicator"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_IndicatorDescription"),properties:{indicatorDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}}},indicatorPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),description:e.data.createDisplayNameGetter("Visual_PrecisionDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},kpiFormat:{displayName:e.data.createDisplayNameGetter("TaskPane_Format"),type:{text:!0}}}},trendline:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_TrendLine"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Trendline_Description"),properties:{show:t.StandardObjectProperties.show}},goals:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goals"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goals"),properties:{showGoal:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Show_Goal"),type:{bool:!0}},showDistance:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Show_Distance"),type:{bool:!0}}}},status:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Status"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Status"),properties:{direction:{displayName:e.data.createDisplayNameGetter("Visual_KPI_Direction"),type:{enumeration:t.kpiDirection.type}}}}}}}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.animatedNumber=e.visuals.animatedNumberCapabilities,t.areaChart=e.visuals.lineChartCapabilities,t.barChart=e.visuals.getColumnChartCapabilities(!0),t.card=e.visuals.cardCapabilities,t.multiRowCard=e.visuals.multiRowCardCapabilities,t.clusteredBarChart=e.visuals.getColumnChartCapabilities(!0),t.clusteredColumnChart=e.visuals.getColumnChartCapabilities(),t.columnChart=e.visuals.getColumnChartCapabilities(),t.comboChart=e.visuals.comboChartCapabilities,t.dataDotChart=e.visuals.dataDotChartCapabilities,t.dataDotClusteredColumnComboChart=e.visuals.comboChartCapabilities,t.dataDotStackedColumnComboChart=e.visuals.comboChartCapabilities,t.donutChart=e.visuals.donutChartCapabilities,t.funnel=e.visuals.funnelChartCapabilities,t.gauge=e.visuals.gaugeCapabilities,t.hundredPercentStackedBarChart=e.visuals.getColumnChartCapabilities(!0),t.hundredPercentStackedColumnChart=e.visuals.getColumnChartCapabilities(),t.image=e.visuals.imageVisualCapabilities,t.lineChart=e.visuals.lineChartCapabilities,t.lineStackedColumnComboChart=e.visuals.comboChartCapabilities,t.lineClusteredColumnComboChart=e.visuals.comboChartCapabilities,t.map=e.visuals.mapCapabilities,t.filledMap=e.visuals.filledMapCapabilities,t.treemap=e.visuals.treemapCapabilities,t.pieChart=e.visuals.donutChartCapabilities,t.scatterChart=e.visuals.scatterChartCapabilities,t.table=e.visuals.tableCapabilities,t.matrix=e.visuals.matrixCapabilities,t.slicer=e.visuals.slicerCapabilities,t.textbox=e.visuals.textboxCapabilities,t.waterfallChart=e.visuals.waterfallChartCapabilities,t.cheerMeter=e.visuals.cheerMeterCapabilities,t.scriptVisual=e.visuals.scriptVisualCapabilities,t.kpi=e.visuals.KPIStatusWithHistoryCapabilities}(i=t.capabilities||(t.capabilities={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(i,a){this.options=i;var r=i.eventGroup;r.on("click",function(){var e=t.getDatumForLastInputEvent();a.handleSelection(e,d3.event.ctrlKey)}),r.on("contextmenu",function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var i=t.getDatumForLastInputEvent(),r=e.InteractivityUtils.getPositionOfLastInputEvent();a.handleContextMenu(i,r)}})},t.prototype.renderSelection=function(t){var i=this.options;i.bars.style("fill-opacity",function(a){return e.ColumnUtil.getFillOpacity(a.selected,a.highlight,!a.highlight&&t,!a.selected&&i.hasHighlights)})},t.getDatumForLastInputEvent=function(){var e=d3.event.target;return d3.select(e).datum()},t}();e.ColumnChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.dots=t.dots,r=t.dotLabels;e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),r&&e.InteractivityUtils.registerStandardInteractivityHandlers(r,i)},t.prototype.renderSelection=function(t){this.dots.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)})},t}();e.DataDotChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.slices=t.slices,r=this.highlightSlices=t.highlightSlices,o=t.clearCatcher;this.hasHighlights=t.hasHighlights;var n=function(e){i.handleSelection(e.data,d3.event.ctrlKey)},s=function(t){if(!d3.event.ctrlKey){var a=e.InteractivityUtils.getPositionOfLastInputEvent();i.handleContextMenu(t.data,a),d3.event.preventDefault()}};a.on("click",n),a.on("contextmenu",s),r.on("click",n),r.on("contextmenu",s),o.on("click",function(){i.handleClearSelection()})},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.slices.style("fill-opacity",function(a){return e.ColumnUtil.getFillOpacity(a.data.selected,!1,t,i&&!a.data.selected)}),this.highlightSlices.style("fill-opacity",function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!0,!1,i)})},t}();e.DonutChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bars=t.bars,r=this.interactors=t.interactors,o=t.clearCatcher;this.hasHighlights=t.hasHighlights,e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),e.InteractivityUtils.registerStandardInteractivityHandlers(r,i),o.on("click",function(){i.handleClearSelection()})},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.bars.style("fill-opacity",function(a){return e.ColumnUtil.getFillOpacity(a.selected,a.highlight,!a.highlight&&t,!a.selected&&i)})},t}();e.FunnelWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){this.lines=t.lines;var a=t.interactivityLines,r=this.dots=t.dots,o=this.areas=t.areas,n=this.tooltipOverlay=t.tooltipOverlay;e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),e.InteractivityUtils.registerStandardInteractivityHandlers(r,i),o&&e.InteractivityUtils.registerStandardInteractivityHandlers(o,i),n&&n.on("click",function(){return i.handleClearSelection()})},t.prototype.renderSelection=function(t){this.lines.style("stroke-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}),this.dots.style("fill-opacity",function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}),this.areas&&this.areas.style("fill-opacity",function(i){return t&&!i.selected?e.LineChart.DimmedAreaFillOpacity:e.LineChart.AreaFillOpacity})},t}();e.LineChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){this.mapPointerEventsDisabled=!1,this.mapPointerTimeoutSet=!1,this.viewChangedSinceLastClearMouseDown=!1,this.receivedZoomOrPanEvent=!1}return t.prototype.bindEvents=function(t,i){var a=this,r=this.bubbles=t.bubbles,o=this.slices=t.slices,n=this.shapes=t.shapes,s=t.clearCatcher,l=function(){var e=d3.event.target,t=d3.select(e).datum();r&&r.style("pointer-events","all"),n&&n.style("pointer-events","all"),i.handleSelection(t,d3.event.ctrlKey)};this.mapPointerEventsDisabled||(r&&r.style("pointer-events","all"),o&&o.style("pointer-events","all"),n&&n.style("pointer-events","all")),r&&(t.bubbleEventGroup.on("click",l),t.bubbleEventGroup.on("mousewheel",function(){a.mapPointerEventsDisabled||r.style("pointer-events","none"),a.mapPointerEventsDisabled=!0,a.mapPointerTimeoutSet||(a.mapPointerTimeoutSet=!0,setTimeout(function(){r&&r.style("pointer-events","all"),a.mapPointerEventsDisabled=!1,a.mapPointerTimeoutSet=!1},200))}),e.InteractivityUtils.registerGroupContextMenuHandler(t.bubbleEventGroup,i)),o&&(t.sliceEventGroup.on("click",function(){o.style("pointer-events","all"),a.mapPointerEventsDisabled=!1;var e=d3.event.target,t=d3.select(e).datum();i.handleSelection(t.data,d3.event.ctrlKey)}),t.sliceEventGroup.on("mousewheel",function(){a.mapPointerEventsDisabled||o.style("pointer-events","none"),a.mapPointerEventsDisabled=!0,a.mapPointerTimeoutSet||(a.mapPointerTimeoutSet=!0,setTimeout(function(){o&&o.style("pointer-events","all"),a.mapPointerEventsDisabled=!1,a.mapPointerTimeoutSet=!1},200))}),t.sliceEventGroup.on("contextmenu",function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var t=e.InteractivityUtils.getPositionOfLastInputEvent(),a=d3.event.target,r=d3.select(a).datum();i.handleContextMenu(r.data,t)}})),n&&(t.shapeEventGroup.on("click",l),t.shapeEventGroup.on("mousewheel",function(){a.mapPointerEventsDisabled||n.style("pointer-events","none"),a.mapPointerEventsDisabled=!0,a.mapPointerTimeoutSet||(a.mapPointerTimeoutSet=!0,setTimeout(function(){n&&n.style("pointer-events","all"),a.mapPointerEventsDisabled=!1,a.mapPointerTimeoutSet=!1},200))}),e.InteractivityUtils.registerGroupContextMenuHandler(t.shapeEventGroup,i)),s.on("mouseup",function(){a.viewChangedSinceLastClearMouseDown||(i.handleClearSelection(),a.receivedZoomOrPanEvent=!0)}),s.on("mousedown",function(){a.viewChangedSinceLastClearMouseDown=!1}),s.on("mousewheel",function(){a.receivedZoomOrPanEvent=!0})},t.prototype.renderSelection=function(t){this.bubbles&&this.bubbles.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}}),this.slices&&this.slices.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,t,!1)}}),this.shapes&&this.shapes.style({"fill-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)},"stroke-opacity":function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)}})},t.prototype.viewChanged=function(){this.viewChangedSinceLastClearMouseDown=!0},t.prototype.resetZoomPan=function(){this.receivedZoomOrPanEvent=!1},t.prototype.hasReceivedZoomOrPanEvent=function(){return this.receivedZoomOrPanEvent},t}();e.MapBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.CssConstants.createClassAndSelector,i=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bubbles=t.dataPointsSelection,r=t.data,o=t.eventGroup;!this.playOptions||!this.playOptions.traceLineRenderer||t.playOptions&&t.playOptions.traceLineRenderer||this.playOptions.traceLineRenderer.remove(),this.playOptions=t.playOptions,this.shouldEnableFill=(!r.sizeRange||!r.sizeRange.min)&&r.fillPoint,this.colorBorder=r.colorBorder,o?e.InteractivityUtils.registerGroupInteractivityHandlers(o,i):e.InteractivityUtils.registerStandardInteractivityHandlers(a,i)},t.prototype.renderSelection=function(t){var i=this.shouldEnableFill,a=this.colorBorder;if(this.bubbles.style("fill-opacity",function(a){return e.ScatterChart.getMarkerFillOpacity(null!=a.size,i,t,a.selected)}),this.bubbles.style("stroke-opacity",function(i){return e.ScatterChart.getMarkerStrokeOpacity(null!=i.size,a,t,i.selected)}),this.playOptions&&this.bubbles){var r=this.bubbles.filter(function(e){return e.selected}).data(),o=this.playOptions.traceLineRenderer;r&&r.length>0&&null!=o?o.render(r,!0):o.remove()}},t}();e.ScatterChartWebBehavior=i;var a=function(){function i(){}return i.prototype.bindEvents=function(e,t){this.setOptions(e),e.visualInitOptions&&e.visualInitOptions.interactivity.isInteractiveLegend&&(this.makeDataPointsSelectable(e.dataPointsSelection),this.makeRootSelectable(e.root),this.makeDragable(e.root),this.disableDefaultTouchInteractions(e.root),this.selectRoot())},i.prototype.renderSelection=function(e){},i.prototype.setSelectionHandler=function(e){},i.prototype.makeDataPointsSelectable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;r>a;a++){var o=t[a];o.on("click",function(t,i){e.select(i)})}},i.prototype.makeRootSelectable=function(e){var t=this;e.on("click",function(e,i){t.selectRoot()})},i.prototype.makeDragable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;r>a;a++){var o=t[a],n=d3.behavior.drag().on("drag",function(t){e.drag(0)}).on("dragend",function(t){e.drag(1)});o.call(n)}},i.prototype.disableDefaultTouchInteractions=function(e){e.style("touch-action","none")},i.prototype.setOptions=function(e){this.data=e.data,this.mainGraphicsContext=e.plotContext,this.xAxisProperties=e.xAxisProperties,this.yAxisProperties=e.yAxisProperties,this.host=e.host},i.prototype.select=function(e){this.selectDotByIndex(e)},i.prototype.selectRoot=function(){var e=jsCommon.PerformanceUtil.create("selectRoot");this.onClick(),e.end()},i.prototype.drag=function(e){switch(e){case 0:this.onDrag();break;case 1:this.onClick()}},i.prototype.onDrag=function(){var e=this.getMouseCoordinates();this.moveCrosshairToXY(e.x,e.y);var t=this.findClosestDotIndex(e.x,e.y);this.selectDot(t),this.updateLegend(t)},i.prototype.onClick=function(){var e=this.getMouseCoordinates(),t=this.findClosestDotIndex(e.x,e.y);-1!==t&&this.selectDotByIndex(t)},i.prototype.getMouseCoordinates=function(){var e=this.mainGraphicsContext,t=0,i=parseInt(e.attr("height"),10);i=i||0;try{var a=d3.mouse(e.node());t=a[0],i=a[1]}catch(r){}return{x:t,y:i}},i.prototype.selectDotByIndex=function(e){this.selectDot(e),this.moveCrosshairToIndexDot(e),this.updateLegend(e)},i.prototype.selectDot=function(e){var t=this,a=this.mainGraphicsContext;a.selectAll(i.ScatterChartCircleTagName+i.DotClassSelector).classed({selected:!1,notSelected:!0}),a.selectAll(i.ScatterChartCircleTagName+i.DotClassSelector).filter(function(i,a){var r=t.data.dataPoints,o=r[e];return i.x===o.x&&i.y===o.y}).classed({selected:!0,notSelected:!1})},i.prototype.moveCrosshairToIndexDot=function(e){var t=this.data.dataPoints,a=this.mainGraphicsContext,r=this.xAxisProperties.scale(t[e].x),o=this.yAxisProperties.scale(t[e].y);if(null==this.crosshair){var n=+a.attr("width"),s=+a.attr("height");this.crosshair=this.drawCrosshair(a,r,o,n,s),this.crosshairHorizontal=this.crosshair.select(i.Horizontal.selector),this.crosshairVertical=this.crosshair.select(i.Vertical.selector)}else this.moveCrosshairToXY(r,o)},i.prototype.moveCrosshairToXY=function(e,t){this.crosshairHorizontal.attr({y1:t,y2:t}),this.crosshairVertical.attr({x1:e,x2:e})},i.prototype.drawCrosshair=function(e,t,a,r,o){var n=e.append("g");return n.classed(i.CrosshairClassName,!0),n.append("line").classed(i.Horizontal["class"],!0).attr({x1:0,x2:r,y1:a,y2:a}),n.append("line").classed(i.Vertical["class"],!0).attr({x1:t,x2:t,y1:o,y2:0}),n},i.prototype.findClosestDotIndex=function(e,t){var i=-1,a=Number.MAX_VALUE,r=this.data.dataPoints,o=this.xAxisProperties.scale,n=this.yAxisProperties.scale;for(var s in r){var l=r[s],c=o(l.x),u=n(l.y),h=c-e,d=u-t,p=h*h+d*d;a===Number.MAX_VALUE?(i=s,a=p):a&&a>p&&(i=s,a=p)}return i},i.prototype.updateLegend=function(e){if(null==this.lastDotIndex||this.lastDotIndex!==e){var t=this.createLegendDataPoints(e);this.host.updateLegend(t),this.lastDotIndex=e}},i.prototype.createLegendDataPoints=function(t){var i=e.scatterChartProps.general.formatString,a=[],r=this.data,o=r.dataPoints[t],n=e.valueFormatter.format(null),s=n,l=r.legendData,c=l.dataPoints,u=o.formattedCategory.getValue();return u!==n?s=u:null!=o.radius.sizeMeasure?s=e.valueFormatter.format(o.radius.sizeMeasure.source.groupName):c.length>=t&&c[t].label!==n&&(s=c[t].label),null!=r.xCol&&a.push({category:s,color:o.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.xCol.queryName).createSelectionId(),selected:o.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(this.data.axesLabels.x),
measure:e.valueFormatter.format(o.x,e.valueFormatter.getFormatString(r.xCol,i)),iconOnlyOnLabel:!0}),null!=r.yCol&&a.push({category:s,color:o.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.yCol.queryName).createSelectionId(),selected:o.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.axesLabels.y),measure:e.valueFormatter.format(o.y,e.valueFormatter.getFormatString(r.yCol,i)),iconOnlyOnLabel:!0}),null!=r.size&&a.push({category:s,color:o.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.size.queryName).createSelectionId(),selected:o.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.size.displayName),measure:e.valueFormatter.format(o.radius.sizeMeasure.values[o.radius.index],e.valueFormatter.getFormatString(r.size,i)),iconOnlyOnLabel:!0}),{dataPoints:a}},i.CrosshairClassName="crosshair",i.ScatterChartCircleTagName="circle",i.DotClassName="dot",i.DotClassSelector="."+i.DotClassName,i.Horizontal=t("horizontal"),i.Vertical=t("vertical"),i}();e.ScatterChartMobileBehavior=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){this.itemLabels=t.itemLabels,this.dataPoints=t.dataPoints,this.interactivityService=t.interactivityService,this.slicerSettings=t.settings,e.SlicerWebBehavior.bindSlicerEvents(t.slicerContainer,this.itemLabels,t.clear,i,this.slicerSettings,this.interactivityService)},t.prototype.renderSelection=function(t){e.SlicerWebBehavior.setSelectionOnSlicerItems(this.itemLabels,this.itemLabels,t,this.interactivityService,this.slicerSettings)},t}();e.HorizontalSlicerWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=t.itemContainers;this.itemLabels=t.itemLabels,this.itemInputs=t.itemInputs,this.dataPoints=t.dataPoints,this.interactivityService=t.interactivityService,this.settings=t.settings,e.SlicerWebBehavior.bindSlicerEvents(t.slicerContainer,a,t.clear,i,this.settings,this.interactivityService,t.searchInput)},t.prototype.renderSelection=function(t){e.SlicerWebBehavior.setSelectionOnSlicerItems(this.itemInputs,this.itemLabels,t,this.interactivityService,this.settings)},t}();e.VerticalSlicerWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(e,t){this.behavior=this.createWebBehavior(e),this.behavior.bindEvents(e.behaviorOptions,t)},t.prototype.renderSelection=function(e){this.behavior.renderSelection(e)},t.bindSlicerEvents=function(e,i,a,r,o,n,s){t.bindSlicerItemSelectionEvent(i,r,o,n),t.bindSlicerClearEvent(a,r),s&&t.bindSlicerSearchEvent(s,r),t.styleSlicerContainer(e,n)},t.setSelectionOnSlicerItems=function(e,i,a,r,o){if(a||r.isSelectionModeInverted())t.styleSlicerItems(e,a,r.isSelectionModeInverted());else{e.filter(".selected").classed("selected",!1),e.filter(".partiallySelected").classed("partiallySelected",!1);var n=e.selectAll("input");n&&n.property("checked",!1),i.style("color",o.slicerText.color)}},t.styleSlicerItems=function(e,t,i){e.each(function(e){var a=this,r=!1;e.isSelectAllDataPoint?t?(a.classList.add("partiallySelected"),r=!1):(a.classList.remove("partiallySelected"),r=i):r=jsCommon.LogicExtensions.XOR(e.selected,i),r?a.classList.add("selected"):a.classList.remove("selected");var o=a.getElementsByTagName("input")[0];o&&(o.checked=r)})},t.bindSlicerItemSelectionEvent=function(i,a,r,o){t.isTouch=!1,i.on("touchstart",function(e){t.isTouch=!0}),i.on("pointerdown",function(e){var i=d3.event;i&&"touch"===i.pointerType&&(t.isTouch=!0)}),i.on("click",function(i){d3.event.preventDefault(),i.isSelectAllDataPoint?a.toggleSelectionModeInversion():a.handleSelection(i,t.isTouch||t.isMultiSelect(d3.event,r,o)),a.persistSelectionFilter(e.slicerProps.filterPropertyIdentifier),t.isTouch=!1})},t.bindSlicerClearEvent=function(t,i){t&&t.on("click",function(t){i.handleClearSelection(),i.persistSelectionFilter(e.slicerProps.filterPropertyIdentifier)})},t.bindSlicerSearchEvent=function(e,t){e.empty()||e.on("mousedown",function(){d3.event.stopPropagation()}).on("keydown",function(){d3.event.ctrlKey&&jsCommon.KeyUtils.isCtrlDefaultKey(d3.event.keyCode)?d3.event.stopPropagation():jsCommon.KeyUtils.isArrowKey(d3.event.keyCode)&&d3.event.stopPropagation()})},t.styleSlicerContainer=function(e,t){var i=t.hasSelection()&&void 0===t.isDefaultValueEnabled()||t.isDefaultValueEnabled()===!1;e.classed("hasSelection",i)},t.isMultiSelect=function(e,t,i){return i.isSelectionModeInverted()||!t.selection.singleSelect||e.ctrlKey},t.prototype.createWebBehavior=function(t){var i,a=t.orientation;switch(a){case 1:i=new e.HorizontalSlicerWebBehavior;break;case 0:default:i=new e.VerticalSlicerWebBehavior}return i},t}();e.SlicerWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=t.legendItems;this.legendIcons=t.legendIcons;var r=t.clearCatcher;e.InteractivityUtils.registerStandardSelectionHandler(a,i),r.on("click",function(){i.handleClearSelection()})},t.prototype.renderSelection=function(e){e?this.legendIcons.style({fill:function(e){return e.selected?e.color:t.dimmedLegendColor}}):this.legendIcons.style({fill:function(e){return e.color}})},t.dimmedLegendColor="#A6A6A6",t}();e.LegendBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.shapes=t.shapes,r=this.highlightShapes=t.highlightShapes,o=t.majorLabels,n=t.minorLabels;this.hasHighlights=t.hasHighlights,e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),e.InteractivityUtils.registerStandardInteractivityHandlers(r,i),o&&e.InteractivityUtils.registerStandardInteractivityHandlers(o,i),n&&e.InteractivityUtils.registerStandardInteractivityHandlers(n,i)},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.shapes.style("fill",function(t){return e.Treemap.getFill(t,!1)}).style("fill-opacity",function(a){return e.Treemap.getFillOpacity(a,t,!a.selected&&i,!1)}),this.highlightShapes.style("fill",function(t){return e.Treemap.getFill(t,!0)}).style("fill-opacity",function(a){return e.Treemap.getFillOpacity(a,t,!a.selected&&i,!0)})},t}();e.TreemapWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bars=t.bars;a.on("click",function(e){e.isTotal||i.handleSelection(e,d3.event.ctrlKey)}),a.on("contextmenu",function(t){if(!d3.event.ctrlKey&&(d3.event.preventDefault(),!t.isTotal)){var a=e.InteractivityUtils.getPositionOfLastInputEvent();i.handleContextMenu(t,a)}})},t.prototype.renderSelection=function(t){this.bars.style("fill-opacity",function(i){return i.isTotal?e.ColumnUtil.DefaultOpacity:e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)})},t}();e.WaterfallChartWebBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.bindEvents=function(t,i){this.labelItems=t.labelItems,e.InteractivityUtils.registerStandardSelectionHandler(this.labelItems,i)},t.prototype.renderSelection=function(e){e?this.labelItems.style({opacity:function(e){return e.selected?t.DefaultLabelOpacity:t.DimmedLabelOpacity}}):this.labelItems.style({opacity:t.DefaultLabelOpacity})},t.DefaultLabelOpacity=1,t.DimmedLabelOpacity=.6,t}();e.LabelsBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.behaviors=e}return e.prototype.bindEvents=function(e,t){for(var i=this.behaviors,a=0,r=i.length;r>a;a++)i[a].bindEvents(e.layerOptions[a],t);e.clearCatcher.on("click",function(){t.handleClearSelection()})},e.prototype.renderSelection=function(e){for(var t=0,i=this.behaviors;t<i.length;t++){var a=i[t];a.renderSelection(e)}},e}();e.CartesianChartBehavior=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){t.emptyDomain=[0,0];var i;!function(i){function a(e){return 300>e?3:500>e?5:8}function r(e){return 150>e?3:300>e?5:8}function o(e,t,i,a,r){return isNaN(e)||isNaN(t)?ee:1>=a||1>=t&&e>=-1?a:e===t?r?1:ee:n(i)?a:Math.min(t-e+1,a)}function n(e){for(var t=0,i=e.length;i>t;t++){var a=e[t];if(a&&a.type&&!a.type.integer)return!0}return!1}function s(e,t,i,a,r){return!a||v(t)?l(e,t.domain()):b(i)?h(e,t.domain()):c(e,t,r)}function l(e,t){var i=[];if(0>=e)return i;var a=t.length;if(e>a)return t;for(var r=0,o=Math.ceil(a/e);a>r;r+=o)i.push(t[r]);return i}function c(e,t,i){var a=[];if(0===e)return a;var r=t;if(r.ticks){if(a=r.ticks(e),a.length>e&&e>1&&(a=r.ticks(e-1)),a.length<J&&(a=r.ticks(e+1)),a=u(a),i&&a.length>1){for(var o=a[1]-a[0];o>0&&i>o;){for(var n=1;n<a.length;n++)a.splice(n,1);o=2*o}1===a.length&&a.push(a[0]+i)}return a}return a}function u(e,t){if(void 0===t&&(t=1e-5),!e||e.length<2)return e;var i=t*Math.abs(e[1]-e[0]);return e.map(function(e){return Math.abs(e)<=i?0:e})}function h(t,i){var a=[];if(0===i[0]&&0===i[1])return[];var r=e.DateTimeSequence.calculate(new Date(i[0]),new Date(i[1]),t).sequence;return a=r.map(function(e){return e.getTime()}),a=T(a,i[0],i[1])}function d(e){return isNaN(e.min)||isNaN(e.max)?(e.min=t.emptyDomain[0],e.max=t.emptyDomain[1]):e.min===e.max?(e.min=e.min<0?1.2*e.min:.8*e.min,e.max=e.max<0?.8*e.max:1.2*e.max):Math.abs(e.min)<1e-4&&e.min/(e.max-e.min)<1e-4&&(e.min=0),e}function p(e,t,i,o){return 0===a(e-i)||0===r(t-o)?{top:0,right:i,bottom:o,left:0}:{top:20,right:30,bottom:40,left:30}}function g(e,t,i,o,n,s,l,c,u,h,d,p){var g=n.x,m=n.y1,f=n.y2,y=g.values,b=m.values,C=0,S=0,x=0,w=0,P=0,D=g.categoryThickness?g.categoryThickness/2:0,L=v(g.scale),T=0;if(void 0!==g.outerPadding?T=g.outerPadding:void 0!==g.xLabelMaxWidth&&(T=Math.max(0,(e.width-g.xLabelMaxWidth*y.length)/2)),0!==a(e.width)||0!==r(e.height)){var _=void 0;if(_=c?ae.DefaultRotationWithScrollbar:ae.DefaultRotation,d)for(var V=0,M=b.length;M>V;V++)l.text=b[V],x=Math.max(x,i(l));if(f&&p)for(var N=f.values,V=0,M=N.length;M>V;V++)l.text=N[V],w=Math.max(w,i(l));var A=o(l),O=Math.floor(s/A),I=g.scale,R=I.domain();if(h&&y.length>0){for(var V=0,M=y.length;M>V;V++){var F=void 0;l.text=y[V];var H=i(l);if(g.willLabelsWordBreak){var z=jsCommon.WordBreaker.splitByWidth(l.text,l,i,g.xLabelMaxWidth,O);F=z.length*A,H=g.xLabelMaxWidth}else!g.willLabelsFit&&L?(F=H*_.sine,H*=_.cosine):F=Z;if(0===V){if(L)C=g.willLabelsFit?H/2-D-T:H-D-T,C=Math.max(C,0);else if(R.length>1){var G=I(R[0]);C=H/2-G,C=Math.max(C,0)}}else if(V===M-1)if(L)(g.willLabelsFit||g.willLabelsWordBreak)&&(S=H/2-D-T,S=Math.max(S,0));else if(R.length>1){var G=I(R[1]);S=H/2-(e.width-G),S=Math.max(S,0)}P=Math.max(P,F)}C=Math.min(C,Q),S=Math.min(S,Q)}}var k=0,j=0,E=Math.min(Math.ceil(P),s);return u?(j=Math.min(Math.max(C,w),t),k=Math.min(Math.max(S,x),t)):(j=Math.min(Math.max(C,x),t),k=Math.min(Math.max(S,w),t)),{xMax:Math.ceil(E),yLeft:Math.ceil(j),yRight:Math.ceil(k)}}function m(e){return e&&(e.bool||e.numeric||e.text||e.dateTime)}function f(){return e.ValueType.fromDescriptor({text:!0})}function y(e){return!(!e||!e.text&&!e.bool)}function v(e){return"undefined"==typeof e.invert}function b(e){return!(!e||!e.dateTime)}function C(e,t){return v(e)?x(e,t):e.invert(t)}function S(e){return v(e)?e.rangeExtent():e.range()}function x(e,t){var i=e.range();if(i.length<2)return 0;var a,r=e.rangeBand(),o=(i[1]-i[0]-r)/2;for(a=0;t>i[a]+r+o&&a<i.length-1;a++);return e.domain()[a]}function w(e,t){var i=-1,a=Number.MAX_VALUE;for(var r in t){var o=Math.abs(e-t[r].categoryValue);a>o&&(a=o,i=parseInt(r,10))}return i}function P(e,t){var i=-1,a=Number.MAX_VALUE,r=e.domain();if(r.length<2)return 0;var o=(e(1)-e(0))/2;for(var n in r){var s=e(n),l=s+o,c=Math.abs(t-l);a>c&&(a=c,i=parseInt(n,10))}return i}function D(e,t,i){var a=e(t)-e(i);return 0===a?0:0>a?Math.min(a,-1):Math.max(a,1)}function L(e,t,i,a,r){if(i&&!y(t)){var o=void 0,n=void 0;return a&&2===a.length&&(o=a[0],n=a[1]),F(e,o,n,t,r)}return z(e)}function T(e,t,i){var a=e.filter(function(e){return e>=t&&i>=e});return a.length<2&&(a=[t,i]),a}function V(t,i){return t&&m(t.type)?t.type:i?e.ValueType.fromDescriptor({numeric:!0}):e.ValueType.fromDescriptor({text:!0})}function M(e){var a=e.pixelSpan,r=e.dataDomain,o=e.metaDataColumn,n=e.formatString,l=e.outerPadding||0,c=!!e.isCategoryAxis,u=!!e.isScalar,h=!!e.isVertical,d=!!e.useTickIntervalForDisplayUnits,p=e.getValueFn,g=e.categoryThickness,m=e.axisDisplayUnits,f=e.axisPrecision,y=!!e.is100Pct,v=i.getCategoryValueType(o,u),b=i.createScale(e),C=b.scale,S=b.bestTickCount,x=C.domain(),w=i.isLogScalePossible(r,v);if(g&&u&&r&&2===r.length){var P=r[1]-r[0],D=x[1]-x[0];P>0&&D>0&&(g=g*P/D)}var L;if(u&&1===S)L=[r[0]];else{var T=u?R(n,v,y):void 0;L=s(S,C,v,u,T)}e.scaleType&&e.scaleType===t.axisScale.log&&w&&(L=L.filter(function(e){return i.powerOfTen(e)}));var _=O(x,r,v,u,n,S,L,p,d,m,f),V=d3.svg.axis().scale(C).tickSize(6,0).orient(h?"left":"bottom").ticks(S).tickValues(L),M=[];o&&(M=I(V,L,_,v,p));var A;return!u&&g?A=Math.max(1,g-2*t.CartesianChart.TickLabelPadding):(A=L.length>1?N(C,L):a,A-=2*ie),{scale:C,axis:V,formatter:_,values:M,axisType:v,axisLabel:null,isCategoryAxis:c,xLabelMaxWidth:A,categoryThickness:g,outerPadding:l,usingDefaultDomain:b.usingDefaultDomain,isLogScaleAllowed:w,dataDomain:r}}function N(e,t){return e&&!_.isEmpty(t)?Math.abs(e(t[1])-e(t[0])):1}function A(e){var o,n=e.pixelSpan,s=e.dataDomain,l=e.metaDataColumn,c=e.outerPadding||0,u=!!e.isScalar,h=!!e.isVertical,p=e.forcedTickCount,g=e.categoryThickness,m=!!e.shouldClamp,f=i.getCategoryValueType(l,u),v=h?r(n):a(n),b=s?s.slice():null,C=v,S=!1;if(null==s||2===s.length&&null==s[0]&&null==s[1]||2!==s.length&&u)S=!0,s=f.dateTime||!y(f)?t.emptyDomain:[],o=y(f)?G(n,s,g?c/g:0):j(e.scaleType,n,s,f,c,C);else{if(u&&s.length>0){C=void 0!==p?0!==v?p:0:i.getBestNumberOfTicks(s[0],s[s.length-1],[l],v,f.dateTime);var x=d({min:s[0],max:s[s.length-1]});b=[x.min,x.max]}u&&f.numeric&&!f.dateTime?o=j(e.scaleType,n,b,f,c,C,m):u&&f.dateTime?o=B(n,b,c,null,m):(f.text||f.dateTime||f.numeric||f.bool)&&(o=G(n,b,g?c/g:0),C=0===v?0:Math.min(b.length,(n-2*c)/t.CartesianChart.MinOrdinalRectThickness))}return h&&u&&o.range(o.range().reverse()),t.ColumnUtil.normalizeInfinityInScale(o),{scale:o,bestTickCount:C,usingDefaultDomain:S}}function O(e,i,a,r,o,n,s,l,c,u,h){void 0===c&&(c=!1);var d;if(a.dateTime)if(r){var p=new Date(e[0]),g=new Date(e[1]);1===n&&(p=g=new Date(i[0])),d=t.valueFormatter.create({format:o,value:p,value2:g,tickCount:n})}else d=t.valueFormatter.createDefaultFormatter(o,!0);else if(c&&r&&s.length>1){var m=u?u:s[1]-s[0],f={format:o,value:m,value2:0,allowFormatBeautification:!0};h?f.precision=h:f.detectAxisPrecision=!0,d=t.valueFormatter.create(f)}else d=t.valueFormatter.createDefaultFormatter(o,!0);return d}function I(e,t,i,a,r){var o=[];return r||(r=function(e){return e}),i?(e.tickFormat(function(e){return i.format(r(e,a))}),o=t.map(function(e){return i.format(r(e,a))})):o=t.map(function(e){return r(e,a)}),o}function R(t,i,a){var r=t&&!e.NumberFormat.isStandardFormat(t);if(r){var o=e.NumberFormat.getCustomFormatMetadata(t,!0).precision;return t.indexOf("%")>-1&&(o+=2),Math.pow(10,-o)}return a?.01:i.integer?1:0}function F(e,t,i,a,r){if(0===e.length)return null;var o=d3.min(e,function(e){return d3.min(e.data,function(e){return e.categoryValue})}),n=d3.max(e,function(e){return d3.max(e.data,function(e){return e.categoryValue})});return Y([t,i],[o,n],r)}function H(e,t){if(0===e.length)return null;var i=d3.min(e,function(e){return d3.min(e.data,function(e){return e.value})}),a=d3.max(e,function(e){return d3.max(e.data,function(e){return e.value})});return t?[Math.min(i,0),Math.max(a,0)]:[i,a]}function z(e){if(_.isEmpty(e))return[];for(var t=[],i=e[0],a=0,r=i.data;a<r.length;a++){var o=r[a];o.highlight||t.push(o.categoryIndex)}return t}function G(e,i,a){void 0===a&&(a=0);var r=d3.scale.ordinal().rangeBands([0,e],t.CartesianChart.InnerPaddingRatio,a).domain(i);return r}function k(e,t){return null==e?!1:b(t)?!1:e[0]>0&&e[1]>0||e[0]<0&&e[1]<0}function j(e,i,a,r,o,n,s){return void 0===o&&(o=0),e===t.axisScale.log&&k(a,r)?E(i,a,o,n):B(i,a,o,n,s)}function E(e,t,i,a){void 0===i&&(i=0);var r=d3.scale.log().range([i,e-i]).domain([t[0],t[1]]).clamp(!0);return a&&r.nice(a),r}function B(e,t,i,a,r){void 0===i&&(i=0);var o=d3.scale.linear().range([i,e-i]).domain([t[0],t[1]]).clamp(r);return a&&o.nice(a),o}function W(e){var t={};return e&&(t.min=null==e.min?null==e.minLocal?d3.min(e.values):e.minLocal:e.min,t.max=null==e.max?null==e.maxLocal?d3.max(e.values):e.maxLocal:e.max),t}function U(e,t){var i=[void 0,void 0];return t&&2===t.length&&(i=[t[0],t[1]]),e&&2===e.length&&(null!=e[0]&&(i[0]=e[0]),null!=e[1]&&(i[1]=e[1])),null==i[0]&&null==i[1]?t:null!=i[0]&&null!=i[1]&&i[0]>i[1]?t:i}function Y(e,t,i){var a=t?[t[0],t[1]]:[];i&&((null==a[0]||i.min<a[0])&&(a[0]=i.min),(null==a[1]||i.max>a[1])&&(a[1]=i.max));var r=[a[0],a[1]];return e&&2===e.length&&(null!=e[0]&&(a[0]=e[0]),null!=e[1]&&(a[1]=e[1]),a[0]>a[1]&&(a=r)),a}function K(e,i,a,r){void 0===r&&(r=!1);var o=r?"secAxisStyle":"axisStyle";if(!e||!e[o])return i;var n;return n=e[o]===t.axisStyle.showBoth?i+" ("+a+")":e[o]===t.axisStyle.showUnitOnly?a:i}function X(e,t){return!e||!t||e.length<2||t.length<2?!1:e[0]!==t[0]||e[1]!==t[1]}function q(e){return isNaN(e)?null:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}function $(e){var t=Math.abs(e),i=Math.log(t)/Math.LN10;return i=Math.ceil(i-1e-12),t/Math.pow(10,i)===1}var Q=35,Z=10,J=2,ee=3,te=10,ie=3;i.getRecommendedNumberOfTicksForXAxis=a,i.getRecommendedNumberOfTicksForYAxis=r,i.getBestNumberOfTicks=o,i.hasNonIntegerData=n,i.getRecommendedTickValues=s,i.getRecommendedTickValuesForAnOrdinalRange=l,i.getRecommendedTickValuesForAQuantitativeRange=c,i.getMargin=p,i.getTickLabelMargins=g,i.columnDataTypeHasValue=m,i.createOrdinalType=f,i.isOrdinal=y,i.isOrdinalScale=v,i.isDateTime=b,i.invertScale=C,i.extent=S,i.invertOrdinalScale=x,i.findClosestXAxisIndex=w,i.lookupOrdinalIndex=P,i.diffScaled=D,i.createDomain=L,i.ensureValuesInRange=T,i.getCategoryValueType=V,i.createAxis=M,i.createScale=A,i.createFormatter=O,i.getMinTickValueInterval=R,i.createValueDomain=H;var ae;!function(i){function a(e,t,i,a){var r=e.values;if(0===r.length)return!1;var o=void 0!==e.xLabelMaxWidth?e.xLabelMaxWidth:t/r.length;return!r.some(function(e){return a.text=e,i(a)>o})}function r(e,a,r,o,n,s,l){var c=e.values,u=void 0!==e.xLabelMaxWidth?e.xLabelMaxWidth:r/c.length,h=a.bottom/i.DefaultRotation.sine,d=n(l),p=Math.max(1,Math.floor(a.bottom/d));if(0===c.length)return!1;var g=c.some(function(e){return l.text=e,!jsCommon.WordBreaker.hasBreakers(e)&&o(l)>u});if(g)return!1;var m=c.filter(function(r,n){var c=a.left+e.outerPadding+e.categoryThickness*(n+.5)-te,d=c/i.DefaultRotation.cosine,g=Math.min(d,h),m=jsCommon.WordBreaker.splitByWidth(r,l,o,u,p,s).join(" ");l.text=r;var f=s(l,g);return t.TextUtil.removeEllipses(m).length>=t.TextUtil.removeEllipses(f).length});return m.length>=Math.floor(c.length/2)}function o(e,t,a,r,o,n,s,l,c){var u,h;h=c?i.DefaultRotationWithScrollbar:i.DefaultRotation,o&&(u=t/h.sine),e.each(function(){var e=d3.select(this),t=e.text();if(r.text=t,o){var i=s.values.indexOf(this.textContent),d=l.left+s.outerPadding+s.categoryThickness*(i+.5);c||(d-=te);var p=d/h.cosine;(c||n||u>p)&&(t=a(r,Math.min(p,u)),e.text(t)),e.style("text-anchor","end").attr({dx:"-0.5em",dy:h.dy,transform:h.transform})}else{var g=a(r,s.xLabelMaxWidth);g!==t&&e.text(g),e.style("text-anchor","middle").attr({dx:"0em",dy:"1em",transform:"rotate(0)"})}})}function n(t,i,a){var r=i.xLabelMaxWidth;t.each(function(){var t=d3.select(this);t.style("text-anchor","middle").attr({dx:"0em",dy:"1em",transform:"rotate(0)"}),e.TextMeasurementService.wordBreak(this,r,a)})}function s(e,t,i){0!==e.size()&&e.each(function(){var e=d3.select(this);i(e[0][0],t)})}i.willLabelsFit=a,i.willLabelsWordBreak=r,i.DefaultRotation={sine:Math.sin(Math.PI*(35/180)),cosine:Math.cos(Math.PI*(35/180)),tangent:Math.tan(Math.PI*(35/180)),transform:"rotate(-35)",dy:"-0.5em"},i.DefaultRotationWithScrollbar={sine:Math.sin(.5*Math.PI),cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.8em"},i.rotate=o,i.wordBreak=n,i.clip=s}(ae=i.LabelLayoutStrategy||(i.LabelLayoutStrategy={})),i.createOrdinalScale=G,i.isLogScalePossible=k,i.createNumericalScale=j,i.createLinearScale=B,i.getRangeForColumn=W,i.applyCustomizedDomain=U,i.combineDomain=Y,i.createAxisLabel=K,i.scaleShouldClamp=X,i.normalizeNonFiniteNumber=q,i.powerOfTen=$}(i=t.AxisHelper||(t.AxisHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t,i,a,r){var o=i*c.PaddingConstRatio+e.lineWeight/2,n=t*c.PaddingConstRatio+e.lineWeight/2,u=i*c.ShapeConstRatio-e.lineWeight,h=t*c.ShapeConstRatio-e.lineWeight,d={x:o,y:n,width:u,height:h,rx:e.roundEdge,ry:e.roundEdge},p=l(u,h,r);s(e,t,i,a,r,p,"rect",d)}function i(e,t,i,a,r){var o=(i/c.OvalRadiusConst).toString(),n=(t/c.OvalRadiusConst).toString(),u=i/(c.OvalRadiusConst+c.OvalRadiusConstPadding)-e.lineWeight,h=t/(c.OvalRadiusConst+c.OvalRadiusConstPadding)-e.lineWeight,d={cx:o,cy:n,rx:u,ry:h},p=l(i,t,r);s(e,t,i,a,r,p,"ellipse",d)}function a(e,t,i,a,r){var o,n,s,l,u,h=i-c.SmallPaddingConstValue-c.SmallPaddingConstValue,d=t-c.SmallPaddingConstValue-c.SmallPaddingConstValue;45>=r?(u=r/90,o=i/2+h*u,n=c.SmallPaddingConstValue,s=i/2-h*u,l=t-c.SmallPaddingConstValue):135>=r?(u=(r-45)/90,o=i-c.SmallPaddingConstValue,n=c.SmallPaddingConstValue+d*u,s=c.SmallPaddingConstValue,l=t-c.SmallPaddingConstValue-d*u):225>=r?(u=(r-135)/90,o=i-c.SmallPaddingConstValue-h*u,n=t-c.SmallPaddingConstValue,s=c.SmallPaddingConstValue+h*u,l=c.SmallPaddingConstValue):315>=r?(u=(r-225)/90,o=c.SmallPaddingConstValue,n=t-c.SmallPaddingConstValue-d*u,s=i-c.SmallPaddingConstValue,l=c.SmallPaddingConstValue+d*u):360>=r&&(u=(r-315)/90,o=c.SmallPaddingConstValue+h*u,n=c.SmallPaddingConstValue,s=i-c.SmallPaddingConstValue-h*u,l=t-c.SmallPaddingConstValue),a.append("svg").attr({width:i,height:t}).append("line").attr({x1:o,y1:n,x2:s,y2:l}).style({"vector-effect":"non-scaling-stroke","stroke-width":e.lineWeight+"px","stroke-opacity":(100-e.lineTransparency)/100,stroke:e.lineColor})}function r(e,t,i,a,r){var o=e.lineWeight,s=t-o,l=i-o,u=[{x:(l*c.ArrowLeftHeadPoint.x).toString(),y:(s*c.ArrowLeftHeadPoint.y).toString()},{x:(l*c.ArrowMiddleHeadPoint.x).toString(),y:(s*c.ArrowMiddleHeadPoint.y).toString()},{x:(l*c.ArrowRightHeadPoint.x).toString(),y:(s*c.ArrowRightHeadPoint.y).toString()},{x:(l*c.ArrowRightMiddleHeadPoint.x).toString(),y:(s*c.ArrowRightMiddleHeadPoint.y).toString()},{x:(l*c.ArrowBottomRightPoint.x).toString(),y:(s*c.ArrowBottomRightPoint.y).toString()},{x:(l*c.ArrowBottomLeftPoint.x).toString(),y:(s*c.ArrowBottomLeftPoint.y).toString()},{x:(l*c.ArrowLeftMiddleHeadPoint.x).toString(),y:(s*c.ArrowLeftMiddleHeadPoint.y).toString()}];n(e,u,a,t,i,r)}function o(e,t,i,a,r){var o=e.lineWeight;o>3&&(o-=3);var s=(i+o)*c.TrianglePaddingConstRatio,l=t-c.SmallPaddingConstValue-o<0?t-c.SmallPaddingConstValue:t-c.SmallPaddingConstValue-o,u=(t+o)*c.TrianglePaddingConstRatio,h=(i-o)*c.TriangleEndPaddingConstRatio<0?i*c.TriangleEndPaddingConstRatio:(i-o)*c.TriangleEndPaddingConstRatio,d=t-c.SmallPaddingConstValue-o<0?t-c.SmallPaddingConstValue:t-o-c.SmallPaddingConstValue,p=(s+h)/2;10>s&&(s=c.SmallPaddingConstValue),10>u&&(u=c.SmallPaddingConstValue);var g=[{x:s,y:l},{x:p,y:u},{x:h,y:d}];n(e,g,a,t,i,r)}function n(e,t,i,a,r,o){var n=d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear"),c={d:n(t)+" Z"},u=l(r,a,o);s(e,a,r,i,o,u,"path",c)}function s(e,t,i,a,r,o,n,s){a.append("div").style({transform:"rotate("+r+"deg) scale("+o+")","transform-origin":"center","-webkit-transform":"rotate("+r+"deg) scale("+o+")","-webkit-transform-origin":"center",width:i+"px",height:t+"px"}).append("svg").attr({width:i,height:t}).append(n).attr(s).style({"vector-effect":"non-scaling-stroke","stroke-width":e.lineWeight+"px",stroke:e.lineColor,"stroke-opacity":(100-e.lineTransparency)/100,fill:e.fillColor,"fill-opacity":e.showFill===!0?(100-e.shapeTransparency)/100:0})}function l(e,t,i){var a=e,r=t,o=Math.atan2(t,e),n=Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),s=i/180*Math.PI;return e>=t?(90>i?s+=o:180>i?s-=o:270>i?s+=o:s-=o,r/Math.abs(Math.sin(s))/n):(90>i?s-=o:180>i?s+=o:270>i?s-=o:s+=o,a/Math.abs(Math.cos(s))/n)}var c;!function(e){e.PaddingConstRatio=.01,e.TrianglePaddingConstRatio=.15,e.TriangleEndPaddingConstRatio=.85,e.ShapeConstRatio=1-2*e.PaddingConstRatio,e.SmallPaddingConstValue=10,e.OvalRadiusConst=2,e.OvalRadiusConstPadding=.2,e.ArrowLeftHeadPoint={x:.05,y:.42},e.ArrowMiddleHeadPoint={x:.5,y:.016},e.ArrowRightHeadPoint={x:.95,y:.42},e.ArrowRightMiddleHeadPoint={x:.764,y:.42},e.ArrowBottomRightPoint={x:.764,y:.993},e.ArrowBottomLeftPoint={x:.246,y:.993},e.ArrowLeftMiddleHeadPoint={x:.246,y:.42}}(c=e.ShapeFactoryConsts||(e.ShapeFactoryConsts={})),e.createRectangle=t,e.createOval=i,e.createLine=a,e.createUpArrow=r,e.createTriangle=o}(t=e.ShapeFactory||(e.ShapeFactory={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(e,t){var i={};if(!e)return i;var a=e.objects;if(a){var r=a.categoryAxis;r&&(i={show:r.show,axisType:r.axisType,axisScale:r.axisScale,start:r.start,end:r.end,showAxisTitle:null==r.showAxisTitle?t:r.showAxisTitle,axisStyle:r.axisStyle,labelColor:r.labelColor,labelDisplayUnits:r.labelDisplayUnits,labelPrecision:r.labelPrecision,duration:r.duration})}return i}function a(e,t){var i={};if(!e)return i;var a=e.objects;if(a){var r=a.valueAxis;r&&(i={show:r.show,position:r.position,axisScale:r.axisScale,start:r.start,end:r.end,showAxisTitle:null==r.showAxisTitle?t:r.showAxisTitle,axisStyle:r.axisStyle,labelColor:r.labelColor,labelDisplayUnits:r.labelDisplayUnits,labelPrecision:r.labelPrecision,secShow:r.secShow,secPosition:r.secPosition,secAxisScale:r.secAxisScale,secStart:r.secStart,secEnd:r.secEnd,secShowAxisTitle:r.secShowAxisTitle,secAxisStyle:r.secAxisStyle,secLabelColor:r.secLabelColor,secLabelDisplayUnits:r.secLabelDisplayUnits,secLabelPrecision:r.secLabelPrecision})}return i}function r(t,i){return t&&(t=i&&i.axisType?i.axisType===e.axisType.scalar:!0),t}function o(e){return null!=e?0>e?0:e:null}function n(t,i,a,r){var o=e.AxisHelper.isDateTime(a);if(r)return o?new Date(i):i;if(a.text)return t.categories[i];if(t&&t.series&&t.series.length>0){var n=t.series[0];if(n){var s=n.data;if(s){t.hasHighlights&&(i=2*i);var l=s[i];if(l)return o&&null!=l.categoryValue?new Date(l.categoryValue):l.categoryValue}}}return i}function s(e){if(_.isEmpty(e))return 0;for(var t=0,i=0,a=e;i<a.length;i++){var r=a[i];if(!_.isEmpty(r.data)){var o=r.data[r.data.length-1].categoryIndex;t=Math.max(o,t)}}return t}t.getCategoryAxisProperties=i,t.getValueAxisProperties=a,t.isScalar=r,t.getPrecision=o,t.lookupXValue=n,t.findMaxCategoryIndex=s}(t=e.CartesianHelper||(e.CartesianHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.data.SQExprShortSerializer,a=function(){function t(e,t,i){this.colors=e,this.fillProp=t,this.defaultDataPointColor=i,this.defaultColorScale=e.getNewColorScale()}return t.prototype.getColorForSeriesValue=function(t,i,a){return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||this.getColorScaleForSeries(i).getColor(a).value},t.prototype.getColorScaleForSeries=function(e){return this.colors.getColorScaleByKey(i.serializeArray(e||[]))},t.prototype.getColorForMeasure=function(t,i){var a=this.defaultColorScale.getColor(i).value;return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||a},t.normalizeSelector=function(e,t){return e&&(t||e.data)?{data:e.data}:e},t}();t.ColorHelper=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a="rect";!function(i){function r(e,t,a){if(e){var r=a.start,o=a.end;return i.transformDomain(t,r,o)}return t}function o(t,i,a){if(!t.categories||!t.values||0===t.categories.length||0===t.values.length)return t;if("number"!=typeof i&&"number"!=typeof a)return t;var r=t.categories[0],o=r.values,n=r.objects;if(!o||!n)return t;var s=[],l=[],c=[];if("number"!=typeof i&&(i=o[0]),"number"!=typeof a&&(a=o[o.length-1]),i>a)return t;for(var u=0,h=t.values.length;h>u;u++)l.push([]);for(var d=0,h=o.length;h>d;d++)if(o[d]>=i&&o[d]<=a&&(s.push(o[d]),n&&c.push(n[d]),t.values))for(var p=0;p<t.values.length;p++)l[p].push(t.values[p].values[d]);var g=e.Prototype.inherit(t),m=g.values=e.Prototype.inherit(g.values),f=g.categories=e.Prototype.inherit(t.categories),y=g.categories[0]=e.Prototype.inherit(f[0]);y.values=s,y.objects&&(y.objects=c);for(var d=0,h=t.values.length;h>d;d++){var v=m[d]=e.Prototype.inherit(m[d]);v.values=l[d]}return g}function n(i,a,r,o,n,s,l,c,u,h){var d=r.categoryThickness,p=r.isScalar,g=r.outerPaddingRatio,m=t.AxisHelper.createDomain(i.series,i.categoryMetadata?i.categoryMetadata.type:e.ValueType.fromDescriptor({text:!0}),p,[n,s],h),f=t.AxisHelper.createAxis({pixelSpan:a,dataDomain:m,metaDataColumn:i.categoryMetadata,formatString:t.valueFormatter.getFormatString(i.categoryMetadata,t.columnChartProps.general.formatString),outerPadding:d*g,isCategoryAxis:!0,isScalar:p,isVertical:o,categoryThickness:d,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,a){return t.CartesianHelper.lookupXValue(i,e,a,p)},scaleType:l,axisDisplayUnits:c,axisPrecision:u});return r.categoryThickness=f.categoryThickness,f}function s(e,t){t&&e.attr("draggable","true").on("dragstart",t)}function l(e,t,a,r){return r&&!t||a&&!e?i.DimmedOpacity:i.DefaultOpacity}function c(e,t){for(var i=0,a=Number.MAX_VALUE,r=0,o=t.length;o>r;r++){var n=Math.abs(e-t[r]);a>n&&(a=n,i=r)}return i}function u(e,r,o,n){var s=e.selectAll(t.ColumnChart.SeriesClasses.selector),l="undefined"==typeof n;s.selectAll(a+r).filter(function(e){return e.categoryIndex!==o&&(l||e.categoryIndex===n)}).transition().style("fill-opacity",i.DimmedOpacity),s.selectAll(a+r).filter(function(e){return e.categoryIndex===o}).style("fill-opacity",i.DefaultOpacity)}function h(e,i,a){var r=i.selectAll(t.ColumnChart.SeriesClasses.selector),o=r.data(e.series,function(e){return e.key});return o.enter().append("g").classed(t.ColumnChart.SeriesClasses["class"],!0),o.style({fill:function(e){return e.color}}),o.exit().remove(),o}function d(e,t,r,o,n,s){var l;l=n?function(e){var t=_.filter(e.data,function(e){return!!e.value});return t}:function(e){return e.data};var c=t.selectAll(o.selector),u=c.data(l,function(e){return e.key});return u.enter().append(a).attr("class",function(e){return o["class"].concat(e.highlight?" highlight":"")}),u.style("fill-opacity",function(t){return i.getFillOpacity(t.selected,t.highlight,s,e.hasHighlights)}).style("fill",function(t){return t.color!==e.series[t.seriesIndex].color?t.color:null}).attr(r.shapeLayout),u.exit().remove(),u}function p(e,i,a,r,o,n){if(void 0===o&&(o=!1),e){for(var s=e.data(),l=[],c=0,u=s.length;u>c;c++)Array.prototype.push.apply(l,s[c].data);return t.dataLabelUtils.drawDefaultLabelsForDataPointChart(l,i,a,r,o,n)}t.dataLabelUtils.cleanDataLabels(i)}function g(e){for(var t=e.domain(),i=0,a=t.length;a>i;++i)t[i]===Number.POSITIVE_INFINITY?t[i]=Number.MAX_VALUE:t[i]===Number.NEGATIVE_INFINITY&&(t[i]=-Number.MAX_VALUE);e.domain(t)}function m(e,i){var a=i.xScale,r=i.yScale,o=r(0),n=a(0);switch(e.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:
return n+Math.abs(t.AxisHelper.diffScaled(a,0,e.valueAbsolute))+t.AxisHelper.diffScaled(a,e.position-e.valueAbsolute,0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredBar:return n+t.AxisHelper.diffScaled(a,Math.max(0,e.value),0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:return o+t.AxisHelper.diffScaled(r,e.position,0)-t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredColumn:return o+t.AxisHelper.diffScaled(r,Math.max(0,e.value),0)-t.dataLabelUtils.defaultColumnLabelMargin}}i.DimmedOpacity=.4,i.DefaultOpacity=1,i.applyUserMinMax=r,i.transformDomain=o,i.getCategoryAxis=n,i.applyInteractivity=s,i.getFillOpacity=l,i.getClosestColumnIndex=c,i.setChosenColumnOpacity=u,i.drawSeries=h,i.drawDefaultShapes=d,i.drawDefaultLabels=p,i.normalizeInfinityInScale=g,i.calculatePosition=m}(i=t.ColumnUtil||(t.ColumnUtil={}));var r;!function(e){function t(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}e.clearColumns=t}(r=t.ClusteredUtil||(t.ClusteredUtil={}));var o;!function(i){function a(e,i,a){return void 0===a&&(a=0),t.AxisHelper.diffScaled(e,a,i)}function r(t,i){var a={min:0,max:10};if(0===t.length)return a;var r=d3.min(t,function(e){return d3.min(e.data,function(e){return e.position-e.valueAbsolute})}),o=d3.max(t,function(e){return d3.max(e.data,function(e){return e.position})});return i&&(r=e.Double.roundToPrecision(r,s),o=e.Double.roundToPrecision(o,s)),{min:r,max:o}}function o(e,i,a,r,o){for(var n=0,s=0,l=0;a>l;l++){var c=o.getValueBySeriesAndCategory(l,i);c=t.AxisHelper.normalizeNonFiniteNumber(c),c>0?n+=c:0>c&&(s-=c)}var u=n+s;return{pos:n?n/u/n:1,neg:s?s/u/s:1}}function n(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}var s=1e-4;i.getSize=a,i.calcValueDomain=r,i.getStackedMultiplier=o,i.clearColumns=n}(o=t.StackedUtil||(t.StackedUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=e.data.DataRoleHelper;!function(i){function r(e,t,i){if(e.categories&&e.categories.length>0){var r=e.categories[0];return r.source&&a.hasRole(r.source,t)&&a.hasRole(r.source,i)}return!1}function o(i,a){if(i.categories&&i.categories.length>0){var r=i.categories[0],o=r.values;return r.values.length>0?{categories:o,categoryFormatter:t.valueFormatter.create({format:t.valueFormatter.getFormatString(r.source,a),value:o[0],value2:o[o.length-1],displayUnitSystemType:e.DisplayUnitSystemType.Verbose}),categoryIdentities:r.identity,categoryObjects:r.objects}:{categories:[],categoryFormatter:{format:t.valueFormatter.format}}}return l()}function n(e){return void 0!==e.groupName?e.groupName:e.queryName}function s(e,i,a){var r=e,o=e.displayName;return void 0!==e.groupName&&(r=i.source,o=e.groupName),t.valueFormatter.format(o,t.valueFormatter.getFormatString(r,a))}function l(){return{categories:[null],categoryFormatter:{format:t.valueFormatter.format}}}function c(e,i,a,r){var o=null,n=null;if(e&&a&&a.displayName&&(o=a.displayName),i){var s=[];r&&(s=r.map(function(e){return e?e.displayName:""}).filter(function(e,t,i){return""!==e&&i.indexOf(e)===t}),n=t.valueFormatter.formatListAnd(s))}return{xAxisLabel:o,yAxisLabel:n}}function u(e){var t=d(e);return null!=t&&t.imageUrl===!0}function h(e){var t=d(e);return null!=t&&t.webUrl===!0}function d(e){return e&&e.type&&e.type.misc}function p(e){return e&&e.metadata&&!_.isEmpty(e.metadata.columns)?_.any(e.metadata.columns,function(e){return u(e)===!0}):!1}function g(e,i,a){var r=t.valueFormatter.getFormatString(i,a,!0);return!r&&i&&(r=i.format),t.valueFormatter.format(e,r)}i.categoryIsAlsoSeriesRole=r,i.getPivotedCategories=o,i.getSeriesName=n,i.getFormattedLegendLabel=s,i.createAxesLabels=c,i.isImageUrlColumn=u,i.isWebUrlColumn=h,i.hasImageUrlColumn=p,i.formatFromMetadataColumn=g}(i=t.converterHelper||(t.converterHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=jsCommon.CssConstants.createClassAndSelector,r=jsCommon.PixelConverter,o=t.labelStyle;!function(i){function n(e,t){e&&(void 0!==e.show&&(t.show=e.show),void 0!==e.showSeries&&(t.show=e.showSeries),void 0!==e.color&&(t.labelColor=e.color.solid.color),void 0!==e.labelDisplayUnits&&(t.displayUnits=e.labelDisplayUnits),void 0!==e.labelPrecision&&(t.precision=e.labelPrecision>=0?e.labelPrecision:i.defaultLabelPrecision),void 0!==e.fontSize&&(t.fontSize=e.fontSize),void 0!==e.showAll&&(t.showLabelPerSeries=e.showAll),void 0!==e.labelStyle&&(t.labelStyle=e.labelStyle))}function s(e,t){n(e,t),e&&void 0!==e.labelDensity&&(t.labelDensity=e.labelDensity)}function l(e,t,a){return void 0===e&&(e=!1),{show:e,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:t||i.defaultLabelColor,formatterOptions:null,fontSize:a||i.DefaultFontSizeInPt}}function c(e,t,i){var a=l(!0,e,i);return a.showCategory=!0,a.categoryLabelColor=t,a}function u(){return{show:!1,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultInsideLabelColor,showCategory:!0,formatterOptions:null}}function h(){return{show:!1,labelColor:i.defaultInsideLabelColor,fontSize:i.DefaultFontSizeInPt,displayUnits:0,precision:i.defaultLabelPrecision,showCategory:!0}}function d(e){var t=l(!1,void 0);return t.position=null,t.labelColor=void 0,t}function p(){return{show:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,formatterOptions:null,fontSize:i.DefaultFontSizeInPt}}function g(e){return{show:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,formatterOptions:null,fontSize:i.DefaultFontSizeInPt,labelDensity:e?t.NewDataLabelUtils.LabelDensityMax:t.NewDataLabelUtils.LabelDensityMin}}function m(){return{show:!1,showCategory:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultInsideLabelColor,formatterOptions:null,fontSize:i.DefaultFontSizeInPt}}function f(){var e=i.getDefaultLabelSettings(!0,i.defaultLabelColor,i.DefaultFontSizeInPt);return e.labelStyle=o.category,e}function y(){return{show:!0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:null,position:null,fontSize:i.minLabelFontSize,formatterOptions:null}}function v(){return{show:!0,position:e.visuals.labelPosition.insideCenter,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,formatterOptions:null,fontSize:i.DefaultFontSizeInPt}}function b(){return{show:!1,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,position:null,showCategory:!0,formatterOptions:null}}function C(t,a){if(t!==i.defaultLabelPrecision)return t;if("g"!==a&&"G"!==a){if(a){var r=a.split(";")[0],o=e.NumberFormat.getCustomFormatMetadata(r,!0);if(o.hasDots)return o.precision}return U}}function S(i,a,r,o,n,s,l){void 0===n&&(n=!1);var c=new e.DataLabelManager,u=c.hideCollidedLabels(o,i,r),h=n&&!!s,d=w(u,a,!1,h);return d?(h?(d.text(function(e){return e.labeltext}).transition().duration(s).style(r.style).style("opacity",l?function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,l,!1)}:1).attr({x:function(e){return e.labelX},y:function(e){return e.labelY}}),d.exit().transition().duration(s).style("opacity",0).remove()):(d.attr({x:function(e){return e.labelX},y:function(e){return e.labelY}}).text(function(e){return e.labeltext}).style(r.style),d.exit().remove()),d):void 0}function x(e,t,i,a,r){void 0===a&&(a=!1);var o=e.filter(i.filter),n=w(o,t);return n?(n.attr(i.labelLayout).text(i.labelText).style(i.style),a&&r&&n.transition().duration(r),n.exit().remove(),n):void 0}function w(e,t,i,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),0===e.length)return P(t,!0),null;t.select(Y.selector).empty()&&t.append("g").classed(Y["class"],!0);var r=null!=e[0].key,o=null!=e[0].identity,n=r?function(e){return e.key}:o?function(e){return e.identity.getKey()}:void 0,s=i?t.select(Y.selector).selectAll(X.selector).data(e,function(e){return e.data.identity.getKey()}):null!=n?t.select(Y.selector).selectAll(X.selector).data(e,n):t.select(Y.selector).selectAll(X.selector).data(e),l=s.enter().append("text").classed(X["class"],!0);return a&&l.style("opacity",0),s}function P(e,t){void 0===t&&(t=!1);var i=[],a=e.selectAll(X.selector).data(i);if(a.exit().remove(),e.selectAll(Y.selector).remove(),t){var r=e.selectAll(q.selector).data(i);r.exit().remove(),e.selectAll(K.selector).remove()}}function D(e,i,a){e.selectAll(X.selector).style("fill-opacity",function(e){var r=t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a)<1?0:1;return r})}function L(t){var a={text:t.formatter?t.formatter.format(t.label):e.formattingService.formatValue(t.label,t.format),fontFamily:i.LabelTextProperties.fontFamily,fontSize:r.fromPoint(t.fontSize),fontWeight:i.LabelTextProperties.fontWeight};return e.TextMeasurementService.getTailoredTextOrDefault(a,t.maxWidth?t.maxWidth:i.maxLabelWidth)}function T(e,t,i,a){return{x:function(i){return e.scale(i.categoryIndex)+t/2},y:function(e){return _(i.scale,e,a)}}}function _(t,a,r){var o=t(0)-t(Math.abs(a.value)),n=t(a.position),s=t(r[0]),l=t(a.position+a.value);if(a.value<0){var c={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},u=n+o+e.TextMeasurementService.estimateSvgTextHeight(c);if(s>u)return u}else{var h=n-o-i.labelMargin;if(h>0)return h}return a.isLabelInside=!0,V(n,l,s)}function V(e,t,i){return e=0>e?0:e,e=e>i?i:e,t=0>t?0:t,t=t>i?i:t,Math.abs(t-e)/2+Math.min(e,t)}function M(a,r,o){if(null==a||null===a.value)return!1;var n={text:o.labelText(a),fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},s=t.WaterfallChart.getRectTop(r.scale,a.position,a.value)-i.labelMargin;if(s>0)return!0;var l=e.TextMeasurementService.measureSvgTextWidth(n),c=e.TextMeasurementService.estimateSvgTextHeight(n),u=o.categoryWidth,h=Math.abs(t.AxisHelper.diffScaled(r.scale,Math.max(0,Math.abs(a.value)),0));return!(l>u||c>h)}function N(e){return{labelText:function(t){return L({label:t.labeltext,fontSize:e.fontSize})},labelLayout:{x:function(e){return e.x},y:function(t){var a=t.radius+i.labelMargin;return 0===e.position?t.y-a:t.y+a}},filter:function(e){return null!=e&&null!=e.labeltext},style:{fill:function(e){return e.labelFill},"font-size":r.fromPoint(e.fontSize)}}}function A(e,t,a,r,o,n,s,l){var c=r?i.hundredPercentFormat:null,u=j(),h=s?s.hasSelection():!1;return{labelText:function(e){var t=null!=c?c:e.labelFormatString,a=k(o,e.labelSettings),r=u.getOrCreate(t,e.labelSettings,a);return L({label:r.format(e.value),maxWidth:i.maxLabelWidth})},labelLayout:t,filter:function(t){return i.getColumnChartLabelFilter(t,h,e.hasHighlights,n,l)},style:{fill:function(e){return e.labelFill},"text-anchor":a?"middle":"start"}}}function O(a,r,o){var n,s,l=r.xScale,c=r.yScale,u=r.columnWidth,h={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},d=e.TextMeasurementService.measureSvgTextWidth(h),p=e.TextMeasurementService.estimateSvgTextHeight(h),g=!1,m=t.ColumnUtil.calculatePosition(a,r);switch(a.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:(!a.lastSeries||m+d>o||a.chartType===t.ColumnChartType.hundredPercentStackedBar)&&(n=-t.StackedUtil.getSize(l,a.valueAbsolute),s=u,g=!0);break;case t.ColumnChartType.clusteredBar:m+d>o&&(n=Math.abs(t.AxisHelper.diffScaled(l,0,a.value)),s=u,g=!0);break;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:(!a.lastSeries||0>=m||a.chartType===t.ColumnChartType.hundredPercentStackedColumn)&&(n=u,s=t.StackedUtil.getSize(c,a.valueAbsolute),g=!0);break;case t.ColumnChartType.clusteredColumn:0>=m&&(n=u,s=Math.abs(t.AxisHelper.diffScaled(c,0,a.value)),g=!0);break;default:return!0}return!g||!(d>n||p>s)}function I(e,i,a,r,o){var n=i?t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a):t.ColumnUtil.getFillOpacity(e.selected,e.highlight,i,a);return null!=e&&null!=e.value&&O(e,r,o)&&1===n}function R(e,a,r,o,n){return{labelText:function(e){return L({label:e.formattedCategory.getValue(),maxWidth:2*i.maxLabelWidth})},labelLayout:{x:function(t){return e(t.x)},y:function(e){var s=t.ScatterChart.getBubbleRadius(e.radius,n,o)+i.labelMargin;return 0===r.position?a(e.y)-s:a(e.y)+s}},filter:function(e){return null!=e&&null!=e.formattedCategory.getValue()},style:{fill:function(e){return e.labelFill}}}}function F(e,t,a,o,n){var s=j();return{labelText:function(e){var t=k(n,e.labelSettings),i=s.getOrCreate(e.labelFormatString,e.labelSettings,t);return L({label:i.format(e.value)})},labelLayout:{x:function(t){return e(o?t.categoryValue:t.categoryIndex)},y:function(e){return 0===a.position?t(e.value)-i.labelMargin:t(e.value)+i.labelMargin}},filter:function(e){return null!=e&&null!=e.value},style:{fill:function(e){return e.labelFill},"font-size":function(e){return r.fromPoint(e.labelSettings.fontSize)}}}}function H(a,o,n,s,l){var c=o.categoryScale,u=o.valueScale,h=o.margin.left,d=.7,p=o.categoryScale.rangeBand(),g=o.maxWidth/2,m=t.valueFormatter.getFormatString(a.valuesMetadata[0],t.funnelChartProps.general.formatString),f=e.TextMeasurementService.measureSvgTextWidth,y=null;if(0===s.displayUnits){var v=d3.min(a.slices,function(e){return e.value}),b=d3.max(a.slices,function(e){return e.value});y=Math.max(Math.abs(v),Math.abs(b))}var C=j();return{labelText:function(e){var i=Math.abs(c(e.value)-c(0)),a=Math.abs(c(e.value)-c(0))-2*n,r=g-i/2-n,o=null!=m?m:e.labelFormatString,l=Math.max(a,r),u=C.getOrCreate(o,s,y),h=u.format(t.FunnelChart.getFunnelSliceValue(e,!0));return L({label:h,maxWidth:l,fontSize:s.fontSize})},labelLayout:{y:function(t,a){var o={text:t.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:r.fromPoint(s.fontSize),fontWeight:i.LabelTextProperties.fontWeight},n=e.TextMeasurementService.estimateSvgTextHeight(o);return c(t.categoryOrMeasureIndex)+p/2+n/2},x:function(e){var a=Math.abs(u(e.value)-u(0)),o=Math.abs(u(e.value)-u(0))-2*n,l=g-a/2-n,c=Math.max(o,l),d=null!=m?m:e.labelFormatString,p=C.getOrCreate(d,s,y),v=p.format(t.FunnelChart.getFunnelSliceValue(e,!0)),b={text:L({label:v,maxWidth:c}),fontFamily:i.LabelTextProperties.fontFamily,fontSize:r.fromPoint(s.fontSize),fontWeight:i.LabelTextProperties.fontWeight},S=f(b),x=s.position;switch(x===t.labelPosition.outsideEnd&&S>l||0===e.value?x=t.labelPosition.insideCenter:x===t.labelPosition.insideCenter&&S>o&&(x=t.labelPosition.outsideEnd),x){case t.labelPosition.outsideEnd:return h+g+a/2+n+S/2;default:return e.labelFill=0!==e.value?i.defaultInsideLabelColor:e.labelFill,h+g}},dy:"-0.15em"},filter:function(t){if(null==t||null==t.value||a.hasHighlights!==!!t.highlight)return!1;var o={text:t.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:r.fromPoint(s.fontSize),fontWeight:i.LabelTextProperties.fontWeight},n=e.TextMeasurementService.estimateSvgTextHeight(o)*d;return p>n},style:{fill:function(e){return e.labelFill},"fill-opacity":function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,!1,!1)},"font-size":function(e){return r.fromPoint(s.fontSize)}}}}function z(e){if(e.dataLabelsSettings){var t={objectName:"labels",selector:e.selector,properties:{}};if(e.show&&e.selector?t.properties.showSeries=e.dataLabelsSettings.show:e.show&&(t.properties.show=e.dataLabelsSettings.show),t.properties.color=e.dataLabelsSettings.labelColor||i.defaultLabelColor,e.displayUnits&&(t.properties.labelDisplayUnits=e.dataLabelsSettings.displayUnits),e.precision){var a=e.dataLabelsSettings.precision;t.properties.labelPrecision=a===i.defaultLabelPrecision?null:a}if(e.position&&(t.properties.labelPosition=e.dataLabelsSettings.position,e.positionObject&&(t.validValues={labelPosition:e.positionObject})),e.labelStyle&&(t.properties.labelStyle=e.dataLabelsSettings.labelStyle),e.fontSize&&(t.properties.fontSize=e.dataLabelsSettings.fontSize),e.labelDensity){var r=e.dataLabelsSettings;r&&(t.properties.labelDensity=r.labelDensity)}return e.showAll&&(t.properties.showAll=e.dataLabelsSettings.showLabelPerSeries),e.enumeration.pushInstance(t)}}function G(e,t,a,r,o){void 0===r&&(r=!1);var n=t?t:p(),s={objectName:"categoryLabels",selector:null,properties:{show:r?n.showCategory:n.show,fontSize:t?t.fontSize:i.DefaultFontSizeInPt}};a&&(s.properties.color=n.categoryLabelColor?n.categoryLabelColor:n.labelColor),o&&(s.properties.fontSize=o),e.pushInstance(s)}function k(e,t){return e&&e.displayUnit&&0===t.displayUnits?e.displayUnit.value:null}function j(){return{cache:{defaultFormatter:null},getOrCreate:function(e,i,a){if(e){var r={formatString:e,displayUnits:i.displayUnits,precision:C(i.precision,e),value2:a},o=JSON.stringify(r);return this.cache[o]||(this.cache[o]=t.valueFormatter.create(E(i,e,a,r.precision))),this.cache[o]}return this.cache.defaultFormatter||(this.cache.defaultFormatter=t.valueFormatter.create(E(i,e,a,i.precision))),this.cache.defaultFormatter}}}function E(t,i,a,r){return{displayUnitSystemType:e.DisplayUnitSystemType.DataLabels,format:i,precision:r,value:t.displayUnits,value2:a,allowFormatBeautification:!0}}function B(e,t){return e>t}function W(e,t){return e>t}i.minLabelFontSize=8,i.labelMargin=8,i.maxLabelWidth=50,i.defaultColumnLabelMargin=5,i.defaultColumnHalfLabelHeight=4,i.DefaultDy="-0.15em",i.DefaultFontSizeInPt=9,i.StandardFontFamily="wf_segoe-ui_normal",i.LabelTextProperties={fontFamily:"wf_standard-font",fontSize:r.fromPoint(i.DefaultFontSizeInPt),fontWeight:"normal"},i.defaultLabelColor="#777777",i.defaultInsideLabelColor="#ffffff",i.hundredPercentFormat="0.00 %;-0.00 %;0.00 %",i.defaultLabelPrecision=void 0;var U=0,Y=a("labels"),K=a("lines"),X=a("data-labels"),q=a("line-label");i.updateLabelSettingsFromLabelsObject=n,i.updateLineChartLabelSettingsFromLabelsObject=s,i.getDefaultLabelSettings=l,i.getDefaultCardLabelSettings=c,i.getDefaultTreemapLabelSettings=u,i.getDefaultSunburstLabelSettings=h,i.getDefaultColumnLabelSettings=d,i.getDefaultPointLabelSettings=p,i.getDefaultLineChartLabelSettings=g,i.getDefaultMapLabelSettings=m,i.getDefaultDonutLabelSettings=f,i.getDefaultGaugeLabelSettings=y,i.getDefaultFunnelLabelSettings=v,i.getDefaultKpiLabelSettings=b,i.getLabelPrecision=C,i.drawDefaultLabelsForDataPointChart=S,i.drawDefaultLabelsForFunnelChart=x,i.cleanDataLabels=P,i.setHighlightedLabelsOpacity=D,i.getLabelFormattedText=L,i.getLabelLayoutXYForWaterfall=T,i.doesDataLabelFitInShape=M,i.getMapLabelLayout=N,i.getColumnChartLabelLayout=A,i.getColumnChartLabelFilter=I,i.getScatterChartLabelLayout=R,i.getLineChartLabelLayout=F,i.getFunnelChartLabelLayout=H,i.enumerateDataLabels=z,i.enumerateCategoryLabels=G,i.createColumnFormatterCacheManager=j,i.getOptionsForLabelFormatter=E,i.isTextWidthOverflows=B,i.isTextHeightOverflows=W}(i=t.dataLabelUtils||(t.dataLabelUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t,i,a,r){void 0===r&&(r=0);var o,n,s,l=2.05;if(r){var c=r,u=i.radius*i.outerArcRadiusRatio,h=i.radius/2*i.innerArcRadiusRatio;n=[Math.cos(c)*u,Math.sin(c)*u],s=[Math.cos(c)*h,Math.sin(c)*h]}else n=i.outerArc.centroid(t),s=i.arc.centroid(t);var d=a.x,p=e.NewDataLabelUtils.maxLabelOffset/2;return d+=0>d?-p:p,o=[d,a.y],s[0]*=l,s[1]*=l,[s,n,o]}function a(e){if(e&&e.length>2){var i={width:Math.abs(e[1][0]-e[0][0]),height:Math.abs(e[1][1]-e[0][1])},a={width:Math.abs(e[2][0]-e[1][0]),height:t.LineStrokeWidth};return[i,a]}return null}function r(t){var i=0>t?-e.NewDataLabelUtils.maxLabelOffset:e.NewDataLabelUtils.maxLabelOffset;return t+=i}function o(t,i){return i.width/2-Math.abs(t)-e.NewDataLabelUtils.maxLabelOffset}t.LineStrokeWidth=1,t.DiagonalLineIndex=0,t.HorizontalLineIndex=1,t.getLabelLeaderLineForDonutChart=i,t.getLabelLeaderLinesSizeForDonutChart=a,t.getXPositionForDonutLabel=r,t.getSpaceAvailableForDonutLabels=o}(t=e.DonutLabelUtils||(e.DonutLabelUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=jsCommon.CssConstants.createClassAndSelector,r=jsCommon.PixelConverter;!function(i){function o(e,t,a,o,n){void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===n&&(n=!1);var s=_.filter(t,function(e){return e.isVisible}),l=e.selectAll(S.selector).data(s,y);l.enter().append("text").classed(S["class"],!0);var c={x:function(e){return e.boundingBox.left+e.boundingBox.width/2},y:function(e){return e.hasBackground?e.boundingBox.top+e.boundingBox.height-i.verticalLabelBackgroundPadding:e.boundingBox.top+e.boundingBox.height},dy:"-0.15em"};a&&(c.dy=void 0),l.text(function(e){return e.text}).attr(c).style({fill:function(e){return e.fill},"font-size":function(e){return r.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)},"text-anchor":function(e){return e.textAnchor}}),l.exit().remove();var u=_.filter(o?t:[],function(e){return e.isVisible&&!_.isEmpty(e.secondRowText)}),h=e.selectAll(x.selector).data(u,function(e,t){return e.identity?e.identity.getKeyWithoutHighlight():t});return h.enter().append("text").classed(x["class"],!0),c={x:function(e){return e.boundingBox.left+e.boundingBox.width/2},y:function(e){var t=void 0!==e.text?e.boundingBox.height/2:e.boundingBox.height;return e.hasBackground?e.boundingBox.top+t-i.verticalLabelBackgroundPadding:e.boundingBox.top+t},dy:"-0.15em"},a&&(c.dy=void 0),h.text(function(e){return e.secondRowText}).attr(c).style({fill:function(e){return e.fill},"font-size":function(e){return r.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)},"text-anchor":function(e){return e.textAnchor}}),h.exit().remove(),n&&(l.append("title").text(function(e){return e.tooltip}),h.append("title").text(function(e){return e.tooltip}),l.style("pointer-events","all"),h.style("pointer-events","all")),l}function n(e,t,a,o,n){void 0===o&&(o=!1),void 0===n&&(n="cubic-in-out");var s=e.selectAll(S.selector).data(_.filter(t,function(e){return e.isVisible}),y);s.enter().append("text").classed(S["class"],!0).style("opacity",0);var l={x:function(e){return e.boundingBox.left+e.boundingBox.width/2},y:function(e){return e.boundingBox.top+e.boundingBox.height},dy:"-0.15em"};return o&&(l.dy=void 0),s.text(function(e){return e.text}).style({fill:function(e){return e.fill},"font-size":function(e){return r.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)}}).transition().ease(n).duration(a).attr(l).style("opacity",1),s.exit().transition().duration(a).style("opacity",0).remove(),s}function s(e,t,a,r){var o=e.selectAll("rect").data(_.filter(t,function(e){return e.isVisible}),y);return o.enter().append("rect"),o.attr({x:function(e){return e.boundingBox.left-i.horizontalLabelBackgroundPadding},y:function(e){return e.boundingBox.top-i.verticalLabelBackgroundPadding},rx:v,ry:v,width:function(e){return e.boundingBox.width+2*i.horizontalLabelBackgroundPadding},height:function(e){return void 0===e.text&&void 0===e.secondRowText?0:e.boundingBox.height+2*i.verticalLabelBackgroundPadding}}).style("fill",a?a:"#000000").style("fill-opacity",null!=r?r:1),o.exit().remove(),o}function l(e,i,a,r){e.select(w.selector).empty()&&e.append("g").classed(w["class"],!0);var o=e.select(w.selector).selectAll("polyline").data(i,a);o.enter().append("polyline").classed(P["class"],!0),o.attr("points",function(e){return e.leaderLinePoints}).style({stroke:function(e){return r?r:e.fill},"stroke-width":t.DonutLabelUtils.LineStrokeWidth}),o.exit().remove()}function c(t,i,a){return a?a.format(t):e.formattingService.formatValue(t,i)}function u(e,t){return e&&e.displayUnit&&0===t.displayUnits?e.displayUnit.value:null}function h(t,i){if(t!==b)return t;if(i){var a=i.split(";")[0],r=e.NumberFormat.getCustomFormatMetadata(a,!0);if(r.hasDots)return r.precision}return C}function d(){return{cache:{defaultFormatter:null},getOrCreate:function(e,i,a){if(e){var r={formatString:e,displayUnits:i.displayUnits,precision:h(i.precision,e),value2:a},o=JSON.stringify(r);return this.cache[o]||(this.cache[o]=t.valueFormatter.create(p(i,e,a,r.precision))),this.cache[o]}return this.cache.defaultFormatter||(this.cache.defaultFormatter=t.valueFormatter.create(p(i,e,a,i.precision))),this.cache.defaultFormatter}}}function p(t,i,a,r){return{displayUnitSystemType:e.DisplayUnitSystemType.DataLabels,format:i,precision:r,value:t.displayUnits,value2:a,allowFormatBeautification:!0}}function g(e){for(var i=[],a={},r=function(e,i,a){return i.some(function(i){return a?t.shapes.Rect.equals(e.parentShape.rect,i.rect):t.shapes.Point.equals(e.parentShape.point,i.point)})},o=0,n=e;o<n.length;o++){var s=n[o],l=1===s.parentType,c=a[s.text];c?r(s,c,l)||(i.push(s),c.push(s.parentShape)):(i.push(s),a[s.text]=[s.parentShape])}return i}function m(e){switch(e){case 9:return{maximumOffset:t.ScatterChart.dataLabelLayoutMaximumOffset,startingOffset:t.ScatterChart.dataLabelLayoutStartingOffset,offsetIterationDelta:t.ScatterChart.dataLabelLayoutOffsetIterationDelta,allowLeaderLines:!0,attemptToMoveLabelsIntoViewport:!0};default:return{maximumOffset:i.maxLabelOffset,startingOffset:i.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0}}}function f(t,a){var r=i.LabelTextProperties,o={text:t,fontFamily:r.fontFamily,fontSize:jsCommon.PixelConverter.fromPoint(a),fontWeight:r.fontWeight};return{width:e.TextMeasurementService.measureSvgTextWidth(o),height:e.TextMeasurementService.estimateSvgTextHeight(o)}}function y(e,t){return e.key?e.key:e.identity?e.identity.getKeyWithoutHighlight():t}i.DefaultLabelFontSizeInPt=9,i.MapPolylineOpacity=.5,i.LabelDensityBufferFactor=3,i.LabelDensityPadding=6,i.LabelDensityMin=0,i.LabelDensityMax=6,i.startingLabelOffset=8,i.maxLabelOffset=8,i.maxLabelWidth=50,i.hundredPercentFormat="0.00 %;-0.00 %;0.00 %",i.LabelTextProperties={fontFamily:"wf_standard-font",fontSize:r.fromPoint(i.DefaultLabelFontSizeInPt),fontWeight:"normal"},i.defaultLabelColor="#777777",i.defaultInsideLabelColor="#ffffff",i.horizontalLabelBackgroundPadding=4,i.verticalLabelBackgroundPadding=2;var v=4,b=void 0,C=0;i.labelGraphicsContextClass=a("labelGraphicsContext"),i.labelBackgroundGraphicsContextClass=a("labelBackgroundGraphicsContext");var S=a("label"),x=a("label-second-line"),w=a("leader-lines"),P=a("line-label");i.drawDefaultLabels=o,i.animateDefaultLabels=n,i.drawLabelBackground=s,i.drawLabelLeaderLines=l,i.getLabelFormattedText=c,i.getDisplayUnitValueFromAxisFormatter=u,i.createColumnFormatterCacheManager=d,i.removeDuplicates=g,i.getDataLabelLayoutOptions=m,i.getTextSize=f}(i=t.NewDataLabelUtils||(t.NewDataLabelUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var i=parseFloat(t);if(e){var a=p[e.graphic.toUpperCase()];if(a&&!isNaN(i)){var r=a.statusValues;e.normalizedFiveStateKpiRange&&5===r.length&&(i=2*i);var o=i+Math.floor(r.length/2);return[a.kpiIconClass,r[o]].join(" ").trim()}}}function i(e,t){return e?1===t?[o,n,e].join(" "):[o,e].join(" "):void 0}function a(e,a,r){var o=t(e,a);return i(o,r)}function r(e,a,r){var o=e&&e.kpi;if(o){var n=t(o,a);if(n)return{caption:n,statusGraphic:o.graphic,"class":i(n,r)}}}var o="powervisuals-glyph",n="big-kpi",s=["kpi-red","kpi-yellow","kpi-green"],l={kpiIconClass:"circle",statusValues:s},c={kpiIconClass:"",statusValues:["circle-x kpi-red","circle-exclamation kpi-yellow","circle-checkmark kpi-green"]},u={kpiIconClass:"traffic-light",statusValues:s},h={kpiIconClass:"",statusValues:["rhombus kpi-red","triangle kpi-yellow","circle kpi-green"]},d={kpiIconClass:"",statusValues:["circle-empty","circle-one-quarter","circle-half","circle-three-quarters","circle-full"]},p={"THREE CIRCLES COLORED":l,"TRAFFIC LIGHT - SINGLE":l,"THREE FLAGS COLORED":{kpiIconClass:"flag",statusValues:s},"ROAD SIGNS":c,"THREE SYMBOLS CIRCLED COLORED":c,"TRAFFIC LIGHT":u,"THREE TRAFFIC LIGHTS RIMMED COLORED":u,"THREE SYMBOLS UNCIRCLED COLORED":{kpiIconClass:"",statusValues:["x kpi-red","exclamation kpi-yellow","checkmark kpi-green"]},SHAPES:h,"SMILEY FACE":h,THERMOMETER:h,CYLINDER:h,"THREE SIGNS COLORED":h,"THREE STARS COLORED":{kpiIconClass:"star-stacked",statusValues:["star-empty","star-half-full","star-full"]},"FIVE BARS COLORED":{kpiIconClass:"bars-stacked",statusValues:["bars-zero","bars-one","bars-two","bars-three","bars-four"]},"FIVE BOXES COLORED":{kpiIconClass:"boxes-stacked",statusValues:["boxes-zero","boxes-one","boxes-two","boxes-three","boxes-four"]},"FIVE QUARTERS COLORED":d,"GAUGE - ASCENDING":d,"GAUGE - DESCENDING":{kpiIconClass:"",statusValues:["circle-full","circle-three-quarters","circle-half","circle-one-quarter","circle-empty"]},"STANDARD ARROW":{kpiIconClass:"",statusValues:["arrow-down","arrow-right-down","arrow-right","arrow-right-up","arrow-up"]},"VARIANCE ARROW":{kpiIconClass:"",statusValues:["arrow-down kpi-red","arrow-right kpi-yellow","arrow-up kpi-green"]},"STATUS ARROW - ASCENDING":{kpiIconClass:"",statusValues:["arrow-down kpi-red","arrow-right-down kpi-yellow","arrow-right kpi-yellow","arrow-right-up kpi-yellow","arrow-up kpi-green"]},"STATUS ARROW - DESCENDING":{kpiIconClass:"",statusValues:["arrow-up kpi-green","arrow-right-up kpi-yellow","arrow-right kpi-yellow","arrow-right-down kpi-yellow","arrow-down kpi-red"]}};e.getClassForKpi=a,e.getKpiImageMetadata=r}(t=e.KpiUtil||(e.KpiUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){function a(a,r,o,n){if(_.isEmpty(r)){var s={selector:{id:"0"},properties:{show:!1,value:"",lineColor:{solid:{color:o}},transparency:50,style:t.lineStyle.dashed,position:t.referenceLinePosition.back,dataLabelShow:!1},objectName:n};return void a.pushInstance(s)}for(var l=0,c=r;l<c.length;l++){var u=c[l],h=u.object,d=e.DataViewObject.getValue(h,i.referenceLineProps.show,!1),p=e.DataViewObject.getValue(h,i.referenceLineProps.value),g=e.DataViewObject.getValue(h,i.referenceLineProps.lineColor,{solid:{color:o}}),m=e.DataViewObject.getValue(h,i.referenceLineProps.transparency,50),f=e.DataViewObject.getValue(h,i.referenceLineProps.style,t.lineStyle.dashed),y=e.DataViewObject.getValue(h,i.referenceLineProps.position,t.referenceLinePosition.back),v=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelShow,!1),s={selector:{id:u.id},properties:{show:d,value:p,lineColor:g,transparency:m,style:f,position:y,dataLabelShow:v},objectName:n};if(v){var b=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelColor,{solid:{color:o}}),C=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelHorizontalPosition,t.referenceLineDataLabelHorizontalPosition.left),S=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelVerticalPosition,t.referenceLineDataLabelVerticalPosition.above),x=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelDecimalPoints,void 0)<0?void 0:e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelDecimalPoints,void 0),w=e.DataViewObject.getValue(h,i.referenceLineProps.dataLabelDisplayUnits,0);s.properties[i.referenceLineProps.dataLabelColor]=b,s.properties[i.referenceLineProps.dataLabelHorizontalPosition]=C,s.properties[i.referenceLineProps.dataLabelVerticalPosition]=S,s.properties[i.referenceLineProps.dataLabelDecimalPoints]=x,s.properties[i.referenceLineProps.dataLabelDisplayUnits]=w}a.pushInstance(s)}}function r(a){var r=a.graphicContext,o=a.axes,n=a.referenceLineProperties,s=a.isHorizontal,l=a.viewport,c=a.classAndSelector,u=o.x.scale,h=o.y1.scale,d=e.DataViewObject.getValue(n,i.referenceLineProps.value,0),p=e.DataViewObject.getValue(n,i.referenceLineProps.lineColor,{solid:{color:a.defaultColor}}),g=e.DataViewObject.getValue(n,i.referenceLineProps.transparency),m=e.DataViewObject.getValue(n,i.referenceLineProps.style,t.lineStyle.dashed),f=e.DataViewObject.getValue(n,i.referenceLineProps.position,t.referenceLinePosition.back),y=r.select(c.selector),v=$(y[0]).index(),b=v>1?t.referenceLinePosition.front:t.referenceLinePosition.back,C=-1!==v,S=b!==f;C&&S&&y.remove(),C&&!S||(y=f===t.referenceLinePosition.back?r.insert("line",":first-child"):r.append("line"));
var x=s?0:u(d),w=s?h(d):0,P=s?l.width:u(d),D=s?h(d):l.height;y.attr({"class":c["class"],x1:x,y1:w,x2:P,y2:D}).style({stroke:p.solid.color}),null!=g&&y.style("stroke-opacity",(100-g)/100),m===t.lineStyle.dashed?y.style("stroke-dasharray","5, 5"):m===t.lineStyle.dotted?y.style({"stroke-dasharray":"1, 5","stroke-linecap":"round"}):m===t.lineStyle.solid&&y.style({"stroke-dasharray":null,"stroke-linecap":null})}function o(a){var r=5,o=a.axes,n=a.referenceLineProperties,s=a.isHorizontal,l=a.viewport,c=o.x.scale,u=o.y1.scale,h=e.DataViewObject.getValue(n,i.referenceLineProps.value,0),d=e.DataViewObject.getValue(n,i.referenceLineProps.dataLabelColor,{solid:{color:a.defaultColor}}),p=n[i.referenceLineProps.dataLabelDecimalPoints]<0?void 0:n[i.referenceLineProps.dataLabelDecimalPoints],g=n[i.referenceLineProps.dataLabelHorizontalPosition]||t.referenceLineDataLabelHorizontalPosition.left,m=n[i.referenceLineProps.dataLabelVerticalPosition]||t.referenceLineDataLabelVerticalPosition.above,f=e.DataViewObject.getValue(n,i.referenceLineProps.dataLabelDisplayUnits,0),y=s?o.y1.formatter:o.x.formatter,v=y;if(null!=y.options){var b=e.Prototype.inherit(y.options);b.precision=p,b.value=f,b.detectAxisPrecision=!1,v=t.valueFormatter.create(b)}var C,S,x=t.NewDataLabelUtils.getLabelFormattedText(v.format(h)),w={text:x,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.dataLabelUtils.LabelTextProperties.fontWeight},P=e.TextMeasurementService.measureSvgTextWidth(w),D=e.TextMeasurementService.estimateSvgTextHeight(w),L=s?0:c(h),T=s?u(h):0,_=s?l.width:c(h),V=s?u(h):l.height,M=[1];s?(C=g===t.referenceLineDataLabelHorizontalPosition.left?L+r:_-P/2-r,S=T,M=m===t.referenceLineDataLabelVerticalPosition.above?[1]:[2]):(C=L,S=m===t.referenceLineDataLabelVerticalPosition.above?T+D/2+r:V-D/2-r,M=g===t.referenceLineDataLabelHorizontalPosition.left?[4]:[8]);var N,A=e.TextMeasurementService.measureSvgTextWidth(w),O=e.TextMeasurementService.estimateSvgTextHeight(w,!0);return N={point:{x:C,y:S},radius:0,validPositions:M},{isPreferred:!0,text:x,textSize:{width:A,height:O},outsideFill:d.solid.color,insideFill:null,parentShape:N,parentType:0,fontSize:9,identity:null,secondRowText:null,key:a.key}}function n(t){var a=null;return t&&e.DataViewObject.getValue(t,i.referenceLineProps.show,!1)&&(a=e.DataViewObject.getValue(t,i.referenceLineProps.value,null)),a}i.referenceLineProps={show:"show",lineColor:"lineColor",transparency:"transparency",value:"value",style:"style",position:"position",dataLabelShow:"dataLabelShow",dataLabelColor:"dataLabelColor",dataLabelDecimalPoints:"dataLabelDecimalPoints",dataLabelHorizontalPosition:"dataLabelHorizontalPosition",dataLabelVerticalPosition:"dataLabelVerticalPosition",dataLabelDisplayUnits:"dataLabelDisplayUnits"},i.enumerateObjectInstances=a,i.render=r,i.createLabelDataPoint=o,i.extractReferenceLineValue=n}(i=t.ReferenceLineHelper||(t.ReferenceLineHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){return{x:d3.event.clientX,y:d3.event.clientY}}function i(e,t){a(e,t),r(e,t)}function a(e,t){e.on("click",function(e){return c(e,t)})}function r(e,t){e.on("contextmenu",function(e){return l(e,t)})}function o(e,t){n(e,t),s(e,t)}function n(e,t){e.on("click",function(){var e=d3.event.target,i=d3.select(e).datum();c(i,t)})}function s(e,t){e.on("contextmenu",function(){var e=d3.event.target,i=d3.select(e).datum();l(i,t)})}function l(t,i){if(!d3.event.ctrlKey){d3.event.preventDefault();var a=e.getPositionOfLastInputEvent();i.handleContextMenu(t,a)}}function c(e,t){t.handleSelection(e,d3.event.ctrlKey)}e.getPositionOfLastInputEvent=t,e.registerStandardInteractivityHandlers=i,e.registerStandardSelectionHandler=a,e.registerStandardContextMenuHandler=r,e.registerGroupInteractivityHandlers=o,e.registerGroupSelectionHandler=n,e.registerGroupContextMenuHandler=s}(t=e.InteractivityUtils||(e.InteractivityUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,a,r){var o=new i(t,a,r);return o.getWarningMessages(e)}e.getInvalidValueWarnings=t;var i=function(){function t(e,t,i){this.supportsNaN=e,this.supportsNegativeInfinity=t,this.supportsPositiveInfinity=i}return t.prototype.getWarningMessages=function(t){this.loadWarningStatus(t);var i=[];return this.hasNaN&&!this.supportsNaN&&i.push(new e.NaNNotSupportedWarning),(this.hasNegativeInfinity&&!this.supportsNegativeInfinity||this.hasPositiveInfinity&&!this.supportsPositiveInfinity)&&i.push(new e.InfinityValuesNotSupportedWarning),this.hasOutOfRange&&i.push(new e.ValuesOutOfRangeWarning),i},t.prototype.loadWarningStatus=function(e){this.hasNaN=!1,this.hasNegativeInfinity=!1,this.hasOutOfRange=!1,this.hasPositiveInfinity=!1;for(var t=0;t<e.length;t++){var i=e[t],a=i&&i.categorical&&i.categorical.values?i.categorical.values:null;if(!a)return;for(var r=a.length,o=0;r>o;o++){var n=a[o];if(n.values)for(var s=n.values.length,l=0;s>l;l++){var c=n.values[l];isNaN(c)?this.hasNaN=!0:c===Number.POSITIVE_INFINITY?this.hasPositiveInfinity=!0:c===Number.NEGATIVE_INFINITY?this.hasNegativeInfinity=!0:(-1e300>c||c>1e300)&&(this.hasOutOfRange=!0)}}}},t}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return new i(e)}e.createListView=t}(t=e.ListViewFactory||(e.ListViewFactory={}));var i=function(){function t(e){var i=this;this.options=$.extend(!0,{},e),this.scrollbarInner=e.baseContainer.append("div").classed("scrollbar-inner",!0).on("scroll",function(){return i.renderImpl(i.options.rowHeight)}),this.scrollContainer=this.scrollbarInner.append("div").classed("scrollRegion",!0).on("touchstart",function(){return i.stopTouchPropagation()}).on("touchmove",function(){return i.stopTouchPropagation()}),this.visibleGroupContainer=this.scrollContainer.append("div").classed("visibleGroup",!0),$(e.baseContainer.node()).find(".scroll-element").attr("drag-resize-disabled","true"),t.SetDefaultOptions(e)}return t.SetDefaultOptions=function(e){e.rowHeight=e.rowHeight||t.defaultRowHeight},t.prototype.rowHeight=function(e){return this.options.rowHeight=Math.ceil(e),this},t.prototype.data=function(e,t,i){return void 0===i&&(i=!1),this._data=e,this.getDatumIndex=t,this.setTotalRows(),i&&$(this.scrollbarInner.node()).scrollTop(0),this.render(),this},t.prototype.viewport=function(e){return this.options.viewport=e,this.render(),this},t.prototype.empty=function(){this._data=[],this.render()},t.prototype.render=function(){var e=this;this.renderTimeoutId&&window.clearTimeout(this.renderTimeoutId),this.renderTimeoutId=window.setTimeout(function(){e.getRowHeight().then(function(t){e.renderImpl(t)}),e.renderTimeoutId=void 0},0)},t.prototype.renderImpl=function(e){var t=this.options.scrollEnabled?Math.max(0,this._totalRows*e):this.options.viewport.height;this.scrollContainer.style("height",t+"px").attr("height",t),this.scrollToFrame(!0)},t.prototype.stopTouchPropagation=function(){if(this.options.isReadMode()){if("touchstart"===d3.event.type){var e=d3.event;e.touches&&1===e.touches.length&&d3.event.stopPropagation()}"touchmove"===d3.event.type&&d3.event.stopPropagation()}},t.prototype.scrollToFrame=function(i){var a=this.options,r=this.visibleGroupContainer,o=this._totalRows,n=a.rowHeight||t.defaultRowHeight,s=this.getVisibleRows()||1,l=this.scrollbarInner.node().scrollTop,c=0===l?0:Math.floor(l/n),u=e.SVGUtil.translateWithPixels(0,c*n);r.style({transform:function(e){return u},"-webkit-transform":u});var h=Math.max(0,Math.min(c,o-s+1)),d=h+s;if(this.options.scrollEnabled){var p=l-c*n,g=.5*n;p>g&&d++}var m=r.selectAll(".row").data(this._data.slice(h,Math.min(d,o)),this.getDatumIndex);m.enter().append("div").classed("row",!0).call(function(e){return a.enter(e)}),m.order();var f=r.selectAll(".row:not(.transitioning)");f.call(function(e){return a.update(e)}),m.exit().call(function(e){return a.exit(e)}).remove(),i&&s!==o&&d>=o*t.loadMoreDataThreshold&&a.loadMoreData()},t.prototype.setTotalRows=function(){var e=this._data;this._totalRows=e?e.length:0},t.prototype.getVisibleRows=function(){var e=1,t=this.options.rowHeight,i=this.options.viewport.height;return!t||1>t?e:this.options.scrollEnabled?Math.min(Math.ceil(i/t),this._totalRows)||e:Math.min(Math.floor(i/t),this._totalRows)||e},t.prototype.getRowHeight=function(){var e=$.Deferred(),i=this,a=i.options;if(this.cancelMeasurePass&&this.cancelMeasurePass(),!(this._data&&this._data.length&&a))return i.rowHeight(t.defaultRowHeight),e.resolve(a.rowHeight).promise();this.scrollToFrame(!1);var r=window.requestAnimationFrame(function(){var t=i.visibleGroupContainer.select(".row");if(!t.empty()){var a=t.node(),o=Math.max($(a).outerHeight(!0),$(a).children().first().outerHeight(!0));i.rowHeight(o),e.resolve(o)}i.cancelMeasurePass=void 0,window.cancelAnimationFrame(r)});return this.cancelMeasurePass=function(){window.cancelAnimationFrame(r),e.reject()},e.promise()},t.loadMoreDataThreshold=.8,t.defaultRowHeight=1,t}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=11;!function(t){function i(e,t,i){return Math.min(Math.max(e,t),i)}function a(e){return 23===e?2147483648:Math.floor(e)===e?256<<e:256*Math.pow(2,e)}function r(e,r,o){void 0===o&&(o=!1);for(var n=[],s={array:new Float64Array(e.length),arrayString:""},l=0;l<e.length;l+=2){var c=i(e[l],t.MinAllowedLatitude,t.MaxAllowedLatitude),u=i(e[l+1],t.MinAllowedLongitude,t.MaxAllowedLongitude),h=(u+180)/360,d=Math.sin(c*Math.PI/180),g=.5-Math.log((1+d)/(1-d))/(4*Math.PI),m=a(r);s.array[l]=i(h*m+.5,0,m-1),s.array[l+1]=i(g*m+.5,0,m-1),o&&(n.push(s.array[l],s.array[l+1]),n.length>=p&&(s.arrayString+=n.join(" ")+" ",n=[]))}return o&&(s.arrayString+=n.join(" ")+" "),s}function o(e){for(var t={latitude:-90,longitude:180},a={latitude:90,longitude:-180},r=0;r<e.length;r+=2)t.latitude=Math.max(e[r],t.latitude),t.longitude=Math.min(e[r+1],t.longitude),a.latitude=Math.min(e[r],a.latitude),a.longitude=Math.max(e[r+1],a.longitude);return t.longitude=i(t.longitude,-180,180),a.longitude=i(a.longitude,-180,180),Microsoft.Maps.LocationRect.fromCorners(new Microsoft.Maps.Location(t.latitude,t.longitude),new Microsoft.Maps.Location(a.latitude,a.longitude))}function n(e){for(var t=[],i=0,a=0,r=0,o=4294967296;i<e.length;){for(var n=0,s=0;;){if(i>=e.length)return null;var l=d.indexOf(e.charAt(i++));if(-1===l)return null;var c=(31&l)*Math.pow(2,s),u=c/o,h=c%o,p=n/o,g=n%o,m=(h|g)>>>0;if(n=(u|p)*o+m,s+=5,32>l)break}var f=Math.floor((Math.sqrt(8*n+5)-1)/2);n-=f*(f+1)/2;var y=Math.floor(n),v=f-y;v=v>>1^-(1&v),y=y>>1^-(1&y),a+=v,r+=y;var b=1e-5*r,C=1e-5*a;t.push(b),t.push(C)}return new Float64Array(t)}function s(e){for(var i=e.locations,a=0;a<i.length;a++){var r=i[a];r.geographic||(r.geographic=t.parseEncodedSpatialValueArray(r.nativeBing));var o=r.geographic;if(o&&!r.absolute){var n=t.latLongToPixelXYArray(o,t.DefaultLevelOfDetail,!0);r.absolute=n.array,r.absoluteString=n.arrayString;var s=t.getLocationBoundaries(o);r.absoluteBounds=t.locationRectToRectXY(s,t.DefaultLevelOfDetail)}}}function l(e,t){return u(e.latitude,e.longitude,t)}function c(t,i){var a=l(t.getNorthwest(),i),r=l(t.getSoutheast(),i);return new e.visuals.Rect(a.x,a.y,r.x-a.x,r.y-a.y)}function u(t,i,a){var o=r(new Float64Array([t,i]),a).array;return new e.visuals.Point(o[0],o[1])}function h(e,t,r){var o=a(r),n=i(e,0,o-1)/o-.5,s=.5-i(t,0,o-1)/o,l=90-360*Math.atan(Math.exp(2*-s*Math.PI))/Math.PI,c=360*n;return new Microsoft.Maps.Location(l,c)}t.Settings={MaxBingRequest:6,MaxCacheSize:3e3,MaxCacheSizeOverflow:100,BingKey:"insert your key",BingUrl:"https://dev.virtualearth.net/REST/v1/Locations",BingUrlGeodata:"https://platform.bing.com/geo/spatial/v1/public/Geodata?",UseDoubleArrayGeodataResult:!0,UseDoubleArrayDequeueTimeout:0},t.MinAllowedLatitude=-85.05112878,t.MaxAllowedLatitude=85.05112878,t.MinAllowedLongitude=-180,t.MaxAllowedLongitude=180,t.TileSize=256,t.MaxLevelOfDetail=23,t.MinLevelOfDetail=1,t.MaxAutoZoomLevel=5,t.DefaultLevelOfDetail=11,t.WorkerErrorName="___error___",t.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"};var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-";t.clip=i,t.getMapSize=a;var p=15e3;t.latLongToPixelXYArray=r,t.getLocationBoundaries=o,t.parseEncodedSpatialValueArray=n,t.calcGeoData=s,t.locationToPixelXY=l,t.locationRectToRectXY=c,t.latLongToPixelXY=u,t.pixelXYToLocation=h;var g;!function(e){function t(e){var t='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle fill="#FF5F00" cx="12" cy="12" r="6"/><circle fill="none" stroke="#FF5F00" stroke-width="2" cx="12" cy="12" r="10"/></svg>',i={draggable:!1,htmlContent:t,height:24,width:24};return new Microsoft.Maps.Pushpin(e,i)}e.createPushpin=t}(g=t.CurrentLocation||(t.CurrentLocation={}))}(i=t.MapUtil||(t.MapUtil={}));var r=function(){function e(){this._locationRect=new Microsoft.Maps.LocationRect(new Microsoft.Maps.Location(30,-30),60,60)}return e.prototype.reCalc=function(e,r,o){var n=[this._locationRect.getNorthwest(),this._locationRect.getSoutheast()];if(r/=2,o/=2,!this._baseRect){var s=i.locationToPixelXY(this._locationRect.getNorthwest(),a),l=i.locationToPixelXY(this._locationRect.getSoutheast(),a);this._baseRect=new t.Rect(s.x,s.y,l.x-s.x,l.y-s.y)}var c=e.tryLocationToPixel(n);this._currentRect=new t.Rect(c[0].x+r,c[0].y+o,c[1].x-c[0].x,c[1].y-c[0].y)},Object.defineProperty(e.prototype,"scale",{get:function(){return this._baseRect?this._currentRect.width/this._baseRect.width:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform;return a.translate(i.left,i.top),a.scale(i.width/e.width,i.height/e.height),a.translate(-e.left,-e.top),a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outherTransform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform;a.translate(i.left,i.top);var r=Math.sqrt(i.width/e.width);return a.scale(r,r),a},enumerable:!0,configurable:!0}),e.prototype.setViewBox=function(e){var t=e.getBoundingClientRect(),i=this._currentRect;e.setAttribute("viewBox",[-i.left,-i.top,t.width,t.height].join(" "))},Object.defineProperty(e.prototype,"innerTransform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform,r=i.width/e.width;return a.scale(r,r),a.translate(-e.left,-e.top),a},enumerable:!0,configurable:!0}),e.prototype.transformToString=function(e){var t=e.matrix;return"matrix("+t.m00+" "+t.m10+" "+t.m01+" "+t.m11+" "+t.m02+" "+t.m12+")"},e}();t.MapPolygonInfo=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var a=function(){function i(e){this.hostServices=e.hostServices,this.selectedIds=[]}return i.prototype.select=function(e,t){void 0===t&&(t=!1);var i=$.Deferred();return this.hostServices.shouldRetainSelection()?this.sendSelectionToHost([e]):(this.selectInternal(e,t),this.sendSelectionToHost(this.selectedIds)),i.resolve(this.selectedIds),i},i.prototype.showContextMenu=function(e,i){var a=$.Deferred();return i=i||t.InteractivityUtils.getPositionOfLastInputEvent(),this.sendContextMenuToHost(e,i),a.resolve(),a},i.prototype.hasSelection=function(){return this.selectedIds.length>0},i.prototype.clear=function(){var e=$.Deferred();return this.selectedIds=[],this.sendSelectionToHost([]),e.resolve(),e},i.prototype.getSelectionIds=function(){return this.selectedIds},i.prototype.sendSelectionToHost=function(e){var t={data:e.filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()})},i=this.getSelectorsByColumn(e);_.isEmpty(i)||(t.data2=i),this.hostServices.onSelect(t)},i.prototype.sendContextMenuToHost=function(e,t){var i=this.getSelectorsByColumn([e]);if(!_.isEmpty(i)){var a={data:i,position:t};this.hostServices.onContextMenu(a)}},i.prototype.getSelectorsByColumn=function(e){return _(e).filter(function(e){return e.hasIdentity}).map(function(e){return e.getSelectorsByColumn()}).compact().value()},i.prototype.selectInternal=function(t,a){i.containsSelection(this.selectedIds,t)?this.selectedIds=a?this.selectedIds.filter(function(i){return!e.data.Selector.equals(i,t)}):this.selectedIds.length>1?[t]:[]:a?this.selectedIds.push(t):this.selectedIds=[t]},i.containsSelection=function(t,i){return t.some(function(t){return e.data.Selector.equals(t.getSelector(),i.getSelector())})},i}();i.SelectionManager=a}(i=t.utility||(t.utility={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){"use strict";var i;!function(t){var i=jsCommon.Utility,a=function(){function e(e){this.polygonPoints=this.convertArrayPathToPoints(e)}return e.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},e.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},e.prototype.contains=function(e){var t={x:e.left,y:e.top},i={x:e.left+e.width,y:e.top},a={x:e.left,y:e.top+e.height},r={x:e.left+e.width,y:e.top+e.height};return this.inside(t)&&this.inside(i)&&this.inside(a)&&this.inside(r)},e.prototype.conflicts=function(e){if(!this.isConflictWithBoundingBox(e))return!1;var t={x:e.left,y:e.top},i={x:e.left+e.width/2,y:e.top},a={x:e.left+e.width,y:e.top},r={x:e.left,y:e.top+e.height},o={x:e.left+e.width/2,y:e.top+e.height},n={x:e.left+e.width,y:e.top+e.height},s={x:e.left,y:e.top+e.height/2},l={x:e.left+e.width,y:e.top+e.height/2};return this.inside(t)||this.inside(i)||this.inside(a)||this.inside(r)||this.inside(o)||this.inside(n)||this.inside(s)||this.inside(l)},e.prototype.lineIntersectionPoint=function(e,t){for(var i=0;i<this.polygonPoints.length;i++){var a=this.polygonPoints[i],r=i===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[i+1],o=this.getLineIntersection(e,t,a,r);if(null!==o)return o}return null},e.calculateAbsolutePolygonArea=function(e){var t,i=1,a=0;for(t=0;t<e.length;t++)a+=e[t].x*e[i].y-e[i].x*e[t].y,i=(i+1)%e.length;return a*=.5},e.prototype.isConflictWithBoundingBox=function(e){return n.isIntersecting(this.absoluteBoundingRect(),e)},e.prototype.calculatePolygonCentroid=function(){var t,i,a,r,o,n;for(t=e.calculateAbsolutePolygonArea(this.polygonPoints),a=r=0,n=1,o=0;o<this.polygonPoints.length;o++)i=this.polygonPoints[o].x*this.polygonPoints[n].y-this.polygonPoints[n].x*this.polygonPoints[o].y,a+=(this.polygonPoints[o].x+this.polygonPoints[n].x)*i,r+=(this.polygonPoints[o].y+this.polygonPoints[n].y)*i,n=(n+1)%this.polygonPoints.length;return a/=6*t,r/=6*t,{x:a,y:r}},e.prototype.calculateBoundingRect=function(){for(var e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,r=0;r<this.polygonPoints.length;r++)this.polygonPoints[r].x<e?e=this.polygonPoints[r].x:this.polygonPoints[r].x>i&&(i=this.polygonPoints[r].x),this.polygonPoints[r].y<t?t=this.polygonPoints[r].y:this.polygonPoints[r].y>a&&(a=this.polygonPoints[r].y);return{left:e,top:t,width:i-e,height:a-t}},e.prototype.inside=function(e){for(var t=e.x,i=e.y,a=!1,r=0,o=this.polygonPoints.length-1;r<this.polygonPoints.length;o=r++){var n=this.polygonPoints[r].x,s=this.polygonPoints[r].y,l=this.polygonPoints[o].x,c=this.polygonPoints[o].y,u=s>i!=c>i&&(l-n)*(i-s)/(c-s)+n>t;u&&(a=!a)}return a},e.prototype.getLineIntersection=function(e,t,i,a){var r=e.x,o=e.y,n=t.x,s=t.y,l=i.x,c=i.y,u=a.x,h=a.y,d=n-r,p=s-o,g=u-l,m=h-c,f=(-p*(r-l)+d*(o-c))/(-g*p+d*m),y=(g*(o-c)-m*(r-l))/(-g*p+d*m);return f>=0&&1>=f&&y>=0&&1>=y?{x:r+y*d,y:o+y*p}:null},e.prototype.convertArrayPathToPoints=function(e){for(var t=[],i=0;i<e.length;i+=2){var a=e[i],r=e[i+1],o={x:a,y:r};t.push(o)}return t},e}();t.Polygon=a;var r;!function(t){function a(e,t,i){var a=e.x+t>=0?e.x+t:0,r=e.y+i>=0?e.y+i:0;return{x:a,y:r}}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function o(e){return null!==e?{x:e.x,y:e.y}:null}function n(e){return"{x:"+e.x+", y:"+e.y+"}"}function s(e){return e.x+","+e.y}function l(e,t){if(null===e||null===t)return null;var i=t.x-e.x,a=t.y-e.y;return Math.sqrt(i*i+a*a)}function c(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function u(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(2===e.length)return{x:i.parseNumber(e[0]),y:i.parseNumber(e[1])};if("string"==typeof e){var a=e.split(",");return 2!==a.length?void 0===t?null:t:{x:i.parseNumber(a[0]),y:i.parseNumber(a[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{x:i.parseNumber(e.x),y:i.parseNumber(e.y)}}t.offset=a,t.equals=r,t.clone=o,t.toString=n,t.serialize=s,t.getDistance=l,t.equalWithPrecision=c,t.parsePoint=u}(r=t.Point||(t.Point={}));var o;!function(t){function a(e){return 0===e.width&&0===e.height}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.width===t.width&&e.height===t.height}function o(e){return null!==e?{width:e.width,height:e.height}:null}function n(e,t){var i=o(e);return t&&(i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function s(e,t){var i=o(e);return t&&(i.width=i.width-t.left-t.right,i.width<0&&(i.width=0),i.height=i.height-t.top-t.bottom,i.height<0&&(i.height=0)),i}function l(e,t){return t&&(e.width=Math.max(e.width,t.width),e.height=Math.max(e.height,t.height)),e}function c(e){return{left:0,top:0,width:e.width,height:e.height}}function u(e){return"{width:"+e.width+", height:"+e.height+"}"}function h(e,t){return e===t||void 0!==e&&void 0!==t&&e.width===t.width&&e.height===t.height}function d(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function p(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(2===e.length)return{width:i.parseNumber(e[0]),height:i.parseNumber(e[1])};if("string"==typeof e){var a=e.split(",");return 2!==a.length?void 0===t?null:t:{width:i.parseNumber(a[0]),height:i.parseNumber(a[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{width:i.parseNumber(e.width),height:i.parseNumber(e.height)}}t.isEmpty=a,t.equals=r,t.clone=o,t.inflate=n,t.deflate=s,t.combine=l,t.toRect=c,t.toString=u,t.equal=h,t.equalWithPrecision=d,t.parseSize=p}(o=t.Size||(t.Size={}));var n;!function(t){function a(e){return{x:e.left,y:e.top}}function r(e){return{width:e.width,height:e.height}}function o(e,t){e.width=t.width,e.height=t.height}function n(e){return e.left+e.width}function s(e){return e.top+e.height}function l(e){return{x:e.left,y:e.top}}function c(e){return{x:e.left+e.width,y:e.top}}function u(e){return{x:e.left,y:e.top+e.height}}function h(e){return{x:e.left+e.width,y:e.top+e.height}}function d(e,t){return void 0!==t&&null!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function p(e){return null!==e?{left:e.left,top:e.top,width:e.width,height:e.height}:null}function g(e){return"{left:"+e.left+", top:"+e.top+", width:"+e.width+", height:"+e.height+"}"}function m(e,t,i){var a=e.left+t>=0?e.left+t:0,r=e.top+i>=0?e.top+i:0;return{left:a,top:r,width:e.width,height:e.height}}function f(e,t){var i=p(e);return t&&(i.left-=t.left,i.top-=t.top,i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function y(e,t){var i=p(e);return t&&(i.left+=t.left,i.top+=t.top,i.width-=t.left+t.right,i.height-=t.top+t.bottom),i}function v(e,t){return{left:e.left-t,top:e.top-t,width:e.width+t+t,height:e.height+t+t}}function b(e,t){return{left:e.left+t,top:e.top+t,width:e.width-t-t,height:e.height-t-t}}function C(e,t,i){return{x:Math.min(Math.max(e.left,t),e.left+e.width),y:Math.min(Math.max(e.top,i),e.top+e.height)}}function S(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function x(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function w(e){return void 0===e||null===e||0===e.width&&0===e.height}function P(t,i){return null===t||null===i?!1:e.Double.lessOrEqualWithPrecision(t.left,i.x)&&e.Double.lessOrEqualWithPrecision(i.x,t.left+t.width)&&e.Double.lessOrEqualWithPrecision(t.top,i.y)&&e.Double.lessOrEqualWithPrecision(i.y,t.top+t.height)}function D(e,t){if(!e||!t)return!1;var i=Math.max(e.left,t.left),a=Math.min(e.left+e.width,t.left+t.width);if(i>a)return!1;var r=Math.max(e.top,t.top),o=Math.min(e.top+e.height,t.top+t.height);return o>=r}function L(e,t){if(!e)return t;if(!t)return e;var i=Math.max(e.left,t.left),a=Math.max(e.top,t.top),r=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height);return r>=i&&o>=a?{left:i,top:a,width:r-i,height:o-a}:{left:0,top:0,width:0,height:0}}function T(e,t){if(!e)return t;if(!t)return e;var i=Math.min(e.left,t.left),a=Math.min(e.top,t.top),r=Math.max(e.left+e.width,t.left+t.width),o=Math.max(e.top+e.height,t.top+t.height);return{left:i,top:a,width:r-i,height:o-a}}function _(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:i.parseNumber(e[0]),top:i.parseNumber(e[1]),width:i.parseNumber(e[2]),height:i.parseNumber(e[3])};if("string"==typeof e){var a=e.split(",");return 4!==a.length?void 0===t?null:t:{left:i.parseNumber(a[0]),top:i.parseNumber(a[1]),width:i.parseNumber(a[2]),height:i.parseNumber(a[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:i.parseNumber(e.left),top:i.parseNumber(e.top),width:i.parseNumber(e.width),height:i.parseNumber(e.height)}}t.getOffset=a,t.getSize=r,t.setSize=o,t.right=n,t.bottom=s,t.topLeft=l,t.topRight=c,t.bottomLeft=u,t.bottomRight=h,t.equals=d,t.clone=p,t.toString=g,t.offset=m,t.inflate=f,t.deflate=y,t.inflateBy=v,t.deflateBy=b,t.getClosestPoint=C,t.equal=S,t.equalWithPrecision=x,t.isEmpty=w,t.containsPoint=P,t.isIntersecting=D,t.intersect=L,t.combine=T,t.parseRect=_}(n=t.Rect||(t.Rect={}));var s;!function(t){function a(e,t){var i=n(e);return t&&(i.left=e.left+t.left,i.right=e.right+t.right,i.bottom=e.bottom+t.bottom,i.top=e.top+t.top),i}function r(e){return e.left+e.right}function o(e){return e.top+e.bottom}function n(e){return null!==e?{left:e.left,top:e.top,right:e.right,bottom:e.bottom}:null}function s(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.left===t.left&&e.bottom===t.bottom&&e.right===t.right&&e.top===t.top}function l(e){var t=e.right;e.right=e.left,e.left=t}function c(e){var t=e.top;e.top=e.bottom,e.bottom=t}function u(e){return"{top:"+e.top+", left:"+e.left+", right:"+e.right+", bottom:"+e.bottom+"}"}function h(e){return e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px"}function d(e){return 0===e.left&&0===e.top&&0===e.right&&0===e.bottom}function p(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.right===t.right&&e.bottom===t.bottom}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.right,i.right)&&e.Double.equalWithPrecision(t.bottom,i.bottom)}function m(e,t,a){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:i.parseNumber(e[0]),top:i.parseNumber(e[1]),right:i.parseNumber(e[2]),bottom:i.parseNumber(e[3])};if("string"==typeof e){var r=e.split(",");return 4!==r.length?void 0===t?null:t:{left:i.parseNumber(r[0]),top:i.parseNumber(r[1]),right:i.parseNumber(r[2]),bottom:i.parseNumber(r[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:i.parseNumber(e.left),top:i.parseNumber(e.top),right:i.parseNumber(e.right),bottom:i.parseNumber(e.bottom)}}t.inflate=a,t.getWidth=r,t.getHeight=o,t.clone=n,t.equals=s,t.flipHorizontal=l,t.flipVertical=c,t.toString=u,t.toCssString=h,t.isEmpty=d,t.equal=p,t.equalWithPrecision=g,t.parseThickness=m}(s=t.Thickness||(t.Thickness={}));var l;!function(t){function i(e){return 0===e.x&&0===e.y}function a(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function r(e){return null!==e?{x:e.x,y:e.y}:null}function o(e){return"{x:"+e.x+", y:"+e.y+"}"}function n(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function s(e){return e.x*e.x+e.y*e.y}function l(e,t){return{x:e.x*t,y:e.y*t}}function c(e){return i(e)?e:l(e,1/n(e))}function u(e){return{x:e.y,y:-e.x}}function h(e){return{x:-e.y,y:e.x}}function d(e,t){var i=e.x*Math.cos(t)-e.y*Math.sin(t),a=e.x*Math.sin(t)+e.y*Math.cos(t);return{x:i,y:a}}function p(e,t){return e===t||void 0!==e&&void 0!==t&&e.x===t.x&&e.y===t.y}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function m(e,t){return e&&t?{x:e.x+t.x,y:e.y+t.y}:void 0}function f(e,t){return e&&t?{x:e.x-t.x,y:e.y-t.y}:void 0}function y(e,t){return e&&t?e.x*t.x+e.y*t.y:void 0}function v(e,t){return e&&t?{x:t.x-e.x,y:t.y-e.y}:void 0}t.isEmpty=i,t.equals=a,t.clone=r,t.toString=o,t.getLength=n,t.getLengthSqr=s,t.scale=l,t.normalize=c,t.rotate90DegCW=u,t.rotate90DegCCW=h,t.rotate=d,t.equal=p,t.equalWithPrecision=g,t.add=m,t.subtract=f,t.dotProduct=y,t.getDeltaVector=v}(l=t.Vector||(t.Vector={}))}(i=t.shapes||(t.shapes={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=jsCommon.PixelConverter;!function(i){function r(t,i,a){if(!t||_.isEmpty(i))return!1;for(var r=0,o=i.length;o>r;r++){var n=i[r];if(e.DataViewScopeIdentity.equals(t,n,a))return i.splice(r,1),!0}return!1}var o;!function(e){var t=jsCommon.CssConstants.createClassAndSelector;e.HeaderContainer=t("headerContainer"),e.Header=t("slicerHeader"),e.TitleHeader=t("titleHeader"),e.HeaderText=t("headerText"),e.Body=t("slicerBody"),e.Label=t("slicerLabel"),e.LabelText=t("slicerText"),e.LabelImage=t("slicerImage"),e.CountText=t("slicerCountText"),e.Clear=t("clear"),e.SearchHeader=t("searchHeader"),e.SearchHeaderCollapsed=t("collapsed"),e.SearchHeaderShow=t("show"),e.MultiSelectEnabled=t("isMultiSelectEnabled")}(o=i.Selectors||(i.Selectors={}));var n;!function(e){e.Clear="Slicer_Clear",e.SelectAll="Slicer_SelectAll",e.Search="SearchBox_Text"}(n=i.DisplayNameKeys||(i.DisplayNameKeys={}));var s;!function(e){function t(e){return null!=e&&null!=e.slicerSettings}e.areSettingsDefined=t}(s=i.SettingsHelper||(i.SettingsHelper={}));var l;!function(e){function t(e){if(e){var t=e.categorical;if(t&&!_.isEmpty(t.categories))return t.categories[0].identityFields}}e.getIdentityFields=t}(l=i.DefaultValueHandler||(i.DefaultValueHandler={})),i.tryRemoveValueFromRetainedList=r;var c=function(){function r(){}return r.prototype.createSlicerHeader=function(e){var t=document.createElement("div");t.className=o.Header["class"];var i=d3.select(t),a=i.append("h2").classed(o.TitleHeader["class"],!0);a.append("span").classed(o.Clear["class"],!0).attr("title",e.getLocalizedString(n.Clear)),a.append("div").classed(o.HeaderText["class"],!0);var r=i.append("div").classed(o.SearchHeader["class"],!0).classed(o.SearchHeaderCollapsed["class"],!0);return r.append("button").attr("title",e.getLocalizedString(n.Search)),r.append("input").attr("type","text"),t},r.prototype.getHeaderTextProperties=function(e){var t={fontFamily:"wf_segoe-ui_normal",fontSize:"10px"};return e.header.show&&(t.fontSize=a.fromPoint(e.header.textSize)),t},r.prototype.getSlicerBodyViewport=function(e,t,i){var a=t.header.show?this.getHeaderHeight(t,i):0,r=e.height-(a+t.header.borderBottomWidth);return{height:r,width:e.width}},r.prototype.updateSlicerBodyDimensions=function(e,t,i){
var r=this.getSlicerBodyViewport(e,i,this.getHeaderTextProperties(i));t.style({height:a.toString(r.height),width:a.toString(r.width)})},r.prototype.getHeaderHeight=function(t,i){return e.TextMeasurementService.estimateSvgTextHeight(this.getTextProperties(t.header.textSize,i))+t.general.outlineWeight},r.prototype.getRowHeight=function(t,i){return e.TextMeasurementService.estimateSvgTextHeight(this.getTextProperties(t.slicerText.textSize,i))+this.getRowsOutlineWidth(t.slicerText.outline,t.general.outlineWeight)},r.prototype.styleSlicerHeader=function(e,t,a){var r=e.select(i.Selectors.TitleHeader.selector),n=e.select(i.Selectors.SearchHeader.selector);if(t.header.show){r.style("display","block");var s=e.select(o.HeaderText.selector).text(a);this.setSlicerHeaderTextStyle(s,t)}else r.style("display","none");t.search.enabled?(n.classed(o.SearchHeaderShow["class"],!0),n.classed(o.SearchHeaderCollapsed["class"],!1)):(n.classed(o.SearchHeaderShow["class"],!1),n.classed(o.SearchHeaderCollapsed["class"],!0))},r.prototype.setSlicerTextStyle=function(e,i){e.style({color:i.slicerText.color,"background-color":i.slicerText.background,"border-style":"solid","border-color":i.general.outlineColor,"border-width":t.VisualBorderUtil.getBorderWidth(i.slicerText.outline,i.general.outlineWeight),"font-size":a.fromPoint(i.slicerText.textSize)})},r.prototype.getRowsOutlineWidth=function(e,i){switch(e){case t.outline.none:case t.outline.leftRight:return 0;case t.outline.bottomOnly:case t.outline.topOnly:return i;case t.outline.topBottom:case t.outline.frame:return 2*i;default:return 0}},r.prototype.setSlicerHeaderTextStyle=function(e,i){e.style({"border-style":"solid","border-color":i.general.outlineColor,"border-width":t.VisualBorderUtil.getBorderWidth(i.header.outline,i.general.outlineWeight),color:i.header.fontColor,"background-color":i.header.background,"font-size":a.fromPoint(i.header.textSize)})},r.prototype.getTextProperties=function(e,t){return t.fontSize=a.fromPoint(e),t},r}();i.DOMHelper=c}(i=t.SlicerUtil||(t.SlicerUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(0!==t.length){var i=e.selectAll("title"),a=i.data(function(e,i){return[t[i]]});a.enter().append("title"),a.exit().remove(),a.text(function(e){return e})}}e.tooltipUpdate=t}(t=e.tooltipUtils||(e.tooltipUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return"translate("+e+","+t+")"}function i(e){return"translateX("+e+"px)"}function a(e,t){return"translate("+e+"px,"+t+"px)"}function r(e,t,i,a,r){return"translate("+e+","+t+") rotate("+r+","+i+","+a+")"}function o(e){return"scale("+e+")"}function n(e,t,i){return"translate("+e+","+t+") scale("+i+")"}function s(e,t){return e+" "+t}function l(){var e=Date.now;Date.now=function(){return 1/0},d3.timer.flush(),Date.now=e}function c(e){if(e){var t=e,i=e;i.animation&&(t=i.animation),t&&t.transitionImmediate&&l()}}function u(e){e.getAttribute("d")||e.setAttribute("d","")}function h(e){isNaN(e.x)&&(e.x=0),isNaN(e.y)&&(e.y=0)}function d(e){if(!e||0===e.length)return{x:"0",y:"0"};var t,i=e.split(/[\s,]+/),a="0",r=i[0];if(1===i.length)t=r.substring(10,r.length-1);else{var o=i[1];a=o.substring(0,o.length-1),t=r.substring(10,r.length)}return{x:t,y:a}}function p(e,t,i){var a="rotate("+i+" "+e/2+" "+t/2+")",r="M0 0";return r+="L0 "+t,r+="L"+e+" "+t/2+" Z",{path:r,transform:a}}function g(e){if(null!=e){var t=e.getBoundingClientRect(),i=e.getBBox();if(i.height>0&&i.width>0)return{x:t.width/i.width,y:t.height/i.height}}return{x:1,y:1}}e.AlmostZero=1e-6,e.translate=t,e.translateXWithPixels=i,e.translateWithPixels=a,e.translateAndRotate=r,e.scale=o,e.translateAndScale=n,e.transformOrigin=s,e.flushAllD3Transitions=l,e.flushAllD3TransitionsIfNeeded=c,e.ensureDAttribute=u,e.ensureValidSVGPoint=h,e.parseTranslateTransform=d,e.createArrow=p,e.getTransformScaleRatios=g}(t=e.SVGUtil||(e.SVGUtil={}));var i=function(){function e(e){this.scaleDetectorElement=e.append("rect").classed("scale-detector",!0).attr({width:1,height:1,"stroke-width":"0px",fill:"none"}).node()}return e.prototype.getScale=function(){var e=this.scaleDetectorElement.getBoundingClientRect(),t=this.scaleDetectorElement.getBBox();return t.height>0&&t.width>0?{x:e.width/t.width,y:e.height/t.height}:{x:1,y:1}},e}();e.SVGScaleDetector=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e.toString().replace(new RegExp(" ","g"),"&nbsp")}function i(e){return e.replace(//g,"")}function a(e){return null!=e?e.replace(/ /g,""):void 0}e.removeBreakingSpaces=t,e.removeEllipses=i,e.replaceSpaceWithNBSP=a}(t=e.TextUtil||(e.TextUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=e.data.DataRoleHelper;!function(t){function i(e){if(e)for(var t in e){var i=e[t];for(var a in i.properties){var r=i.properties[a];if(r.type&&r.type[N])return r.rule.inputRole}}}function r(e){var t=!!(e&&e.query&&e.query.projections&&e.query.projections.Gradient);return t}function o(e){var t;if(e&&!$.isEmptyObject(e)){t=c();for(var i in t){var a=e.hasOwnProperty(i);if(a){var r=e[i];r&&r.solid&&r.solid.color&&(r=r.solid.color),t[i]=r}}}return t}function n(e){if(e&&e.values&&e.values.grouped){var t=e.values.grouped();return a.getMeasureIndexOfRole(t,"Gradient")}return-1}function s(e){if(null==e)return null;var i=t.getGradientMeasureIndex(e),a=-1===i?null:e.values[i];return a}function l(e){var t=n(e);return t>=0}function c(){var e=g(),t={diverging:!1,minColor:e.minColor,midColor:_,maxColor:e.maxColor,minValue:void 0,midValue:void 0,maxValue:void 0};return t}function u(){return y()}function h(t,i,a){var r,o,n=e.data.DataViewObjectDefinitions.ensure(a,M,null),s=p(a);s&&($.isNumeric(i)&&(r=void 0!==i?T["double"](+i):void 0),"minColor"!==t&&"midColor"!==t&&"maxColor"!==t||(o=C(s,t,i)),"minColor"===t?S(s,o):"midColor"===t?x(s,o):"maxColor"===t?w(s,o):"minValue"===t?P(s,r):"midValue"===t?D(s,r):"maxValue"===t?L(s,r):"diverging"===t?(s=i?v(s):y(s),n.properties[N]=s):"revertToDefault"===t&&(s=this.getDefaultFillRuleDefinition(),n.properties[N]=s))}function d(e){return e?m(e):c()}function p(t){var i=e.data.DataViewObjectDefinitions.getValue(t,{objectName:M,propertyName:N},null);return i}function g(){var t=new e.visuals.DataColorPalette,i=t.getColorByIndex(0),a=d3.scale.linear().domain([0,100]).range(["#ffffff",i.value]),r=i.value,o=a(20),n=_;return{minColor:o,midColor:n,maxColor:r}}function m(e){var t,i,a,r,o,n=_,s=void 0!==e.linearGradient3;if(e.linearGradient2){var l=e.linearGradient2.max.color,c=e.linearGradient2.min.color,u=e.linearGradient2.max.value,h=e.linearGradient2.min.value;t=l.value,i=c.value,u&&(a=u.value),h&&(o=h.value)}else if(e.linearGradient3){var l=e.linearGradient3.max.color,d=e.linearGradient3.mid.color,c=e.linearGradient3.min.color,u=e.linearGradient3.max.value,p=e.linearGradient3.mid.value,h=e.linearGradient3.min.value;t=l.value,n=d.value,i=c.value,u&&(a=u.value),p&&(r=p.value),h&&(o=h.value)}return{diverging:s,minColor:i,midColor:n,maxColor:t,minValue:o,midValue:r,maxValue:a}}function f(e){var t=[];return e.minColor=e.minColor||V,t.push(e.minColor),e.diverging&&(e.midColor=e.midColor||V,t.push(e.midColor||V)),e.maxColor=e.maxColor||V,t.push(e.maxColor||V),t.join(",")}function y(e){var t=d(e),i={linearGradient2:{max:{color:T.text(t.maxColor)},min:{color:T.text(t.minColor)}}};return i}function v(e){var t=d(e),i={linearGradient3:{max:{color:T.text(t.maxColor)},mid:{color:T.text(t.midColor)},min:{color:T.text(t.minColor)}}};return i}function b(e,t){var i,a;return e.linearGradient3?(a=v(),"minColor"===t?i=a.linearGradient3.min.color:"midColor"===t?i=a.linearGradient3.mid.color:"maxColor"===t&&(i=a.linearGradient3.max.color)):e.linearGradient2&&(a=y(),"minColor"===t?i=a.linearGradient2.min.color:"maxColor"===t&&(i=a.linearGradient2.max.color)),i}function C(e,t,i){var a;return a=i?T.text(i):b(e,t)}function S(e,t){e.linearGradient2?e.linearGradient2.min.color=t:e.linearGradient3&&(e.linearGradient3.min.color=t)}function x(e,t){e.linearGradient3&&(e.linearGradient3.mid.color=t)}function w(e,t){e.linearGradient2?e.linearGradient2.max.color=t:e.linearGradient3&&(e.linearGradient3.max.color=t)}function P(e,t){e.linearGradient2?e.linearGradient2.min.value=t:e.linearGradient3&&(e.linearGradient3.min.value=t)}function D(e,t){e.linearGradient3&&(e.linearGradient3.mid.value=t)}function L(e,t){e.linearGradient2?e.linearGradient2.max.value=t:e.linearGradient3&&(e.linearGradient3.max.value=t)}var T=e.data.SQExprBuilder,_="#ffffff",V=_,M="dataPoint",N="fillRule";t.getFillRuleRole=i,t.shouldShowGradient=r,t.getUpdatedGradientSettings=o,t.getGradientMeasureIndex=n,t.getGradientValueColumn=s,t.hasGradientRole=l,t.getDefaultGradientSettings=c,t.getDefaultFillRuleDefinition=u,t.updateFillRule=h,t.getGradientSettings=d,t.getFillRule=p,t.getGradientSettingsFromRule=m,t.getGradientBarColors=f}(i=t.GradientUtils||(t.GradientUtils={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(){return"#FFF"}function a(){return 50}function r(){return!1}function o(){return{color:i(),transparency:a(),show:r()}}function n(e,t){var i=t&&t.transparency;null==i&&(i=a());var r={selector:null,properties:{transparency:i,image:t&&t.image},objectName:"plotArea"};e.pushInstance(r)}function s(t,i,a){var r=t&&t.image,o=r&&r.url,n=r&&r.scaling,s=t&&t.transparency,l=i.children(".background-image");if(!o)return void(0!==l.length&&l.remove());switch(0===l.length&&(i.prepend('<div class="background-image"></div>'),l=i.children(".background-image"),l.css("position","absolute")),l.css({width:a.width,height:a.height,"margin-left":a.left,"margin-top":a.top}),l.css({"background-image":"url("+o+")","background-repeat":"no-repeat",opacity:(100-s)/100}),n){case e.imageScalingType.normal:l.css({"background-size":"","background-position":"50% 50%"});break;case e.imageScalingType.fit:l.css({"background-size":"100% 100%","background-position":""});break;case e.imageScalingType.fill:l.css({"background-size":"100%","background-position":"50% 50%"});break;default:l.css({"background-size":"","background-position":"50% 50%"})}}t.getDefaultColor=i,t.getDefaultTransparency=a,t.getDefaultShow=r,t.getDefaultValues=o,t.enumeratePlot=n,t.renderBackgroundImage=s}(t=e.visualBackgroundHelper||(e.visualBackgroundHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.data.Selector,a=function(){function e(){}return e.prototype.pushInstance=function(e){var t=this.instances;t||(t=this.instances=[]);var i=this.containerIdx;null!=i&&(e.containerIdx=i);for(var a=0,r=t;a<r.length;a++){var o=r[a];if(this.canMerge(o,e))return this.extend(o,e,"properties"),this.extend(o,e,"validValues"),this}return t.push(e),this},e.prototype.pushContainer=function(e){var t=this.containers;t||(t=this.containers=[]);var i=t.push(e);return this.containerIdx=i-1,this},e.prototype.popContainer=function(){return this.containerIdx=void 0,this},e.prototype.complete=function(){if(this.instances){var e={instances:this.instances},t=this.containers;return t&&(e.containers=t),e}},e.prototype.canMerge=function(e,t){return e.objectName===t.objectName&&e.containerIdx===t.containerIdx&&i.equals(e.selector,t.selector)},e.prototype.extend=function(e,t,i){var a=t[i];if(a){var r=e[i];r||(r=e[i]={});for(var o in a)r[o]||(r[o]=a[o])}},e.merge=function(t,i){var a=e.normalize(t),r=e.normalize(i);if(!a||!r)return a||r;for(var o=a.containers?a.containers.length:0,n=0,s=r.instances;n<s.length;n++){var l=s[n];a.instances.push(l),null!=l.containerIdx&&(l.containerIdx+=o)}var c=r.containers;return _.isEmpty(c)||(a.containers?Array.prototype.push.apply(a.containers,c):a.containers=c),a},e.normalize=function(e){return _.isArray(e)?{instances:e}:e},e.getContainerForInstance=function(e,t){return e.containers[t.containerIdx]},e}();t.ObjectEnumerationBuilder=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t,i){switch(t){case e.outline.none:return"0px";case e.outline.bottomOnly:return"0px 0px "+i+"px 0px";case e.outline.topOnly:return i+"px 0px 0px 0px";case e.outline.leftOnly:return"0px 0px 0px "+i+"px";case e.outline.rightOnly:return"0px "+i+"px 0px 0px";case e.outline.topBottom:return i+"px 0px";case e.outline.leftRight:return"0px "+i+"px";case e.outline.frame:return i+"px";default:return"0px"}}t.getBorderWidth=i}(t=e.VisualBorderUtil||(e.VisualBorderUtil={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t){return{m00:1,m01:0,m02:e,m10:0,m11:1,m12:t}}function i(e,t){return{m00:e,m01:0,m02:0,m10:0,m11:t,m12:0}}function a(e){var t=e,i=Math.sin(t),a=Math.cos(t);return{m00:a,m01:-i,m02:0,m10:i,m11:a,m12:0}}function r(e){var t=e.m00*e.m11-e.m01*e.m10,i=1/t;return{m00:e.m11*i,m01:-e.m01*i,m02:(e.m01*e.m12-e.m02*e.m11)*i,m10:-e.m10*i,m11:e.m00*i,m12:-(e.m00*e.m12-e.m10*e.m02)*i}}function o(e,t){return{m00:e.m00*t.m00+e.m01*t.m10,m01:e.m00*t.m01+e.m01*t.m11,m02:e.m00*t.m02+e.m01*t.m12+e.m02,m10:e.m10*t.m00+e.m11*t.m10,m11:e.m10*t.m01+e.m11*t.m11,m12:e.m10*t.m02+e.m11*t.m12+e.m12}}var n=function(){function e(e){this.matrix=e||{m00:1,m01:0,m02:0,m10:0,m11:1,m12:0}}return e.prototype.applyToPoint=function(e){if(!e)return e;var t=this.matrix;return{x:t.m00*e.x+t.m01*e.y+t.m02,y:t.m10*e.x+t.m11*e.y+t.m12}},e.prototype.applyToRect=function(e){if(!e)return e;var t=e.left,i=e.top,a=this.matrix,r=1!==a.m00||1!==a.m11,o=0!==a.m01||0!==a.m10;if(!o&&!r)return{left:t+a.m02,top:i+a.m12,width:e.width,height:e.height};var n,s,l,c,u=e.left+e.width,h=e.top+e.height;if(o){var d=a.m00*t+a.m01*i+a.m02,p=a.m10*t+a.m11*i+a.m12,g=a.m00*t+a.m01*h+a.m02,m=a.m10*t+a.m11*h+a.m12,f=a.m00*u+a.m01*i+a.m02,y=a.m10*u+a.m11*i+a.m12,v=a.m00*u+a.m01*h+a.m02,b=a.m10*u+a.m11*h+a.m12;n=Math.min(d,g,f,v),s=Math.max(d,g,f,v),l=Math.min(p,m,y,b),c=Math.max(p,m,y,b)}else{var d=a.m00*t+a.m02,p=a.m11*i+a.m12,v=a.m00*u+a.m02,b=a.m11*h+a.m12;n=Math.min(d,v),s=Math.max(d,v),l=Math.min(p,b),c=Math.max(p,b)}return{left:n,top:l,width:s-n,height:c-l}},e.prototype.translate=function(e,i){if(0!==e||0!==i){var a=t(e,i);this.matrix=o(this.matrix,a),this._inverse=null}},e.prototype.scale=function(e,t){if(1!==e||1!==t){var a=i(e,t);this.matrix=o(this.matrix,a),this._inverse=null}},e.prototype.rotate=function(e){if(0!==e){var t=a(e);this.matrix=o(this.matrix,t),this._inverse=null}},e.prototype.add=function(e){e&&(this.matrix=o(this.matrix,e.matrix),this._inverse=null)},e.prototype.getInverse=function(){return this._inverse||(this._inverse=new e(r(this.matrix))),this._inverse},e}();e.Transform=n,e.createTranslateMatrix=t,e.createScaleMatrix=i,e.createRotationMatrix=a,e.createInverseMatrix=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=jsCommon.Color,r=e.data.DataRoleHelper;!function(i){function o(e,t){if(_.isEmpty(t))return void e.pushInstance({selector:null,properties:{show:!1,lineColor:i.defaults.lineColor,transparency:i.defaults.transparency,style:i.defaults.lineStyle,combineSeries:i.defaults.combineSeries},objectName:h});var a=t[0],r={};r.show=a.show,a.combineSeries&&(r.lineColor=a.lineColor),r.transparency=a.transparency,r.style=a.style,r.combineSeries=a.combineSeries,r.useHighlightValues=a.useHighlightValues,e.pushInstance({selector:null,properties:r,objectName:h})}function n(e){return r.hasRoleInDataView(e,"regression.X")}function s(a,r,o,n){if(a&&a.categorical){var s=a.categorical;if(!_.isEmpty(s.categories)&&!_.isEmpty(s.values)){var c=s.categories[0].values,d=s.values.grouped();if(c&&d){var p=e.DataViewObjects.getObject(a.metadata.objects,h,{}),g=e.DataViewObject.getValue(p,u.show,!1),m=e.DataViewObject.getValue(p,u.lineColor),f=e.DataViewObject.getValue(p,u.transparency,i.defaults.transparency),y=e.DataViewObject.getValue(p,u.style,i.defaults.lineStyle),v=e.DataViewObject.getValue(p,u.combineSeries,i.defaults.combineSeries),b=e.DataViewObject.getValue(p,u.useHighlightValues,i.defaults.useHighlightValues),C=e.DataViewObjects.getValue(s.values[0].source.objects,t.lineChartProps.dataPoint.fill);C&&(m=C);for(var S=r.metadata.objects,x=e.DataViewObjects.getFillColor(S,{objectName:"dataPoint",propertyName:"defaultColor"}),w=new t.ColorHelper(n,{objectName:"dataPoint",propertyName:"fill"},x),P=[],D=0;D<d.length;D++){for(var L=d[D],T=[],V=0;V<c.length;V++){var M=t.AxisHelper.normalizeNonFiniteNumber(c[V]),N=L.values[0],A=void 0;A=b&&N.highlights?N.highlights:N.values;var O=t.AxisHelper.normalizeNonFiniteNumber(A[V]);null!=M&&null!=O&&T.push({x:M,y:O})}var I=void 0;if(v)I=m||i.defaults.lineColor;else if(r.categorical.values.source){var R=r.categorical.values.grouped(),F=w.getColorForSeriesValue(R[D].objects,r.categorical.values.identityFields,L.name);F=l(F),I={solid:{color:F}}}else{var H=r.categorical.values[D],F=w.getColorForMeasure(H.source.objects,L.name);F=l(F),I={solid:{color:F}}}P.push({points:T,show:g,lineColor:I,transparency:f,style:y,combineSeries:v,useHighlightValues:b,y2Axis:o})}return P}}}}function l(e){var t=a.parseColorString(e);return t=a.darken(t,20),a.rgbString(t)}function c(e,i,a,r){var o=i.select(p.selector);o.empty()&&(o=i.append("svg").classed(p["class"],!0)),o.attr({height:r.height,width:r.width});var n=o.selectAll(d.selector).data(e||[]);n.enter().append("path").classed(d["class"],!0),n.attr("d",function(e){var t=a.x.scale,i=e.y2Axis&&a.y2?a.y2.scale:a.y1.scale,r=d3.svg.line().x(function(e){return t(e.x)}).y(function(e){return i(e.y)});return r(_.filter(e.points,function(e){return null!=e.x&&null!=e.y}))}),n.each(function(e){var i=d3.select(this),a={};a.stroke=e.lineColor.solid.color,null!=e.transparency&&(a["stroke-opacity"]=(100-e.transparency)/100),e.style===t.lineStyle.dashed?a["stroke-dasharray"]="5, 5":e.style===t.lineStyle.dotted?(a["stroke-dasharray"]="1, 5",a["stroke-linecap"]="round"):e.style===t.lineStyle.solid&&(a["stroke-dasharray"]=null,a["stroke-linecap"]=null),i.style(a)}),n.exit().remove()}var u={show:"show",lineColor:"lineColor",transparency:"transparency",style:"style",combineSeries:"combineSeries",useHighlightValues:"useHighlightValues"},h="trend";i.defaults={lineColor:{solid:{color:"#000"}},lineStyle:t.lineStyle.dashed,transparency:0,combineSeries:!0,useHighlightValues:!0};var d=jsCommon.CssConstants.createClassAndSelector("trend-line"),p=jsCommon.CssConstants.createClassAndSelector("trend-line-layer");i.enumerateObjectInstances=o,i.isDataViewForRegression=n,i.readDataView=s,i.darkenTrendLineColor=l,i.render=c}(i=t.TrendLineHelper||(t.TrendLineHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e.is(":visible")}e.partiallyVisible=t}(t=e.visibilityHelper||(e.visibilityHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,i=e.data.Selector;!function(e){function t(e,t){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:i.equals(e.selector,t.selector)?_.isEqual(e.objects,t.objects):!1}e.equals=t}(t=e.VisualObjectRepetition||(e.VisualObjectRepetition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=e.data.SemanticFilter,r=jsCommon.UrlUtils;!function(i){function o(i,r,o,s){if(i&&i.categorical&&!_.isEmpty(i.categorical.categories)){var l=i.categorical.categories[0].identityFields;if(l){var c=i.metadata&&i.metadata.objects&&e.DataViewObjects.getValue(i.metadata.objects,t.slicerProps.filterPropertyIdentifier),u=s.analyzeFilter({dataView:i,defaultValuePropertyId:t.slicerProps.defaultValue,filter:c,fieldSQExprs:l});if(u){var h=u.filter;if(h&&!a.isSameFilter(h,c)){o.handleClearSelection();var d=t.slicerProps.filterPropertyIdentifier,p={};p[d.propertyName]=u.filter;var g={objectName:d.objectName,selector:void 0,properties:p},m={merge:[g]};s.persistProperties(m)}var f=n(u,i.metadata,i.categorical,r,o,s);return f}}}}function n(e,i,o,n,l,c){var u=l&&l.isSelectionModeInverted(),h=e.selectedIdentities,d=!_.isEmpty(h)||u===!0;!u&&e.filter&&(u=e.isNotFilter),l&&(l.setSelectionModeInverted(u),l.setDefaultValueMode(a.isDefaultFilter(e.filter)));var p=o.categories[0],g=p&&p.values?p.values.length:0,m=[],f=t.valueFormatter.getFormatString(p.source,t.slicerProps.formatString),y=0,v=o.values&&o.values[0]&&o.values[0].values;v&&_.isEmpty(v)&&(v=void 0);for(var b=i&&!_.isEmpty(i.columns)&&t.converterHelper.isImageUrlColumn(i.columns[0]),C=[],S=0;g>S;S++){var x=p.identity&&p.identity[S],w=p.values&&p.values[S],P=v&&v[S],D=d?t.SlicerUtil.tryRemoveValueFromRetainedList(x,h):!1,L=t.valueFormatter.format(w,f),T=b===!0&&r.isValidImageUrl(L),V={value:L,tooltip:L,identity:t.SelectionId.createWithId(x),selected:D,count:P,isImage:T};if(D){var M={displayName:L,identity:x};C.push(M)}m.push(V),V.selected&&y++}if(_.isEmpty(C)||c.setIdentityDisplayNames(C),d&&!_.isEmpty(h)){var N=c.getIdentityDisplayNames(h);if(!_.isEmpty(N))for(var A=0,O=N;A<O.length;A++){var I=O[A],R={value:I.displayName,tooltip:I.displayName,identity:t.SelectionId.createWithId(I.identity),selected:!0,count:null!=v?0:void 0};m.push(R),y++}}var F=s(i);if(F.selection.selectAllCheckboxEnabled){if(y>0&&!i.segment&&y===m.length){u=!u,l.setSelectionModeInverted(u);for(var H=0,z=m;H<z.length;H++){var G=z[H];G.selected=!1}d=!1,y=0}m.unshift({value:n,tooltip:n,identity:t.SelectionId.createWithMeasure(n),selected:!!u&&0===y,isSelectAllDataPoint:!0,count:void 0})}var k={categorySourceName:p.source.displayName,slicerSettings:F,slicerDataPoints:m,hasSelectionOverride:d,defaultValue:e.defaultValue};return k}function s(i){var a=t.Slicer.DefaultStyleProperties(),r=i.objects,o=i.columns&&_.some(i.columns,function(e){return e.discourageAggregationAcrossGroups});if(r){a.general.outlineColor=e.DataViewObjects.getFillColor(r,t.slicerProps.general.outlineColor,a.general.outlineColor),a.general.outlineWeight=e.DataViewObjects.getValue(r,t.slicerProps.general.outlineWeight,a.general.outlineWeight),a.general.orientation=e.DataViewObjects.getValue(r,t.slicerProps.general.orientation,a.general.orientation),a.header.show=e.DataViewObjects.getValue(r,t.slicerProps.header.show,a.header.show),a.header.fontColor=e.DataViewObjects.getFillColor(r,t.slicerProps.header.fontColor,a.header.fontColor);var n=e.DataViewObjects.getFillColor(r,t.slicerProps.header.background);n&&(a.header.background=n),a.header.outline=e.DataViewObjects.getValue(r,t.slicerProps.header.outline,a.header.outline),a.header.textSize=e.DataViewObjects.getValue(r,t.slicerProps.header.textSize,a.header.textSize),a.slicerText.color=e.DataViewObjects.getFillColor(r,t.slicerProps.items.fontColor,a.slicerText.color);var s=e.DataViewObjects.getFillColor(r,t.slicerProps.items.background);s&&(a.slicerText.background=s),a.slicerText.outline=e.DataViewObjects.getValue(r,t.slicerProps.items.outline,a.slicerText.outline),a.slicerText.textSize=e.DataViewObjects.getValue(r,t.slicerProps.items.textSize,a.slicerText.textSize),a.selection.selectAllCheckboxEnabled=!o&&e.DataViewObjects.getValue(r,t.slicerProps.selection.selectAllCheckboxEnabled,a.selection.selectAllCheckboxEnabled),a.selection.singleSelect=o||e.DataViewObjects.getValue(r,t.slicerProps.selection.singleSelect,a.selection.singleSelect),a.search.enabled=e.DataViewObjects.getValue(r,t.slicerProps.general.selfFilterEnabled,a.search.enabled)}return a}i.convert=o}(i=t.DataConversion||(t.DataConversion={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=e.visuals.shapes;!function(e){e[e.None=0]="None",e[e.VerticalBottomTop=1]="VerticalBottomTop",e[e.VerticalTopBottom=2]="VerticalTopBottom",e[e.HorizontalLeftRight=3]="HorizontalLeftRight",e[e.HorizontalRightLeft=4]="HorizontalRightLeft"}(e.RectOrientation||(e.RectOrientation={}));var i=e.RectOrientation;!function(e){e[e.Allowed=0]="Allowed",e[e.Disallowed=1]="Disallowed",e[e.Partial=2]="Partial"}(e.OutsidePlacement||(e.OutsidePlacement={}));var a=e.OutsidePlacement,r=function(){function r(){this.movingStep=3,this.hideOverlapped=!0,this.defaultDataLabelSettings={anchorMargin:r.DefaultAnchorMargin,anchorRectOrientation:i.None,contentPosition:128,outsidePlacement:a.Disallowed,maximumMovingDistance:r.DefaultMaximumMovingDistance,minimumMovingDistance:r.DefaultMinimumMovingDistance,validContentPositions:128,opacity:1}}return Object.defineProperty(r.prototype,"defaultSettings",{get:function(){return this.defaultDataLabelSettings},enumerable:!0,configurable:!0}),r.prototype.hideCollidedLabels=function(e,t,i,a){void 0===a&&(a=!1);var n=new o(e,t,i),s=[],l={x:0,y:0};a&&(l.x=e.width/2,l.y=e.height/2);for(var c=0,u=t.length;u>c;c++)if(i.filter(t[c])){var h=this.getLabelInfo(t[c]);h.anchorPoint={x:i.labelLayout.x(t[c])+l.x,y:i.labelLayout.y(t[c])+l.y};var d=this.calculateContentPosition(h,h.contentPosition,t[c].size,h.anchorMargin);r.isValid(d)&&!this.hasCollisions(n,h,d,e)&&(t[c].labelX=d.left-l.x,t[c].labelY=d.top-l.y,n.add(h,d),s.push(t[c]))}return s},r.prototype.getLabelInfo=function(e){var t=this.defaultDataLabelSettings;return e.anchorMargin=void 0!==e.anchorMargin?e.anchorMargin:t.anchorMargin,e.anchorRectOrientation=void 0!==e.anchorRectOrientation?e.anchorRectOrientation:t.anchorRectOrientation,e.contentPosition=void 0!==e.contentPosition?e.contentPosition:t.contentPosition,e.maximumMovingDistance=void 0!==e.maximumMovingDistance?e.maximumMovingDistance:t.maximumMovingDistance,e.minimumMovingDistance=void 0!==e.minimumMovingDistance?e.minimumMovingDistance:t.minimumMovingDistance,e.outsidePlacement=void 0!==e.outsidePlacement?e.outsidePlacement:t.outsidePlacement,e.validContentPositions=void 0!==e.validContentPositions?e.validContentPositions:t.validContentPositions,e.opacity=void 0!==e.opacity?e.opacity:t.opacity,e.maximumMovingDistance+=e.anchorMargin,e},r.prototype.calculateContentPositionFromPoint=function(e,t,i,a){var r={x:0,y:0};if(e){if(void 0!==e.x&&isFinite(e.x))switch(r.x=e.x,t){case 1:case 8:case 64:r.x-=i.width/2;break;case 4:case 32:case 256:r.x+=i.width/2}if(void 0!==e.y&&isFinite(e.y))switch(r.y=e.y,t){case 8:case 16:case 32:r.y-=i.height/2;break;case 4:case 1:case 2:r.y-=i.height}if(void 0!==a&&isFinite(a))switch(t){case 1:r.x-=a,r.y-=a;break;case 8:r.x-=a;break;case 64:r.x-=a,r.y+=a;break;case 2:r.y-=a;break;case 16:break;case 128:r.y+=a;break;case 4:r.x+=a,r.y-=a;break;case 32:r.x+=a;break;case 256:r.x+=a,r.y+=a}}return{left:r.x,top:r.y,width:i.width,height:i.height}},r.prototype.calculateContentPositionFromRect=function(e,t,i,a,r){switch(i){case 512:return this.handleInsideCenterPosition(t,a,e,r);case 2048:return this.handleInsideEndPosition(t,a,e,r);case 1024:return this.handleInsideBasePosition(t,a,e,r);case 8192:return this.handleOutsideEndPosition(t,a,e,r);case 4096:return this.handleOutsideBasePosition(t,a,e,r)}return{left:0,top:0,width:-1,height:-1}},r.prototype.handleInsideCenterPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:case i.VerticalTopBottom:return n.middleVertical(t,a,r);case i.HorizontalLeftRight:case i.HorizontalRightLeft:default:return n.middleHorizontal(t,a,r)}},r.prototype.handleInsideEndPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return n.topInside(t,a,r);case i.VerticalTopBottom:return n.bottomInside(t,a,r);case i.HorizontalRightLeft:return n.leftInside(t,a,r);case i.HorizontalLeftRight:default:return n.rightInside(t,a,r)}},r.prototype.handleInsideBasePosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return n.bottomInside(t,a,r);case i.VerticalTopBottom:return n.topInside(t,a,r);case i.HorizontalRightLeft:return n.rightInside(t,a,r);case i.HorizontalLeftRight:default:return n.leftInside(t,a,r)}},r.prototype.handleOutsideEndPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return n.topOutside(t,a,r);case i.VerticalTopBottom:return n.bottomOutside(t,a,r);case i.HorizontalRightLeft:return n.leftOutside(t,a,r);case i.HorizontalLeftRight:default:return n.rightOutside(t,a,r)}},r.prototype.handleOutsideBasePosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return n.bottomOutside(t,a,r);case i.VerticalTopBottom:return n.topOutside(t,a,r);case i.HorizontalRightLeft:return n.rightOutside(t,a,r);case i.HorizontalLeftRight:default:return n.leftOutside(t,a,r)}},r.prototype.calculateContentPosition=function(e,t,i,a){return 2048!==t&&512!==t&&1024!==t&&4096!==t&&8192!==t?this.calculateContentPositionFromPoint(e.anchorPoint,t,i,a):this.calculateContentPositionFromRect(e.anchorRect,e.anchorRectOrientation,t,i,a)},r.prototype.hasCollisions=function(i,o,n,s){var l=t.Rect;if(i.hasConflict(n))return!0;var c={left:0,top:n.height/2,width:s.width,height:s.height};if(c=l.inflate(c,{left:r.InflateAmount,top:0,right:r.InflateAmount,bottom:0}),c=l.intersect(c,n),l.isEmpty(c))return!0;var u=e.Double.lessWithPrecision;switch(o.outsidePlacement){case a.Disallowed:return u(c.width,n.width)||u(c.height,n.height/2);case a.Partial:return u(c.width,n.width/2)||u(c.height,n.height/4)}return!1},r.isValid=function(e){return!t.Rect.isEmpty(e)&&e.width>0&&e.height>0},r.DefaultAnchorMargin=0,r.DefaultMaximumMovingDistance=12,r.DefaultMinimumMovingDistance=3,r.InflateAmount=5,r}();e.DataLabelManager=r;var o=function(){function i(t,a,r){this.grid=[],0!==t.width&&0!==t.height||(this.cellSize=t,this.rowCount=this.colCount=0);var o={fontFamily:e.visuals.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:e.visuals.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:e.visuals.dataLabelUtils.LabelTextProperties.fontWeight};this.cellSize={width:0,height:0};for(var n=0,s=a.length;s>n;n++){var l=a[n];l.labeltext=r.labelText(l);var c=e.Prototype.inherit(o);c.text=l.labeltext,c.fontSize=l.data?l.data.labelFontSize:l.labelFontSize?l.labelFontSize:e.visuals.dataLabelUtils.LabelTextProperties.fontSize,l.size={width:e.TextMeasurementService.measureSvgTextWidth(c),height:e.TextMeasurementService.estimateSvgTextHeight(c)};var u=2*l.size.width,h=2*l.size.height;u>this.cellSize.width&&(this.cellSize.width=u),h>this.cellSize.height&&(this.cellSize.height=h)}0===this.cellSize.width&&(this.cellSize.width=t.width),0===this.cellSize.height&&(this.cellSize.height=t.height),this.colCount=this.getGridRowColCount(this.cellSize.width,t.width,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this.rowCount=this.getGridRowColCount(this.cellSize.height,t.height,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this.cellSize.width=t.width/this.colCount,this.cellSize.height=t.height/this.rowCount;for(var d=this.grid,p=0;p<this.colCount;p++){d[p]=[];for(var g=0;g<this.rowCount;g++)d[p][g]=[]}}return i.prototype.add=function(e,t){for(var i=this.getGridIndexRect(t),a=this.grid,r=i.left;r<i.right;r++)for(var o=i.top;o<i.bottom;o++)a[r][o].push({element:e,rect:t})},i.prototype.hasConflict=function(e){for(var i=this.getGridIndexRect(e),a=this.grid,r=t.Rect.isIntersecting,o=i.left;o<i.right;o++)for(var n=i.top;n<i.bottom;n++)for(var s=0;s<a[o][n].length;s++){var l=a[o][n][s];if(r(l.rect,e))return!0}return!1},i.prototype.getGridRowColCount=function(e,t,i,a){return Math.min(Math.max(Math.ceil(t/e),i),a)},i.prototype.getGridIndexRect=function(e){var t=function(e,t,i){return Math.min(Math.max(e,t),i)};return{left:t(Math.floor(e.left/this.cellSize.width),0,this.colCount),top:t(Math.floor(e.top/this.cellSize.height),0,this.rowCount),right:t(Math.ceil((e.left+e.width)/this.cellSize.width),0,this.colCount),bottom:t(Math.ceil((e.top+e.height)/this.cellSize.height),0,this.rowCount)}},i.ARRANGEGRID_MIN_COUNT=1,i.ARRANGEGRID_MAX_COUNT=100,i}();e.DataLabelArrangeGrid=o;var n;!function(e){function t(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+i,width:e.width,height:e.height}}function i(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height-e.height-i,width:e.width,height:e.height}}function a(e,t,i){
return{left:t.left+t.width-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function r(e,t,i){return{left:t.left+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function o(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top-e.height-i,width:e.width,height:e.height}}function n(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height+i,width:e.width,height:e.height}}function s(e,t,i){return{left:t.left+t.width+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function l(e,t,i){return{left:t.left-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function c(e,t,i){return{left:t.left+t.width/2-e.width/2+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function u(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height/2-e.height/2+i,width:e.width,height:e.height}}e.topInside=t,e.bottomInside=i,e.rightInside=a,e.leftInside=r,e.topOutside=o,e.bottomOutside=n,e.rightOutside=s,e.leftOutside=l,e.middleHorizontal=c,e.middleVertical=u}(n||(n={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=e.visuals.shapes,i=e.visuals.shapes.Rect,a=e.visuals.NewDataLabelUtils,r=function(){function e(t,i){this.viewport=i;for(var a=0,r=0,o=0,n=t;o<n.length;o++)for(var s=n[o],l=0,c=s.labelDataPoints;l<c.length;l++){var u=c[l];if(u.isPreferred){var h=u.labelSize;h.width>a&&(a=h.width),h.height>r&&(r=h.height)}}0===a&&(a=i.width),0===r&&(r=i.height);var d=this.cellSize={width:a*e.cellSizeMultiplier,height:r*e.cellSizeMultiplier};this.columnCount=e.getCellCount(d.width,i.width,1,100),this.rowCount=e.getCellCount(d.height,i.height,1,100);for(var p=[],g=0,m=this.columnCount;m>g;g++){p[g]=[];for(var f=0,y=this.rowCount;y>f;f++)p[g][f]=[]}this.grid=p}return e.prototype.add=function(e){for(var t=this.getContainingGridSubsection(e),i=t.xMin;i<t.xMax;i++)for(var a=t.yMin;a<t.yMax;a++)this.grid[i][a].push(e)},e.prototype.hasConflict=function(e){return this.isWithinGridViewport(e)?this.hasCollision(e):!0},e.prototype.tryPositionInViewport=function(e){return this.isCloseToGridViewport(e)?(this.isWithinGridViewport(e)||(e=this.tryMoveInsideViewport(e)),e&&!this.hasCollision(e)?e:void 0):void 0},e.prototype.hasCollision=function(e){for(var i=this.getContainingGridSubsection(e),a=this.grid,r=t.Rect.isIntersecting,o=i.xMin;o<i.xMax;o++)for(var n=i.yMin;n<i.yMax;n++)for(var s=0,l=a[o][n];s<l.length;s++){var c=l[s];if(r(c,e))return!0}return!1},e.prototype.isWithinGridViewport=function(e){return e.left>=0&&e.top>=0&&e.left+e.width<=this.viewport.width&&e.top+e.height<=this.viewport.height},e.prototype.isCloseToGridViewport=function(e){return e.left+e.width>=0-e.width&&e.top+e.height>=-e.height&&e.left<=this.viewport.width+e.width&&e.top<=this.viewport.height+e.height},e.prototype.tryMoveInsideViewport=function(e){var t=i.clone(e),a=this.viewport;return e.width>a.width||e.height>a.height?void 0:(e.left<0?t.left=0:e.left+e.width>a.width&&(t.left-=e.left+e.width-a.width),e.top<0?t.top=0:e.top+e.height>a.height&&(t.top-=e.top+e.height-a.height),t)},e.prototype.getContainingGridSubsection=function(t){return{xMin:e.bound(Math.floor(t.left/this.cellSize.width),0,this.columnCount),xMax:e.bound(Math.ceil((t.left+t.width)/this.cellSize.width),0,this.columnCount),yMin:e.bound(Math.floor(t.top/this.cellSize.height),0,this.rowCount),yMax:e.bound(Math.ceil((t.top+t.height)/this.cellSize.height),0,this.rowCount)}},e.getCellCount=function(t,i,a,r){return e.bound(Math.ceil(i/t),a,r)},e.bound=function(e,t,i){return Math.max(Math.min(e,i),t)},e.cellSizeMultiplier=2,e}();e.LabelArrangeGrid=r;var o=function(){function e(t){this.startingOffset=t.startingOffset,this.maximumOffset=t.maximumOffset,null!=t.offsetIterationDelta?this.offsetIterationDelta=t.offsetIterationDelta:this.offsetIterationDelta=e.defaultOffsetIterationDelta,null!=t.horizontalPadding?this.horizontalPadding=t.horizontalPadding:this.horizontalPadding=e.defaultHorizontalPadding,null!=t.verticalPadding?this.verticalPadding=t.verticalPadding:this.verticalPadding=e.defaultVerticalPadding,this.allowLeaderLines=!!t.allowLeaderLines,this.attemptToMoveLabelsIntoViewport=!!t.attemptToMoveLabelsIntoViewport}return e.prototype.layout=function(e,t){for(var i=0,o=e;i<o.length;i++)for(var n=o[i],s=0,l=n.labelDataPoints;s<l.length;s++){var c=l[s];c.hasBeenRendered=!1,c.hasBackground?c.labelSize={width:c.textSize.width+2*a.horizontalLabelBackgroundPadding,height:c.textSize.height+2*a.verticalLabelBackgroundPadding}:c.labelSize=c.textSize}for(var u=[],h=new r(e,t),d=0,p=e;d<p.length;d++){for(var n=p[d],g=n.maxNumberOfLabels,m=_.clone(n.labelDataPoints),f=[],y=m.length-1,v=g;y>=0&&v>0;y--){var c=m[y];c.isPreferred&&(f.unshift(m.splice(y,1)[0]),v--)}if(f.length>0){var b=this.positionDataLabels(f,t,h,g);g-=b.length,u=u.concat(b)}if(m.length>0){var C=this.positionDataLabels(m,t,h,g);u=u.concat(C)}}return u},e.prototype.positionDataLabels=function(e,t,i,a){for(var r,o=[],n=this.offsetIterationDelta,s=this.startingOffset,l=0;s<=this.maximumOffset&&a>0;){r=this.allowLeaderLines&&s>this.startingOffset;for(var c=0,u=e;c<u.length;c++){var h=u[c];if(0===a)break;if(!h.hasBeenRendered){var d=void 0;d=1===h.parentType?this.tryPositionForRectPositions(h,i,s,l):this.tryPositionForPointPositions(h,i,s,r),d&&(o.push(d),a--)}}s+=n,l+=n}return o},e.prototype.tryPositionForRectPositions=function(t,i,a,r){for(var o=this,s=function(s,l){var c=7&s;if(!c||n.canFitWithinParent(t,o.horizontalPadding,o.verticalPadding)){var u=e.tryPositionRect(i,s,t,a,r,l);if(u){if(c&&!n.isLabelWithinParent(u,t,o.horizontalPadding,o.verticalPadding))return;return i.add(u),t.hasBeenRendered=!0,{boundingBox:u,text:t.text,tooltip:t.tooltip,isVisible:!0,fill:c?t.insideFill:t.outsideFill,identity:t.identity,key:t.key,fontSize:t.fontSize,selected:!1,hasBackground:!!t.hasBackground}}}},l=0,c=t.parentShape.validPositions;l<c.length;l++){var u=c[l],h=s(u,!1);if(h)return h}if(this.attemptToMoveLabelsIntoViewport)for(var d=0,p=t.parentShape.validPositions;d<p.length;d++){var u=p[d],h=s(u,!0);if(h)return h}return null},e.tryPositionRect=function(e,t,i,a,r,o){var s=a;1&t&&(s=r);var l=n.getLabelRect(i,t,s);if(1!==t||0===i.parentShape.orientation){if(!e.hasConflict(l))return l;if(o)return e.tryPositionInViewport(l)}else{if(!e.hasConflict(l))return l;if(l=n.getLabelRect(i,t,-s),!e.hasConflict(l))return l}return null},e.prototype.tryPositionForPointPositions=function(t,i,a,r){for(var o=function(o,n,l){var c=e.tryPositionPoint(i,o,t,a,l);return c?(i.add(c),t.hasBeenRendered=!0,{boundingBox:c,text:t.text,tooltip:t.tooltip,isVisible:!0,fill:256===o?t.insideFill:t.outsideFill,isInsideParent:256===o,identity:t.identity,key:t.key,fontSize:t.fontSize,selected:!1,leaderLinePoints:r?s.getLabelLeaderLineEndingPoint(c,o,n):null,hasBackground:!!t.hasBackground}):void 0},n=t.parentShape,l=n.validPositions,c=0,u=l;c<u.length;c++){var h=u[c],d=o(h,n,!1);if(d)return d}if(this.attemptToMoveLabelsIntoViewport&&!_.isEmpty(l)){var d=o(l[0],n,!0);if(d)return d}return null},e.tryPositionPoint=function(e,t,i,a,r){var o=s.getLabelRect(i.labelSize,i.parentShape,t,a);return e.hasConflict(o)?r?e.tryPositionInViewport(o):null:o},e.defaultOffsetIterationDelta=2,e.defaultHorizontalPadding=2,e.defaultVerticalPadding=2,e}();e.LabelLayout=o;var n;!function(e){function i(t,i,a){var r=t.parentShape;if(null!=r)switch(i){case 1:switch(r.orientation){case 1:case 2:return e.middleVertical(t.labelSize,r.rect,a);case 3:case 4:return e.middleHorizontal(t.labelSize,r.rect,a);case 0:}case 2:switch(r.orientation){case 1:return e.bottomInside(t.labelSize,r.rect,a);case 2:return e.topInside(t.labelSize,r.rect,a);case 3:return e.leftInside(t.labelSize,r.rect,a);case 4:return e.rightInside(t.labelSize,r.rect,a);case 0:}case 4:switch(r.orientation){case 1:return e.topInside(t.labelSize,r.rect,a);case 2:return e.bottomInside(t.labelSize,r.rect,a);case 3:return e.rightInside(t.labelSize,r.rect,a);case 4:return e.leftInside(t.labelSize,r.rect,a);case 0:}case 8:switch(r.orientation){case 1:return e.bottomOutside(t.labelSize,r.rect,a);case 2:return e.topOutside(t.labelSize,r.rect,a);case 3:return e.leftOutside(t.labelSize,r.rect,a);case 4:return e.rightOutside(t.labelSize,r.rect,a);case 0:}case 16:switch(r.orientation){case 1:return e.topOutside(t.labelSize,r.rect,a);case 2:return e.bottomOutside(t.labelSize,r.rect,a);case 3:return e.rightOutside(t.labelSize,r.rect,a);case 4:return e.leftOutside(t.labelSize,r.rect,a);case 0:}}return null}function a(e,t,i){return e.labelSize.width+2*t<e.parentShape.rect.width||e.labelSize.height+2*i<e.parentShape.rect.height}function r(e,i,a,r){var o=i.parentShape.rect,n=t.Rect.inflate(e,{left:a,right:a,top:r,bottom:r});return t.Rect.containsPoint(o,{x:n.left,y:n.top})&&t.Rect.containsPoint(o,{x:n.left+n.width,y:n.top+n.height})}function o(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+i,width:e.width,height:e.height}}function n(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height-i-e.height,width:e.width,height:e.height}}function s(e,t,i){return{left:t.left+t.width-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function l(e,t,i){return{left:t.left+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function c(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top-e.height-i,width:e.width,height:e.height}}function u(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height+i,width:e.width,height:e.height}}function h(e,t,i){return{left:t.left+t.width+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function d(e,t,i){return{left:t.left-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function p(e,t,i){return{left:t.left+t.width/2-e.width/2+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function g(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height/2-e.height/2+i,width:e.width,height:e.height}}e.getLabelRect=i,e.canFitWithinParent=a,e.isLabelWithinParent=r,e.topInside=o,e.bottomInside=n,e.rightInside=s,e.leftInside=l,e.topOutside=c,e.bottomOutside=u,e.rightOutside=h,e.leftOutside=d,e.middleHorizontal=p,e.middleVertical=g}(n=e.DataLabelRectPositioner||(e.DataLabelRectPositioner={}));var s;!function(e){function t(t,i,a,r){switch(a){case 1:return e.above(t,i.point,i.radius+r);case 2:return e.below(t,i.point,i.radius+r);case 4:return e.left(t,i.point,i.radius+r);case 8:return e.right(t,i.point,i.radius+r);case 32:return e.belowLeft(t,i.point,i.radius+r);case 16:return e.belowRight(t,i.point,i.radius+r);case 128:return e.aboveLeft(t,i.point,i.radius+r);case 64:return e.aboveRight(t,i.point,i.radius+r);case 256:return e.center(t,i.point)}return null}function i(e,t,i){return{left:t.x-e.width/2,top:t.y-i-e.height,width:e.width,height:e.height}}function a(e,t,i){return{left:t.x-e.width/2,top:t.y+i,width:e.width,height:e.height}}function r(e,t,i){return{left:t.x-i-e.width,top:t.y-e.height/2,width:e.width,height:e.height}}function o(e,t,i){return{left:t.x+i,top:t.y-e.height/2,width:e.width,height:e.height}}function n(t,i,a){return{left:i.x-e.sin45*a-t.width,top:i.y+e.cos45*a,width:t.width,height:t.height}}function s(t,i,a){return{left:i.x+e.sin45*a,top:i.y+e.cos45*a,width:t.width,height:t.height}}function l(t,i,a){return{left:i.x-e.sin45*a-t.width,top:i.y-e.cos45*a-t.height,width:t.width,height:t.height}}function c(t,i,a){return{left:i.x+e.sin45*a,top:i.y-e.cos45*a-t.height,width:t.width,height:t.height}}function u(e,t){return{left:t.x-e.width/2,top:t.y-e.height/2,width:e.width,height:e.height}}function h(e,t,i){var a=e.left,r=e.top;switch(t){case 1:a+=e.width/2,r+=e.height;break;case 2:a+=e.width/2;break;case 4:a+=e.width,r+=2*e.height/3;break;case 8:r+=2*e.height/3;break;case 32:a+=e.width,r+=e.height/2;break;case 16:r+=e.height/2;break;case 128:a+=e.width,r+=e.height;break;case 64:r+=e.height}return[[i.point.x,i.point.y],[a,r]]}e.cos45=Math.cos(45),e.sin45=Math.sin(45),e.getLabelRect=t,e.above=i,e.below=a,e.left=r,e.right=o,e.belowLeft=n,e.belowRight=s,e.aboveLeft=l,e.aboveRight=c,e.center=u,e.getLabelLeaderLineEndingPoint=h}(s=e.DataLabelPointPositioner||(e.DataLabelPointPositioner={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=e.visuals.NewDataLabelUtils,i=e.visuals.labelStyle,a=e.visuals.DonutLabelUtils,r=function(){function r(i,a){this.startingOffset=i.startingOffset,this.maximumOffset=i.maximumOffset,null!=i.offsetIterationDelta&&(this.offsetIterationDelta=i.offsetIterationDelta),this.donutChartProperties=a,this.center={x:a.viewport.width/2,y:a.viewport.height/2},this.outerRadius=this.donutChartProperties.radius*this.donutChartProperties.outerArcRadiusRatio,this.innerRadius=this.donutChartProperties.radius/2*this.donutChartProperties.innerArcRadiusRatio,this.additionalCharsWidth=e.TextMeasurementService.measureSvgTextWidth({text:" ()",fontFamily:t.LabelTextProperties.fontFamily,fontSize:jsCommon.PixelConverter.fromPoint(a.dataLabelsSettings.fontSize),fontWeight:t.LabelTextProperties.fontWeight})}return r.prototype.layout=function(t){for(var i=0,a=t;i<a.length;i++){var r=a[i];r.hasBeenRendered=!1,r.labelSize=r.textSize}for(var o=[],n=[],s=this.donutChartProperties.viewport,l={labelDataPoints:t,maxNumberOfLabels:t.length},c=new e.LabelArrangeGrid([l],s),u=t.length-1;u>=0;u--){var h=t[u];if(h.isPreferred){var d=t.splice(u,1);n=d.concat(n)}}if(n.length>0&&(o=this.positionLabels(n,c)),t.length>0){var p=this.positionLabels(t,c);o=o.concat(p)}return o},r.prototype.positionLabels=function(e,t){for(var i=[],a=this.offsetIterationDelta,r=this.startingOffset,o=0;r<=this.maximumOffset;){for(var n=0,s=e;n<s.length;n++){var l=s[n];if(!l.hasBeenRendered){var c=this.tryPositionForDonut(l,t,r);c&&i.push(c)}}r+=a,o+=a}return i},r.prototype.tryPositionForDonut=function(e,t,a){var r=e.parentShape;if(!_.isEmpty(r.validPositions)&&0!==r.validPositions[0]){var o=r.validPositions[0],n=this.tryAllPositions(e,t,o,a);if(n&&0===n.score)return this.buildLabel(n,t);if(this.donutChartProperties.dataLabelsSettings.labelStyle===i.both){var s=this.splitDonutDataPoint(e),l=this.tryAllPositions(s,t,o,a);if(l&&(!n||l.score<n.score))return this.buildLabel(l,t)}return n?this.buildLabel(n,t):void 0}},r.prototype.generateCandidate=function(e,t,i,o){var n=this.generateCandidateAngleForPosition(e.donutArcDescriptor,t),s=this.getPointPositionForAngle(n),l=s.point,c=this.score(e,l),u=a.getLabelLeaderLineForDonutChart(e.donutArcDescriptor,this.donutChartProperties,l,n),h=a.getLabelLeaderLinesSizeForDonutChart(u),d=_.clone(e);d.angle=n,d.parentShape=s,d.leaderLinePoints=u,d.linesSize=h;var p=r.tryPositionPoint(i,s.validPositions[0],d,o,this.center,this.donutChartProperties.viewport);return{angle:n,point:s,score:c,labelRects:p,labelDataPoint:d}},r.prototype.tryAllPositions=function(e,t,i,a){var o=r.tryPositionPoint(t,i,e,a,this.center,this.donutChartProperties.viewport),n=e.parentShape,s={point:n,angle:e.angle,score:this.score(e,n.point),labelRects:o,labelDataPoint:e};if(o&&o.textRect&&0===s.score)return s;var l,c=[];o&&o.textRect?(c=this.getLabelPointPositions(e,!0),l=s):c=this.getLabelPointPositions(e,!1);for(var u=0,h=c;u<h.length;u++){var d=h[u],p=this.generateCandidate(e,d,t,a);if(p.labelRects&&p.labelRects.textRect&&(null==l||p.score<l.score)&&(l=p,0===l.score))return l}return l},r.prototype.buildLabel=function(t,r){var o=t.labelRects.textRect,n=t.labelDataPoint;r.add(o),r.add(t.labelRects.horizontalLineRect),r.add(t.labelRects.diagonalLineRect),n.hasBeenRendered=!0;var s=o.left-this.center.x;0>s?s+=o.width/2:s-=o.width/2;var l,c,u,h=8===n.parentShape.validPositions[0]?"start":"end",d={left:s,top:o.top-this.center.y,height:o.height,width:o.width},p=this.donutChartProperties.dataLabelsSettings.labelStyle,g=a.getSpaceAvailableForDonutLabels(n.parentShape.point.x,this.donutChartProperties.viewport),m=e.visuals.dataLabelUtils.getLabelFormattedText,f=n.fontSize,y=p===i.both&&null==n.secondRowText;switch(y&&(n.dataLabel=" ("+n.dataLabel+")",g/=2),p!==i.both&&p!==i.data||(l=m({label:n.dataLabel,maxWidth:g,fontSize:f})),p!==i.both&&p!==i.category||(c=m({label:n.categoryLabel,maxWidth:g,fontSize:f})),p){case i.both:null==n.secondRowText?u=c+l:(u=l,n.secondRowText=c);break;case i.data:u=l;break;case i.category:u=c}return n.textSize.width=Math.min(n.textSize.width,y?2*g:g),{boundingBox:d,text:u,tooltip:n.tooltip,isVisible:!0,fill:n.outsideFill,identity:n.identity,fontSize:f,selected:!1,textAnchor:h,leaderLinePoints:n.leaderLinePoints,hasBackground:!1,secondRowText:n.secondRowText}},r.tryPositionPoint=function(t,i,r,o,n,s){var l=r.parentShape,c=_.clone(r.textSize);c.width=Math.min(c.width,a.getSpaceAvailableForDonutLabels(l.point.x,s));var u=e.DataLabelPointPositioner.getLabelRect(c,l,i,o),h={point:{x:r.leaderLinePoints[0][0],y:r.leaderLinePoints[0][1]<0?r.leaderLinePoints[1][1]:r.leaderLinePoints[0][1]},radius:0,validPositions:null},d=e.DataLabelPointPositioner.getLabelRect(r.linesSize[a.DiagonalLineIndex],h,i,o),p={point:{x:r.leaderLinePoints[1][0],y:r.leaderLinePoints[1][1]},radius:0,validPositions:null},g=e.DataLabelPointPositioner.getLabelRect(r.linesSize[a.HorizontalLineIndex],p,i,o);if(u&&d&&g){u.left+=n.x,u.top+=n.y;var m=n.x-u.width/2;return d.left+=m,d.top+=n.y,g.left+=m,g.top+=n.y,t.hasConflict(u)||t.hasConflict(d)||t.hasConflict(g)?void 0:{textRect:u,diagonalLineRect:d,horizontalLineRect:g}}},r.prototype.getLabelPointPositions=function(e,t){var i=e.parentShape,a=i.validPositions[0];return t?i.point.y<0?8===a?[64]:[128]:8===a?[16]:[32]:4===a?[128,32]:[16,64]},r.prototype.splitDonutDataPoint=function(e){var t={width:Math.max(e.categoryLabelSize.width,e.dataLabelSize.width),height:2*e.dataLabelSize.height},i=_.clone(e);return i.textSize=t,i.secondRowText=e.categoryLabel,i},r.prototype.generateCandidateAngleForPosition=function(e,t){var i=e.startAngle+(e.endAngle-e.startAngle)/2;switch(t){case 64:case 32:return(e.startAngle+i-Math.PI)/2;case 128:case 16:return(i+e.endAngle-Math.PI)/2}},r.prototype.getPointPositionForAngle=function(e){var t=a.getXPositionForDonutLabel(Math.cos(e)*this.outerRadius),i=Math.sin(e)*this.outerRadius,r=0>t?4:8,o={point:{x:t,y:i},validPositions:[r],radius:0};return o},r.prototype.score=function(e,t){var r,o=a.getSpaceAvailableForDonutLabels(t.x,this.donutChartProperties.viewport);return this.donutChartProperties.dataLabelsSettings.labelStyle===i.both&&null==e.secondRowText?(r=Math.max(e.categoryLabelSize.width,e.dataLabelSize.width+this.additionalCharsWidth),o/=2):r=e.textSize.width,Math.max(r-o,0)},r}();e.DonutLabelLayout=r}(powerbi||(powerbi={}));var powerbi;!function(e){var t=e.visuals.NewDataLabelUtils,i=5,a=10,r=60,o=5,n=function(){function n(){}return n.prototype.layout=function(i,a,r,o){if(o||void 0===this.labels){for(var n={labelDataPoints:i,maxNumberOfLabels:i.length},l=0,c=i;l<c.length;l++){var u=c[l];u.labelSize={width:u.textSize.width+2*t.horizontalLabelBackgroundPadding,height:u.textSize.height+2*t.verticalLabelBackgroundPadding}}for(var h=new e.LabelArrangeGrid([n],a),d=[],p=[],g=0,m=i;g<m.length;g++){var u=m[g],f=u.parentShape.polygon;p.push(f),f.pixelBoundingRect=r.applyToRect(f.absoluteBoundingRect())}for(var y=new s(p,a),v=0,b=i;v<b.length;v++){var u=b[v],C=this.getLabelByPolygonPositions(u,r,h,y);null!=C&&d.push(C)}this.labels=d}else this.updateLabelOffsets(r);return this.labels},n.prototype.getLabelPolygon=function(e,t,i,a){var r={width:e.textSize.width,height:e.textSize.height};return this.getLabelBoundingBox(r,t,i,a)},n.prototype.getLabelBoundingBox=function(t,i,a,r){switch(i){case 1:return e.DataLabelPointPositioner.above(t,a,r);case 2:return e.DataLabelPointPositioner.below(t,a,r);case 4:return e.DataLabelPointPositioner.left(t,a,r);case 8:return e.DataLabelPointPositioner.right(t,a,r);case 128:return e.DataLabelPointPositioner.aboveLeft(t,a,r);case 64:return e.DataLabelPointPositioner.aboveRight(t,a,r);case 32:return e.DataLabelPointPositioner.belowLeft(t,a,r);case 16:return e.DataLabelPointPositioner.belowRight(t,a,r);case 256:return e.DataLabelPointPositioner.center(t,a)}return null},n.prototype.getLabelByPolygonPositions=function(e,t,o,n){for(var s=0,l=t.getInverse(),c=0;2>c;c++){1===c&&(s=i);for(var u=0,h=e.parentShape.validPositions;u<h.length;u++){var d=h[u],p=this.tryPositionForPolygonPosition(d,e,t,s,l);if((256!==d||0===c)&&p){var g=t.applyToRect(p),m={text:e.text,secondRowText:e.secondRowText,boundingBox:g,isVisible:!0,fill:e.insideFill,identity:null,selected:!1,hasBackground:!0,textAnchor:"middle",originalPixelOffset:s,isPlacedInsidePolygon:!0,absoluteBoundingBoxCenter:{x:p.left+p.width/2,y:p.top+p.height/2}};return m}}}for(var f=6;r>=f;){for(var y=0,v=e.parentShape.validPositions;y<v.length;y++){var d=v[y];if(256!==d){var b=e.parentShape.polygon,C=t.applyToPoint(b.absoluteCentroid()),S=this.tryPlaceLabelOutsidePolygon(o,d,e,f,C,n,l);if(S){var g=t.applyToRect(S),m={text:e.text,secondRowText:e.secondRowText,boundingBox:g,isVisible:!0,fill:e.insideFill,identity:null,selected:!1,hasBackground:!0,isPlacedInsidePolygon:!1,textAnchor:"middle",originalPixelOffset:f,originalPosition:d,originalAbsoluteCentroid:b.absoluteCentroid(),absoluteBoundingBoxCenter:{x:S.left+S.width/2,y:S.top+S.height/2}},x=this.calculateStemSource(t,l,b,g,d,C);return m.leaderLinePoints=this.setLeaderLinePoints(x,this.calculateStemDestination(g,d)),m.absoluteStemSource=l.applyToPoint(x),o.add(g),m}}}f+=a}return null},n.prototype.setLeaderLinePoints=function(e,t){return[[e.x,e.y],[t.x,t.y]]},n.prototype.calculateStemSource=function(t,i,a,r,n,s){var l=a.lineIntersectionPoint(a.absoluteCentroid(),i.applyToPoint({x:r.left+r.width/2,y:r.top+r.height/2}));if(null==l)return s;var c=t.applyToPoint(l);switch(n){case 1:c.y+=o;break;case 2:c.y-=o;break;case 4:c.x+=o;break;case 8:c.x-=o;break;case 128:c.x+=o/e.DataLabelPointPositioner.cos45,c.y+=o/e.DataLabelPointPositioner.sin45;break;case 64:c.x-=o/e.DataLabelPointPositioner.cos45,c.y+=o/e.DataLabelPointPositioner.sin45;break;case 32:c.x+=o/e.DataLabelPointPositioner.cos45,c.y-=o/e.DataLabelPointPositioner.sin45;break;case 16:c.x-=o/e.DataLabelPointPositioner.cos45,c.y-=o/e.DataLabelPointPositioner.sin45;break;case 256:}return c},n.prototype.calculateStemDestination=function(e,t){var i,a;switch(t){case 1:i=e.left+e.width/2,a=e.top+e.height;break;case 2:i=e.left+e.width/2,a=e.top;break;case 4:i=e.left+e.width,a=e.top+e.height/2;break;case 8:i=e.left,a=e.top+e.height/2;break;case 128:i=e.left+e.width,a=e.top+e.height;break;case 64:i=e.left,a=e.top+e.height;break;case 32:i=e.left+e.width,a=e.top;break;case 16:i=e.left,a=e.top;break;case 256:}return{x:i,y:a}},n.prototype.tryPositionForPolygonPosition=function(e,t,i,a,r){var o=t.parentShape.polygon,n=i.applyToPoint(o.absoluteCentroid()),s=this.getLabelPolygon(t,e,n,a),l=this.getAbsoluteRectangle(r,s);return o.contains(l)?l:null},n.prototype.tryPlaceLabelOutsidePolygon=function(e,t,i,a,r,o,n){var s=a,l=this.getLabelPolygon(i,t,r,s),c=e.hasConflict(l);if(!c){var u=this.getAbsoluteRectangle(n,l);if(!o.hasConflict(u,l))return u}return null},n.prototype.updateLabelOffsets=function(e){for(var t=0,i=this.labels;t<i.length;t++){var a=i[t];if(a.isVisible)if(a.isPlacedInsidePolygon){var r=e.applyToPoint(a.absoluteBoundingBoxCenter),o=a.boundingBox.left+a.boundingBox.width/2-r.x,n=a.boundingBox.top+a.boundingBox.height/2-r.y;a.boundingBox.top-=n,a.boundingBox.left-=o}else{var s=e.applyToPoint(a.absoluteStemSource),l=e.applyToPoint(a.originalAbsoluteCentroid);a.boundingBox=this.getLabelBoundingBox({width:a.boundingBox.width,height:a.boundingBox.height},a.originalPosition,l,a.originalPixelOffset),void 0!==a.leaderLinePoints&&(a.leaderLinePoints=this.setLeaderLinePoints(s,this.calculateStemDestination(a.boundingBox,a.originalPosition)))}}},n.prototype.getAbsoluteRectangle=function(e,t){return e.applyToRect(t)},n}();e.FilledMapLabelLayout=n;var s=function(){function e(t,i){this.viewport=i;for(var a=0,r=0,o=0,n=t;o<n.length;o++){var s=n[o],l=s.pixelBoundingRect;l.width>a&&(a=l.width),l.height>r&&(r=l.height)}0===a&&(a=i.width),0===r&&(r=i.height);var c=this.cellSize={width:a*e.cellSizeMultiplier,height:r*e.cellSizeMultiplier};this.columnCount=e.getCellCount(c.width,i.width,1,100),this.rowCount=e.getCellCount(c.height,i.height,1,100);for(var u=[],h=0,d=this.columnCount;d>h;h++){u[h]=[];for(var p=0,g=this.rowCount;g>p;p++)u[h][p]=[]}this.grid=u;for(var m=0,f=t;m<f.length;m++){var s=f[m];this.add(s)}}return e.prototype.hasConflict=function(e,t){for(var i=this.getContainingGridSubsection(t),a=this.grid,r=i.xMin;r<i.xMax;r++)for(var o=i.yMin;o<i.yMax;o++)for(var n=0,s=a[r][o];n<s.length;n++){var l=s[n];if(l.conflicts(e))return!0}return!1},e.prototype.add=function(e){for(var t=this.getContainingGridSubsection(e.pixelBoundingRect),i=t.xMin;i<t.xMax;i++)for(var a=t.yMin;a<t.yMax;a++)this.grid[i][a].push(e)},e.prototype.getContainingGridSubsection=function(t){return{xMin:e.bound(Math.floor(t.left/this.cellSize.width),0,this.columnCount),xMax:e.bound(Math.ceil((t.left+t.width)/this.cellSize.width),0,this.columnCount),yMin:e.bound(Math.floor(t.top/this.cellSize.height),0,this.rowCount),yMax:e.bound(Math.ceil((t.top+t.height)/this.cellSize.height),0,this.rowCount)}},e.getCellCount=function(t,i,a,r){return e.bound(Math.ceil(i/t),a,r)},e.bound=function(e,t,i){return Math.max(Math.min(e,i),t)},e.cellSizeMultiplier=2,e}();e.LabelPolygonArrangeGrid=s}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(){return new i}e.createColorAllocatorFactory=t;var i=function(){function e(){}return e.prototype.linearGradient2=function(e){return new a(e)},e.prototype.linearGradient3=function(e,t){return t?new o(e):new r(e)},e}(),a=function(){function e(e){this.options=e;var t=e.min,i=e.max;this.scale=d3.scale.linear().domain([t.value,i.value]).range([t.color,i.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.max;return t.value===i.value?e>=i.value?i.color:t.color:this.scale(e)},e}(),r=function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale=d3.scale.linear().domain([t.value,i.value,a.value]).range([t.color,i.color,a.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.mid,a=this.options.max;return a.value===i.value||i.value===t.value||a.value===i.value&&a.value===t.value?e>=a.value?a.color:e>=i.value?i.color:t.color:this.scale(e)},e}(),o=function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale1=d3.scale.linear().domain([t.value,i.value]).range([t.color,i.color]).clamp(!0),this.scale2=d3.scale.linear().domain([i.value,a.value]).range([i.color,a.color]).clamp(!0)}return e.prototype.color=function(e){var t=this.options.min,i=this.options.mid,a=this.options.max;return a.value===i.value||i.value===t.value||a.value===i.value&&a.value===t.value?e>=a.value?a.color:e>=i.value?i.color:t.color:e<=i.value?this.scale1(e):this.scale2(e)},e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},a={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",Restatement_Comma:"{0}, {1}",Restatement_CompoundAnd:"{0} and {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",RichTextbox_Link_DefaultText:"Link",TableTotalLabel:"Total",ListJoin_Separator:", ",Tooltip_HighlightedValueDisplayName:"Highlighted",Funnel_PercentOfFirst:"Percent of first",Funnel_PercentOfPrevious:"Percent of previous",Funnel_PercentOfFirst_Highlight:"Percent of first (highlighted)",Funnel_PercentOfPrevious_Highlight:"Percent of previous (highlighted)",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",Waterfall_IncreaseLabel:"Increase",Waterfall_DecreaseLabel:"Decrease",Waterfall_TotalLabel:"Total",Slicer_SelectAll:"Select All"},r=function(){function r(){}return r.initialize=function(){t.valueFormatter.setLocaleOptions(r.createLocaleOptions()),t.TooltipManager.setLocalizedStrings(r.createTooltipLocaleOptions())},r.createLocaleOptions=function(){return{"null":a.NullValue,"true":a.BooleanTrue,"false":a.BooleanFalse,NaN:a.NaNValue,infinity:a.InfinityValue,negativeInfinity:a.NegativeInfinityValue,beautify:function(e){return r.beautify(e)},describe:function(e){return r.describeUnit(e)},restatementComma:a.Restatement_Comma,restatementCompoundAnd:a.Restatement_CompoundAnd,restatementCompoundOr:a.Restatement_CompoundOr}},r.createTooltipLocaleOptions=function(){return{highlightedValueDisplayName:a.Tooltip_HighlightedValueDisplayName}},r.prototype.getLocalizedString=function(e){return a[e]},r.prototype.onDragStart=function(){},r.prototype.canSelect=function(){return!1},r.prototype.onSelect=function(){},r.prototype.onContextMenu=function(){},r.prototype.loadMoreData=function(){},r.prototype.persistProperties=function(e){},r.prototype.onCustomSort=function(e){},r.prototype.getViewMode=function(){return 0},r.prototype.setWarnings=function(e){},r.prototype.setToolbar=function(e){},r.prototype.shouldRetainSelection=function(){return!1},r.prototype.geocoder=function(){return t.services.createGeocoder()},r.prototype.geolocation=function(){return t.services.createGeolocation()},r.prototype.promiseFactory=function(){return e.createJQueryPromiseFactory()},r.prototype.visualCapabilitiesChanged=function(){},r.prototype.analyzeFilter=function(e){return{isNotFilter:!1,selectedIdentities:[],filter:void 0,defaultValue:void 0}},r.prototype.getIdentityDisplayNames=function(e){},r.prototype.setIdentityDisplayNames=function(e){},r.beautify=function(e){var t=i[e];return t?a[t]||e:e},r.describeUnit=function(e){var t=-1===e?"Auto":e.toString(),i=a["DisplayUnitSystem_E"+t+"_Title"],r=0>=e?"{0}":a["DisplayUnitSystem_E"+t+"_LabelFormat"];return i||r?{title:i,format:r}:void 0},r}();t.DefaultVisualHostServices=r,t.defaultVisualHostServices=new r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return new s(e)}function a(e){return e.append("rect").classed("clearCatcher",!0).attr({width:"100%",height:"100%"})}function r(t,i,a){return null!=i.objects&&i.objects[a]&&e.DataViewObjects.getValue(i.objects[a],t)}function o(e){for(var t=0,i=e.length;i>t;t++)if(e[t].selected)return!0;return!1}var n=jsCommon.ArrayExtensions;t.createInteractivityService=i,t.appendClearCatcher=a,t.isCategoryColumnSelected=r,t.dataHasSelection=o;var s=function(){
function t(e){this.renderSelectionInVisual=_.noop,this.renderSelectionInLegend=_.noop,this.renderSelectionInLabels=_.noop,this.selectedIds=[],this.isInvertedSelectionMode=!1,this.hostService=e}return t.prototype.bind=function(e,t,i,a){var r=this;a&&a.overrideSelectionFromData&&this.takeSelectionStateFromDataPoints(e),a?(a.isLegend?(this.selectableLegendDataPoints=e,this.renderSelectionInLegend=function(){return t.renderSelection(r.legendHasSelection())}):a.isLabels?(this.selectableLabelsDataPoints=e,this.renderSelectionInLabels=function(){return t.renderSelection(r.labelsHasSelection())}):(this.selectableDataPoints=e,this.renderSelectionInVisual=function(){return t.renderSelection(r.hasSelection())}),null!=a.hasSelectionOverride&&(this.hasSelectionOverride=a.hasSelectionOverride),a.slicerDefaultValueHandler&&(this.slicerDefaultValueHandler=a.slicerDefaultValueHandler)):(this.selectableDataPoints=e,this.renderSelectionInVisual=function(){return t.renderSelection(r.hasSelection())}),this.behavior=t,t.bindEvents(i,this),this.syncSelectionState()},t.prototype.clearSelection=function(){return this.slicerDefaultValueHandler&&this.slicerDefaultValueHandler.getDefaultValue()&&this.useDefaultValue?void(this.isInvertedSelectionMode=!1):(this.hasSelectionOverride=void 0,n.clear(this.selectedIds),this.isInvertedSelectionMode=!1,this.applyToAllSelectableDataPoints(function(e){return e.selected=!1}),void this.renderAll())},t.prototype.applySelectionStateToData=function(e){for(var i=0,a=e;i<a.length;i++){var r=a[i];r.selected=t.checkDatapointAgainstSelectedIds(r,this.selectedIds)}return this.hasSelection()},t.prototype.hasSelection=function(){return this.selectedIds.length>0},t.prototype.legendHasSelection=function(){return this.selectableLegendDataPoints?o(this.selectableLegendDataPoints):!1},t.prototype.labelsHasSelection=function(){return this.selectableLabelsDataPoints?o(this.selectableLabelsDataPoints):!1},t.prototype.isSelectionModeInverted=function(){return this.isInvertedSelectionMode},t.prototype.setSelectionModeInverted=function(e){this.isInvertedSelectionMode=e},t.prototype.handleSelection=function(e,t){e&&(this.useDefaultValue=!1,this.select(e,t),this.sendSelectionToHost(),this.renderAll())},t.prototype.handleContextMenu=function(e,t){this.sendContextMenuToHost(e,t)},t.prototype.handleClearSelection=function(){this.useDefaultValue=!0,this.clearSelection(),this.sendSelectionToHost()},t.prototype.toggleSelectionModeInversion=function(){return this.useDefaultValue=!1,this.isInvertedSelectionMode=!this.isInvertedSelectionMode,n.clear(this.selectedIds),this.applyToAllSelectableDataPoints(function(e){return e.selected=!1}),this.sendSelectionToHost(),this.isInvertedSelectionMode?this.syncSelectionStateInverted():this.syncSelectionState(),this.renderAll(),this.isInvertedSelectionMode},t.prototype.persistSelectionFilter=function(e){this.hostService.persistProperties(this.createChangeForFilterProperty(e))},t.prototype.setDefaultValueMode=function(e){this.useDefaultValue=e},t.prototype.isDefaultValueEnabled=function(){return this.useDefaultValue},t.prototype.renderAll=function(){this.renderSelectionInVisual(),this.renderSelectionInLegend(),this.renderSelectionInLabels()},t.prototype.select=function(e,t){if(this.isInvertedSelectionMode)return this.selectInverted(e,t);e.identity.highlight&&(e=_.find(this.selectableDataPoints,function(t){return!t.identity.highlight&&e.identity.includes(t.identity,!0)}));var i=e.identity;if(i){var a=!e.selected||!t&&this.selectedIds.length>1;t&&(a?(e.selected=!0,this.selectedIds.push(i),i.hasIdentity()?this.removeSelectionIdsWithOnlyMeasures():this.removeSelectionIdsExceptOnlyMeasures()):(e.selected=!1,this.removeId(i))),t&&this.hostService.canSelect({data:this.selectedIds.map(function(e){return e.getSelector()})})||(this.clearSelection(),a&&(e.selected=!0,this.selectedIds.push(i))),this.syncSelectionState()}},t.prototype.selectInverted=function(e,t){var i=e.selected,a=e.identity;e.selected=!i,i?this.removeId(a):(this.selectedIds.push(a),a.hasIdentity()?this.removeSelectionIdsWithOnlyMeasures():this.removeSelectionIdsExceptOnlyMeasures()),this.syncSelectionStateInverted()},t.prototype.removeId=function(e){for(var t=this.selectedIds,i=t.length-1;i>-1;i--){var a=t[i];e.includes(a)&&t.splice(i,1)}},t.prototype.createChangeForFilterProperty=function(t){var i={},a=[];this.selectedIds.length>0&&(a=_.chain(this.selectedIds).filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()}).value());var r={objectName:t.objectName,selector:void 0,properties:i},o=e.data.Selector.filterFromSelector(a,this.isInvertedSelectionMode);return this.slicerDefaultValueHandler&&this.slicerDefaultValueHandler.getDefaultValue()&&(this.useDefaultValue===!0?o=e.data.SemanticFilter.getDefaultValueFilter(this.slicerDefaultValueHandler.getIdentityFields()):_.isEmpty(a)&&(o=e.data.SemanticFilter.getAnyValueFilter(this.slicerDefaultValueHandler.getIdentityFields()))),null==o?(i[t.propertyName]={},{remove:[r]}):(i[t.propertyName]=o,{merge:[r]})},t.prototype.sendContextMenuToHost=function(e,t){var i=this.hostService;if(i.onContextMenu){var a=this.getSelectorsByColumn([e.identity]);if(!_.isEmpty(a)){var r={data:a,position:t};i.onContextMenu(r)}}},t.prototype.sendSelectionToHost=function(){var e=this.hostService;if(e.onSelect){var t={data:this.selectedIds.filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()})},i=this.getSelectorsByColumn(this.selectedIds);_.isEmpty(i)||(t.data2=i),e.onSelect(t)}},t.prototype.getSelectorsByColumn=function(e){return _(e).filter(function(e){return e.hasIdentity}).map(function(e){return e.getSelectorsByColumn()}).compact().value()},t.prototype.takeSelectionStateFromDataPoints=function(e){var t=this.selectedIds;n.clear(t);for(var i=0,a=e;i<a.length;i++){var r=a[i];r.selected&&t.push(r.identity)}},t.prototype.syncSelectionState=function(){if(this.isInvertedSelectionMode)return this.syncSelectionStateInverted();var e=this.selectedIds,i=this.selectableDataPoints,a=this.selectableLegendDataPoints,r=this.selectableLabelsDataPoints,o=!1;if(i||a){if(i&&t.updateSelectableDataPointsBySelectedIds(i,e)&&(o=!0),a&&t.updateSelectableDataPointsBySelectedIds(a,e)&&(o=!0),r)for(var n,s=0,l=r.length;l>s;s++)n=r[s],e.some(function(e){return e.includes(n.identity)})?n.selected=!0:n.selected=!1;!o&&e.length>0&&(this.clearSelection(),this.sendSelectionToHost())}},t.prototype.syncSelectionStateInverted=function(){var e=this.selectedIds,t=this.selectableDataPoints;if(t)if(0===e.length)for(var i=0,a=t;i<a.length;i++){var r=a[i];r.selected=!1}else for(var o=0,n=t;o<n.length;o++){var s=n[o];e.some(function(e){return e.includes(s.identity)})?s.selected=!0:s.selected&&(s.selected=!1)}},t.prototype.applyToAllSelectableDataPoints=function(e){var t=this.selectableDataPoints,i=this.selectableLegendDataPoints,a=this.selectableLabelsDataPoints;if(t)for(var r=0,o=t;r<o.length;r++){var n=o[r];e(n)}if(i)for(var s=0,l=i;s<l.length;s++){var n=l[s];e(n)}if(a)for(var c=0,u=a;c<u.length;c++){var n=u[c];e(n)}},t.updateSelectableDataPointsBySelectedIds=function(e,i){for(var a=!1,r=0,o=e;r<o.length;r++){var n=o[r];n.selected=t.checkDatapointAgainstSelectedIds(n,i),n.selected&&(a=!0)}return a},t.checkDatapointAgainstSelectedIds=function(e,t){return t.some(function(t){return t.includes(e.identity)})},t.prototype.removeSelectionIdsWithOnlyMeasures=function(){this.selectedIds=_.filter(this.selectedIds,function(e){return e.hasIdentity()})},t.prototype.removeSelectionIdsExceptOnlyMeasures=function(){this.selectedIds=_.filter(this.selectedIds,function(e){return!e.hasIdentity()})},t}();t.InteractivityService=s}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(){return{geocode:l,geocodeBoundary:c,geocodePoint:u,tryGeocodeImmediate:o,tryGeocodeBoundaryImmediate:n}}function a(e){return t.CategoryTypeArray.indexOf(e)>-1}function r(e){switch(e.toLowerCase()){case"fr":return"fr-FR";default:return e}}function o(e,t){var i=x?x.getCoordinates(new w(e,t).key):void 0;return i}function n(e,t,i,a,r){void 0===r&&(r=3);var o=x?x.getCoordinates(new D(e,t,i,a,r).key):void 0;return o}function s(e,t){var i=x?x.getCoordinates(e.key):void 0,a=$.Deferred();if(i)a.resolve(i);else{var r={query:e,deferred:a,isResolved:!1};t&&t.timeout&&t.timeout["finally"](function(){r.isResolved||(r.deferred.reject(),r.isResolved=!0)}),v.push(r),h()}return a}function l(e,t,i){return void 0===t&&(t=""),s(new w(e,t),i)}function c(e,t,i,a,r,o){return void 0===i&&(i=""),void 0===a&&(a=2),void 0===r&&(r=3),s(new D(e,t,i,a,r),o)}function u(e,t,i){return s(new P(e,t),i)}function h(e){for(void 0===e&&(e=0),b-=e;b<y.MaxBingRequest&&0!==v.length;)b++,d(v.shift())}function d(e){if(!e.isResolved){var i=x?x.getCoordinates(e.query.key):void 0;i&&(e.deferred.resolve(i),e.isResolved=!0)}if(e.isResolved)return void setTimeout(function(){return h(1)});var a={type:"GET",dataType:"jsonp",jsonp:"jsonp"},r=e.query.getUrl();r||p(e,new Error("Unsupported query. "+e.query.query)),t.BingAjaxCall(r,a).then(function(t){try{if(e.query instanceof D){var i=t;if(i&&i.d&&Array.isArray(i.d.results)&&i.d.results.length>0){var a=i.d.results[0],r=a.Primitives;if(r&&r.length>0){var o={latitude:e.query.latitude,longitude:e.query.longitude,locations:[]};r.sort(function(e,t){return e.Shape.length<t.Shape.length?1:e.Shape.length>t.Shape.length?-1:0});for(var n=Math.min(r.length,e.query.maxGeoData),s=0;n>s;s++)for(var l=r[s].Shape,c=l.split(","),u=1;u<c.length;u++)o.locations.push({nativeBing:c[u]});p(e,null,o)}else p(e,new Error("Geocode result is empty."))}else p(e,new Error("Geocode result is empty."))}else if(e.query instanceof P){var h=t.resourceSets[0].resources;if(Array.isArray(h)&&h.length>0){var d=g(h,e.query),m=h[d].point.coordinates,f=h[d].address,o={latitude:parseFloat(m[0]),longitude:parseFloat(m[1]),addressLine:f.addressLine,locality:f.locality,neighborhood:f.neighborhood,adminDistrict:f.adminDistrict,adminDistrict2:f.adminDistrict2,formattedAddress:f.formattedAddress,postalCode:f.postalCode,countryRegionIso2:f.countryRegionIso2,countryRegion:f.countryRegion,landmark:f.landmark};p(e,null,o)}else p(e,new Error("Geocode result is empty."))}else{var h=t.resourceSets[0].resources;if(Array.isArray(h)&&h.length>0){var d=g(h,e.query),m=h[d].point.coordinates,o={latitude:parseFloat(m[0]),longitude:parseFloat(m[1])};p(e,null,o)}else p(e,new Error("Geocode result is empty."))}}catch(y){p(e,y)}},function(t){p(e,t)})}function p(e,t,i){void 0===i&&(i=null),e.isResolved||(t?e.deferred.reject(t):(!x||e.query instanceof P||x.registerCoordinates(e.query.key,i),e.deferred.resolve(i)),e.isResolved=!0),L=setTimeout(function(){return h(1)},y.UseDoubleArrayGeodataResult?y.UseDoubleArrayDequeueTimeout:0)}function g(e,t){var i=t.query.toLowerCase();if(2===i.length&&t.category===f.CountryRegion)for(var a=0;a<e.length;a++){var r=e[a].address&&e[a].address.countryRegionIso2;if(r&&i===r.toLowerCase())return a}for(var o=t.getBingEntity().toLowerCase(),a=0;a<e.length;a++){var n=(e[a].entityType||"").toLowerCase();if(n===o)return a}return 0}function m(e){void 0!==e&&(x=e),v=[],b=0,C=null,clearTimeout(L)}var f=e.MapUtil.CategoryTypes,y=e.MapUtil.Settings;t.createGeocoder=i,t.safeCharacters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-",t.BingAjaxCall=$.ajax,t.CategoryTypeArray=["Address","City","Continent","Country","County","Longitude","Latitude","Place","PostalCode","StateOrProvince"],t.isCategoryType=a,t.BingEntities={Continent:"Continent",Sovereign:"Sovereign",CountryRegion:"CountryRegion",AdminDivision1:"AdminDivision1",AdminDivision2:"AdminDivision2",PopulatedPlace:"PopulatedPlace",Postcode:"Postcode",Postcode1:"Postcode1",Neighborhood:"Neighborhood",Address:"Address"};var v,b,C,S,x,w=function(){function e(e,i){this.query=null!=e?e:"",this.category=null!=i?i:"",this.key=(this.query+"/"+this.category).toLowerCase(),x||(x=t.createGeocodingCache(y.MaxCacheSize,y.MaxCacheSizeOverflow))}return e.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return C||(C={},C[f.Continent.toLowerCase()]=t.BingEntities.Continent,C[f.CountryRegion.toLowerCase()]=t.BingEntities.Sovereign,C[f.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,C[f.County.toLowerCase()]=t.BingEntities.AdminDivision2,C[f.City.toLowerCase()]=t.BingEntities.PopulatedPlace,C[f.PostalCode.toLowerCase()]=t.BingEntities.Postcode,C[f.Address.toLowerCase()]=t.BingEntities.Address),C[e]||""},e.prototype.getUrl=function(){var e=y.BingUrl+"?key="+y.BingKey,i=this.getBingEntity(),a=!1;if(i)if(i===t.BingEntities.Postcode)e+="&includeEntityTypes=Postcode,Postcode1,Postcode2,Postcode3,Postcode4";else if(-1!==this.query.indexOf(",")||i!==t.BingEntities.AdminDivision1&&i!==t.BingEntities.AdminDivision2)e+="&includeEntityTypes="+i;else{a=!0;try{e+="&adminDistrict="+decodeURIComponent(this.query)}catch(o){return null}}if(!a)try{e+="&q="+decodeURIComponent(this.query)}catch(o){return null}var n=navigator.userLanguage||navigator.language;return n=r(n),n&&(e+="&c="+n),e+="&maxRes=20",2===this.query.length&&this.category===f.CountryRegion&&(e+="&include=ciso2"),e},e}();t.GeocodeQuery=w;var P=function(e){function i(t,i){e.call(this,[t,i].join(),"Point"),this.latitude=t,this.longitude=i}return __extends(i,e),i.prototype.getUrl=function(){var e=y.BingUrl+"/"+[this.latitude,this.longitude].join()+"?key="+y.BingKey+"&includeEntityTypes="+[t.BingEntities.Address,t.BingEntities.Neighborhood,t.BingEntities.PopulatedPlace,t.BingEntities.Postcode1,t.BingEntities.AdminDivision1,t.BingEntities.AdminDivision2,t.BingEntities.CountryRegion].join()+"&include=ciso2";return e},i}(w);t.GeocodePointQuery=P;var D=function(e){function i(t,i,a,r,o){void 0===o&&(o=3),e.call(this,[t,i,r,o].join(","),a),this.latitude=t,this.longitude=i,this.levelOfDetail=r,this.maxGeoData=o}return __extends(i,e),i.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return S||(S={},S[f.CountryRegion.toLowerCase()]=t.BingEntities.CountryRegion,S[f.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,S[f.County.toLowerCase()]=t.BingEntities.AdminDivision2,S[f.City.toLowerCase()]=t.BingEntities.PopulatedPlace,S[f.PostalCode.toLowerCase()]=t.BingEntities.Postcode1),S[e]||""},i.prototype.getUrl=function(){var e=y.BingUrlGeodata+"key="+y.BingKey+"&$format=json",t=this.getBingEntity();if(!t)return null;var i=navigator.userLanguage||navigator.language;i=r(i);var a=i.split("-"),o=[this.latitude,this.longitude,this.levelOfDetail,"'"+t+"'",1,0,"'"+i+"'"];return a.length>1&&o.push("'"+a[1]+"'"),e+"&SpatialFilter=GetBoundary("+o.join(", ")+")"},i}(w);t.GeocodeBoundaryQuery=D,t.geocodeCore=s,t.geocode=l,t.geocodeBoundary=c,t.geocodePoint=u;var L;t.resetStaticGeocoderState=m,m()}(t=e.services||(e.services={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){function i(t,i,r){return r||(r=e.localStorageService),new a(t,i,r)}t.createGeocodingCache=i;var a=function(){function e(e,t,i){this.geocodeCache={},this.geocodeCacheCount=0,this.maxCacheSize=e,this.maxCacheSizeOverflow=t,this.localStorageService=i}return e.prototype.getCoordinates=function(e){var t=this.geocodeCache[e];return t?(++t.hitCount,t.coordinate):(t=this.localStorageService.getData(e),t?(this.registerInMemory(e,t.coordinate),t.coordinate):void 0)},e.prototype.registerCoordinates=function(e,t){this.registerInMemory(e,t),this.registerInStorage(e,t)},e.prototype.registerInMemory=function(e,t){var i=this.geocodeCache,a=this.maxCacheSize,r=a+this.maxCacheSizeOverflow;if(this.geocodeCacheCount>=r){var o=Object.keys(i),n=o.length;if(o.sort(function(e,t){var a=i[e],r=i[t],o=a?a.hitCount:0,n=r?r.hitCount:0;return n>o?1:o>n?-1:0}),2*r>n)for(var s=a;n>s;s++)i[o[s]]=void 0;else{for(var l={},s=0;a>s;++s)l[o[s]]=i[o[s]];i=this.geocodeCache=l}this.geocodeCacheCount=a}i[e]={key:e,coordinate:t,hitCount:1},++this.geocodeCacheCount},e.prototype.registerInStorage=function(e,t){this.localStorageService.setData(e,{coordinate:t})},e}()}(i=t.services||(t.services={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){return new i}e.createGeolocation=t;var i=function(){function e(){this.webGeolocation=navigator.geolocation}return e.prototype.watchPosition=function(e,t){return this.webGeolocation.watchPosition(function(t){e(t)},function(e){null!=t&&t(e)})},e.prototype.clearWatch=function(e){this.webGeolocation.clearWatch(e)},e.prototype.getCurrentPosition=function(e,t){this.webGeolocation.getCurrentPosition(function(t){e(t)},function(e){null!=t&&t(e)})},e}()}(t=e.services||(e.services={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i,a=["play","subview","smallMultiple"];!function(i){function r(t,i,a,r){var o=e.Prototype.inherit(i);o.create=a,r&&r(o),t[i.name]=o}function o(i,a,o){var n=a.tooltipsEnabled,l=o&&o.lineChartLabelDensityEnabled,c=o&&o.tooltipBucketEnabled,u=o?o.conditionalFormattingEnabled:!1,h=o&&o.cartesianLoadMoreEnabled;r(i,s(e.visuals.plugins.barChart,c),function(){return new t.CartesianChart({chartType:6,tooltipsEnabled:n,tooltipBucketEnabled:c,animator:new t.WebColumnChartAnimator,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.clusteredBarChart,c),function(){return new t.CartesianChart({chartType:5,tooltipsEnabled:n,tooltipBucketEnabled:c,animator:new t.WebColumnChartAnimator,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.clusteredColumnChart,c),function(){return new t.CartesianChart({chartType:3,tooltipsEnabled:n,tooltipBucketEnabled:c,animator:new t.WebColumnChartAnimator,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.columnChart,c),function(){return new t.CartesianChart({chartType:4,tooltipsEnabled:n,tooltipBucketEnabled:c,animator:new t.WebColumnChartAnimator,cartesianLoadMoreEnabled:h})}),r(i,e.visuals.plugins.dataDotClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:15,tooltipsEnabled:n})}),r(i,e.visuals.plugins.dataDotStackedColumnComboChart,function(){return new t.CartesianChart({chartType:16,tooltipsEnabled:n})}),r(i,s(e.visuals.plugins.donutChart,c),function(){return new t.DonutChart({tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,s(e.visuals.plugins.funnel,c),function(){return new t.FunnelChart({tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,e.visuals.plugins.gauge,function(){return new t.Gauge({tooltipsEnabled:n})}),r(i,s(e.visuals.plugins.hundredPercentStackedBarChart,c),function(){return new t.CartesianChart({chartType:7,tooltipsEnabled:n,tooltipBucketEnabled:c,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.hundredPercentStackedColumnChart,c),function(){return new t.CartesianChart({chartType:8,tooltipsEnabled:n,tooltipBucketEnabled:c,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.lineChart,c),function(){return new t.CartesianChart({chartType:0,tooltipsEnabled:n,tooltipBucketEnabled:n&&c,lineChartLabelDensityEnabled:l,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.areaChart,c),function(){return new t.CartesianChart({chartType:1,tooltipsEnabled:n,tooltipBucketEnabled:n&&c,lineChartLabelDensityEnabled:l})}),r(i,s(e.visuals.plugins.stackedAreaChart,c),function(){return new t.CartesianChart({chartType:2,tooltipsEnabled:n,tooltipBucketEnabled:n&&c,lineChartLabelDensityEnabled:l})}),r(i,s(e.visuals.plugins.lineClusteredColumnComboChart,c,!0),function(){return new t.CartesianChart({chartType:13,tooltipsEnabled:n,tooltipBucketEnabled:c,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.lineStackedColumnComboChart,c,!0),function(){return new t.CartesianChart({chartType:14,tooltipsEnabled:n,tooltipBucketEnabled:c,cartesianLoadMoreEnabled:h})}),r(i,s(e.visuals.plugins.pieChart,c),function(){return new t.DonutChart({sliceWidthRatio:0,tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,s(e.visuals.plugins.scatterChart,c),function(){return new t.CartesianChart({chartType:9,tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,s(e.visuals.plugins.treemap,c),function(){return new t.Treemap({isScrollable:!1,tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,s(e.visuals.plugins.waterfallChart,c),function(){return new t.CartesianChart({chartType:12,tooltipsEnabled:n,tooltipBucketEnabled:c})}),r(i,s(e.visuals.plugins.map,c),function(){return new t.Map({tooltipsEnabled:n,tooltipBucketEnabled:c,disableZooming:!0,disablePanning:!0})}),r(i,s(e.visuals.plugins.filledMap,c),function(){return new t.Map({filledMap:!0,tooltipsEnabled:n,tooltipBucketEnabled:c,disableZooming:!0,disablePanning:!0})}),r(i,e.visuals.plugins.matrix,function(){return new t.Matrix({})}),r(i,e.visuals.plugins.table,function(){return new t.Table({isConditionalFormattingEnabled:u})})}function n(i,a){var o=a?a.scriptVisualEnabled:!1,n=a?a.scriptVisualAuthoringEnabled:!1,l=a?a.isLabelInteractivityEnabled:!1,c=a?a.conditionalFormattingEnabled:!1,u=a?a.filledMapDataLabelsEnabled:!1,h=a?a.lineChartLabelDensityEnabled:!1,d=a?a.tooltipBucketEnabled:!1,p=a&&a.cartesianLoadMoreEnabled;r(i,s(e.visuals.plugins.barChart,d),function(){return new t.CartesianChart({chartType:6,isScrollable:!0,animator:new t.WebColumnChartAnimator,tooltipsEnabled:!0,tooltipBucketEnabled:d,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,e.visuals.plugins.card,function(){return new t.Card({isScrollable:!0,animator:new t.BaseAnimator})}),r(i,s(e.visuals.plugins.clusteredBarChart,d),function(){return new t.CartesianChart({chartType:5,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.clusteredColumnChart,d),function(){return new t.CartesianChart({chartType:3,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.columnChart,d),function(){return new t.CartesianChart({chartType:4,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,e.visuals.plugins.dataDotClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:15,isScrollable:!0,tooltipsEnabled:!0,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior,new t.DataDotChartWebBehavior]),isLabelInteractivityEnabled:l})}),r(i,e.visuals.plugins.dataDotStackedColumnComboChart,function(){return new t.CartesianChart({chartType:16,isScrollable:!0,tooltipsEnabled:!0,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior,new t.DataDotChartWebBehavior]),isLabelInteractivityEnabled:l})}),r(i,s(e.visuals.plugins.donutChart,d),function(){return new t.DonutChart({animator:new t.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,behavior:new t.DonutChartWebBehavior})}),r(i,s(e.visuals.plugins.funnel,d),function(){return new t.FunnelChart({animator:new t.WebFunnelAnimator,behavior:new t.FunnelWebBehavior,tooltipsEnabled:!0,tooltipBucketEnabled:d})}),r(i,e.visuals.plugins.gauge,function(){return new t.Gauge({animator:new t.BaseAnimator,tooltipsEnabled:!0})}),r(i,s(e.visuals.plugins.hundredPercentStackedBarChart,d),function(){return new t.CartesianChart({chartType:7,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.hundredPercentStackedColumnChart,d),function(){return new t.CartesianChart({chartType:8,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.lineChart,d),function(){return new t.CartesianChart({chartType:0,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.BaseAnimator,behavior:new t.CartesianChartBehavior([new t.LineChartWebBehavior]),isLabelInteractivityEnabled:l,lineChartLabelDensityEnabled:h,cartesianLoadMoreEnabled:p})}),r(i,e.visuals.plugins.areaChart,function(){return new t.CartesianChart({chartType:1,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.BaseAnimator,behavior:new t.CartesianChartBehavior([new t.LineChartWebBehavior]),isLabelInteractivityEnabled:l,lineChartLabelDensityEnabled:h})}),r(i,e.visuals.plugins.stackedAreaChart,function(){return new t.CartesianChart({chartType:2,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.BaseAnimator,behavior:new t.CartesianChartBehavior([new t.LineChartWebBehavior]),lineChartLabelDensityEnabled:h})}),r(i,s(e.visuals.plugins.lineClusteredColumnComboChart,d,!0),function(){return new t.CartesianChart({chartType:13,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior,new t.LineChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.lineStackedColumnComboChart,d,!0),function(){return new t.CartesianChart({chartType:14,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.WebColumnChartAnimator,behavior:new t.CartesianChartBehavior([new t.ColumnChartWebBehavior,new t.LineChartWebBehavior]),isLabelInteractivityEnabled:l,cartesianLoadMoreEnabled:p})}),r(i,s(e.visuals.plugins.pieChart,d),function(){return new t.DonutChart({sliceWidthRatio:0,animator:new t.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,behavior:new t.DonutChartWebBehavior})}),r(i,s(e.visuals.plugins.scatterChart,d),function(){return new t.CartesianChart({chartType:9,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,animator:new t.BaseAnimator,behavior:new t.CartesianChartBehavior([new t.ScatterChartWebBehavior]),isLabelInteractivityEnabled:l})}),r(i,s(e.visuals.plugins.treemap,d),function(){return new t.Treemap({animator:new t.WebTreemapAnimator,isScrollable:!0,behavior:new t.TreemapWebBehavior,tooltipsEnabled:!0,tooltipBucketEnabled:d})}),r(i,s(e.visuals.plugins.waterfallChart,d),function(){return new t.CartesianChart({chartType:12,isScrollable:!0,tooltipsEnabled:!0,tooltipBucketEnabled:d,behavior:new t.CartesianChartBehavior([new t.WaterfallChartWebBehavior]),isLabelInteractivityEnabled:l})}),r(i,s(e.visuals.plugins.map,d),function(){return new t.Map({behavior:new t.MapBehavior,tooltipsEnabled:!0,tooltipBucketEnabled:d,isLegendScrollable:!0})}),r(i,s(e.visuals.plugins.filledMap,d),function(){return new t.Map({filledMap:!0,behavior:new t.MapBehavior,tooltipsEnabled:!0,tooltipBucketEnabled:d,filledMapDataLabelsEnabled:u,isLegendScrollable:!0})}),r(i,e.visuals.plugins.slicer,function(){return new t.Slicer({behavior:new t.SlicerWebBehavior})}),r(i,e.visuals.plugins.matrix,function(){return new t.Matrix({})}),r(i,e.visuals.plugins.table,function(){return new t.Table({isConditionalFormattingEnabled:c})}),o&&n&&r(i,e.visuals.plugins.scriptVisual,function(){return new t.ScriptVisual({canRefresh:!0})})}function s(t,i,a){if(void 0===a&&(a=!1),!i)return t;var r=_.clone(t);r.capabilities=_.clone(t.capabilities),r.capabilities.dataRoles=_.clone(t.capabilities.dataRoles),r.capabilities.dataRoles.push({name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}),r.capabilities.dataViewMappings=_.clone(t.capabilities.dataViewMappings);for(var o=0;o<t.capabilities.dataViewMappings.length;o++){var n=t.capabilities.dataViewMappings[o].categorical,s=t.capabilities.dataViewMappings[o].matrix,l=n?n:s;if(l){var c=l.values;if(c){r.capabilities.dataViewMappings[o]=_.cloneDeep(t.capabilities.dataViewMappings[o]),n&&(c=r.capabilities.dataViewMappings[o].categorical.values),s&&(c=r.capabilities.dataViewMappings[o].matrix.values);var u=c.group;u&&u.select.push({"for":{"in":"Tooltips"}});var h=c.select;h&&!a&&h.push({"for":{"in":"Tooltips"}})}}}return r}function l(){return new p(void 0)}function c(e){return new p(e)}function u(e,t){return new m(e,t)}function h(e){return new f(e)}function d(e,t){return new y(e,t)}var p=function(){function i(t){this.plugins=e.visuals.plugins,this.featureSwitches=t}return i.prototype.getVisuals=function(){var e=this.plugins,t=Object.keys(e);return t.map(function(t){return e[t]})},i.prototype.getPlugin=function(e){if(e){var t=this.plugins[e];if(t)return t}},i.prototype.capabilities=function(e){var t=this.getPlugin(e);return t?t.capabilities:void 0},i.prototype.requireSandbox=function(e){return e&&e.custom},i.prototype.removeAnyCustomVisuals=function(){var t=e.visuals.plugins;for(var i in t){var a=t[i];a.custom&&delete t[i]}},i.prototype.isCustomVisual=function(e){return e?this.plugins[e]?this.plugins[e].custom===!0:!_.include(a,e):!1},i.prototype.isScriptVisual=function(t){var i=this.capabilities(t);return!!(i&&i.dataViewMappings&&e.ScriptResultUtil.findScriptResult(i.dataViewMappings))},i.prototype.shouldDisableVisual=function(e,i){return(e===t.plugins.map.name||e===t.plugins.filledMap.name)&&i},i.prototype.isScriptVisualQueryable=function(){return void 0!==this.featureSwitches&&this.featureSwitches.scriptVisualEnabled},i.prototype.getInteractivityOptions=function(e){var t={overflow:"hidden"};return t},i}();i.VisualPluginService=p,i.createPlugin=r,i.enableTooltipBucket=s;var g=function(t){function i(){t.call(this,void 0),this.visualPlugins=e.visuals.plugins,n(this.visualPlugins,null)}return __extends(i,t),i.prototype.getVisuals=function(){var e=this.visualPlugins,t=Object.keys(e);return t.map(function(t){return e[t]})},i.prototype.getPlugin=function(e){if(e){var t=this.visualPlugins[e];if(t)return t}},i.prototype.capabilities=function(e){var t=this.getPlugin(e);return t?t.capabilities:void 0},i}(p);i.PlaygroundVisualPluginService=g;var m=function(e){function t(t,i){e.call(this,t),this.visualPlugins={},o(this.visualPlugins,i,this.featureSwitches)}return __extends(t,e),t.prototype.getPlugin=function(t){return this.visualPlugins[t]?this.visualPlugins[t]:e.prototype.getPlugin.call(this,t)},t.prototype.requireSandbox=function(e){return this.featureSwitches.sandboxVisualsEnabled&&(!e||e&&e.custom)},t}(p);i.DashboardPluginService=m;var f=function(i){function a(a){i.call(this,a),this.visualPlugins={},r(this.visualPlugins,e.visuals.plugins.clusteredBarChart,function(){return new t.CartesianChart({chartType:5,animator:new t.WebColumnChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.columnChart,function(){return new t.CartesianChart({chartType:4,animator:new t.WebColumnChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.donutChart,function(){return new t.DonutChart({animator:new t.WebDonutChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.hundredPercentStackedBarChart,function(){return new t.CartesianChart({chartType:7,animator:new t.WebColumnChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.hundredPercentStackedColumnChart,function(){return new t.CartesianChart({chartType:8,animator:new t.WebColumnChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.lineChart,function(){return new t.CartesianChart({chartType:0,animator:new t.BaseAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.areaChart,function(){return new t.CartesianChart({chartType:1,animator:new t.BaseAnimator,
tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.pieChart,function(){return new t.DonutChart({sliceWidthRatio:0,animator:new t.WebDonutChartAnimator,tooltipsEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.scatterChart,function(){return new t.CartesianChart({chartType:9,animator:new t.BaseAnimator,tooltipsEnabled:!0})},void 0)}return __extends(a,i),a.prototype.getPlugin=function(e){return this.visualPlugins[e]?this.visualPlugins[e]:i.prototype.getPlugin.call(this,e)},a.prototype.requireSandbox=function(e){return this.featureSwitches.sandboxVisualsEnabled&&(!e||e&&e.custom)},a}(p);i.InsightsPluginService=f;var y=function(i){function a(o,n){var s=this;i.call(this,n),this.smallViewPortProperties=o||{CartesianSmallViewPortProperties:{hideAxesOnSmallViewPort:!0,hideLegendOnSmallViewPort:!0,MinHeightLegendVisible:a.MinHeightLegendVisible,MinHeightAxesVisible:a.MinHeightAxesVisible},GaugeSmallViewPortProperties:{hideGaugeSideNumbersOnSmallViewPort:!0,smallGaugeMarginsOnSmallViewPort:!0,MinHeightGaugeSideNumbersVisible:a.MinHeightGaugeSideNumbersVisible,GaugeMarginsOnSmallViewPort:a.GaugeMarginsOnSmallViewPort},FunnelSmallViewPortProperties:{hideFunnelCategoryLabelsOnSmallViewPort:!0,minHeightFunnelCategoryLabelsVisible:a.MinHeightFunnelCategoryLabelsVisible},DonutSmallViewPortProperties:{maxHeightToScaleDonutLegend:a.MaxHeightToScaleDonutLegend}};var l=n?n.conditionalFormattingEnabled:!1;t.TooltipManager.ShowTooltips=!1;var c=!1,u=this.getMapThrottleInterval();this.visualPlugins={},r(this.visualPlugins,e.visuals.plugins.areaChart,function(){return new t.CartesianChart({chartType:1,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.barChart,function(){return new t.CartesianChart({chartType:6,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.clusteredBarChart,function(){return new t.CartesianChart({chartType:5,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.clusteredColumnChart,function(){return new t.CartesianChart({chartType:3,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.columnChart,function(){return new t.CartesianChart({chartType:4,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.comboChart,function(){return new t.CartesianChart({chartType:10,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.dataDotChart,function(){return new t.CartesianChart({chartType:11,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.dataDotClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:15,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.dataDotStackedColumnComboChart,function(){return new t.CartesianChart({chartType:16,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.hundredPercentStackedBarChart,function(){return new t.CartesianChart({chartType:7,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.hundredPercentStackedColumnChart,function(){return new t.CartesianChart({chartType:8,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.stackedAreaChart,function(){return new t.CartesianChart({chartType:2,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.waterfallChart,function(){return new t.CartesianChart({chartType:12,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.lineChart,function(){return new t.CartesianChart({chartType:0,cartesianSmallViewPortProperties:s.smallViewPortProperties.CartesianSmallViewPortProperties,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.lineClusteredColumnComboChart,function(){return new t.CartesianChart({chartType:13,cartesianSmallViewPortProperties:s.smallViewPortProperties.CartesianSmallViewPortProperties,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.lineStackedColumnComboChart,function(){return new t.CartesianChart({chartType:14,cartesianSmallViewPortProperties:s.smallViewPortProperties.CartesianSmallViewPortProperties,trimOrdinalDataOnOverflow:c})}),r(this.visualPlugins,e.visuals.plugins.scatterChart,function(){return new t.CartesianChart({chartType:9,cartesianSmallViewPortProperties:s.smallViewPortProperties.CartesianSmallViewPortProperties,behavior:new t.CartesianChartBehavior([new t.ScatterChartMobileBehavior])})}),r(this.visualPlugins,e.visuals.plugins.gauge,function(){return new t.Gauge({gaugeSmallViewPortProperties:s.smallViewPortProperties.GaugeSmallViewPortProperties})}),r(this.visualPlugins,e.visuals.plugins.funnel,function(){return new t.FunnelChart({animator:null,funnelSmallViewPortProperties:s.smallViewPortProperties.FunnelSmallViewPortProperties})}),r(this.visualPlugins,e.visuals.plugins.donutChart,function(){return new t.DonutChart({disableGeometricCulling:!0,smallViewPortProperties:s.smallViewPortProperties.DonutSmallViewPortProperties})}),r(this.visualPlugins,e.visuals.plugins.pieChart,function(){return new t.DonutChart({sliceWidthRatio:0,disableGeometricCulling:!0,smallViewPortProperties:s.smallViewPortProperties.DonutSmallViewPortProperties})}),r(this.visualPlugins,e.visuals.plugins.matrix,function(){return new t.Matrix({isTouchEnabled:!0})}),r(this.visualPlugins,e.visuals.plugins.table,function(){return new t.Table({isTouchEnabled:!0,isConditionalFormattingEnabled:l})}),r(this.visualPlugins,e.visuals.plugins.map,function(){return new t.Map({viewChangeThrottleInterval:u,enableCurrentLocation:n?n.mapCurrentLocationEnabled:!1})}),r(this.visualPlugins,e.visuals.plugins.filledMap,function(){return new t.Map({filledMap:!0,viewChangeThrottleInterval:u})})}return __extends(a,i),a.prototype.getPlugin=function(e){return this.visualPlugins[e]?this.visualPlugins[e]:i.prototype.getPlugin.call(this,e)},a.prototype.requireSandbox=function(e){return this.featureSwitches?this.featureSwitches.sandboxVisualsEnabled&&(!e||e&&e.custom):i.prototype.requireSandbox.call(this,e)},a.prototype.getMapThrottleInterval=function(){var e=100,t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("windows phone")?e:void 0},a.prototype.getInteractivityOptions=function(e){var t={overflow:this.getMobileOverflowString(e),isInteractiveLegend:this.isChartSupportInteractivity(e),selection:!0};return t},a.prototype.getMobileOverflowString=function(e){switch(e){case"multiRowCard":return"visible";default:return"hidden"}},a.prototype.isChartSupportInteractivity=function(e){switch(e){case"areaChart":case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"donutChart":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"lineChart":case"pieChart":case"scatterChart":case"table":case"matrix":case"multiRowCard":return!0;default:return!1}},a.MinHeightLegendVisible=125,a.MinHeightAxesVisible=125,a.MinHeightGaugeSideNumbersVisible=80,a.GaugeMarginsOnSmallViewPort=10,a.MinHeightFunnelCategoryLabelsVisible=80,a.MaxHeightToScaleDonutLegend=300,a}(p);i.MobileVisualPluginService=y,i.create=l,i.createVisualPluginService=c,i.createDashboard=u,i.createInsights=h,i.createMobile=d}(i=t.visualPluginFactory||(t.visualPluginFactory={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(e)for(var i=0;i<e.length;i++){var a=e[i];a(t)}}var i="unselectable";e.fire=t;var a=function(){function t(e,t){this._owner=e,this._direction=t,this._timerHandle=void 0,this.createView();var a=this;this._element.addEventListener("mousedown",function(e){a.onMouseDown(e)}),$(this._element).addClass(i),$(this._svg).addClass(i),$(this._polygon).addClass(i)}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),t.prototype.createView=function(){var e="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(e,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",t.ARROW_COLOR),this._svg=document.createElementNS(e,"svg");var i=this._svg.style;i.position="absolute",i.left="0px",i.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=r.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},t.prototype.onMouseDown=function(e){var t=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){e.cancelBubble=!0;var i=this;this._mouseUpWrapper=function(e){i.onMouseUp(e)},r.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){t.onMouseDown(e)},100),e.preventDefault&&e.preventDefault()},t.prototype.onMouseUp=function(e){clearTimeout(this._timerHandle),r.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},t.prototype.arrange=function(t,i,a){var r=Math.min(t,i),o=r/16,n=(t-r)/2,s=(i-r)/2;this._polygon.setAttributeNS(null,"transform","translate("+n+", "+s+") scale("+o+") rotate("+a+",8,8)"),this._svg.setAttributeNS(null,"width",t+"px"),this._svg.setAttributeNS(null,"height",i+"px"),e.HTMLElementUtils.setElementWidth(this._element,t),e.HTMLElementUtils.setElementHeight(this._element,i)},t.MIN_WIDTH=26,t.ARROW_COLOR="#404040",t}();e.ScrollbarButton=a;var r=function(){function r(e,t){this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(e,t);var a=this;this._element.addEventListener("mousedown",function(e){a.onBackgroundMouseDown(e)}),this._middleBar.addEventListener("mousedown",function(e){a.onMiddleBarMouseDown(e)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(i)}return r.prototype.scrollBy=function(e){this.scrollTo(this.viewMin+e)},r.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},r.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},r.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},r.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._element.style.width=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._element.style.height=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),r.prototype.refresh=function(){},Object.defineProperty(r.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!0,configurable:!0}),r.prototype._scrollSmallIncrement=function(e){this.scrollBy(this.smallIncrement*e)},Object.defineProperty(r.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!0,configurable:!0}),r.prototype.show=function(e){this._visible=e,this.element.style.visibility=e?"visible":"hidden",this.invalidateArrange()},r.prototype._getMouseOffset=function(e){return void 0!==e.offsetX?{x:e.offsetX,y:e.offsetY}:void 0!==e.layerX?{x:e.layerX,y:e.layerY}:{x:e.screenX,y:e.screenY}},r.prototype._getOffsetXDelta=function(e){return(e.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},r.prototype._getOffsetYDelta=function(e){return(e.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},r.prototype._getOffsetXTouchDelta=function(e){return this._getMouseOffset(e).x-this._offsetTouchPrevPos.x},r.prototype._getOffsetYTouchDelta=function(e){return this._getMouseOffset(e).y-this._offsetTouchPrevPos.y},r.prototype.initTouch=function(e,t){var i=this;this._touchPanel=e,this._allowMouseDrag=void 0===t?!0:t,"ontouchmove"in e?(e.addEventListener("touchstart",function(e){return i.onTouchStart(e)}),e.addEventListener("touchmove",function(e){return i.onTouchMove(e)}),e.addEventListener("touchend",function(e){return i.onTouchEnd(e)})):(e.addEventListener("mousedown",function(e){return i.onTouchMouseDown(e)}),e.addEventListener("mousemove",function(e){return i.onTouchMouseMove(e)}),e.addEventListener("mouseup",function(e){return i.onTouchMouseUp(e)}))},r.prototype.onTouchStart=function(e){1===e.touches.length&&this.onTouchMouseDown(e.touches[0])},r.prototype.onTouchMove=function(e){1===e.touches.length&&(e.preventDefault&&e.preventDefault(),this.onTouchMouseMove(e.touches[0]))},r.prototype.onTouchEnd=function(e){this.onTouchMouseUp(1===e.touches.length?e.touches[0]:e,!0)},r.prototype.onTouchMouseDown=function(e){(this._allowMouseDrag||e.pointerType!==MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&("setCapture"in this._touchPanel&&this._touchPanel.setCapture(!0),this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},r.prototype._getOffsetTouchDelta=function(e){return null},r.prototype.onTouchMouseMove=function(e){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(e));var t=this._getOffsetTouchDelta(e);0!==t&&(this.scrollBy(-t/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(e)),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0}},r.prototype.onTouchMouseUp=function(e,t){if(this._touchStarted&&this._offsetTouchStartPos){var i=this._getMouseOffset(e);!t&&(Math.abs(this._offsetTouchStartPos.x-i.x)>3||Math.abs(this._offsetTouchStartPos.y-i.y)>3)&&(e.preventDefault&&e.preventDefault(),e.cancelBubble=!0)}"releaseCapture"in this._touchPanel&&this._touchPanel.releaseCapture(),this._touchStarted=!1},r.prototype.createView=function(e,t){this._element=document.createElement("div"),this._element.className=r.className,this._element.setAttribute("drag-resize-disabled","true"),0===t&&e.appendChild(this._element),this._minButton=new a(this,-1),this._maxButton=new a(this,1),this._middleBar=document.createElement("div"),this._middleBar.className=r.barClassName,this._element.appendChild(this._middleBar)},r.prototype.scrollTo=function(e){var i=Math.min(this.max-this.viewSize,Math.max(this.min,e));i!==this.viewMin&&(this.viewMin=i,t(this._onscroll,null))},r.prototype._scrollByPage=function(e){},r.prototype._getRunningSize=function(e){return null},r.prototype._getOffsetDelta=function(e){return null},r.prototype.scroll=function(e){var t=this._getOffsetDelta(e)/this._getRunningSize(!0)*(this.max-this.min);if(0>t){if(this._getScreenMousePos(e)>=this._screenMaxMousePos)return}else if(t>0&&this._getScreenMousePos(e)<=this._screenMinMousePos)return;this.scrollBy(t)},Object.defineProperty(r.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualHeight",{get:function(){return void 0===!this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualButtonWidth",{get:function(){return void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualButtonHeight",{get:function(){return void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight},enumerable:!0,configurable:!0}),r.prototype.arrange=function(){this._actualWidth||(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition())},r.prototype._calculateButtonWidth=function(){return null},r.prototype._calculateButtonHeight=function(){return null},r.prototype._getMinButtonAngle=function(){return null},r.prototype._getMaxButtonAngle=function(){return null},r.prototype._setMaxButtonPosition=function(){},r.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},r.prototype.onHoldBackgroundMouseDown=function(e){var t=this,i=this._timerHandle?r.ScrollbarBackgroundMousedownHoldDelay:r.ScrollbarBackgroundFirstTimeMousedownHoldDelay;this._timerHandle=setTimeout(function(){t.onBackgroundMouseDown(e)},i)},r.prototype.onBackgroundMouseDown=function(e){var t=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(e.cancelBubble=!0,this._backgroundMouseUpWrapper=function(e){t.onBackgroundMouseUp(e)},r.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(e),this.refresh(),this.onHoldBackgroundMouseDown(e),e.preventDefault&&e.preventDefault()},r.prototype.onBackgroundMouseUp=function(e){clearTimeout(this._timerHandle),this._timerHandle=void 0,r.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},r.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},r.prototype.onMiddleBarMouseDown=function(t){t.cancelBubble=!0,this._screenPrevMousePos={x:t.screenX,y:t.screenY},this._screenMinMousePos=this._getScreenMousePos(t)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(t)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar)),this._screenToOffsetScale=e.HTMLElementUtils.getAccumulatedScale(this.element)*this.getPinchZoomY();var i=this;this._middleBarMouseMoveWrapper=function(e){i.onMiddleBarMouseMove(e)},r.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(e){i.onMiddleBarMouseUp(e)},r.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),t.preventDefault&&t.preventDefault()},r.prototype.onMiddleBarMouseMove=function(e){this._screenPrevMousePos&&(this.scroll(e),this.refresh(),this._screenPrevMousePos={x:e.screenX,y:e.screenY})},r.prototype.onMiddleBarMouseUp=function(e){this._screenPrevMousePos=void 0,r.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,r.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,e.preventDefault&&e.preventDefault()},r.prototype._getScreenContextualLeft=function(e){return null},r.prototype._getScreenContextualRight=function(e){return null},r.prototype.onMouseWheel=function(e){e&&this.mouseWheel(e)},r.prototype.mouseWheel=function(e){this.visible&&(0>e?e=Math.min(-r.MouseWheelRange,e):e>0&&(e=Math.max(r.MouseWheelRange,e)),this.scrollBy(-e/r.MouseWheelRange*this.smallIncrement))},r.prototype._getScreenMousePos=function(e){return null},r.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},r.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},r.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},r.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},r.DefaultScrollbarWidth="15px",r.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,r.ScrollbarBackgroundMousedownHoldDelay=50,r.MouseWheelRange=120,r.className="scroll-bar-div",r.barClassName="scroll-bar-part-bar",r.arrowClassName="scroll-bar-part-arrow",r}();e.Scrollbar=r;var o=function(t){function i(e,i){t.call(this,e,i),this.height=r.DefaultScrollbarWidth}return __extends(i,t),i.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,a.MIN_WIDTH))},i.prototype._calculateButtonHeight=function(){return this.actualHeight},i.prototype._getMinButtonAngle=function(){return-180},i.prototype._getMaxButtonAngle=function(){return 0},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementLeft(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},i.prototype.refresh=function(){this.arrange();var t=this.actualWidth-2*this.actualButtonWidth-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),0>t&&(t=0,i=0),i=Math.min(i,t);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,i),e.HTMLElementUtils.setElementHeight(this.middleBar,this.actualHeight),e.HTMLElementUtils.setElementLeft(this.middleBar,this.actualButtonWidth+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.height=this.height:e.HTMLElementUtils.setElementHeight(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetLeft,i=t+this.middleBar.offsetWidth,a=void 0===e.offsetX?e.layerX:e.offsetX;a>i?this.scrollPageDown():t>a&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualWidth;if(e){var i=this.actualButtonWidth+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetXDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetXTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().left},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().right},i.prototype._getScreenMousePos=function(e){return e.screenX},i}(r);e.HorizontalScrollbar=o;var n=function(t){function i(e,i){t.call(this,e,i),this.width=r.DefaultScrollbarWidth}return __extends(i,t),i.prototype._calculateButtonWidth=function(){return this.actualWidth},i.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,a.MIN_WIDTH))},i.prototype._getMinButtonAngle=function(){return-90},i.prototype._getMaxButtonAngle=function(){return 90},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementTop(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},i.prototype.refresh=function(){this.arrange();var t=this.actualHeight-2*this.actualButtonHeight-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),0>t&&(t=0,i=0);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,this.actualWidth),e.HTMLElementUtils.setElementHeight(this.middleBar,i),e.HTMLElementUtils.setElementTop(this.middleBar,this.actualButtonHeight+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.width=this.width:e.HTMLElementUtils.setElementWidth(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetTop,i=t+this.middleBar.offsetHeight,a=void 0===e.offsetY?e.layerY:e.offsetY;a>i?this.scrollPageDown():t>a&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualHeight;if(e){var i=this.actualButtonHeight+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetYDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetYTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().top},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().bottom},i.prototype._getScreenMousePos=function(e){return e.screenY},i}(r);e.VerticalScrollbar=n}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i="unselectable",a=function(){function e(e,t){this._element=e,this._handler=t,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return e.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},e.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},e.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},e.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},e.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},e.getMouseCoordinateDelta=function(e,t){return{x:t.x-e.x,y:t.y-e.y}},e.prototype.initialize=function(){var e=this;this._elementMouseDownWrapper=function(t){return e.onElementMouseDown(t)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(t){return e.onElementMouseMove(t)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(t){return e.onElementMouseOut(t)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(t){return e.onElementMouseDoubleClick(t)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},e.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(e.prototype,"cell",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype._hotSpot=function(e){return!1},e.prototype.onElementMouseDown=function(t){var i=this,a=e.getMouseCoordinates(t);this._hotSpot(a)&&("setCapture"in this._element&&this._element.setCapture(),t.cancelBubble=!0,this._startMousePosition=a,this._documentMouseMoveWrapper=function(e){return i.onDocumentMouseMove(e)},e.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(e){return i.onDocumentMouseUp(e)},e.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=e.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},e.prototype.onElementMouseMove=function(t){this._startMousePosition||(this._hotSpot(e.getMouseCoordinates(t))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=e.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},e.prototype.onElementMouseOut=function(e){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},e.prototype.onElementMouseDoubleClick=function(t){this._hotSpot(e.getMouseCoordinates(t))&&this._handler.onReset(this.cell)},e.prototype.onDocumentMouseMove=function(t){if(this._startMousePosition){var i=e.getMouseCoordinateDelta(this._startMousePosition,e.getMouseCoordinates(t));this._handler.onResize(this.cell,i.x,i.y),t.preventDefault()}},e.prototype.onDocumentMouseUp=function(t){this._startMousePosition=null,"releaseCapture"in this._element&&this._element.releaseCapture(),e.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,e.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),t.preventDefault&&t.preventDefault(),this._handler.onEndResize(this.cell)},e.resizeHandleSize=4,e.resizeCursor="e-resize",e}();t.TablixResizer=a;var r=function(e){function t(t,i,a){e.call(this,i,a),this._cell=t}return __extends(t,e),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),t.prototype._hotSpot=function(e){return e.x>=this.element.getBoundingClientRect().right-a.resizeHandleSize},t}(a);t.TablixDomResizer=r;var o=function(){function i(e,i){this._tableCell=null,this._contentElement=t.TablixUtils.createDiv(),this._contentHost=t.TablixUtils.createDiv(),this.layoutKind=i,this._contentElement.appendChild(this._contentHost),this._resizer=null}return i.prototype.initialize=function(e){this._owner=e},Object.defineProperty(i.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),i.prototype.registerTableCell=function(e){this._tableCell=e,e.appendChild(this._contentElement)},Object.defineProperty(i.prototype,"tableCell",{get:function(){return this._tableCell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentElement",{get:function(){return this._contentElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!0,configurable:!0}),i.prototype.registerClickHandler=function(e){this._contentElement.onclick=e},i.prototype.unregisterClickHandler=function(){this._contentElement.onclick=null},i.prototype.onContainerWidthChanged=function(t){e.HTMLElementUtils.setElementWidth(this._contentElement,t)},i.prototype.onContinerHeightChanged=function(t){e.HTMLElementUtils.setElementHeight(this._contentElement,t)},i.prototype.onColumnSpanChanged=function(e){this._tableCell.colSpan=e},i.prototype.onRowSpanChanged=function(e){this._tableCell.rowSpan=e},i.prototype.onTextAlignChanged=function(e){this._tableCell.style.textAlign=e},i.prototype.onClear=function(){this._contentHost.className="",this._tableCell.className=""},i.prototype.onHorizontalScroll=function(t,i){e.HTMLElementUtils.setElementLeft(this._contentHost,i),e.HTMLElementUtils.setElementWidth(this._contentHost,t)},i.prototype.onVerticalScroll=function(t,i){e.HTMLElementUtils.setElementTop(this._contentHost,i),e.HTMLElementUtils.setElementHeight(this._contentHost,t)},i.prototype.onInitializeScrolling=function(){e.HTMLElementUtils.setElementLeft(this._contentHost,0),e.HTMLElementUtils.setElementTop(this._contentHost,0),e.HTMLElementUtils.setElementWidth(this._contentHost,-1),e.HTMLElementUtils.setElementHeight(this._contentHost,-1)},i.prototype.enableHorizontalResize=function(e,t){e!==(null!==this._resizer)&&(e?(this._resizer=new r(this._owner,this._tableCell,t),this._resizer.initialize()):(this._resizer.uninitialize(),this._resizer=null))},i.prototype.disableDragResize=function(){this._tableCell.setAttribute(i._dragResizeDisabledAttributeName,"true")},i._dragResizeDisabledAttributeName="drag-resize-disabled",i}();t.TablixCellPresenter=o;var n=function(){function e(e){this._tableRow=null,this._fitProportionally=e}return e.prototype.initialize=function(e){this._row=e},e.prototype.createCellPresenter=function(e){return new o(this._fitProportionally,e)},e.prototype.registerRow=function(e){this._tableRow=e},e.prototype.onAppendCell=function(e){var t=e._presenter;if(null===t.tableCell){var i=this._tableRow.insertCell(-1);t.registerTableCell(i)}else this._tableRow.appendChild(t.tableCell)},e.prototype.onInsertCellBefore=function(e,t){var i=e._presenter;if(null===i.tableCell){var a=this._tableRow.insertCell(Math.max(0,t._presenter.tableCell.cellIndex-1));i.registerTableCell(a)}else this._tableRow.insertBefore(e._presenter.tableCell,t._presenter.tableCell)},e.prototype.onRemoveCell=function(e){this._tableRow.removeChild(e._presenter.tableCell)},e.prototype.getHeight=function(){
return this.getCellHeight(this._row.getTablixCell())},e.prototype.getCellHeight=function(e){return-1},e.prototype.getCellContentHeight=function(e){return-1},Object.defineProperty(e.prototype,"tableRow",{get:function(){return this._tableRow},enumerable:!0,configurable:!0}),e}();t.TablixRowPresenter=n;var s=function(e){function t(t,i){e.call(this,i),this._gridPresenter=t}return __extends(t,e),t.prototype.getCellHeight=function(e){return e.containerHeight},t.prototype.getCellContentHeight=function(e){return e.contentHeight},t}(n);t.DashboardRowPresenter=s;var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getCellHeight=function(e){return e.containerHeight},t.prototype.getCellContentHeight=function(e){return e.contentHeight},t}(n);t.CanvasRowPresenter=l;var c=function(){function e(){}return e.prototype.initialize=function(e){this._column=e},e.prototype.getWidth=function(){return this.getCellWidth(this._column.getTablixCell())},e.prototype.getCellWidth=function(e){return-1},e.prototype.getCellContentWidth=function(e){return-1},e}();t.TablixColumnPresenter=c;var u=function(e){function t(t){e.call(this),this._gridPresenter=t}return __extends(t,e),t.prototype.getCellWidth=function(e){return this._gridPresenter.sizeComputationManager.cellWidth},t.prototype.getCellContentWidth=function(e){return this._gridPresenter.sizeComputationManager.contentWidth},t}(c);t.DashboardColumnPresenter=u;var h=function(t){function i(e,i){t.call(this),this._gridPresenter=e,this._columnIndex=i}return __extends(i,t),i.prototype.getCellWidth=function(t){var i=this._gridPresenter.getPersistedCellWidth(this._columnIndex);return _.isNumber(i)?i:t._presenter?e.HTMLElementUtils.getElementWidth(t._presenter.tableCell):0},i.prototype.getCellContentWidth=function(t){var i=this._gridPresenter.getPersistedCellWidth(this._columnIndex);if(_.isNumber(i))return i;if(!t._presenter)return 0;var a=e.HTMLElementUtils.getElementWidth(t._presenter.contentElement);return a>0&&1===t.colSpan&&(a+=1),a},i}(c);t.CanvasColumnPresenter=h;var d=function(){function a(e){this._table=t.TablixUtils.createTable(),this._table.className=i,this._footerTable=t.TablixUtils.createTable(),this._footerTable.className=i,this._columnWidthManager=e}return a.prototype.initialize=function(e,t,i,a){this._owner=e,t.appendChild(this._table),i.appendChild(this._footerTable)},a.prototype.getWidth=function(){return-1},a.prototype.getHeight=function(){return-1},a.prototype.getScreenToCssRatioX=function(){return 1},a.prototype.getScreenToCssRatioY=function(){return 1},a.prototype.createRowPresenter=function(){return null},a.prototype.createColumnPresenter=function(e){return null},a.prototype.onAppendRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._table.insertRow(-1);t.registerRow(i)}else this._table.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onInsertRowBefore=function(e,t){var i=e.presenter;if(null===i.tableRow){var a=this._table.insertRow(Math.max(0,t.presenter.tableRow.rowIndex-1));i.registerRow(a)}else this._table.tBodies[0].insertBefore(e.presenter.tableRow,t.presenter.tableRow)},a.prototype.onRemoveRow=function(e){this._table.tBodies[0].removeChild(e.presenter.tableRow)},a.prototype.onAddFooterRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._footerTable.insertRow(-1);t.registerRow(i)}else this._footerTable.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onClear=function(){e.HTMLElementUtils.clearChildren(this._table),e.HTMLElementUtils.clearChildren(this._footerTable)},a.prototype.onFillColumnsProportionallyChanged=function(e){e?(this._table.style.width="100%",this._footerTable.style.width="100%"):(this._table.style.width="auto",this._footerTable.style.width="auto")},a.prototype.invokeColumnResizeEndCallback=function(e,t){this._columnWidthManager&&this._columnWidthManager.onColumnWidthChanged(e,t)},a.prototype.getPersistedCellWidth=function(e){return this._columnWidthManager?this._columnWidthManager.getPersistedColumnWidth(e):void 0},a}();t.TablixGridPresenter=d;var p=function(e){function t(t){e.call(this),this._sizeComputationManager=t}return __extends(t,e),t.prototype.createRowPresenter=function(){return new s(this,this._owner.fillColumnsProportionally)},t.prototype.createColumnPresenter=function(e){return new u(this)},Object.defineProperty(t.prototype,"sizeComputationManager",{get:function(){return this._sizeComputationManager},enumerable:!0,configurable:!0}),t.prototype.getWidth=function(){return this._sizeComputationManager.gridWidth},t.prototype.getHeight=function(){return this._sizeComputationManager.gridHeight},t}(d);t.DashboardTablixGridPresenter=p;var g=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.createRowPresenter=function(){return new l(this._owner.fillColumnsProportionally)},i.prototype.createColumnPresenter=function(e){return new h(this,e)},i.prototype.getWidth=function(){return e.HTMLElementUtils.getElementWidth(this._table)},i.prototype.getHeight=function(){return e.HTMLElementUtils.getElementHeight(this._table)},i}(d);t.CanvasTablixGridPresenter=g}(t=e.internal||(e.internal={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(){function e(e){this._binder=e,this._adjustmentFactor=1}return e.prototype._getOwner=function(){return null},Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adjustmentFactor",{get:function(){return this._adjustmentFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsToRealizeCount",{get:function(){return this._itemsToRealizeCount},set:function(e){this._itemsToRealizeCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsEstimatedContextualWidth",{get:function(){return this._itemsEstimatedContextualWidth},set:function(e){this._itemsEstimatedContextualWidth=e},enumerable:!0,configurable:!0}),e.prototype.onStartRenderingIteration=function(){var e=this._getOwner();e.measureEnabled&&!e.done&&this._getEstimatedItemsToRealizeCount(),this._realizedLeavesCount=0},e.prototype.onEndRenderingIteration=function(e,t){t||this._getOwner().allItemsRealized||(this._adjustmentFactor*=this._getSizeAdjustment(e))},e.prototype.onEndRenderingSession=function(){this._adjustmentFactor=1},e.prototype.onCornerCellRealized=function(e,t){},e.prototype.onHeaderRealized=function(e,t,i){i&&this._realizedLeavesCount++},Object.defineProperty(e.prototype,"needsToRealize",{get:function(){return this._realizedLeavesCount<this._itemsToRealizeCount},enumerable:!0,configurable:!0}),e.prototype._getEstimatedItemsToRealizeCount=function(){},e.prototype._getSizeAdjustment=function(e){return 1},e}();t.TablixDimensionRealizationManager=i;var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),t.prototype._getOwner=function(){return this._owner},t.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateRowsToRealizeCount()},t.prototype.estimateRowsToRealizeCount=function(){return this._owner.dimension.model?void(this._owner.alignToEnd?this.itemsToRealizeCount=this._owner.dimension.getItemsCount()-this._owner.dimension.getIntegerScrollOffset()+1:this.itemsToRealizeCount=Math.ceil(this._owner.contextualWidthToFill/(this._owner.owner.getEstimatedRowHeight()*this.adjustmentFactor)+this._owner.dimension.getFractionScrollOffset())-this._owner.otherLayoutManager.dimension.getDepth()+1):void(this.itemsToRealizeCount=0)},t.prototype.getEstimatedRowHierarchyWidth=function(){if(!this._owner.dimension.model||0===this._owner.dimension.getItemsCount())return 0;var e=new o;this.updateRowHiearchyEstimatedWidth(this._owner.dimension.model,this._owner.dimension._hierarchyNavigator.getIndex(this._owner.dimension.getFirstVisibleItem(0)),e);for(var t=e.items,i=t.length,a=0,r=0;i>r;r++){var n=t[r];a+=0!==n.maxNonLeafWidth?n.maxNonLeafWidth:n.maxLeafWidth}return a},t.prototype.updateRowHiearchyEstimatedWidth=function(e,t,i){for(var a=this._owner.owner.owner.hierarchyNavigator,r=this.binder,o=a.getCount(e),s=t;o>s;s++){if(i.leafCount===this.itemsToRealizeCount)return;var l=a.getAt(e,s),c=r.getHeaderLabel(l),u=this._owner.getEstimatedHeaderWidth(c,t),h=a.isLeaf(l),d=a.getLevel(l),p=i.items[d];p||(p=new n,i.items[d]=p),h?(p.maxLeafWidth=Math.max(p.maxLeafWidth,u),i.leafCount=i.leafCount+1):(p.maxNonLeafWidth=Math.max(p.maxNonLeafWidth,u),this.updateRowHiearchyEstimatedWidth(a.getChildren(l),this._owner.dimension.getFirstVisibleChildIndex(l),i))}},t.prototype._getSizeAdjustment=function(e){return e/((this._owner.getRealizedItemsCount()-this._owner.dimension.getFractionScrollOffset())*this._owner.owner.getEstimatedRowHeight())},t}(i);t.RowRealizationManager=a;var r=function(i){function a(){i.apply(this,arguments)}return __extends(a,i),Object.defineProperty(a.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),a.prototype._getOwner=function(){return this._owner},a.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateColumnsToRealizeCount(this.getEstimatedRowHierarchyWidth())},Object.defineProperty(a.prototype,"rowRealizationManager",{get:function(){return this._owner.otherLayoutManager.realizationManager},enumerable:!0,configurable:!0}),a.prototype.getEstimatedRowHierarchyWidth=function(){return this._owner.otherLayoutManager.done?this._owner.getOtherHierarchyContextualHeight():this.rowRealizationManager.getEstimatedRowHierarchyWidth()*this.adjustmentFactor},a.prototype.estimateColumnsToRealizeCount=function(i){var a=this._owner.contextualWidthToFill-i;if(!this._owner.dimension.model||e.Double.lessOrEqualWithPrecision(a,0,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=0);var r=this.binder,o=this._owner.owner.owner.hierarchyNavigator,n=this._owner.dimension.getIntegerScrollOffset(),s=this._owner.dimension.getItemsCount(),l=s-n,c=this._owner.otherLayoutManager.dimension.getIntegerScrollOffset(),u=this._owner.otherLayoutManager.dimension.getItemsCount();if(this.itemsEstimatedContextualWidth=0,this._owner.alignToEnd)return void(this.itemsToRealizeCount=l);for(var h=n;s>h;h++){if(e.Double.greaterOrEqualWithPrecision(this.itemsEstimatedContextualWidth,a,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=h-n);var d=0,p=void 0;p=h===n?this._owner.getVisibleSizeRatio():1;var g=o.getLeafAt(this._owner.dimension.model,h),m=r.getHeaderLabel(g);d=Math.max(d,this._owner.getEstimatedHeaderWidth(m,h));for(var f=c;u>f;f++){var y=o.getIntersection(o.getLeafAt(this._owner.otherLayoutManager.dimension.model,f),g);m=r.getCellContent(y),d=Math.max(d,this._owner.getEstimatedBodyCellWidth(m))}this.itemsEstimatedContextualWidth+=d*p*this.adjustmentFactor}this.itemsToRealizeCount=l},a.prototype._getSizeAdjustment=function(e){return e/(this.getEstimatedRowHierarchyWidth()+this.itemsEstimatedContextualWidth)},a}(i);t.ColumnRealizationManager=r;var o=function(){function e(){this.items=[],this.leafCount=0}return e}();t.RowWidths=o;var n=function(){function e(){this.maxLeafWidth=0,this.maxNonLeafWidth=0}return e}();t.RowWidth=n}(i=t.internal||(t.internal={}))}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(t,i,a){this._scrollable=!1,this._presenter=t,this.extension=i,this._presenter.initialize(this),this._row=a,this.item=null,this.type=null,this._horizontalOffset=0,this._verticalOffset=0,this._colSpan=1,this._rowSpan=1,this._containerWidth=-1,this._containerHeight=-1,this.contentHeight=this.contentWidth=0,this.position=new e.TablixUtils.CellPosition}return t.prototype.unfixRowHeight=function(){this._row.unfixSize()},Object.defineProperty(t.prototype,"colSpan",{get:function(){return this._colSpan},set:function(e){this._colSpan!==e&&(this._presenter.onColumnSpanChanged(e),this._colSpan=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return this._rowSpan},set:function(e){this._rowSpan!==e&&(this._presenter.onRowSpanChanged(e),this._rowSpan=e,this._row.unfixSize())},enumerable:!0,configurable:!0}),t.prototype.getCellSpanningHeight=function(){return this._row.getCellSpanningHeight(this)},Object.defineProperty(t.prototype,"textAlign",{get:function(){return this._textAlign},set:function(e){e!==this._textAlign&&(this._presenter.onTextAlignChanged(e),this._textAlign=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalOffset",{get:function(){return this._horizontalOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalOffset",{get:function(){return this._verticalOffset},enumerable:!0,configurable:!0}),t.prototype.isScrollable=function(){return this._scrollable},t.prototype.clear=function(){this.isScrollable()&&this.initializeScrolling(),this._presenter.onClear(),this.setContainerWidth(-1),this.setContainerHeight(-1),this.contentHeight=this.contentWidth=0},t.prototype.initializeScrolling=function(){this._presenter.onInitializeScrolling(),this._horizontalOffset=0,this._verticalOffset=0,1===this.colSpan&&this.setContainerWidth(-1),1===this.rowSpan&&this.setContainerHeight(-1)},t.prototype.prepare=function(e){this.isScrollable()&&this.initializeScrolling(),this._scrollable=e},t.prototype.scrollVertically=function(e,t){var i=Math.ceil(-e*t);this._verticalOffset=i,this.isScrollable()?(this._presenter.onVerticalScroll(e,i),this.setContainerHeight(e+i)):this.setContainerHeight(this._row.getCellSpanningHeight(this)+i)},t.prototype.scrollHorizontally=function(e,t){if(this.isScrollable()){var i=Math.ceil(-e*t);this._horizontalOffset=i,this._presenter.onHorizontalScroll(e,i),this.setContainerWidth(e+i)}},t.prototype.setContainerWidth=function(e){e!==this._containerWidth&&(this._containerWidth=e,this._presenter.onContainerWidthChanged(e))},Object.defineProperty(t.prototype,"containerWidth",{get:function(){return this._containerWidth},enumerable:!0,configurable:!0}),t.prototype.setContainerHeight=function(e){0>e&&(e=-1),e!==this._containerHeight&&(this._containerHeight=e,this._presenter.onContinerHeightChanged(e))},Object.defineProperty(t.prototype,"containerHeight",{get:function(){return this._containerHeight},enumerable:!0,configurable:!0}),t.prototype.applyStyle=function(e){e&&(e.applyStyle(this),this.contentHeight+=e.getExtraBottom()+e.getExtraTop(),this.contentWidth+=e.getExtraLeft()+e.getExtraRight())},t.prototype.enableHorizontalResize=function(e,t){this._presenter.enableHorizontalResize(e,t)},t}();e.TablixCell=t;var i=function(){function e(e,t){this._presenter=e,this._presenter.initialize(this),this._containerWidth=-1,this._width=-1,this._sizeFixed=!1,this._aligningWidth=-1,this._fixedToAligningWidth=!1,this._items=[],this._itemType=null,this._footerCell=null,this._columnIndex=t}return e.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedColumnHeaders=[],this._realizedCornerCells=[],this._realizedBodyCells=[]},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),e.prototype.getType=function(){return this._realizedCornerCells.length>0?0:2},e.prototype.getColumnHeadersOrCorners=function(){return this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders},e.prototype.columnHeadersOrCornersEqual=function(e,t,i){if(this._items.length!==t.length)return!1;for(var a=this._items.length,r=0;a>r;r++)if(!this.columnHeaderOrCornerEquals(this._itemType,this._items[r],e,t[r].item,i))return!1;return!0},Object.defineProperty(e.prototype,"itemType",{get:function(){return this._itemType},enumerable:!0,configurable:!0}),e.prototype.getLeafItem=function(){return 0===this._items.length?null:this._items[this._items.length-1]},e.prototype.columnHeaderOrCornerEquals=function(e,t,i,a,r){if(e!==i)return!1;if(0===e){if(!r.cornerCellItemEquals(t,a))return!1}else if(!r.headerItemEquals(t,a))return!1;return!0},e.prototype.OnLeafRealized=function(e){var t=this.getType(),i=this.getColumnHeadersOrCorners();if(this.columnHeadersOrCornersEqual(t,i,e))this.clearSpanningCellsWidth(this._realizedColumnHeaders);else{var a=i.length;this._items=[];for(var r=0;a>r;r++)this._items.push(i[r].item);this._itemType=t,this.clearSize()}},e.prototype.clearSpanningCellsWidth=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.colSpan>1&&i.setContainerWidth(-1)}},e.prototype.addCornerCell=function(e){e._column=this,this._realizedCornerCells.push(e),e.setContainerWidth(this._containerWidth)},e.prototype.addRowHeader=function(e){e._column=this,this._realizedRowHeaders.push(e),e.setContainerWidth(this._containerWidth)},e.prototype.addColumnHeader=function(e,t){e._column=this,this._realizedColumnHeaders.push(e),t&&e.setContainerWidth(this._containerWidth)},e.prototype.addBodyCell=function(e){e._column=this,this._realizedBodyCells.push(e),e.setContainerWidth(this._containerWidth)},Object.defineProperty(e.prototype,"footer",{get:function(){return this._footerCell},set:function(e){this._footerCell=e,e._column=this,e.setContainerWidth(this._containerWidth)},enumerable:!0,configurable:!0}),e.prototype.onResize=function(e){e!==this.getContentContextualWidth()&&(this._containerWidth=e,this.setContainerWidth(this._containerWidth),this._sizeFixed=!0,this._fixedToAligningWidth=!1,this._aligningWidth=-1)},e.prototype.onResizeEnd=function(e){var t=this.owner._presenter;t&&t.invokeColumnResizeEndCallback(this._columnIndex,e)},e.prototype.fixSize=function(){var e=-1!==this._aligningWidth,t=e!==this._fixedToAligningWidth;(!this._sizeFixed||t||e)&&(-1===this._aligningWidth?this.setContainerWidth(this._containerWidth):this.setContainerWidth(this._aligningWidth),this._sizeFixed=!0,this._fixedToAligningWidth=-1!==this._aligningWidth)},e.prototype.clearSize=function(){this._containerWidth=-1,this.setContainerWidth(this._containerWidth),this._sizeFixed=!1},e.prototype.getContentContextualWidth=function(){return this._containerWidth},e.prototype.getCellIContentContextualWidth=function(e){return this._presenter.getCellContentWidth(e)},e.prototype.getCellSpanningWidthWithScrolling=function(e,t){var i=this.getContextualWidth()+this.getScrollingOffset();if(e.colSpan>1)for(var a=this.getIndex(t),r=t.realizedColumns,o=1;o<e.colSpan;o++)i+=r[o+a].getContextualWidth();return i},e.prototype.getScrollingOffset=function(){var e=0;return this._realizedColumnHeaders.length>0&&(e=this._realizedColumnHeaders[this._realizedColumnHeaders.length-1].horizontalOffset),e},e.prototype.getContextualWidth=function(){return-1!==this._width&&-1!==this._containerWidth||(this._width=this._presenter.getWidth()),this._width},e.prototype.calculateSize=function(){if(this._sizeFixed)return this._containerWidth;for(var e=0,t=0,i=this._realizedColumnHeaders;t<i.length;t++){var a=i[t];1===a.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(a)))}for(var r=0,o=this._realizedRowHeaders;r<o.length;r++){var a=o[r];1===a.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(a)))}for(var n=0,s=this._realizedCornerCells;n<s.length;n++){var a=s[n];e=Math.max(e,this._presenter.getCellContentWidth(a))}for(var l=0,c=this._realizedBodyCells;l<c.length;l++){var a=c[l];e=Math.max(e,this._presenter.getCellContentWidth(a))}return null!==this._footerCell&&1===this._footerCell.colSpan&&(e=Math.max(e,this._presenter.getCellContentWidth(this._footerCell))),this._containerWidth=e},e.prototype.setAligningContextualWidth=function(e){this._aligningWidth=e},e.prototype.getAligningContextualWidth=function(){return this._aligningWidth},e.prototype.setContainerWidth=function(e){for(var t=0,i=this._realizedColumnHeaders;t<i.length;t++){var a=i[t];1===a.colSpan&&a.setContainerWidth(e)}for(var r=0,o=this._realizedRowHeaders;r<o.length;r++){var a=o[r];1===a.colSpan&&a.setContainerWidth(e)}for(var n=0,s=this._realizedCornerCells;n<s.length;n++){var a=s[n];a.setContainerWidth(e)}for(var l=0,c=this._realizedBodyCells;l<c.length;l++){var a=c[l];a.setContainerWidth(e)}null!==this._footerCell&&1===this._footerCell.colSpan&&this._footerCell.setContainerWidth(e),this._width=e},e.prototype.getTablixCell=function(){var e=this._realizedColumnHeaders.length>0?this._realizedColumnHeaders:this._realizedCornerCells;return e[e.length-1]},e.prototype.getIndex=function(e){return e.realizedColumns.indexOf(this)},e.prototype.getHeaders=function(){return this._realizedColumnHeaders},e.prototype.getOtherDimensionHeaders=function(){return this._realizedRowHeaders},e.prototype.getCellContextualSpan=function(e){return e.colSpan},e.prototype.getOtherDimensionOwner=function(e){return e._row},e}();e.TablixColumn=i;var a=function(){function e(e){this._containerHeight=-1,this._presenter=e,this._presenter.initialize(this),this._allocatedCells=[],this._heightFixed=!1,this._containerHeight=-1,this._height=-1}return e.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedBodyCells=[],this._realizedCornerCells=[],this._realizedColumnHeaders=[],this._realizedCellsCount=0},Object.defineProperty(e.prototype,"presenter",{get:function(){return this._presenter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),e.prototype.releaseUnusedCells=function(e){this.releaseCells(e,this._realizedCellsCount)},e.prototype.releaseAllCells=function(e){this.releaseCells(e,0)},e.prototype.releaseCells=function(e,t){for(var i=this._allocatedCells,a=i.length,r=t;a>r;r++){var o=i[r];e._unbindCell(o),o.clear()}},e.prototype.moveScrollableCellsToEnd=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;t+e>i;i++){var a=this._allocatedCells[i];this._presenter.onRemoveCell(a),this._presenter.onAppendCell(a),this._allocatedCells.push(a)}this._allocatedCells.splice(t,e)},e.prototype.moveScrollableCellsToStart=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;t+e>i;i++){var a=this._allocatedCells.pop();this._presenter.onRemoveCell(a),this._presenter.onInsertCellBefore(a,this._allocatedCells[t]),this._allocatedCells.splice(t,0,a)}},e.prototype.getOrCreateCornerCell=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.addCornerCell(t),this._realizedCornerCells.push(t),t.setContainerHeight(this._containerHeight),t},e.prototype.getOrCreateRowHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addRowHeader(a),this._realizedRowHeaders.push(a),i&&a.setContainerHeight(this._containerHeight),a},e.prototype.getOrCreateColumnHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addColumnHeader(a,i),this._realizedColumnHeaders.push(a),a.setContainerHeight(this._containerHeight),a},e.prototype.getOrCreateBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.addBodyCell(i),this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},e.prototype.getOrCreateFooterRowHeader=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.footer=t,this._realizedRowHeaders.push(t),t.setContainerHeight(this._containerHeight),t},e.prototype.getOrCreateFooterBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.footer=i,this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},e.prototype.getRowHeaderLeafIndex=function(){for(var e=-1,t=this._allocatedCells.length,i=0;t>i&&1===this._allocatedCells[i].type;i++)e++;return e},e.prototype.getAllocatedCellAt=function(e){return this._allocatedCells[e]},e.prototype.moveCellsBy=function(e){if(0!==this._allocatedCells.length)if(e>0)for(var t=this._allocatedCells[0],i=0;e>i;i++){var a=this.createCell(this);this._presenter.onInsertCellBefore(a,t),this._allocatedCells.unshift(a),t=a}else{e=-e;for(var i=0;e>i;i++)this._presenter.onRemoveCell(this._allocatedCells[i]);this._allocatedCells.splice(0,e)}},e.prototype.getRealizedCellCount=function(){return this._realizedCellsCount},e.prototype.getRealizedHeadersCount=function(){return this._realizedRowHeaders.length},e.prototype.getRealizedHeaderAt=function(e){return this._realizedRowHeaders[e]},e.prototype.getTablixCell=function(){var e;return e=this._realizedRowHeaders.length>0?this._realizedRowHeaders:this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders,e[e.length-1]},e.prototype.getOrCreateEmptySpaceCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e&&(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)),e},e.prototype.createCell=function(e){var i=this._presenter.createCellPresenter(this._owner.owner.layoutManager.getLayoutKind());return new t(i,i,this)},e.prototype.getOrCreateCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e?(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)):(e.colSpan=1,e.rowSpan=1),this._realizedCellsCount=this._realizedCellsCount+1,e},e.prototype.onResize=function(e){e!==this.getContentContextualWidth()&&(this._containerHeight=e,this.setContentHeight(),this._heightFixed=!0,this.setAligningContextualWidth(-1))},e.prototype.onResizeEnd=function(e){},e.prototype.fixSize=function(){this.sizeFixed()||(this.setContentHeight(),this._heightFixed=!0)},e.prototype.unfixSize=function(){this._heightFixed=!1,this._height=-1},e.prototype.getContentContextualWidth=function(){return this._containerHeight},e.prototype.getCellIContentContextualWidth=function(e){return this.presenter.getCellContentHeight(e)},e.prototype.getCellSpanningHeight=function(e){var t=this.getContextualWidth();if(e.rowSpan>1)for(var i=this.getIndex(this.owner),a=this.owner.realizedRows,r=1;r<e.rowSpan;r++)t+=a[r+i].getContextualWidth();return t},e.prototype.getContextualWidth=function(){return-1!==this._height&&-1!==this._containerHeight||(this._height=this._presenter.getHeight()),this._height},e.prototype.sizeFixed=function(){return this._heightFixed},e.prototype.calculateSize=function(){if(this._heightFixed)return this._containerHeight;for(var e=0,t=this._realizedRowHeaders.length,i=0;t>i;i++){var a=this._realizedRowHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedCornerCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedCornerCells[i]));t=this._realizedColumnHeaders.length;for(var i=0;t>i;i++){var a=this._realizedColumnHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedBodyCells.length;for(var i=0;t>i;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedBodyCells[i]));return this._containerHeight=e},e.prototype.setAligningContextualWidth=function(e){},e.prototype.getAligningContextualWidth=function(){return-1},e.prototype.setContentHeight=function(){for(var e=this._realizedRowHeaders.length,t=e-1;t>=0;t--){var i=this._realizedRowHeaders[t];i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i))}e=this._realizedCornerCells.length;for(var t=0;e>t;t++)this._realizedCornerCells[t].setContainerHeight(this._containerHeight);e=this._realizedColumnHeaders.length;for(var t=0;e>t;t++){var i=this._realizedColumnHeaders[t];i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i))}e=this._realizedBodyCells.length;for(var t=0;e>t;t++)this._realizedBodyCells[t].setContainerHeight(this._containerHeight);this._height=-1},e.prototype.getIndex=function(e){return e.realizedRows.indexOf(this)},e.prototype.getHeaders=function(){return this._realizedRowHeaders},e.prototype.getOtherDimensionHeaders=function(){return this._realizedColumnHeaders},e.prototype.getCellContextualSpan=function(e){return e.rowSpan},e.prototype.getOtherDimensionOwner=function(e){return e._column},e}();e.TablixRow=a;var r=function(){function e(e){this._presenter=e,this._footerRow=null}return e.prototype.initialize=function(e,t,i){this._owner=e,this._presenter.initialize(this,t,i,e),this.fillColumnsProportionally=!1,this._realizedRows=[],this._realizedColumns=[],this._emptySpaceHeaderCell=null,this._emptyFooterSpaceCell=null},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColumnsProportionally",{get:function(){return this._fillColumnsProportionally},set:function(e){this._fillColumnsProportionally!==e&&(this._fillColumnsProportionally=e,this._presenter.onFillColumnsProportionallyChanged(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedColumns",{get:function(){return this._realizedColumns},set:function(e){this._realizedColumns=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedRows",{get:function(){return this._realizedRows},set:function(e){this._realizedRows=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerRow",{get:function(){return this._footerRow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceHeaderCell",{get:function(){return this._emptySpaceHeaderCell},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceFooterCell",{get:function(){return this._emptyFooterSpaceCell},enumerable:!0,configurable:!0}),e.prototype.ShowEmptySpaceCells=function(e,t){0!==this._realizedRows.length&&(0===this._realizedRows.length||this._emptySpaceHeaderCell||(this._emptySpaceHeaderCell=this._realizedRows[0].getOrCreateEmptySpaceCell(),this._emptySpaceHeaderCell.rowSpan=e,this._emptySpaceHeaderCell.colSpan=1,this._emptySpaceHeaderCell.setContainerWidth(t)),this._footerRow&&null===this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell=this._footerRow.getOrCreateEmptySpaceCell(),this._emptyFooterSpaceCell.rowSpan=1,this._emptyFooterSpaceCell.colSpan=1,this._emptyFooterSpaceCell.setContainerWidth(t)))},e.prototype.HideEmptySpaceCells=function(){this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell.clear(),this._emptySpaceHeaderCell=null),this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell.clear(),this._emptyFooterSpaceCell=null)},e.prototype.onStartRenderingSession=function(e){e&&(this.clearRows(),this.clearColumns())},e.prototype.onStartRenderingIteration=function(){this.initializeRows(),this.initializeColumns()},e.prototype.onEndRenderingIteration=function(){var e=this._rows;if(void 0!==e)for(var t=e.length,i=0;t>i;i++)e[i].releaseUnusedCells(this._owner);this._footerRow&&this._footerRow.releaseUnusedCells(this._owner)},e.prototype.getOrCreateRow=function(e){var t=this._rows[e];return void 0===t&&(t=new a(this._presenter.createRowPresenter()),t.initialize(this),this._presenter.onAppendRow(t),this._rows[e]=t),void 0===this._realizedRows[e]&&(this._realizedRows[e]=t),t},e.prototype.getOrCreateFootersRow=function(){return null===this._footerRow&&(this._footerRow=new a(this._presenter.createRowPresenter()),this._footerRow.initialize(this),this._presenter.onAddFooterRow(this._footerRow)),this._footerRow},e.prototype.moveRowsToEnd=function(e,t){for(var i=0;t>i;i++){var a=this._rows[i+e];a.unfixSize(),this._presenter.onRemoveRow(a),this._presenter.onAppendRow(a),this._rows.push(a)}this._rows.splice(e,t)},e.prototype.moveRowsToStart=function(e,t){for(var i=this._rows[e],a=0;t>a;a++){var r=this._rows.pop();r.unfixSize(),this._presenter.onRemoveRow(r),this._presenter.onInsertRowBefore(r,i),this._rows.splice(e+a,0,r)}},e.prototype.moveColumnsToEnd=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToEnd(t);
for(var r=0;t>r;r++){var o=this._columns[r+e];this._columns.push(o)}this._columns.splice(e,t)},e.prototype.moveColumnsToStart=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToStart(t);for(var r=0;t>r;r++){var o=this._columns.pop();this._columns.splice(e+r,0,o)}},e.prototype.getOrCreateColumn=function(e){var t=this._columns[e];return void 0===t&&(t=new i(this._presenter.createColumnPresenter(e),e),t.initialize(this),this._columns[e]=t),void 0===this._realizedColumns[e]&&(this._realizedColumns[e]=t),t},e.prototype.initializeColumns=function(){this._columns||(this._columns=[]);for(var e=this._columns.length,t=0;e>t;t++)this._columns[t].initialize(this);this._realizedColumns=[]},e.prototype.clearColumns=function(){this._columns=null,this._realizedColumns=null},e.prototype.initializeRows=function(){var e=this._owner.rowDimension.hasFooter()&&null!==this._footerRow;this._realizedRows=[],this._rows||(this._rows=[]);for(var t=this._rows,i=t.length,a=0;i>a;a++)t[a].initialize(this);e&&(this._footerRow||this.getOrCreateFootersRow(),this._footerRow.initialize(this))},e.prototype.clearRows=function(){var e=this._rows;if(e){for(var t=e.length,i=0;t>i;i++)e[i].releaseAllCells(this._owner);this._footerRow&&this._footerRow.releaseAllCells(this._owner),this._presenter.onClear(),this._footerRow=null,this._rows=null,this._realizedRows=null}},e.prototype.getWidth=function(){return this._presenter.getWidth()},e.prototype.getHeight=function(){return this._presenter.getHeight()},e}();e.TablixGrid=r}(t=e.internal||(e.internal={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var a=jsCommon.PixelConverter,r=function(){function e(){}return Object.defineProperty(e.prototype,"visibleWidth",{get:function(){return this._viewport?this._viewport.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleHeight",{get:function(){return this._viewport?this._viewport.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridWidth",{get:function(){return this.visibleWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridHeight",{get:function(){return this.visibleHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this._cellWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._cellWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),e.prototype.updateColumnCount=function(e){this._columnCount=e},e.prototype.updateRowHeight=function(e){this._cellHeight=e},e.prototype.updateScalingFactor=function(e){this._scalingFactor=e,this._cellWidth=this.computeColumnWidth(this._columnCount)},e.prototype.updateViewport=function(e){this._viewport=e,this._cellWidth=this.computeColumnWidth(this._columnCount),this._cellHeight=this.computeColumnHeight()},e.prototype.computeColumnWidth=function(t){var i=this._scalingFactor;i||(i=1);var a=i*e.TablixMinimumColumnWidth,r=Math.floor(this._viewport.width/a);return this.fitToColumnCount(r,t)},e.prototype.computeColumnHeight=function(){if(!this.hasImageContent)return this._cellHeight;var e=this._viewport.width;return 250>=e?20:510>=e?51:770>=e?52:void 0},e.prototype.fitToColumnCount=function(e,t){var i=Math.min(e,t);return Math.floor(this._viewport.width/i)},e.TablixMinimumColumnWidth=75,e}();i.SizeComputationManager=r;var o=function(){function t(e,t,i){this._owner=e,this._grid=t,this._lastScrollOffset=null,this._isScrolling=!1,this._fixedSizeEnabled=!0,this._done=!1,this._realizationManager=i}return Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"realizationManager",{get:function(){return this._realizationManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedSizeEnabled",{get:function(){return this._fixedSizeEnabled},set:function(e){this._fixedSizeEnabled=e},enumerable:!0,configurable:!0}),t.prototype.onCornerCellRealized=function(e,t,i){this._realizationManager.onCornerCellRealized(e,t)},t.prototype.onHeaderRealized=function(e,t,i){this._realizationManager.onHeaderRealized(e,t,i)},Object.defineProperty(t.prototype,"needsToRealize",{get:function(){return this._realizationManager.needsToRealize},enumerable:!0,configurable:!0}),t.prototype.getVisibleSizeRatio=function(){return 1-this.dimension.getFractionScrollOffset()},Object.defineProperty(t.prototype,"alignToEnd",{get:function(){return this._alignToEnd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0}),t.prototype._requiresMeasure=function(){return!0},t.prototype.startScrollingSession=function(){this._isScrolling=!0},t.prototype.endScrollingSession=function(){this._isScrolling=!1},t.prototype.isScrolling=function(){return this._isScrolling},t.prototype.isResizing=function(){return!1},t.prototype.getOtherHierarchyContextualHeight=function(){var e=this.dimension.otherDimension,t=e.getDepth(),i=0,a=this._getRealizedItems();if(a.length>0)for(var r=0;t>r;r++)i+=a[r].getContextualWidth();return i},t.prototype._isAutoSized=function(){return!1},t.prototype.onStartRenderingSession=function(){this._measureEnabled=this._requiresMeasure(),this._gridOffset=this.dimension.otherDimension.getDepth()},t.prototype.onEndRenderingSession=function(){this._realizationManager.onEndRenderingSession(),this._alignToEnd=!1,this._done=!1,this._measureEnabled=!0,this._sendDimensionsToControl()},t.prototype._sendDimensionsToControl=function(){},Object.defineProperty(t.prototype,"measureEnabled",{get:function(){return this._measureEnabled},enumerable:!0,configurable:!0}),t.prototype.getFooterContextualWidth=function(){return 0},t.prototype.onStartRenderingIteration=function(e,t){this._measureEnabled&&!this._done&&(this._contextualWidthToFill=(t-this.otherScrollbarContextualWidth)*this.getGridScale()-this.getFooterContextualWidth()),this._realizationManager.onStartRenderingIteration(),e?this._lastScrollOffset=null:null!==this._lastScrollOffset&&this.swapElements()},Object.defineProperty(t.prototype,"allItemsRealized",{get:function(){return this.getRealizedItemsCount()-this._gridOffset===this.dimension.getItemsCount()||0===this.dimension.getItemsCount()},enumerable:!0,configurable:!0}),t.prototype.onEndRenderingIteration=function(){if(!this._done){if(!this._measureEnabled)return this._lastScrollOffset=this.dimension.scrollOffset,void(this._done=!0);var i,a=this.getGridContextualWidth(),r=e.Double.greaterOrEqualWithPrecision(a,this._contextualWidthToFill,t._pixelPrecision),o=this.allItemsRealized;i=r?this.scrollForwardToAlignEnd(a):this.scrollBackwardToFill(a),this._realizationManager.onEndRenderingIteration(a,r);var n=this.dimension.scrollbar.visible;this.updateScrollbar(a),this._done=(r||o)&&this.dimension.scrollbar.visible===n&&e.Double.equalWithPrecision(i,this.dimension.scrollOffset,t._scrollOffsetPrecision),this.dimension.scrollOffset=i,this._lastScrollOffset=this.dimension.scrollOffset}},t.prototype.getScrollDeltaWithinPage=function(){if(null!==this._lastScrollOffset){var e=this.dimension.getIntegerScrollOffset()-Math.floor(this._lastScrollOffset);if(Math.abs(e)<this.getRealizedItemsCount()-this.dimension.otherDimension.getDepth())return e}return null},t.prototype.swapElements=function(){var e=this.getScrollDeltaWithinPage();if(null!==e){var t=this.dimension.otherDimension.getDepth();Math.abs(e)<this.getRealizedItemsCount()-t&&(e>0?this._moveElementsToBottom(t,e):0>e&&this._moveElementsToTop(t,-e))}},t.prototype._getRealizedItems=function(){return null},t.prototype.getRealizedItemsCount=function(){var e=this._getRealizedItems();return e.length},t.prototype._moveElementsToBottom=function(e,t){},t.prototype._moveElementsToTop=function(e,t){},t.prototype.isScrollingWithinPage=function(){return null!==this.getScrollDeltaWithinPage()},t.prototype.getGridContextualWidth=function(){return 0},t.prototype.updateScrollbar=function(e){var t=this.dimension.scrollbar;t.viewMin=this.dimension.scrollOffset,t.min=0,t.max=this.dimension.getItemsCount(),t.viewSize=this.getViewSize(e),this.dimension.scrollbar.show(this.canScroll(e))},t.prototype.getViewSize=function(i){var a=this.getRealizedItemsCount();if(0===a)return 0;for(var r=this._gridOffset,o=0,n=0,s=this._contextualWidthToFill,l=s-this.getOtherHierarchyContextualHeight(),c=this.getMeaurementError(i),u=r;a>u;u++){var h=void 0;h=u===r?this.getVisibleSizeRatio():1;var d=this.getItemContextualWidthWithScrolling(u)*c;if(n+=d,o+=h,e.Double.greaterWithPrecision(n,l,t._pixelPrecision)){o-=(n-l)/d*h;break}}return o},t.prototype.isScrollableHeader=function(e,t,i){if(0!==i||0===this.dimension.getFractionScrollOffset())return!1;var a=this.dimension._hierarchyNavigator;if(a.isLeaf(e))return!0;var r=e,o=t;do{if(o=a.getChildren(r),r=this.dimension.getFirstVisibleItem(a.getLevel(r)+1),void 0===r)break;if(!a.isLastItem(r,o))return!1}while(!a.isLeaf(r));return!0},t.prototype.reachedEnd=function(){return this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},t.prototype.scrollBackwardToFill=function(i){var a=this.dimension.scrollOffset;if(this.reachedEnd()){var r=this._contextualWidthToFill-i;if(this.dimension.getItemsCount()>0){var o=i/(this.getRealizedItemsCount()-this.dimension.getFractionScrollOffset());a=this.dimension.getValidScrollOffset(Math.floor(this.dimension.scrollOffset-r/o))}this._alignToEnd=!e.Double.equalWithPrecision(a,this.dimension.scrollOffset,t._scrollOffsetPrecision)}return a},t.prototype.getItemContextualWidth=function(e){var t=this._getRealizedItems();return e>=t.length?null:t[e].getContextualWidth()},t.prototype.getItemContextualWidthWithScrolling=function(e){return this.getSizeWithScrolling(this.getItemContextualWidth(e),e)},t.prototype.getSizeWithScrolling=function(e,t){var i;return i=this._gridOffset===t?this.getVisibleSizeRatio():1,e*i},t.prototype.getGridContextualWidthFromItems=function(){for(var e=this.getRealizedItemsCount(),t=0,i=0;e>i;i++)t+=this.getItemContextualWidthWithScrolling(i);return t},t.prototype.getMeaurementError=function(e){return e/this.getGridContextualWidthFromItems()},t.prototype.scrollForwardToAlignEnd=function(i){var a=this.dimension.scrollOffset;if(this._alignToEnd){var r=e.Double.equalWithPrecision(i,this._contextualWidthToFill,t._pixelPrecision);if(!r)for(var o=this.getRealizedItemsCount(),n=this._gridOffset,s=i-this._contextualWidthToFill,l=this.getMeaurementError(i),c=n;o>c;c++){var u=this.getItemContextualWidth(c)*l;if(!e.Double.lessWithPrecision(u,s,t._pixelPrecision)){var h=n===c?1-this.dimension.getFractionScrollOffset():1;a=this.dimension.getValidScrollOffset(this.dimension.scrollOffset+(c-n)+s*h/u);break}s-=u}this._alignToEnd=!r}return a},Object.defineProperty(t.prototype,"dimension",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherLayoutManager",{get:function(){return this.dimension.otherDimension.layoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextualWidthToFill",{get:function(){return this._contextualWidthToFill},enumerable:!0,configurable:!0}),t.prototype.getGridScale=function(){return 0},Object.defineProperty(t.prototype,"otherScrollbarContextualWidth",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.getActualContextualWidth=function(e){return this._isAutoSized()&&!this.canScroll(e)?e:this._contextualWidthToFill},t.prototype.canScroll=function(e){return!1},t.prototype.calculateSizes=function(){this.fixedSizeEnabled&&(this.calculateContextualWidths(),this.calculateSpans())},t.prototype._calculateSize=function(e){return null},t.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=e.length,i=0;t>i;i++){var a=e[i];this.measureEnabled&&a.setAligningContextualWidth(-1),this._calculateSize(a)}},t.prototype.calculateSpans=function(){this.measureEnabled&&(this.updateNonScrollableItemsSpans(),this.updateScrollableItemsSpans())},t.prototype.updateNonScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=e.length,i=this.dimension.getDepth(),a=i;t>a;a++){var r=e[a];this.updateSpans(r,r.getHeaders())}},t.prototype.updateScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=Math.min(this.dimension.getDepth(),e.length),i=0;t>i;i++){var a=e[i];this.updateSpans(a,a.getOtherDimensionHeaders())}},t.prototype.fixSizes=function(){if(this.fixedSizeEnabled)for(var e=this._getRealizedItems(),t=e.length,i=t-1;i>=0;i--)e[i].fixSize()},t.prototype.updateSpans=function(e,t){for(var i=this._getRealizedItems(),a=t.length,r=0;a>r;r++){var o=t[r],n=e.getOtherDimensionOwner(o),s=n.getCellContextualSpan(o);if(s>1)for(var l=0,c=n.getIndex(this._grid),u=0;s>u;u++){var h=i[u+c];l+=h.getContentContextualWidth(),u===s-1&&this.updateLastChildSize(o,h,l)}}},t.prototype.updateLastChildSize=function(e,t,i){var a=t.getCellIContentContextualWidth(e)-i;a>0&&t.setAligningContextualWidth(Math.max(t.getAligningContextualWidth(),a+t.getContentContextualWidth()))},t._pixelPrecision=1.0001,t._scrollOffsetPrecision=.01,t}();i.DimensionLayoutManager=o;var n=function(){function e(e,t,i){this.column=e,this.item=e.getLeafItem(),this.itemType=e.itemType,this.startColumnWidth=t,this.resizingDelta=0,this.animationFrame=null,this.scale=i}return e.prototype.getNewSize=function(){return this.startColumnWidth+this.resizingDelta},e}();i.ResizeState=n;var s=function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this,this.fillProportionally=!1,this._resizeState=null}return __extends(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.columnDimension},enumerable:!0,configurable:!0}),i.prototype.isResizing=function(){return null!==this._resizeState},Object.defineProperty(i.prototype,"fillProportionally",{get:function(){return this._grid.fillColumnsProportionally},set:function(e){this._grid.fillColumnsProportionally=e},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioX()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementWidth(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype._getRealizedItems=function(){return this._grid.realizedColumns||(this._grid.realizedColumns=[]),this._grid.realizedColumns},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveColumnsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveColumnsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()||this.isScrolling()||this.isResizing()},i.prototype.getGridContextualWidth=function(){return this._grid.getWidth()},i.prototype.getFirstVisibleColumn=function(){return this._grid.realizedColumns[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeWidth},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleColumn();void 0!==i&&(t=i.getContextualWidth(),this.scroll(i,t,e))}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedColumnHeaders,t,i),this.scrollBodyCells(this._grid.realizedRows,t,i),null!==e.footer&&e.footer.scrollHorizontally(t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;a>r;r++)e[r].scrollHorizontally(t,i)},i.prototype.scrollBodyCells=function(e,t,i){for(var a,r,o=e.length,n=0;o>n;n++)a=e[n]._realizedBodyCells,void 0!==a&&(r=a[0],void 0!==r&&r.scrollHorizontally(t,i))},i.prototype.onStartResize=function(e,i,a){this._resizeState=new n(e._column,e._column.getContentContextualWidth(),t.HTMLElementUtils.getAccumulatedScale(this.owner.owner.container))},i.prototype.onResize=function(e,t,a){var r=this;this.isResizing()&&(this._resizeState.resizingDelta=Math.round(Math.max(t/this._resizeState.scale,i.minColumnWidth-this._resizeState.startColumnWidth)),null===this._resizeState.animationFrame&&(this._resizeState.animationFrame=requestAnimationFrame(function(){return r.performResizing()})))},i.prototype.onEndResize=function(e){this.isResizing()&&null!==this._resizeState.animationFrame&&this.performResizing(),this.endResizing(),this._resizeState=null},i.prototype.onReset=function(e){this._resizeState=new n(e._column,-1,1),e._column.clearSize(),this.endResizing(),this.owner.owner.refresh(!1),this._resizeState=null},i.prototype.updateItemToResizeState=function(e){if(null!==this._resizeState)for(var t=e.length,i=this.owner.owner.hierarchyNavigator,a=this.otherLayoutManager.dimension.getDepth(),r=a;t>r;r++){var o=e[r];if(o.columnHeaderOrCornerEquals(this._resizeState.itemType,this._resizeState.item,o.itemType,o.getLeafItem(),i)&&o!==this._resizeState.column){this._resizeState.column=o,o.onResize(this._resizeState.getNewSize());break}}},i.prototype.performResizing=function(){if(null!==this._resizeState){this._resizeState.animationFrame=null;var e=this._resizeState.getNewSize();this._resizeState.column.onResize(e),this.owner.owner.refresh(!1)}},i.prototype.endResizing=function(){if(null!==this._resizeState){var e=this._resizeState.getNewSize();this._resizeState.column.onResizeEnd(e)}},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateColumnDimensions(i/a,(t-i)/a,this.getViewSize(e))},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i.prototype.getEstimatedBodyCellWidth=function(e){return-1},i.minColumnWidth=10,i}(o);i.ColumnLayoutManager=s;var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.ignoreColumn(t)?0:this.owner.getCellWidth(void 0)},t.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getCellWidth(void 0)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){var t=e.getIndex(this._grid),i=0;return this.ignoreColumn(t)||(i=this.owner.getContentWidth(void 0)),e.onResize(i),e.onResizeEnd(i),i},t.prototype.ignoreColumn=function(e){return 0===e&&!this.owner.binder.hasRowGroups()},t}(s);i.DashboardColumnLayoutManager=l;var c=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},i.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getEstimatedTextWidth(e)},i.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=[],i=0,a=e;i<a.length;i++){var r=a[i];this.measureEnabled&&r.setAligningContextualWidth(-1),t.push(this._calculateSize(r))}this.owner.columnWidthsToPersist=t},i.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,o._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,o._pixelPrecision)},i.prototype._calculateSize=function(e){return e.calculateSize()},i}(s);i.CanvasColumnLayoutManager=c;var u=function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this}return __extends(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.rowDimension},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioY()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementHeight(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype.startScrollingSession=function(){e.prototype.startScrollingSession.call(this)},i.prototype._getRealizedItems=function(){return this._grid.realizedRows||(this._grid.realizedRows=[]),this._grid.realizedRows},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveRowsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveRowsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()&&!this.otherLayoutManager.isResizing()||this.isScrolling()&&this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},i.prototype.getGridContextualWidth=function(){return this._grid.getHeight()},i.prototype.getFirstVisibleRow=function(){return this._grid.realizedRows[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeHeight},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleRow();i&&(t=i.getContextualWidth(),this.scroll(i,t,e))}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedRowHeaders,t,i),this.scrollCells(e._realizedBodyCells,t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;a>r;r++)e[r].scrollVertically(t,i)},i.prototype.getFooterContextualWidth=function(){return this.owner.owner.rowDimension.hasFooter()&&this.owner.grid.footerRow?this.owner.grid.footerRow.getContextualWidth():0},i.prototype.calculateContextualWidths=function(){if(e.prototype.calculateContextualWidths.call(this),this.fixedSizeEnabled){var t=this._grid.footerRow;t&&this._calculateSize(t)}},i.prototype.fixSizes=function(){e.prototype.fixSizes.call(this),this.fixedSizeEnabled&&this._grid.footerRow&&this._grid.footerRow.fixSize()},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateRowDimensions(i/a,(t-i)/a,e/a,this.getViewSize(e),this._grid.footerRow?this._grid.footerRow.getContextualWidth()/a:0)},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i}(o);i.RowLayoutManager=u;var h=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.getHeaderWidth(t)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){return e.calculateSize()},t.prototype.getHeaderWidth=function(e){return 0!==e||this.owner.binder.hasRowGroups()?this.owner.getEstimatedTextWidth(void 0):0},t}(u);i.DashboardRowLayoutManager=h;var d=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},i.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,o._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,o._pixelPrecision)},i.prototype._calculateSize=function(e){return e.calculateSize()},i}(u);i.CanvasRowLayoutManager=d;var p=function(){function e(e,t,i,a){this._allowHeaderResize=!0,this._binder=e,this._grid=t,this._columnLayoutManager=i,this._rowLayoutManager=a,this._columnWidthsToPersist=[]}return e.prototype.initialize=function(e){this._owner=e,this._container=e.container,this._gridHost=e.contentHost,this._footersHost=e.footerHost,this._grid.initialize(e,this._gridHost,this._footersHost)},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnWidthsToPersist",{get:function(){return this._columnWidthsToPersist},set:function(e){this._columnWidthsToPersist=e},enumerable:!0,configurable:!0}),e.prototype.getTablixClassName=function(){return null},e.prototype.getLayoutKind=function(){return null},e.prototype.getOrCreateColumnHeader=function(e,t,i,a){var r=this.owner.hierarchyNavigator,o=this._grid.getOrCreateRow(i),n=this._grid.getOrCreateColumn(a+this._columnLayoutManager._gridOffset),s=r.isLeaf(e),l=o.getOrCreateColumnHeader(n,this._columnLayoutManager.isScrollableHeader(e,t,a),s),c=r.getLevel(e);l.position.row.index=l.position.row.indexInSiblings=c,l.position.row.isFirst=0===c,l.position.row.isLast=s;var u=r.getIndex(e);return l.position.column.index=l.position.row.indexInSiblings=u,l.position.column.isFirst=r.areAllParentsFirst(e,t),l.position.column.isLast=r.areAllParentsLast(e,t),this.enableCellHorizontalResize(s,l),l},e.prototype.getOrCreateRowHeader=function(e,t,i,a){var r=this.owner.hierarchyNavigator,o=this._grid.getOrCreateRow(i+this._rowLayoutManager._gridOffset),n=this._grid.getOrCreateColumn(a),s=r.isLeaf(e),l=this._rowLayoutManager.isScrollableHeader(e,t,i);0===o.getRealizedCellCount()&&this.alignRowHeaderCells(e,o);var c=o.getOrCreateRowHeader(n,l,r.isLeaf(e)),u=r.getIndex(e);c.position.row.index=c.position.row.indexInSiblings=u,c.position.row.isFirst=r.areAllParentsFirst(e,t),c.position.row.isLast=r.areAllParentsLast(e,t);var h=r.getLevel(e);return c.position.column.index=c.position.column.indexInSiblings=h,c.position.column.isFirst=0===h,c.position.column.isLast=s,c.enableHorizontalResize(!1,this._columnLayoutManager),c},e.prototype.getOrCreateCornerCell=function(e,t,i){var a=this._grid.getOrCreateRow(i),r=this._grid.getOrCreateColumn(t),o=this._columnLayoutManager.dimension.getDepth(),n=i===o-1,s=a.getOrCreateCornerCell(r),l=i;s.position.row.index=s.position.row.indexInSiblings=l,s.position.row.isFirst=0===l,s.position.row.isLast=n;var c=t;return s.position.column.index=s.position.column.indexInSiblings=c,s.position.column.isFirst=0===c,s.position.column.isLast=c===this._rowLayoutManager.dimension.getDepth()-1,this.enableCellHorizontalResize(n,s),s},e.prototype.getOrCreateBodyCell=function(e,t,i,a,r){var o,n=this._grid.getOrCreateRow(a+this._rowLayoutManager._gridOffset),s=this._grid.getOrCreateColumn(r+this._columnLayoutManager._gridOffset);o=0===n._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset()?!0:this._rowLayoutManager.isScrollableHeader(t,i,a);var l=n.getOrCreateBodyCell(s,o);return l.position=e.position,l.enableHorizontalResize(!1,this._columnLayoutManager),l},e.prototype.getOrCreateFooterBodyCell=function(e,t){var i,a=this._grid.getOrCreateFootersRow(),r=this._grid.getOrCreateColumn(t+this._columnLayoutManager._gridOffset);i=0===a._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset();var o=a.getOrCreateFooterBodyCell(r,i);return o.position=e.position,o.enableHorizontalResize(!1,this._columnLayoutManager),o},e.prototype.getOrCreateFooterRowHeader=function(e,t){var i=this._grid.getOrCreateFootersRow(),a=this._grid.getOrCreateColumn(0),r=i.getOrCreateFooterRowHeader(a);return r.position=void 0,r.enableHorizontalResize(!1,this._columnLayoutManager),r},e.prototype.getVisibleWidth=function(){return-1},e.prototype.getVisibleHeight=function(){return-1},e.prototype.updateColumnCount=function(e,t){},e.prototype.updateViewport=function(e){},e.prototype.getEstimatedRowHeight=function(){return-1},e.prototype.getCellWidth=function(e){return-1},e.prototype.getContentWidth=function(e){return-1},e.prototype.adjustContentSize=function(e){},e.prototype.alignRowHeaderCells=function(e,t){var i=t.getRowHeaderLeafIndex();if(-1!==i){var a=this._owner.rowDimension,r=a.getFirstVisibleChildLeaf(e);this.owner.hierarchyNavigator.headerItemEquals(r,t.getAllocatedCellAt(i).item)&&t.moveCellsBy(this.owner.hierarchyNavigator.getLevel(r)-this.owner.hierarchyNavigator.getLevel(e)-i)}},Object.defineProperty(e.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowLayoutManager",{get:function(){return this._rowLayoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnLayoutManager",{get:function(){return this._columnLayoutManager},enumerable:!0,configurable:!0}),e.prototype.showEmptySpaceHeader=function(){return!1},e.prototype.onStartRenderingSession=function(e,t,i){if(this.showEmptySpaceHeader()){var a=this._grid.emptySpaceHeaderCell;a&&this._binder.unbindEmptySpaceHeaderCell(a),a=this._grid.emptySpaceFooterCell,a&&this._binder.unbindEmptySpaceFooterCell(a),this._grid.HideEmptySpaceCells()}this._scrollingDimension=e,this._scrollingDimension&&this._scrollingDimension.layoutManager.startScrollingSession(),this._rowLayoutManager.onStartRenderingSession(),this._columnLayoutManager.onStartRenderingSession(),this._grid.onStartRenderingSession(i);var r=this._columnLayoutManager.measureEnabled||this._rowLayoutManager.measureEnabled;r&&this.measureSampleText(t)},e.prototype.onEndRenderingSession=function(){if(this._rowLayoutManager.onEndRenderingSession(),this._columnLayoutManager.onEndRenderingSession(),this._scrollingDimension&&this._scrollingDimension.layoutManager.endScrollingSession(),this._scrollingDimension=null,this.showEmptySpaceHeader()){var e=this._columnLayoutManager.contextualWidthToFill-this._columnLayoutManager.getGridContextualWidth();if(e>0){this._grid.ShowEmptySpaceCells(this._owner.columnDimension.getDepth(),e);var t=this._grid.emptySpaceHeaderCell;t&&this._binder.bindEmptySpaceHeaderCell(t),t=this._grid.emptySpaceFooterCell,t&&this._binder.bindEmptySpaceFooterCell(t)}}},e.prototype.onStartRenderingIteration=function(e){this._rowLayoutManager.onStartRenderingIteration(e,this.getVisibleHeight()),this._columnLayoutManager.onStartRenderingIteration(e,this.getVisibleWidth()),this._grid.onStartRenderingIteration()},e.prototype.onEndRenderingIteration=function(){return this._grid.onEndRenderingIteration(),this._columnLayoutManager.calculateSizes(),this._rowLayoutManager.calculateSizes(),this._columnLayoutManager.fixSizes(),this._rowLayoutManager.fixSizes(),this._columnLayoutManager.updateItemToResizeState(this._grid.realizedColumns),this._columnLayoutManager.applyScrolling(),this._rowLayoutManager.applyScrolling(),this._columnLayoutManager.onEndRenderingIteration(),this._rowLayoutManager.onEndRenderingIteration(),this._columnLayoutManager.done&&this._rowLayoutManager.done},e.prototype.onCornerCellRealized=function(e,t){var i=this.owner.hierarchyNavigator.isColumnHierarchyLeaf(e),a=this.owner.hierarchyNavigator.isRowHierarchyLeaf(e);i&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onCornerCellRealized(e,t,i),this._rowLayoutManager.onCornerCellRealized(e,t,a)},e.prototype.onRowHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e),r=t;r.colSpan>1&&r.setContainerWidth(-1),this._rowLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onRowHeaderFooterRealized=function(e,t){},e.prototype.onColumnHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e);a&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onBodyCellRealized=function(e,t){},e.prototype.onBodyCellFooterRealized=function(e,t){},e.prototype.setAllowHeaderResize=function(e){this._allowHeaderResize=e},e.prototype.enableCellHorizontalResize=function(e,t){var i=e&&this._allowHeaderResize;t.enableHorizontalResize(i,this._columnLayoutManager);
},e.prototype.getEstimatedTextWidth=function(e){return-1},e.prototype.measureSampleText=function(e){},e}();i.TablixLayoutManager=p;var g=function(o){function n(e,t,i,a,r){var n=new l(null,i,r),s=new h(null,i,a);o.call(this,e,i,n,s),n.owner=this,s.owner=this,this._sizeComputationManager=t}return __extends(n,o),n.createLayoutManager=function(e){var t=new r;return new n(e,t,new i.TablixGrid(new i.DashboardTablixGridPresenter(t)),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},n.prototype.getTablixClassName=function(){return"tablixDashboard"},n.prototype.getLayoutKind=function(){return 1},n.prototype.showEmptySpaceHeader=function(){return!1},n.prototype.measureSampleText=function(i){var r=e.TextMeasurementService.getSvgMeasurementProperties(i);this._characterHeight=e.TextMeasurementService.estimateSvgTextHeight(r),this._sizeComputationManager.updateRowHeight(this._characterHeight);var o=a.toPoint(parseFloat(r.fontSize)),n=o/t.TablixDefaultTextSize;this._sizeComputationManager.updateScalingFactor(e.Double.toIncrement(n,.05))},n.prototype.getVisibleWidth=function(){return this._sizeComputationManager.visibleWidth},n.prototype.getVisibleHeight=function(){return this._sizeComputationManager.visibleHeight},n.prototype.getCellWidth=function(e){return this._sizeComputationManager.cellWidth},n.prototype.getContentWidth=function(e){return this._sizeComputationManager.contentWidth},n.prototype.getEstimatedTextWidth=function(e){return this._sizeComputationManager.contentWidth},n.prototype.adjustContentSize=function(e){this._sizeComputationManager.hasImageContent=e},n.prototype.updateColumnCount=function(e,t){var i=e?e.getDepth():0,a=t?t.getItemsCount():0,r=i+a;this.binder.hasRowGroups()||r--,this._sizeComputationManager.updateColumnCount(r)},n.prototype.updateViewport=function(e){this._sizeComputationManager.updateViewport(e)},n.prototype.getEstimatedRowHeight=function(){return this._characterHeight},n}(p);i.DashboardTablixLayoutManager=g;var m=function(e){function a(t,i,a,r){var o=new c(null,i,r),n=new d(null,i,a);e.call(this,t,i,o,n),o.owner=this,n.owner=this}return __extends(a,e),a.createLayoutManager=function(e,r){return new a(e,new i.TablixGrid(new t.internal.CanvasTablixGridPresenter(r)),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},a.prototype.getTablixClassName=function(){return"tablixCanvas"},a.prototype.getLayoutKind=function(){return 0},a.prototype.measureSampleText=function(e){var i=t.internal.TablixUtils.createDiv();i.style.cssFloat="left",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.lineHeight="normal",e.appendChild(i);var a=document.createTextNode("a");i.appendChild(a),this.characterWidth=t.HTMLElementUtils.getElementWidth(i),this.characterHeight=t.HTMLElementUtils.getElementHeight(i),i.removeChild(a),e.removeChild(i)},a.prototype.showEmptySpaceHeader=function(){return!this._columnLayoutManager.fillProportionally},a.prototype.getVisibleWidth=function(){return this._columnLayoutManager.measureEnabled?this._owner.autoSizeWidth&&this._owner.maxWidth?this._owner.maxWidth:t.HTMLElementUtils.getElementWidth(this._container):-1},a.prototype.getVisibleHeight=function(){return this._rowLayoutManager.measureEnabled?this._owner.autoSizeHeight&&this._owner.maxHeight?this._owner.maxHeight:t.HTMLElementUtils.getElementHeight(this._container):-1},a.prototype.getCellWidth=function(e){return t.HTMLElementUtils.getElementWidth(e._presenter.tableCell)},a.prototype.getContentWidth=function(e){return t.HTMLElementUtils.getElementWidth(e._presenter.contentElement)},a.prototype.getEstimatedTextWidth=function(e){return e?e.length*this.characterWidth:0},a.prototype.updateColumnCount=function(e,t){},a.prototype.updateViewport=function(e){},a.prototype.getEstimatedRowHeight=function(){return this.characterHeight},a}(p);i.CanvasTablixLayoutManager=m}(i=t.internal||(t.internal={}))}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){if(e)for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function i(e,t){e.style.top=t+"px"}function a(e,t){e.style.left=t+"px"}function r(t,i){e.isAutoSize(i)?t.style.height="":t.style.height=i+"px"}function o(t,i){e.isAutoSize(i)?t.style.width="":t.style.width=i+"px"}function n(e){return e.offsetWidth}function s(e){return e.offsetHeight}function l(e){return-1===e}function c(t){for(var i=1;t;)i*=e.getScale(t),t=t.parentElement;return i}function u(e){e=$(e);var t=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");return t&&(t.match(/\d*\.\d*/)&&Number(t.match(/\d*\.\d*/)[0])||t.match(/\d+/)&&Number(t.match(/\d+/)[0]))||1}e.clearChildren=t,e.setElementTop=i,e.setElementLeft=a,e.setElementHeight=r,e.setElementWidth=o,e.getElementWidth=n,e.getElementHeight=s,e.isAutoSize=l,e.getAccumulatedScale=c,e.getScale=u}(t=e.HTMLElementUtils||(e.HTMLElementUtils={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var a;!function(a){var r,o=InJs.DomFactory,n=e.data.DataViewObjectDefinitions,s=e.data.DataViewRoleWildcard;!function(t){function a(e){return e&&e.metadata?e.metadata.objects:null}function r(e,a,r){if(r===i.TablixType.Table){for(var o=S(a),n=0,l=o;n<l.length;n++){var c=l[n],u={selector:{data:[s.fromRoles(["Values"])],metadata:c.queryName},objects:(h={},h[t.ObjectValues]={formattingProperties:[t.PropValuesBackColor.propertyName]},h)};e.push(u)}var h}}function o(e,r,o,n){var s=a(o),m=!0;switch(m=n===i.TablixType.Table?C(o)&&b(s):D(o)&&P(s)||w(o)&&x(s),e.objectName){case t.ObjectGeneral:l(r,s,n,o);break;case t.ObjectGrid:c(r,s,n);break;case t.ObjectColumnHeaders:u(r,s);break;case t.ObjectRowHeaders:h(r,s);break;case t.ObjectValues:d(r,s,n);break;case t.ObjectTotal:m&&p(r,s);break;case t.ObjectSubTotals:m&&g(r,s)}}function l(e,a,r,o){var n={selector:null,objectName:t.ObjectGeneral,properties:{autoSizeColumnWidth:t.PropGeneralAutoSizeColumns.getValue(a),textSize:t.PropGeneralTextSize.getValue(a)}},s=n.properties;switch(r){case i.TablixType.Table:C(o)&&(s[t.PropGeneralTableTotals.propertyName]=b(a));break;case i.TablixType.Matrix:w(o)&&(s[t.PropGeneralMatrixRowSubtotals.propertyName]=x(a)),D(o)&&(s[t.PropGeneralMatrixColumnSubtotals.propertyName]=P(a))}e.pushInstance(n)}function c(e,a,r){var o={selector:null,objectName:t.ObjectGeneral,properties:{}},n=o.properties,s=t.PropGridVertical.getValue(a);n[t.PropGridVertical.propertyName]=s,s&&(n[t.PropGridVerticalColor.propertyName]=t.PropGridVerticalColor.getValue(a),n[t.PropGridVerticalWeight.propertyName]=t.PropGridVerticalWeight.getValue(a));var l=(r===i.TablixType.Table?t.PropGridHorizontalTable:t.PropGridHorizontalMatrix).getValue(a);n[(r===i.TablixType.Table?t.PropGridHorizontalTable:t.PropGridHorizontalMatrix).propertyName]=l,l&&(n[t.PropGridHorizontalColor.propertyName]=t.PropGridHorizontalColor.getValue(a),n[t.PropGridHorizontalWeight.propertyName]=t.PropGridHorizontalWeight.getValue(a)),n[t.PropGridRowPadding.propertyName]=t.PropGridRowPadding.getValue(a),n[t.PropGridOutlineColor.propertyName]=t.PropGridOutlineColor.getValue(a),n[t.PropGridOutlineWeight.propertyName]=t.PropGridOutlineWeight.getValue(a),n[t.PropGridImageHeight.propertyName]=t.PropGridImageHeight.getValue(a),e.pushInstance(o)}function u(e,i){e.pushInstance({selector:null,objectName:t.ObjectColumnHeaders,properties:{fontColor:t.PropColumnsFontColor.getValue(i),backColor:t.PropColumnsBackColor.getValue(i),outline:t.PropColumnsOutline.getValue(i)}})}function h(e,i){e.pushInstance({selector:null,objectName:t.ObjectRowHeaders,properties:{fontColor:t.PropRowsFontColor.getValue(i),backColor:t.PropRowsBackColor.getValue(i),outline:t.PropRowsOutline.getValue(i)}})}function d(e,a,r){var o={selector:null,objectName:t.ObjectValues,properties:{fontColorPrimary:t.PropValuesFontColorPrimary.getValue(a),backColorPrimary:t.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(a),backColorSecondary:t.PropValuesBackColorSecondary.getValue(a),outline:t.PropValuesOutline.getValue(a)}};r===i.TablixType.Table&&(o.properties[t.PropValuesUrlIconProp.propertyName]=t.PropValuesUrlIconProp.getValue(a)),e.pushInstance(o)}function p(e,i){e.pushInstance({selector:null,objectName:t.ObjectTotal,properties:{fontColor:t.PropTotalFontColor.getValue(i),backColor:t.PropTotalBackColor.getValue(i),outline:t.PropTotalOutline.getValue(i)}})}function g(e,i){e.pushInstance({selector:null,objectName:t.ObjectSubTotals,properties:{fontColor:t.PropSubTotalsFontColor.getValue(i),backColor:t.PropSubTotalsBackColor.getValue(i)}})}function m(e){var i=a(e),r={general:{autoSizeColumnWidth:t.PropGeneralAutoSizeColumns.getValue(i),textSize:t.PropGeneralTextSize.getValue(i),totals:b(i)}};return r.grid={gridVertical:t.PropGridVertical.getValue(i),gridVerticalColor:t.PropGridVerticalColor.getValue(i),gridVerticalWeight:t.PropGridVerticalWeight.getValue(i),gridHorizontal:t.PropGridHorizontalTable.getValue(i),gridHorizontalColor:t.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:t.PropGridHorizontalWeight.getValue(i),outlineColor:t.PropGridOutlineColor.getValue(i),outlineWeight:t.PropGridOutlineWeight.getValue(i),rowPadding:t.PropGridRowPadding.getValue(i),imageHeight:t.PropGridImageHeight.getValue(i)},r.columnHeaders={fontColor:t.PropColumnsFontColor.getValue(i),backColor:t.PropColumnsBackColor.getValue(i),outline:t.PropColumnsOutline.getValue(i)},r.values={fontColorPrimary:t.PropValuesFontColorPrimary.getValue(i),backColorPrimary:t.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(i),backColorSecondary:t.PropValuesBackColorSecondary.getValue(i),outline:t.PropValuesOutline.getValue(i),urlIcon:t.PropValuesUrlIconProp.getValue(i)},r.total={fontColor:t.PropTotalFontColor.getValue(i),backColor:t.PropTotalBackColor.getValue(i),outline:t.PropTotalOutline.getValue(i)},r}function f(e){var i=a(e),r={general:{autoSizeColumnWidth:t.PropGeneralAutoSizeColumns.getValue(i),textSize:t.PropGeneralTextSize.getValue(i),rowSubtotals:x(i),columnSubtotals:P(i)}};return r.grid={gridVertical:t.PropGridVertical.getValue(i),gridVerticalColor:t.PropGridVerticalColor.getValue(i),gridVerticalWeight:t.PropGridVerticalWeight.getValue(i),gridHorizontal:t.PropGridHorizontalMatrix.getValue(i),gridHorizontalColor:t.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:t.PropGridHorizontalWeight.getValue(i),outlineColor:t.PropGridOutlineColor.getValue(i),outlineWeight:t.PropGridOutlineWeight.getValue(i),rowPadding:t.PropGridRowPadding.getValue(i),imageHeight:t.PropGridImageHeight.getValue(i)},r.columnHeaders={fontColor:t.PropColumnsFontColor.getValue(i),backColor:t.PropColumnsBackColor.getValue(i),outline:t.PropColumnsOutline.getValue(i)},r.rowHeaders={fontColor:t.PropRowsFontColor.getValue(i),backColor:t.PropRowsBackColor.getValue(i),outline:t.PropRowsOutline.getValue(i)},r.values={fontColorPrimary:t.PropValuesFontColorPrimary.getValue(i),backColorPrimary:t.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(i),backColorSecondary:t.PropValuesBackColorSecondary.getValue(i),outline:t.PropValuesOutline.getValue(i)},r.subtotals={fontColor:t.PropSubTotalsFontColor.getValue(i),backColor:t.PropSubTotalsBackColor.getValue(i),outline:t.PropSubTotalsOutline.getValue(i)},r}function y(e){return{general:[{selector:null,properties:{textSize:n.encodePropertyValue(12,{numeric:!0}),totals:n.encodePropertyValue(!1,{bool:!0})}}]}}function v(e){return jsCommon.PixelConverter.fromPoint(e)}function b(e){return t.PropGeneralTableTotals.getValue(e)}function C(e){if(e&&e.table&&!_.isEmpty(e.table.columns)){var t=e.table.columns;if(_.some(t,function(e){return e.discourageAggregationAcrossGroups}))return!1}return!0}function S(e){return e&&e.table&&!_.isEmpty(e.table.columns)?e.table.columns:void 0}function x(e){return t.PropGeneralMatrixRowSubtotals.getValue(e)}function w(e){return!(e&&e.matrix&&e.matrix.rows&&L(e.matrix.rows.levels))}function P(e){return t.PropGeneralMatrixColumnSubtotals.getValue(e)}function D(e){return!(e&&e.matrix&&e.matrix.columns&&L(e.matrix.columns.levels))}function L(e){var t=_.last(e);return t&&_.some(t.sources,function(e){return e.discourageAggregationAcrossGroups})}t.ObjectGeneral="general",t.ObjectGrid="grid",t.ObjectColumnHeaders="columnHeaders",t.ObjectRowHeaders="rowHeaders",t.ObjectValues="values",t.ObjectTotal="total",t.ObjectSubTotals="subTotals";var T=function(){function e(e,t,i,a){this.objectName=e,this.propertyName=t,this.defaultValue=i,this.getterFuntion=a}return e.prototype.getPropertyID=function(){return{objectName:this.objectName,propertyName:this.propertyName}},e.prototype.getValue=function(e){return this.getterFuntion(e,this.getPropertyID(),this.defaultValue)},e}();t.TablixProperty=T,t.PropColumnFormatString=new T(t.ObjectGeneral,"formatString",void 0,e.DataViewObjects.getValue),t.PropGeneralAutoSizeColumns=new T(t.ObjectGeneral,"autoSizeColumnWidth",!0,e.DataViewObjects.getValue),t.PropGeneralTextSize=new T(t.ObjectGeneral,"textSize",8,e.DataViewObjects.getValue),t.PropGeneralTableTotals=new T(t.ObjectGeneral,"totals",!0,e.DataViewObjects.getValue),t.PropGeneralMatrixRowSubtotals=new T(t.ObjectGeneral,"rowSubtotals",!0,e.DataViewObjects.getValue),t.PropGeneralMatrixColumnSubtotals=new T(t.ObjectGeneral,"columnSubtotals",!0,e.DataViewObjects.getValue),t.PropGridVertical=new T(t.ObjectGrid,"gridVertical",!1,e.DataViewObjects.getValue),t.PropGridVerticalColor=new T(t.ObjectGrid,"gridVerticalColor","#E8E8E8",e.DataViewObjects.getFillColor),t.PropGridVerticalWeight=new T(t.ObjectGrid,"gridVerticalWeight",1,e.DataViewObjects.getValue),t.PropGridHorizontalTable=new T(t.ObjectGrid,"gridHorizontal",!0,e.DataViewObjects.getValue),t.PropGridHorizontalMatrix=new T(t.ObjectGrid,"gridHorizontal",!1,e.DataViewObjects.getValue),t.PropGridHorizontalColor=new T(t.ObjectGrid,"gridHorizontalColor","#E8E8E8",e.DataViewObjects.getFillColor),t.PropGridHorizontalWeight=new T(t.ObjectGrid,"gridHorizontalWeight",1,e.DataViewObjects.getValue),t.PropGridRowPadding=new T(t.ObjectGrid,"rowPadding",0,e.DataViewObjects.getValue),t.PropGridOutlineColor=new T(t.ObjectGrid,"outlineColor","#CCC",e.DataViewObjects.getFillColor),t.PropGridOutlineWeight=new T(t.ObjectGrid,"outlineWeight",1,e.DataViewObjects.getValue),t.PropGridImageHeight=new T(t.ObjectGrid,"imageHeight",75,e.DataViewObjects.getValue),t.PropColumnsFontColor=new T(t.ObjectColumnHeaders,"fontColor","#666",e.DataViewObjects.getFillColor),t.PropColumnsBackColor=new T(t.ObjectColumnHeaders,"backColor",void 0,e.DataViewObjects.getFillColor),t.PropColumnsOutline=new T(t.ObjectColumnHeaders,"outline","BottomOnly",e.DataViewObjects.getValue),t.PropRowsFontColor=new T(t.ObjectRowHeaders,"fontColor","#666",e.DataViewObjects.getFillColor),t.PropRowsBackColor=new T(t.ObjectRowHeaders,"backColor",void 0,e.DataViewObjects.getFillColor),t.PropRowsOutline=new T(t.ObjectRowHeaders,"outline","RightOnly",e.DataViewObjects.getValue),t.PropValuesBackColor=new T(t.ObjectValues,"backColor",void 0,e.DataViewObjects.getFillColor),t.PropValuesFontColorPrimary=new T(t.ObjectValues,"fontColorPrimary","#333",e.DataViewObjects.getFillColor),t.PropValuesBackColorPrimary=new T(t.ObjectValues,"backColorPrimary",void 0,e.DataViewObjects.getFillColor),t.PropValuesFontColorSecondary=new T(t.ObjectValues,"fontColorSecondary","#333",e.DataViewObjects.getFillColor),t.PropValuesBackColorSecondary=new T(t.ObjectValues,"backColorSecondary",void 0,e.DataViewObjects.getFillColor),t.PropValuesOutline=new T(t.ObjectValues,"outline","None",e.DataViewObjects.getValue),t.PropValuesUrlIconProp=new T(t.ObjectValues,"urlIcon",!1,e.DataViewObjects.getValue),t.PropTotalFontColor=new T(t.ObjectTotal,"fontColor","#333",e.DataViewObjects.getFillColor),t.PropTotalBackColor=new T(t.ObjectTotal,"backColor",void 0,e.DataViewObjects.getFillColor),t.PropTotalOutline=new T(t.ObjectTotal,"outline","TopOnly",e.DataViewObjects.getValue),t.PropSubTotalsFontColor=new T(t.ObjectSubTotals,"fontColor","#333",e.DataViewObjects.getFillColor),t.PropSubTotalsBackColor=new T(t.ObjectSubTotals,"backColor",void 0,e.DataViewObjects.getFillColor),t.PropSubTotalsOutline=new T(t.ObjectSubTotals,"outline","TopOnly",e.DataViewObjects.getValue),t.getMetadadataObjects=a,t.enumerateObjectRepetition=r,t.enumerateObjectInstances=o,t.enumerateGeneralOptions=l,t.enumerateGridOptions=c,t.enumerateColumnHeadersOptions=u,t.enumerateRowHeadersOptions=h,t.enumerateValuesOptions=d,t.enumerateTotalOptions=p,t.enumerateSubTotalsOptions=g,t.getTableObjects=m,t.getMatrixObjects=f,t.generateTablixDefaultObjects=y,t.getTextSizeInPx=v,t.shouldShowTableTotals=b,t.shouldShowRowSubtotals=x,t.shouldShowColumnSubtotals=P,t.shouldShowColumnSubtotalsOption=D,t.isDiscourageAggregationAcrossGroups=L}(r=a.TablixObjects||(a.TablixObjects={}));var l;!function(e){function n(){return document.createElement("table")}function s(){var e=document.createElement("div");return e.className="tablixDiv",e}function l(t){t.extension.contentElement.className=e.CssClassTablixDiv+" "+e.CssClassContentElement,t.extension.contentHost.className=e.CssClassTablixDiv+" "+e.CssClassContentHost}function c(e,t){e.extension.contentHost.className+=" "+t}function u(e){e.extension.contentHost.className="",e.extension.contentHost.style.cssText=""}function h(e){e.extension.contentHost.textContent="",e.extension.contentHost.removeAttribute("title"),e.contentHeight=e.contentWidth=0,i.HTMLElementUtils.clearChildren(e.extension.contentHost)}function d(e,i,a){var r=t.TextUtil.replaceSpaceWithNBSP(e);i.textContent=r,(a||i).title=r}function p(e){var t=e.target,i=e.offsetX;return i>=0&&i<t.offsetWidth-a.TablixResizer.resizeHandleSize}function g(t,i,a){var r=null;0===i.childElementCount?(r=document.createElement("a"),i.appendChild(r)):r=i.children[0],r.href=t,r.target="_blank",r.title=t,a===!0?(r.className=e.CssClassValueURLIcon,i.className=e.CssClassValueURLIconContainer):r.innerText=t}function m(t,i,a){var r=e.createDiv(),o=document.createElement("img");r.style.height=a+"px",r.style.width="100%",r.style.textAlign="center",o.src=t,o.style.maxHeight="100%",o.style.maxWidth="100%",r.appendChild(o),i.appendChild(r),i.title=t}function f(e,i){var a=t.KpiUtil.getClassForKpi(e,i)||"";return o.div().addClass(a).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}function y(e,i){return e&&void 0!==i?!!t.KpiUtil.getClassForKpi(e,i):!1}function v(e,t){var i=[{queryName:e,sortDirection:t}];return{sortDescriptors:i}}function b(e){return 2===e?1:2}function C(t,i){var a=e.createDiv();t?(a.appendChild(S(t,!0)),a.appendChild(S(b(t),!1))):a.appendChild(S(2,!1));var r=e.createDiv();return a.appendChild(r),i.appendChild(a),r}function S(e,t){var i=document.createElement("i");return i.className=P+" "+(t?"sorted":"future")+" "+(1===e?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),i}function x(e){for(var t=0,i=e.extension.contentElement.childElementCount;i>t;t++){var a=e.extension.contentElement.children.item(t);if(a.classList.contains(P))return!0}return!1}function w(e){x(e)&&$(e.extension.contentElement).find("."+P).remove()}e.CssClassTablixDiv="tablixDiv",e.CssClassContentElement="tablixCellContentElement",e.CssClassContentHost="tablixCellContentHost",e.CssClassTablixHeader="tablixHeader",e.CssClassTablixColumnHeaderLeaf="tablixColumnHeaderLeaf",e.CssClassTablixValueNumeric="tablixValueNumeric",e.CssClassTablixValueTotal="tablixValueTotal",e.CssClassValueURLIcon="powervisuals-glyph url-icon tablixUrlIconGlyph",e.CssClassValueURLIconContainer="tablixValueUrlIcon",e.CssClassMatrixRowHeaderLeaf="matrixRowHeaderLeaf",e.CssClassMatrixRowHeaderSubTotal="matrixRowHeaderSubTotal",e.CssClassTableFooter="tableFooterCell",e.CssClassTableBodyCell="tableBodyCell",e.CssClassTableBodyCellBottom="tableBodyCellBottom",e.StringNonBreakingSpace="&nbsp;",e.UnitOfMeasurement="px";var P="tablixSortIconContainer";e.CellPaddingLeft=10,e.CellPaddingRight=5,e.CellPaddingLeftMatrixTotal=5,e.FontFamilyCell="'Segoe UI','wf_segoe-ui_normal', helvetica, arial, sans-serif",e.FontFamilyHeader="'Segoe UI','wf_segoe-ui_normal', helvetica, arial, sans-serif",e.FontFamilyTotal="'Segoe UI Bold','wf_segoe-ui_bold', helvetica, arial, sans-serif",e.FontColorCells="#333",e.FontColorHeaders="#666",function(e){e[e.Outline=0]="Outline",e[e.Gridline=1]="Gridline"}(e.EdgeType||(e.EdgeType={}));var D=e.EdgeType,L=function(){function t(e,t){this.applyParams(!0,e,t)}return t.prototype.applyParams=function(e,t,i,a){e?(this.weight=null==t?0:t,this.color=null==i?"black":i,this.type=null==a?D.Gridline:a):(this.weight=0,this.color="black",this.type=D.Gridline)},t.prototype.getCSS=function(){var t=[];return _.isNumber(this.weight)&&(t.push(this.weight+e.UnitOfMeasurement),this.color&&t.push(this.color),t.push("solid")),t.join(" ")},t.prototype.getPriority=function(e){return this===e.top||this===e.bottom?this.type===D.Outline?2:0:this===e.right||this===e.left?this.type===D.Outline?3:1:-1},t.prototype.getShadowCss=function(t){var i="inset ";if(this===t.left)i+=this.weight+e.UnitOfMeasurement+" 0";else if(this===t.right)i+="-"+this.weight+e.UnitOfMeasurement+" 0";else if(this===t.top)i+="0 "+this.weight+e.UnitOfMeasurement;else{if(this!==t.bottom)return"";i+="0 -"+this.weight+e.UnitOfMeasurement}return i+" 0 0 "+this.color},t}();e.EdgeSettings=L;var T=function(){function t(){this.borders={},this.paddings={top:0,left:e.CellPaddingLeft,bottom:0,right:e.CellPaddingRight},this.fontFamily="",this.fontColor="",this.backColor="",this.hasImage=!1}return t.prototype.applyStyle=function(t){var i=this,a=t.extension.contentHost,r=a.style;r.fontFamily=this.fontFamily,r.color=this.fontColor,r.backgroundColor=this.backColor;var o=[this.borders.top,this.borders.right,this.borders.bottom,this.borders.left];o=_.sortBy(o,function(e){return e?e.getPriority(i.borders):-1}).reverse(),r.boxShadow=_.map(o,function(e){return e?e.getShadowCss(i.borders):void 0}).join(", "),r.border="none",r.paddingTop=(null==this.paddings.top?0:this.paddings.top)+(null==this.borders.top?0:this.borders.top.weight)+e.UnitOfMeasurement,r.paddingRight=(null==this.paddings.right?e.CellPaddingRight:this.paddings.right)+(null==this.borders.right?0:this.borders.right.weight)+e.UnitOfMeasurement,r.paddingBottom=(null==this.paddings.bottom?0:this.paddings.bottom)+(null==this.borders.bottom?0:this.borders.bottom.weight)+e.UnitOfMeasurement,r.paddingLeft=(null==this.paddings.left?e.CellPaddingLeft:this.paddings.left)+(null==this.borders.left?0:this.borders.left.weight)+e.UnitOfMeasurement},t.prototype.getExtraTop=function(){var e=0;return this.paddings.top&&(e+=this.paddings.top),this.borders.top&&(e+=this.borders.top.weight),e},t.prototype.getExtraBottom=function(){var e=0;return this.paddings.bottom&&(e+=this.paddings.bottom),this.borders.bottom&&(e+=this.borders.bottom.weight),e},t.prototype.getExtraRight=function(){var e=0;return this.paddings.right&&(e+=this.paddings.right),this.borders.right&&(e+=this.borders.right.weight),e},t.prototype.getExtraLeft=function(){var e=0;return this.paddings.left&&(e+=this.paddings.left),this.borders.left&&(e+=this.borders.left.weight),e},t}();e.CellStyle=T;var V=function(){function e(){}return e}();e.DimensionPosition=V;var M=function(){function e(){this.row=new V,this.column=new V}return e.prototype.isMatch=function(e){return this.column.index===e.column.index&&this.row.index===e.row.index},e}();e.CellPosition=M;var N=function(){function i(t,i,a,r,o){this.dataPoint=t,this.columnMetadata=a,this.formatter=r,this.isTotal=i,this.nullsAreBlank=o,this.position=new e.CellPosition}return Object.defineProperty(i.prototype,"textContent",{get:function(){return this.formatter?this.formatter(this.dataPoint,this.columnMetadata,r.PropColumnFormatString.getPropertyID(),this.nullsAreBlank):null!=this.dataPoint?this.dataPoint:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kpiContent",{get:function(){return this.columnMetadata&&y(this.columnMetadata.kpi,this.textContent)?f(this.columnMetadata.kpi,this.textContent):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isNumeric",{get:function(){return this.columnMetadata?this.columnMetadata.type.numeric&&!this.columnMetadata.kpi:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isUrl",{get:function(){return this.columnMetadata?t.converterHelper.isWebUrlColumn(this.columnMetadata):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isImage",{get:function(){return this.columnMetadata?t.converterHelper.isImageUrlColumn(this.columnMetadata):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isValidUrl",{get:function(){return jsCommon.UrlUtils.isValidImageUrl(this.textContent)},enumerable:!0,configurable:!0}),i.prototype.isMatch=function(e){return this.position.isMatch(e.position)&&this.backColor===e.backColor},i}();e.TablixVisualCell=N,e.createTable=n,e.createDiv=s,e.resetCellCssClass=l,e.addCellCssClass=c,e.clearCellStyle=u,e.clearCellTextAndTooltip=h,e.setCellTextAndTooltip=d,e.isValidSortClick=p,e.appendATagToBodyCell=g,e.appendImgTagToBodyCell=m,e.createKpiDom=f,e.isValidStatusGraphic=y,e.getCustomSortEventArgs=v,e.reverseSort=b,e.addSortIconToColumnHeader=C,e.removeSortIcons=w}(l=a.TablixUtils||(a.TablixUtils={}))}(a=i.internal||(i.internal={}))}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){e.TablixDefaultTextSize=jsCommon.TextSizeDefaults.TextSizeMin;var t=function(){function t(i,a,r,o,n){var s=this;this.scrollBarElementWidth=9,this.options=n;var l=n.interactive;this.isTouchEnabled=l&&n.enableTouchSupport,this.mainDiv=e.internal.TablixUtils.createDiv(),this.mainDiv.classList.add(t.TablixTableAreaClassName),this.footerDiv=e.internal.TablixUtils.createDiv(),this.footerDiv.classList.add(t.TablixFooterClassName),this.isTouchEnabled&&this.InitializeTouchSupport(),this.gridDimensions={},this.containerElement=e.internal.TablixUtils.createDiv(),this.className=a.getTablixClassName(),this.autoSizeWidth=!1,this.autoSizeHeight=!1,this.fontFamily=e.internal.TablixUtils.FontFamilyCell,this.fontColor=e.internal.TablixUtils.FontColorCells,this.fontSize=n.fontSize,o.className=t.TablixContainerClassName,o.appendChild(this.containerElement),this.containerElement.addEventListener("mousewheel",function(e){s.onMouseWheel(e)}),this.containerElement.addEventListener("DOMMouseScroll",function(e){s.onFireFoxMouseWheel(e)}),this.containerElement.appendChild(this.mainDiv),this.containerElement.appendChild(this.footerDiv),this.isTouchEnabled&&(this.touchInterpreter.initTouch(this.mainDiv,null,!1),this.footerTouchInterpreter.initTouch(this.footerDiv,this.mainDiv,!1)),this.controlLayoutManager=a,this.controlLayoutManager.initialize(this),this.hierarchyTablixNavigator=i,this.binder=r,this.columnDim=new e.TablixColumnDimension(this),this.rowDim=new e.TablixRowDimension(this),this.columnDim._otherDimension=this.rowDimension,this.rowDim._otherDimension=this.columnDimension,this.InitializeScrollbars(),l||(this.scrollbarWidth=0),this.updateHorizontalPosition(),this.updateVerticalPosition(),this.updateFooterVisibility(),this.lastRenderingArgs={}}return t.prototype.InitializeTouchSupport=function(){this.touchManager=new e.TouchUtils.TouchManager,this.touchInterpreter=new e.TouchUtils.TouchEventInterpreter(this.touchManager),this.footerTouchInterpreter=new e.TouchUtils.TouchEventInterpreter(this.touchManager),this.columnTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this.rowTouchDelegate=new e.RowTouchDelegate(new e.TouchUtils.Rectangle),this.bodyTouchDelegate=new e.BodyTouchDelegate(new e.TouchUtils.Rectangle),this.footerTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this.columnTouchDelegate.setHandler(this,this.onTouchEvent),this.rowTouchDelegate.setHandler(this,this.onTouchEvent),this.bodyTouchDelegate.setHandler(this,this.onTouchEvent),this.footerTouchDelegate.setHandler(this,this.onTouchEvent),this.touchManager.addTouchRegion(this.columnTouchDelegate.dimension,this.columnTouchDelegate,this.columnTouchDelegate),this.touchManager.addTouchRegion(this.rowTouchDelegate.dimension,this.rowTouchDelegate,this.rowTouchDelegate),this.touchManager.addTouchRegion(this.bodyTouchDelegate.dimension,this.bodyTouchDelegate,this.bodyTouchDelegate),this.touchManager.addTouchRegion(this.footerTouchDelegate.dimension,this.footerTouchDelegate,this.footerTouchDelegate)},t.prototype.InitializeScrollbars=function(){this.rowDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var e=this.rowDim.scrollbar.element.style;e.position="absolute",e.top="0"+t.UnitOfMeasurement,e.right="0"+t.UnitOfMeasurement,this.rowDim.scrollbar.width=this.scrollBarElementWidth+t.UnitOfMeasurement,this.rowDim.scrollbar.show(!0),this.columnDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var i=this.columnDim.scrollbar.element.style;i.position="absolute",i.left="0"+t.UnitOfMeasurement,i.bottom="0"+t.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+t.UnitOfMeasurement,this.columnDim.scrollbar.show(!1)},Object.defineProperty(t.prototype,"container",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentHost",{get:function(){return this.mainDiv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"footerHost",{get:function(){return this.footerDiv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{set:function(e){this.containerElement.className=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hierarchyNavigator",{get:function(){return this.hierarchyTablixNavigator},enumerable:!0,configurable:!0}),t.prototype.getBinder=function(){return this.binder},Object.defineProperty(t.prototype,"autoSizeWidth",{get:function(){return this._autoSizeWidth},set:function(e){this._autoSizeWidth=e,e||(this.containerElement.style.minWidth=this.containerElement.style.maxWidth="none")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoSizeHeight",{get:function(){return this._autoSizeHeight},set:function(e){e||(this.containerElement.style.minHeight=this.containerElement.style.maxHeight="none")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.maximumWidth},set:function(e){this.maximumWidth=e,this.containerElement.style.maxWidth=this.maximumWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewport",{get:function(){return this.viewPort},set:function(e){this.viewPort=e,this.containerElement.style.width=this.viewPort.width+t.UnitOfMeasurement,this.containerElement.style.height=this.viewPort.height+t.UnitOfMeasurement,this.rowDim.scrollbar.invalidateArrange(),this.columnDim.scrollbar.invalidateArrange(),this.controlLayoutManager.updateViewport(this.viewPort)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this.maximumHeight},set:function(e){this.maximumHeight=e,this.containerElement.style.maxHeight=this.maximumHeight+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.minimumWidth},set:function(e){this.minimumWidth=e,this.containerElement.style.minWidth=this.minimumWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.minimumHeight},set:function(e){this.minimumHeight=e,this.containerElement.style.minHeight=this.minimumHeight+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.textFontSize;
},set:function(e){this.textFontSize=e?e:t.DefaultFontSize,this.containerElement.style.fontSize=this.textFontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.textFontFamily},set:function(e){this.textFontFamily=e,this.containerElement.style.fontFamily=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontColor",{get:function(){return this.textFontColor},set:function(e){this.textFontColor=e,this.containerElement.style.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollbarWidth",{set:function(e){this.scrollBarElementWidth=e,this.rowDim.scrollbar.width=this.scrollBarElementWidth+t.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),t.prototype.updateModels=function(e,t,i){this.rowDim.model=t,this.rowDim.modelDepth=this.hierarchyNavigator.getRowHierarchyDepth(),this.columnDim.model=i,this.columnDim.modelDepth=this.hierarchyNavigator.getColumnHierarchyDepth(),e&&(this.rowDim.scrollOffset=0,this.columnDim.scrollOffset=0),this.layoutManager.updateColumnCount(this.rowDim,this.columnDim)},t.prototype.updateColumnDimensions=function(e,t,i){var a=this.gridDimensions;a.columnCount=i,a.rowHierarchyWidth=e,a.columnHierarchyWidth=t},t.prototype.updateRowDimensions=function(e,t,i,a,r){var o=this.gridDimensions;o.rowCount=a,o.rowHierarchyHeight=t,o.rowHierarchyContentHeight=i,o.columnHierarchyHeight=e,o.footerHeight=r},t.prototype.updateTouchDimensions=function(){var e=this.gridDimensions;this.columnTouchDelegate.resize(e.rowHierarchyWidth,0,e.columnHierarchyWidth,e.columnHierarchyHeight),this.columnTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth),this.rowTouchDelegate.resize(0,e.columnHierarchyHeight,e.rowHierarchyWidth,e.rowHierarchyHeight),this.rowTouchDelegate.setScrollDensity(e.rowCount/e.rowHierarchyHeight),this.bodyTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight,e.columnHierarchyWidth,e.rowHierarchyHeight),this.bodyTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth,e.rowCount/e.rowHierarchyHeight),this.footerTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight+e.rowHierarchyHeight,e.columnHierarchyWidth,e.footerHeight),this.footerTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth)},t.prototype.onMouseWheel=function(e){this.determineDimensionToScroll(e,function(e,t){e.scrollbar.onMouseWheel(t)}),e.preventDefault()},t.prototype.onFireFoxMouseWheel=function(e){this.determineDimensionToScrollFirefox(e,function(e,t){e.scrollbar.onMouseWheel(t)}),e.preventDefault()},t.prototype.determineDimensionToScroll=function(e,t){this.rowDim.scrollbar.visible?(e.wheelDeltaY&&t(this.rowDim,e.wheelDeltaY),e.wheelDeltaX&&this.columnDim.scrollbar.visible&&t(this.columnDim,e.wheelDeltaX)):this.columnDim.scrollbar.visible&&(e.wheelDeltaX?t(this.columnDim,e.wheelDeltaX):e.wheelDeltaY&&t(this.columnDim,e.wheelDeltaY))},t.prototype.determineDimensionToScrollFirefox=function(e,t){if(e.detail){if(this.rowDim.scrollbar.visible)return void t(this.rowDim,-e.detail);if(this.columnDim.scrollbar.visible)return void t(this.columnDim,-e.detail)}},Object.defineProperty(t.prototype,"layoutManager",{get:function(){return this.controlLayoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnDimension",{get:function(){return this.columnDim},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowDimension",{get:function(){return this.rowDim},enumerable:!0,configurable:!0}),t.prototype.refresh=function(e){this.render(e,null)},t.prototype._onScrollAsync=function(e){var t=this;requestAnimationFrame(function(){t.performPendingScroll(e)})},t.prototype.performPendingScroll=function(e){this.render(!1,e)},t.prototype.updateHorizontalPosition=function(){this.rowDim.scrollbar.visible?(this.columnDim.scrollbar.element.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement,this.footerDiv.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement,this.mainDiv.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement):(this.columnDim.scrollbar.element.style.right="0"+t.UnitOfMeasurement,this.mainDiv.style.right="0"+t.UnitOfMeasurement,this.footerDiv.style.right="0"+t.UnitOfMeasurement)},t.prototype.updateFooterVisibility=function(){(this.rowDim.hasFooter()?"block"!==this.footerDiv.style.display:"none"!==this.footerDiv.style.display)&&(this.rowDim.hasFooter()?this.footerDiv.style.display="block":this.footerDiv.style.display="none")},t.prototype.updateVerticalPosition=function(){var e=this.rowDim.scrollbar.visible,i=1===this.controlLayoutManager.getLayoutKind(),a=e||i;if(a){var r=this.footerDiv.offsetHeight,o=0,n=0,s=this.columnDim.scrollbar.visible;s&&(r+=this.scrollBarElementWidth,o+=this.scrollBarElementWidth,n=this.scrollBarElementWidth),this.mainDiv.style.bottom=r+t.UnitOfMeasurement,this.rowDim.scrollbar.element.style.bottom=n+t.UnitOfMeasurement,this.footerDiv.style.bottom=o+t.UnitOfMeasurement,this.footerDiv.style.removeProperty("top")}else this.footerDiv.style.top=this.gridDimensions.rowHierarchyContentHeight+t.UnitOfMeasurement,this.footerDiv.style.removeProperty("bottom"),this.mainDiv.style.removeProperty("bottom")},t.prototype.alreadyRendered=function(e){return e===this.lastRenderingArgs.scrollingDimension&&this.rowDimension.scrollOffset===this.lastRenderingArgs.rowScrollOffset&&this.columnDimension.scrollOffset===this.lastRenderingArgs.columnScrollOffset},t.prototype.render=function(e,i){if(this.columnDim.makeScrollOffsetValid(),this.rowDim.makeScrollOffsetValid(),e||null===i)this.lastRenderingArgs={};else if(this.alreadyRendered(i))return;var a=!1;this.renderIterationCount=0,this.controlLayoutManager.onStartRenderingSession(i,this.mainDiv,e);var r=this.binder;r.onStartRenderingSession();for(var o=this.gridDimensions.footerHeight,n=this.gridDimensions.rowHierarchyHeight,s=this.gridDimensions.rowHierarchyContentHeight;!a&&this.renderIterationCount<t.MaxRenderIterationCount;){var l=this.columnDim.scrollbar.visible,c=this.rowDim.scrollbar.visible;this.columnDim._onStartRenderingIteration(),this.rowDim._onStartRenderingIteration(),this.controlLayoutManager.onStartRenderingIteration(e),this.renderCorner(),this.columnDim._render(),this.rowDim._render(),a=this.controlLayoutManager.onEndRenderingIteration(),this.columnDim._onEndRenderingIteration(),this.rowDim._onEndRenderingIteration(),l!==this.columnDim.scrollbar.visible&&this.updateVerticalPosition(),c!==this.rowDim.scrollbar.visible&&this.updateHorizontalPosition(),this.renderIterationCount++}this.controlLayoutManager.onEndRenderingSession(),r.onEndRenderingSession(),this.isTouchEnabled&&this.updateTouchDimensions(),this.lastRenderingArgs.rowScrollOffset=this.rowDimension.scrollOffset,this.lastRenderingArgs.columnScrollOffset=this.columnDimension.scrollOffset,this.updateContainerDimensions();var u=this.lastRenderingArgs;u.rowScrollOffset=this.rowDimension.scrollOffset,u.columnScrollOffset=this.columnDimension.scrollOffset,u.scrollingDimension=i,o===this.gridDimensions.footerHeight&&n===this.gridDimensions.rowHierarchyHeight&&s===this.gridDimensions.rowHierarchyContentHeight||this.updateVerticalPosition(),this.options.interactive&&(this.columnDim.scrollbar.refresh(),this.rowDim.scrollbar.refresh())},t.prototype.updateContainerDimensions=function(){var e=this.gridDimensions;if(this._autoSizeWidth){var i=this.rowDim.scrollbar.visible?this.scrollBarElementWidth:0;this.containerElement.style.width=e.rowHierarchyWidth+e.columnHierarchyWidth+i+t.UnitOfMeasurement}if(this._autoSizeHeight){var a=this.columnDim.scrollbar.visible?this.scrollBarElementWidth:0;this.containerElement.style.height=e.columnHierarchyHeight+e.rowHierarchyHeight+e.footerHeight+a+t.UnitOfMeasurement}},t.prototype.cornerCellMatch=function(e,t){var i=t.item;return 0===t.type&&i&&this.hierarchyTablixNavigator.cornerCellItemEquals(e,i)},t.prototype.renderCorner=function(){for(var e=this.columnDim.getDepth(),t=this.rowDim.getDepth(),i=0;e>i;i++)for(var a=0;t>a;a++){var r=this.hierarchyTablixNavigator.getCorner(a,i),o=this.controlLayoutManager.getOrCreateCornerCell(r,a,i),n=this.cornerCellMatch(r,o);n||(this._unbindCell(o),o.type=0,o.item=r,this.binder.bindCornerCell(r,o)),this.controlLayoutManager.onCornerCellRealized(r,o)}},t.prototype._unbindCell=function(e){switch(e.type){case 3:this.binder.unbindBodyCell(e.item,e);break;case 2:this.binder.unbindColumnHeader(e.item,e);break;case 1:this.binder.unbindRowHeader(e.item,e);break;case 0:this.binder.unbindCornerCell(e.item,e)}e.item=null,e.type=null},t.prototype.onTouchEvent=function(e){var t,i,a;e&&e.length>0&&"columnDim"in e[0]&&"rowDim"in e[0]&&(a=e[0],t=a.columnDim.scrollbar.visible?e[1]:0,i=a.rowDim.scrollbar.visible?e[2]:0,a.columnDim.scrollbar.viewMin=Math.max(0,a.columnDim.scrollbar.viewMin+t),a.columnDim.scrollOffset=Math.max(0,a.columnDim.scrollOffset+t),a.rowDim.scrollbar.viewMin=Math.max(0,a.rowDim.scrollbar.viewMin+i),a.rowDim.scrollOffset=Math.max(0,a.rowDim.scrollOffset+i),0===t?a._onScrollAsync(a.rowDim):0===i?a._onScrollAsync(a.columnDim):a._onScrollAsync(null))},t.UnitOfMeasurement="px",t.TablixContainerClassName="tablixContainer",t.TablixTableAreaClassName="tablixTableArea",t.TablixFooterClassName="tableFooterArea",t.DefaultFontSize=jsCommon.PixelConverter.fromPoint(e.TablixDefaultTextSize),t.MaxRenderIterationCount=10,t}();e.TablixControl=t}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._scrollStep=.1,this._owner=e,this._hierarchyNavigator=e.hierarchyNavigator,this._binder=e.getBinder(),this._tablixLayoutManager=e.layoutManager,this.scrollOffset=0}return e.prototype._onStartRenderingIteration=function(){this.updateScrollPosition()},e.prototype._onEndRenderingIteration=function(){},e.prototype.getValidScrollOffset=function(e){return Math.min(Math.max(e,0),Math.max(this.getItemsCount()-this._scrollStep,0))},e.prototype.makeScrollOffsetValid=function(){this.scrollOffset=this.getValidScrollOffset(this.scrollOffset)},e.prototype.getIntegerScrollOffset=function(){return Math.floor(this.scrollOffset)},e.prototype.getFractionScrollOffset=function(){return this.scrollOffset-this.getIntegerScrollOffset()},Object.defineProperty(e.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!0,configurable:!0}),e.prototype.getFirstVisibleItem=function(e){return this._scrollItems[e]},e.prototype.getFirstVisibleChild=function(e){return this._hierarchyNavigator.getAt(this._hierarchyNavigator.getChildren(e),this.getFirstVisibleChildIndex(e))},e.prototype.getFirstVisibleChildIndex=function(e){var t,i=this.getFirstVisibleItem(this._hierarchyNavigator.getLevel(e)+1);return t=void 0===i||void 0!==i&&this._hierarchyNavigator.getParent(i)!==e?0:this._hierarchyNavigator.getIndex(i)},e.prototype._initializeScrollbar=function(e,t,i){var a=this;this._scrollbar=this._createScrollbar(e,i),this._scrollbar._onscroll.push(function(e){return a.onScroll()}),t&&(this.scrollbar.initTouch(t,!0),t.style.setProperty("-ms-touch-action","pinch-zoom"))},e.prototype.getItemsCount=function(){return this.model?this._hierarchyNavigator.getLeafCount(this.model):0},e.prototype.getDepth=function(){return this.modelDepth},e.prototype.onScroll=function(){this.scrollOffset=this._scrollbar.viewMin,this._owner._onScrollAsync(this)},Object.defineProperty(e.prototype,"otherDimension",{get:function(){return this._otherDimension},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!0,configurable:!0}),e.prototype._createScrollbar=function(e,t){return null},e.prototype.updateScrollPosition=function(){if(this._scrollItems=[],this.model){var e=this.getIntegerScrollOffset(),t=this._hierarchyNavigator.getLeafAt(this.model,e);if(t){this._firstVisibleScrollIndex=e;do this._scrollItems[this._hierarchyNavigator.getLevel(t)]=t,t=this._hierarchyNavigator.getParent(t);while(null!==t)}}},e}();e.TablixDimension=t;var i=function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.rowLayoutManager,this._footer=null}return __extends(i,t),i.prototype.setFooter=function(e){this._footer=e,this._owner.updateFooterVisibility()},i.prototype.hasFooter=function(){return null!==this._footer},i.prototype._render=function(){var e=this.getFirstVisibleItem(0);this.hasFooter()&&(this.addFooterRowHeader(this._footer),this.addFooterBodyCells(this._footer)),void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t,i){return new e.VerticalScrollbar(t,i)},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),o=a;r>o;o++){if(!this._layoutManager.needsToRealize)return;var n=this._hierarchyNavigator.getAt(e,o),s=this.addNode(n,e,t,i);t+=s.rowSpan}},i.prototype.getFirstVisibleChildLeaf=function(e){for(var t=e;!this._hierarchyNavigator.isLeaf(t);)t=this.getFirstVisibleChild(t);return t},i.prototype.bindRowHeader=function(e,t){this._binder.bindRowHeader(e,t)},i.prototype.addNode=function(e,t,i,a){var r,o=this._tablixLayoutManager.getOrCreateRowHeader(e,t,i,this._hierarchyNavigator.getLevel(e)),n=this.rowHeaderMatch(e,o);return n||(this._owner._unbindCell(o),o.type=1,o.item=e,o.unfixRowHeight()),this._hierarchyNavigator.isLeaf(e)?(o.colSpan=a-this._hierarchyNavigator.getLevel(e),o.rowSpan=1,n||this.bindRowHeader(e,o),this._tablixLayoutManager.onRowHeaderRealized(e,o),this.addBodyCells(e,t,i)):(r=this._layoutManager.getRealizedItemsCount(),this.addNodes(this._hierarchyNavigator.getChildren(e),i,a,this.getFirstVisibleChildIndex(e)),o.colSpan=1,o.rowSpan=this._layoutManager.getRealizedItemsCount()-r+1,n||this.bindRowHeader(e,o),this._tablixLayoutManager.onRowHeaderRealized(e,o)),o},i.prototype.rowHeaderMatch=function(e,t){var i=t.item;return 1===t.type&&i&&this._hierarchyNavigator.headerItemEquals(e,i)},i.prototype.addBodyCells=function(e,t,i){for(var a=this._otherDimension.getIntegerScrollOffset(),r=this._otherDimension._layoutManager.getRealizedItemsCount()-this.getDepth(),o=this._hierarchyNavigator,n=this._otherDimension.model,s=this._tablixLayoutManager,l=0;r>l;l++){var c=o.getIntersection(e,o.getLeafAt(n,a+l)),u=s.getOrCreateBodyCell(c,e,t,i,l);this.bindBodyCell(c,u),s.onBodyCellRealized(c,u)}},i.prototype.bindBodyCell=function(e,t){var i=this.bodyCelMatch(e,t);i||(this._owner._unbindCell(t),t.type=3,t.item=e,t.unfixRowHeight(),this._binder.bindBodyCell(e,t))},i.prototype.addFooterRowHeader=function(e){var t=this._tablixLayoutManager.getOrCreateFooterRowHeader(e,this.model);t.colSpan=this.getDepth();var i=this.rowHeaderMatch(e,t);i||(this._owner._unbindCell(t),t.type=1,t.item=e,t.unfixRowHeight(),this.bindRowHeader(e,t),this._tablixLayoutManager.onRowHeaderFooterRealized(e,t))},i.prototype.addFooterBodyCells=function(e){for(var t=this._otherDimension.getIntegerScrollOffset(),i=this._otherDimension.layoutManager.getRealizedItemsCount()-this.getDepth(),a=this._tablixLayoutManager,r=0;i>r;r++){var o=this._hierarchyNavigator.getLeafAt(this._otherDimension.model,t+r),n=this._hierarchyNavigator.getIntersection(e,o),s=a.getOrCreateFooterBodyCell(n,r);this.bindBodyCell(n,s),a.onBodyCellFooterRealized(n,s)}},i.prototype.bodyCelMatch=function(e,t){var i=t.item;return 3===t.type&&i&&this._hierarchyNavigator.bodyCellItemEquals(e,i)},i}(t);e.TablixRowDimension=i;var a=function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.columnLayoutManager}return __extends(i,t),i.prototype._render=function(){var e=this.getFirstVisibleItem(0);void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t,i){var a=new e.HorizontalScrollbar(t,i);return a.smallIncrement=.2,a},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),o=a;r>o;o++){if(!this._layoutManager.needsToRealize)return;var n=this.addNode(this._hierarchyNavigator.getAt(e,o),e,t,i);t+=n.colSpan}},i.prototype.addNode=function(e,t,i,a){var r=this._tablixLayoutManager.getOrCreateColumnHeader(e,t,this._hierarchyNavigator.getLevel(e),i),o=this.columnHeaderMatch(e,r);if(o||(this._owner._unbindCell(r),r.type=2,r.item=e,r.unfixRowHeight()),this._hierarchyNavigator.isLeaf(e))r.rowSpan=a-this._hierarchyNavigator.getLevel(e);else{var n=this._layoutManager.getRealizedItemsCount();this.addNodes(this._hierarchyNavigator.getChildren(e),i,a,this.getFirstVisibleChildIndex(e));var s=this._hierarchyNavigator.getChildrenLevelDifference(e);s===1/0?r.rowSpan=1:r.rowSpan=s,r.colSpan=this._layoutManager.getRealizedItemsCount()-n+1}return o||this._binder.bindColumnHeader(e,r),this._tablixLayoutManager.onColumnHeaderRealized(e,r),r},i.prototype.columnHeaderMatch=function(e,t){var i=t.item;return 2===t.type&&i&&this._hierarchyNavigator.headerItemEquals(e,i)},i}(t);e.TablixColumnDimension=a}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e){this.dim=e,this.averageSize=1,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this.averageSize=e},t.prototype.resize=function(e,t,i,a){this.dim.x=e,this.dim.y=t,this.dim.width=i,this.dim.height=a},t.prototype.getPixelToItem=function(t,i,a,r,o){return new e.TouchUtils.TouchEvent(t*this.averageSize,0,o,-a*this.averageSize,0)},t.prototype.touchEvent=function(t){var i=[];i[0]=this.tablixControl,i[1]=t.dx,i[2]=t.dy,this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t}();e.ColumnTouchDelegate=t;var i=function(){function t(e){this.dim=e,this.averageSize=30,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this.averageSize=e},t.prototype.resize=function(e,t,i,a){this.dim.x=e,this.dim.y=t,this.dim.width=i,this.dim.height=a},t.prototype.getPixelToItem=function(t,i,a,r,o){var n=new e.TouchUtils.TouchEvent(0,i*this.averageSize,o,0,-r*this.averageSize);return n},t.prototype.touchEvent=function(t){var i=[];i[0]=this.tablixControl,i[1]=t.dx,i[2]=t.dy,this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t}();e.RowTouchDelegate=i;var a=function(){function t(e){this.dim=e,this.averageSizeX=t.DefaultAverageSizeX,this.averageSizeY=t.DefaultAverageSizeY,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e,t){this.averageSizeX=e,this.averageSizeY=t},t.prototype.resize=function(e,t,i,a){var r=this.dim;r.x=e,r.y=t,r.width=i,r.height=a},t.prototype.getPixelToItem=function(t,i,a,r,o){return new e.TouchUtils.TouchEvent(t*this.averageSizeX,i*this.averageSizeY,o,-a*this.averageSizeX,-r*this.averageSizeY)},t.prototype.touchEvent=function(t){var i=[this.tablixControl,t.dx,t.dy];this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t.DefaultAverageSizeX=30,t.DefaultAverageSizeY=30,t}();e.BodyTouchDelegate=a}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.offset=function(e,t){this.x+=e,this.y+=t},e}();t.Point=i;var a=function(e){function t(t,i,a,r){e.call(this,t,i),this.width=a||0,this.height=r||0}return __extends(t,e),Object.defineProperty(t.prototype,"point",{get:function(){return new i(this.x,this.y)},enumerable:!0,configurable:!0}),t.prototype.contains=function(e){return t.contains(this,e)},t.contains=function(e,i){return i&&!t.isEmpty(e)?e.x<=i.x&&i.x<e.x+e.width&&e.y<=i.y&&i.y<e.y+e.height:!1},t.isEmpty=function(e){return!(void 0!==e&&e.width>=0&&e.height>=0)},t}(i);t.Rectangle=a,function(e){e[e.NoClick=0]="NoClick",e[e.LeftClick=1]="LeftClick",e[e.RightClick=2]="RightClick",e[e.CenterClick=3]="CenterClick"}(t.MouseButton||(t.MouseButton={}));var r=t.MouseButton,o=function(){function e(e,t,i,a,r){this._x=e,this._y=t,this.isMouseButtonDown=i,this._dx=a||0,this._dy=r||0}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dx",{get:function(){return this._dx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dy",{get:function(){return this._dy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMouseDown",{get:function(){return this.isMouseButtonDown},enumerable:!0,configurable:!0}),e}();t.TouchEvent=o;var n=function(){function e(){this.touchList=[],this.swipeDirection=2,this.matchingDirectionCount=0,this.lockThreshold=!0,this.scrollThreshold=!0,this.lastTouchEvent=new o(0,0,!1)}return Object.defineProperty(e.prototype,"lastEvent",{get:function(){return this.lastTouchEvent},enumerable:!0,configurable:!0}),e.prototype.addTouchRegion=function(e,t,i){var a={lastPoint:new o(0,0,!1),handler:t,region:e,converter:i};this.touchList=this.touchList.concat([a])},e.prototype.upAllTouches=function(){var e,t;t=this.touchList.length;for(var i=0;t>i;i++)this.touchList[i].lastPoint.isMouseDown&&(e=this.touchList[i].converter.getPixelToItem(this.touchList[i].lastPoint.x,this.touchList[i].lastPoint.y,0,0,!1),this.touchList[i].handler.touchEvent(e)),this.touchList[i].lastPoint=new o(this.touchList[i].lastPoint.x,this.touchList[i].lastPoint.y,!1);this.lastTouchEvent=new o(0,0,!1)},e.prototype.touchEvent=function(e){var t,i,a=0,r=0,n=0,s=0,l=0,c=null;t=this._getActive(),!this.lastTouchEvent.isMouseDown&&e.isMouseDown&&(t=this._findRegions(e)),n=this.lastTouchEvent.x-e.x,s=this.lastTouchEvent.y-e.y,this.lastTouchEvent=new o(e.x,e.y,e.isMouseDown,n,s),i=t.length;for(var u=0;i>u;u++)a=e.x-t[u].region.point.x,r=e.y-t[u].region.point.y,t[u].lastPoint.isMouseDown&&e.isMouseDown?(n=a-t[u].lastPoint.x,s=r-t[u].lastPoint.y,l=Math.abs(180/Math.PI*Math.atan(s/n)),this.scrollThreshold&&(this.lockThreshold&&this.matchingDirectionCount>5?1===this.swipeDirection?s=0:0===this.swipeDirection&&(n=0):20>l?(s=0,1===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=1)):(l=Math.abs(180/Math.PI*Math.atan(n/s)),20>l?(n=0,0===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=0)):2===this.swipeDirection?this.matchingDirectionCount++:(this.swipeDirection=2,this.matchingDirectionCount=1)))):(n=0,s=0,this.swipeDirection=2,this.matchingDirectionCount=0),t[u].lastPoint=new o(a,r,e.isMouseDown,n,s),c=t[u].converter.getPixelToItem(a,r,n,s,e.isMouseDown),t[u].handler.touchEvent(c)},e.prototype._findRegions=function(e){var t,a=[];t=this.touchList.length;for(var r=0;t>r;r++)this.touchList[r].region.contains(new i(e.x,e.y))&&(a=a.concat([this.touchList[r]]));return a},e.prototype._getActive=function(){var e,t=[];e=this.touchList.length;for(var i=0;e>i;i++)this.touchList[i].lastPoint.isMouseDown&&(t=t.concat([this.touchList[i]]));return t},e}();t.TouchManager=n;var s=80,l=600,c=function(){function t(e){this.manager=e,this.allowMouseDrag=!0,this.touchPanel=null,this.scale=1,this.documentMouseMoveWrapper=null,this.documentMouseUpWrapper=null,this.sliding=!1}return t.prototype.initTouch=function(e,t,i){var a=this;e.style.setProperty("-ms-touch-action","pinch-zoom"),this.touchReferencePoint=t,this.touchPanel=e,this.allowMouseDrag=void 0===i?!0:i,"ontouchmove"in e?(e.addEventListener("touchstart",function(e){return a.onTouchStart(e)}),e.addEventListener("touchend",function(e){return a.onTouchEnd(e)})):(e.addEventListener("mousedown",function(e){return a.onTouchMouseDown(e)}),e.addEventListener("mouseup",function(e){return a.onTouchMouseUp(e)}))},t.prototype.getXYByClient=function(e,t,a){var r=a.left,o=a.top;void 0!==window.scrollX&&(r+=window.scrollX,o+=window.scrollY);var n=new i(0,0);return n.offset(e-r,t-o),n},t.prototype.onTouchStart=function(e){if(1===e.touches.length){e.cancelBubble=!0;var t=e.touches[0];this.touchStartTime=(new Date).getTime(),this.touchStartPageY=t.pageY,this.onTouchMouseDown(t)}},t.prototype.onTouchMove=function(e){if(1===e.touches.length){e.preventDefault&&e.preventDefault();var t=e.touches[0];this.touchLastPageY=t.pageY,this.touchLastPageX=t.pageX,this.sliding||this.onTouchMouseMove(t)}},t.prototype.onTouchEnd=function(e){this.clearTouchEvents();var t=this.getSwipeInfo();this.didUserSwipe(t)?this.startSlideAffect(t):this.sliding||this.upAllTouches()},t.prototype.onTouchMouseDown=function(t){var i=this;this.scale=e.HTMLElementUtils.getAccumulatedScale(this.touchPanel),document.getSelection().removeAllRanges(),this.rect=(this.touchReferencePoint?this.touchReferencePoint:this.touchPanel).getBoundingClientRect(),"ontouchmove"in this.touchPanel?(this.documentMouseMoveWrapper=function(e){return i.onTouchMove(e)},document.addEventListener("touchmove",this.documentMouseMoveWrapper),this.documentMouseUpWrapper=function(e){return i.onTouchEnd(e)},document.addEventListener("touchend",this.documentMouseUpWrapper)):(this.documentMouseMoveWrapper=function(e){return i.onTouchMouseMove(e)},document.addEventListener("mousemove",this.documentMouseMoveWrapper),this.documentMouseUpWrapper=function(e){return i.onTouchMouseUp(e)},document.addEventListener("mouseup",this.documentMouseUpWrapper)),"setCapture"in this.touchPanel&&this.touchPanel.setCapture()},t.prototype.onTouchMouseMove=function(e){var t,i,a=this.rect,n=null!==a&&e.which!==r.NoClick;n&&!this.sliding&&(i=this.getXYByClient(e.pageX,e.pageY,a),t=new o(i.x/this.scale,i.y/this.scale,n),this.manager.touchEvent(t),e.preventDefault?e.preventDefault():"returnValue"in e&&(e.returnValue=!1))},t.prototype.onTouchMouseUp=function(e,t){this.upAllTouches(),this.clearTouchEvents()},t.prototype.getSwipeInfo=function(){var e=(new Date).getTime(),t=e-this.touchStartTime,i=this.touchLastPageY-this.touchStartPageY,a=0>i?-1:1;return{direction:a,distance:i,endTime:e,time:t}},t.prototype.didUserSwipe=function(e){return e.time<l&&e.distance*e.direction>s},t.prototype.startSlideAffect=function(e){var t=this;if(!this.sliding){this.sliding=!0;var i=this.getXYByClient(this.touchLastPageX,this.touchLastPageY,this.rect);this.slide(i,300,e),requestAnimationFrame(function(){t.didUserChangeDirection(e)||t.slide(i,200,e),t.clearSlide()})}},t.prototype.didUserChangeDirection=function(e){if(this.touchStartTime<=e.endTime)return!1;var t=this.touchLastPageY-this.touchStartPageY,i=0>t?-1:1;return i!==e.direction},t.prototype.slide=function(e,t,i){var a=this.touchStartTime>i.endTime?this.touchLastPageY-this.touchStartPageY:0;e.y+=t*i.direction+a;var r=new o(e.x/this.scale,e.y/this.scale,!0);this.manager.touchEvent(r)},t.prototype.clearSlide=function(){this.sliding=!1,this.upAllTouches()},t.prototype.upAllTouches=function(){null===this.documentMouseMoveWrapper&&(this.rect=null,this.manager.upAllTouches())},t.prototype.clearTouchEvents=function(){"releaseCapture"in this.touchPanel&&this.touchPanel.releaseCapture(),null!==this.documentMouseMoveWrapper&&("ontouchmove"in this.touchPanel?(document.removeEventListener("touchmove",this.documentMouseMoveWrapper),document.removeEventListener("touchend",this.documentMouseUpWrapper)):(document.removeEventListener("mousemove",this.documentMouseMoveWrapper),document.removeEventListener("mouseup",this.documentMouseUpWrapper)),this.documentMouseMoveWrapper=null,this.documentMouseUpWrapper=null)},t}();t.TouchEventInterpreter=c}(t=e.TouchUtils||(e.TouchUtils={}))}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Matrix=0]="Matrix",e[e.Table=1]="Table"}(e.TablixType||(e.TablixType={}));e.TablixType}(t=e.controls||(e.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i=t.internal.TablixObjects.PropGeneralAutoSizeColumns,a=t.internal.TablixObjects.getMetadadataObjects,r=function(){function t(e,t,i,a){this.columnWidthObjects=[],this.isMatrix=t,this.updateDataView(e,a),this.hostPersistCallBack=i}return t.prototype.updateDataView=function(e,t){this.previousDataView=this.currentDataView,this.previousDataView?this.previousAutoColumnSizePropertyValue=i.getValue(a(this.previousDataView)):this.previousAutoColumnSizePropertyValue=void 0,this.currentDataView=e,this.currentDataView?this.currentAutoColumnSizePropertyValue=i.getValue(a(this.currentDataView)):this.currentAutoColumnSizePropertyValue=void 0,this.matrixLeafNodes=t,this.updateColumnWidthObjects(),this.updateTablixColumnWidths()},t.prototype.updateColumnWidthObjects=function(){this.columnWidthObjects.length=0,this.isMatrix?this.updateMatrixColumnWidthObjects():this.updateTableColumnWidthObjects()},t.prototype.updateTableColumnWidthObjects=function(){if(this.currentDataView&&this.currentDataView.table)for(var e=this.currentDataView.table.columns,t=0,i=e.length;i>t;t++){var a=e[t].queryName;this.columnWidthObjects.push({queryName:a,width:void 0})}},t.prototype.updateMatrixColumnWidthObjects=function(){if(this.currentDataView&&this.currentDataView.matrix&&this.currentDataView.matrix.rows)for(var e=0,t=this.currentDataView.matrix.rows.levels.length;t>e;e++){var i=this.currentDataView.matrix.rows.levels[e];_.isEmpty(i.sources)||this.columnWidthObjects.push({queryName:i.sources[0].queryName,width:void 0})}if(this.matrixLeafNodes)for(var e=0,t=this.matrixLeafNodes.length;t>e;e++){var a=this.matrixLeafNodes[e].queryName;this.columnWidthObjects.push({queryName:a,width:void 0})}},t.prototype.updateTablixColumnWidths=function(){var e=this.currentDataView&&this.currentDataView.metadata&&this.currentDataView.metadata.columns;e&&(this.shouldClearAllColumnWidths()?this.autoSizeAllColumns():this.deserializeColumnWidths(e))},t.prototype.deserializeColumnWidths=function(i){this.columnWidthObjects.forEach(function(e){e.width=void 0});for(var a=0,r=i;a<r.length;a++){var o=r[a],n=e.DataViewObjects.getValue(o.objects,t.columnWidthProp);if(_.isNumber(n))for(var s=0,l=this.columnWidthObjects;s<l.length;s++){var c=l[s];c.queryName===o.queryName&&(c.width=n)}}},t.prototype.shouldPersistAllColumnWidths=function(){return this.previousDataView?!this.currentAutoColumnSizePropertyValue&&this.previousAutoColumnSizePropertyValue:!1},t.prototype.shouldClearAllColumnWidths=function(){return null!=this.previousDataView&&this.previousAutoColumnSizePropertyValue===!1&&null!=this.currentDataView&&this.currentAutoColumnSizePropertyValue===!0},t.prototype.getColumnWidthObjects=function(){return this.columnWidthObjects},t.prototype.getFixedColumnWidthObjects=function(){return this.columnWidthObjects.filter(function(e){return null!=e.width})},t.prototype.getPersistedColumnWidth=function(e){var t=this.isMatrix?e:e-1,i=this.columnWidthObjects[t];return i?i.width:void 0},t.prototype.callHostToPersist=function(e){e&&this.generateVisualObjectInstancesToPersist(),this.hostPersistCallBack&&this.hostPersistCallBack(this.visualObjectInstancesToPersist)},t.prototype.autoSizeAllColumns=function(){this.visualObjectInstancesToPersist={merge:[this.getAutoSizeColumnWidthObject()],remove:[]};for(var e=0,t=this.columnWidthObjects;e<t.length;e++){var i=t[e];this.visualObjectInstancesToPersist.remove.push({selector:{metadata:i.queryName},objectName:"general",properties:{columnWidth:void 0
}})}this.callHostToPersist(!1)},t.prototype.onColumnAutosized=function(e){for(var t=this.currentAutoColumnSizePropertyValue?void 0:-1,i=0,a=this.columnWidthObjects;i<a.length;i++){var r=a[i];r.queryName===e&&(r.width=t)}this.currentAutoColumnSizePropertyValue&&(this.visualObjectInstancesToPersist={remove:[{selector:{metadata:e},objectName:"general",properties:{columnWidth:void 0}}]},this.callHostToPersist(!1))},t.prototype.onColumnWidthChanged=function(e,t){var i=this.isMatrix?e:e-1;if(!(_.isEmpty(this.columnWidthObjects)||0>i||i>=this.columnWidthObjects.length)){var a=this.columnWidthObjects[i].queryName;if(-1===t)this.onColumnAutosized(a);else{for(var r=0,o=this.columnWidthObjects;r<o.length;r++){var n=o[r];n.queryName===a&&(n.width=t)}this.callHostToPersist(!0)}}},t.prototype.persistAllColumnWidths=function(e){var t=this,i=this.isMatrix?e:e.slice(1,e.length);if(this.columnWidthObjects.length===i.length){var a=new Array;i.forEach(function(e,i){var r=t.columnWidthObjects[i].queryName;null==a[r]?a[r]=e:a[r]=Math.max(e,a[r])});for(var r=0,o=this.columnWidthObjects;r<o.length;r++){var n=o[r],s=a[n.queryName];null!=s&&(n.width=s)}this.callHostToPersist(!0)}},t.prototype.getAutoSizeColumnWidthObject=function(){return{selector:null,objectName:"general",properties:{autoSizeColumnWidth:this.currentAutoColumnSizePropertyValue}}},t.prototype.generateVisualObjectInstancesToPersist=function(){this.visualObjectInstancesToPersist={merge:[this.getAutoSizeColumnWidthObject()]};for(var e=new Array,t=0,i=this.columnWidthObjects;t<i.length;t++){var a=i[t];a.queryName&&_.isNumber(a.width)&&!e[a.queryName]&&(this.visualObjectInstancesToPersist.merge.push({selector:{metadata:a.queryName},objectName:"general",properties:{columnWidth:a.width}}),e[a.queryName]=!0)}},t.columnWidthProp={objectName:"general",propertyName:"columnWidth"},t}();t.TablixColumnWidthManager=r}(i=t.controls||(t.controls={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){this.mainText=jsCommon.CssConstants.createClassAndSelector("mainText"),this.name=e,this.visualConfiguration={maxFontSize:60}}return i.prototype.getMetaDataColumn=function(e){if(e&&e.metadata&&e.metadata.columns)for(var t=0,i=e.metadata.columns.length;i>t;t++){var a=e.metadata.columns[t];if(a.isMeasure){this.metaDataColumn=a;break}}},i.prototype.getAdjustedFontHeight=function(e,t,i){var a={fontFamily:null,fontSize:null,text:t},r=this.getAdjustedFontHeightCore(a,e,i,0);return r},i.prototype.getAdjustedFontHeightCore=function(t,i,a,r){if(r>10)return a;t.fontSize=jsCommon.PixelConverter.toString(a);var o=e.TextMeasurementService.measureSvgTextWidth(t);return i>o?a:this.getAdjustedFontHeightCore(t,i,.9*a,r+1)},i.prototype.clear=function(){this.svg.select(this.mainText.selector).text("")},i.prototype.doValueTransition=function(e,i,a,r,o,n,s){if(n||e!==i||null==i){e||(e=0);var l=this.svg,c=this.currentViewport,u=c.height,h=c.width,d=[i],p=this.getSeedFontHeight(h,u),g=this.getTranslateX(h),m=this.getTranslateY(p),f=this.metaDataColumn;s||(s=t.valueFormatter.create({format:this.getFormatString(f),value:i,displayUnitSystemType:a,formatSingleValues:!0,allowFormatBeautification:!0,columnType:f?f.type:void 0}));var y=s.format(e),v=s.format(i);l.attr("class",this.name);var b=l.selectAll("text").data(d);b.enter().append("text").attr("class",this.mainText["class"]);var C=this.getAdjustedFontHeight(h,v,p);m=this.getTranslateY(C+(u-C)/2);var S=b.text(y).attr({"text-anchor":this.getTextAnchor(),"font-size":C,transform:t.SVGUtil.translate(g,m)}).style({fill:this.style.titleText.color.value}).call(t.tooltipUtils.tooltipUpdate,[y]);if(null==i)S.text(v).call(t.tooltipUtils.tooltipUpdate,[v]);else if(f&&t.AxisHelper.isDateTime(f.type))S.text(v).call(t.tooltipUtils.tooltipUpdate,[v]);else{var x=e;S.transition().duration(o).tween("text",function(e){var t=d3.interpolate(x,e);return function(e){var i=t(e);this.textContent=s.format(i)}})}t.SVGUtil.flushAllD3TransitionsIfNeeded(r)}},i.prototype.setTextColor=function(e){this.style.titleText.color.value=e},i.prototype.getSeedFontHeight=function(e,t){var i=Math.floor(.75*Math.min(e,t)),a=this.visualConfiguration.maxFontSize;return a?Math.min(a,i):i},i.prototype.getTranslateX=function(e){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return 0;case"right":return e}return e/2},i.prototype.getTranslateY=function(e){return e},i.prototype.getTextAnchor=function(){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return"start";case"right":return"end"}return"middle"},i.prototype.getFormatString=function(e){return t.valueFormatter.getFormatString(e,i.formatStringProp)},i.formatStringProp={objectName:"general",propertyName:"formatString"},i}();t.AnimatedText=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(t){function i(e,i){t.call(this,"animatedNumber"),e&&(this.svg=e),i&&(this.animator=i)}return __extends(i,t),i.prototype.init=function(e){this.options=e;var t=e.element;this.svg||(this.svg=d3.select(t.get(0)).append("svg")),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportDependantProperties()},i.prototype.updateViewportDependantProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},i.prototype.update=function(e){this.currentViewport=e.viewport;var t=this.dataViews=e.dataViews;if(t&&t[0]){var i=t[0];this.updateViewportDependantProperties(),this.getMetaDataColumn(i);var a=i&&i.single?i.single.value:0;null!=a&&this.updateInternal(a,e.suppressAnimations,!0,this.formatter)}},i.prototype.setFormatter=function(e){this.formatter=e},i.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},i.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},i.prototype.canResizeTo=function(e){return!0},i.prototype.updateInternal=function(t,i,a,r){void 0===a&&(a=!1);var o=this.value||0,n=e.AnimatorCommon.GetAnimationDuration(this.animator,i);this.doValueTransition(o,t,null,this.options.animation,n,a,r),this.value=t},i}(e.AnimatedText);e.AnimatedNumber=t}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){}return Object.defineProperty(i.prototype,"shapeType",{get:function(){return this.data.shapeType},set:function(e){this.data.shapeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineColor",{get:function(){return this.data?this.data.lineColor:i.DefaultStrokeColor},set:function(e){this.data.lineColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineTransparency",{get:function(){return this.data?this.data.lineTransparency:i.DefaultLineTransValue},set:function(e){this.data.lineTransparency=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineWeight",{get:function(){return this.data?this.data.lineWeight:i.DefaultWeightValue},set:function(e){this.data.lineWeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"roundEdge",{get:function(){return this.data?this.data.roundEdge:i.DefaultRoundEdgeValue},set:function(e){this.data.roundEdge=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showFill",{get:function(){return this.data?this.data.showFill:i.DefaultFillShowValue},set:function(e){this.data.showFill=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillColor",{get:function(){return this.data?this.data.fillColor:i.DefaultFillColor},set:function(e){this.data.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shapeTransparency",{get:function(){return this.data?this.data.shapeTransparency:i.DefaultFillTransValue},set:function(e){this.data.shapeTransparency=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.data?this.data.angle:i.DefaultAngle},set:function(e){this.data.angle=this.scaleTo360Deg(e)},enumerable:!0,configurable:!0}),i.prototype.init=function(e){this.element=e.element,this.selection=d3.select(this.element.context),this.currentViewport=e.viewport},i.prototype.update=function(e){this.currentViewport=e.viewport;var t=e.dataViews;if(!_.isEmpty(t)){var i=e.dataViews[0];if(i.metadata&&i.metadata.objects){var a=e.dataViews[0].metadata.objects;this.data=this.getDataFromDataView(a),this.render()}}},i.prototype.getDataFromDataView=function(a){return a?{shapeType:e.DataViewObjects.getValue(a,t.basicShapeProps.general.shapeType,i.DefaultShape),lineColor:this.getValueFromColor(e.DataViewObjects.getValue(a,t.basicShapeProps.line.lineColor,i.DefaultStrokeColor)),lineTransparency:e.DataViewObjects.getValue(a,t.basicShapeProps.line.transparency,i.DefaultLineTransValue),lineWeight:e.DataViewObjects.getValue(a,t.basicShapeProps.line.weight,i.DefaultWeightValue),roundEdge:e.DataViewObjects.getValue(a,t.basicShapeProps.line.roundEdge,i.DefaultRoundEdgeValue),shapeTransparency:e.DataViewObjects.getValue(a,t.basicShapeProps.fill.transparency,i.DefaultFillTransValue),fillColor:this.getValueFromColor(e.DataViewObjects.getValue(a,t.basicShapeProps.fill.fillColor,i.DefaultFillColor)),showFill:e.DataViewObjects.getValue(a,t.basicShapeProps.fill.show,i.DefaultFillShowValue),angle:this.scaleTo360Deg(e.DataViewObjects.getValue(a,t.basicShapeProps.rotation.angle,i.DefaultAngle))}:null},i.prototype.scaleTo360Deg=function(e){return 0!==e&&Math.abs(e)%360===0?e:(e%=360,e=(e+360)%360)},i.prototype.getValueFromColor=function(e){return e.solid?e.solid.color:e},i.prototype.enumerateObjectInstances=function(e){var i=[];if(!this.data)return i;switch(e.objectName){case"line":var a={selector:null,properties:{lineColor:this.lineColor,transparency:this.lineTransparency,weight:this.lineWeight},objectName:e.objectName};return this.shapeType===t.basicShapeType.rectangle&&(a.properties.roundEdge=this.roundEdge),i.push(a),i;case"fill":return this.shapeType!==t.basicShapeType.line&&i.push({selector:null,properties:{show:this.showFill,fillColor:this.fillColor,transparency:this.shapeTransparency},objectName:e.objectName}),i;case"rotation":return i.push({selector:null,properties:{angle:this.angle},objectName:e.objectName}),i}return null},i.prototype.render=function(){switch(this.selection.html(""),this.shapeType){case t.basicShapeType.rectangle:t.ShapeFactory.createRectangle(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.oval:t.ShapeFactory.createOval(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.line:t.ShapeFactory.createLine(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.arrow:t.ShapeFactory.createUpArrow(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.triangle:t.ShapeFactory.createTriangle(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle)}},i.DefaultShape=t.basicShapeType.rectangle,i.DefaultStrokeColor="#00B8AA",i.DefaultFillColor="#E6E6E6",i.DefaultFillShowValue=!0,i.DefaultFillTransValue=0,i.DefaultWeightValue=3,i.DefaultLineTransValue=0,i.DefaultRoundEdgeValue=0,i.DefaultAngle=0,i}();t.BasicShapeVisual=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return _.isEmpty(e)?[]:_.filter(e,function(e){return!t.TrendLineHelper.isDataViewForRegression(e)})}function a(e){return e.length>1}function r(e,t,i){return 0===e&&!!t&&!!t.showAxisTitle||1===e&&!i&&!!t&&!!t.secShowAxisTitle}function o(e,t){var i={domain:void 0,merged:!1,tickCount:void 0};if(e.length<2)return i;var a,r,o,n,s=e[0].calculateAxesProperties(t)[1],l=e[1].calculateAxesProperties(t)[1],u=s.scale.domain(),h=l.scale.domain();if(s.values&&s.values.length>0&&l.values&&l.values.length>0&&(i.tickCount=Math.max(s.values.length,l.values.length)),a=Math.min(u[0],h[0]),r=Math.max(u[1],h[1]),t.forceMerge)return{domain:[a,r],merged:!0,tickCount:i.tickCount};if(u[0]>h[1]||u[1]<h[0])return i;n=Math.max(u[0],h[0]),o=Math.min(u[1],h[1]);var d=r-a;if(0===d)return i;var p=Math.abs((o-n)/d);return c>p?i:{domain:[a,r],merged:!0,tickCount:i.tickCount}}var n=jsCommon.EnumExtensions,s=jsCommon.CssConstants.createClassAndSelector,l=t.axisScale.linear,c=.1,u=6;t.DEFAULT_AXIS_COLOR="#777";var h=function(){function a(e){this.xRefLine=s("x-ref-line"),this.y1RefLine=s("y1-ref-line");var t=!1;this.trimOrdinalDataOnOverflow=!0,e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,this.cartesianLoadMoreEnabled=e.cartesianLoadMoreEnabled,this.type=e.chartType,this.isLabelInteractivityEnabled=e.isLabelInteractivityEnabled,this.lineChartLabelDensityEnabled=e.lineChartLabelDensityEnabled,void 0!==e.trimOrdinalDataOnOverflow&&(this.trimOrdinalDataOnOverflow=e.trimOrdinalDataOnOverflow),e.isScrollable&&(t=e.isScrollable),this.animator=e.animator,e.cartesianSmallViewPortProperties&&(this.cartesianSmallViewPortProperties=e.cartesianSmallViewPortProperties),e.behavior&&(this.behavior=e.behavior)),this.axes=new m(t,p.ScrollbarWidth,this.trimOrdinalDataOnOverflow),this.svgAxes=new g(this.axes),this.svgBrush=new d(p.ScrollbarWidth),this.scrollableAxes=new p(this.axes,this.svgBrush)}return a.getAxisVisibility=function(e){switch(e){case 6:case 5:case 7:return 1;case 9:return 3;default:return 2}},a.prototype.init=function(e){this.visualInitOptions=e,this.layers=[];var i=this.element=e.element;this.currentViewport=e.viewport,this.hostServices=e.host;var r=this.chartAreaSvg=d3.select(i.get(0)).append("svg");r.classed(a.ClassName,!0),r.style("position","absolute"),this.behavior&&(this.clearCatcher=t.appendClearCatcher(r),this.interactivityService=t.createInteractivityService(this.hostServices)),null!=e.style.maxMarginFactor&&this.axes.setMaxMarginFactor(e.style.maxMarginFactor);var o=a.getAxisVisibility(this.type);this.axes.setAxisLinesVisibility(o),this.svgAxes.init(r),this.svgBrush.init(r),this.sharedColorPalette=new y(e.style.colorPalette.dataColors),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,12!==this.type?this.interactivityService:void 0,this.axes.isScrollable),this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend},a.prototype.isPlayAxis=function(){if(!this.dataViews||!this.dataViews[0])return!1;var e=this.dataViews[0],t=e.categorical&&e.categorical.categories&&e.categorical.categories[0]&&e.categorical.categories[0].source&&e.categorical.categories[0].source.roles&&e.categorical.categories[0].source.roles.Play;return 9===this.type&&(this.animator||this.isMobileChart)&&null!=e.matrix&&(!e.categorical||t)},a.getIsScalar=function(i,a,r){var o=e.DataViewObjects.getValue(i,a);return i&&void 0!==o?o===t.axisType.scalar&&!t.AxisHelper.isOrdinal(r):!t.AxisHelper.isOrdinal(r)},a.getAdditionalTelemetry=function(e){var i={},a=e&&e.categorical&&_.first(e.categorical.categories);return a&&(i.axisType=t.CartesianChart.getIsScalar(e.metadata.objects,t.columnChartProps.categoryAxis.axisType,a.source.type)?"scalar":"categorical"),i},a.detectScalarMapping=function(e){if(!e||!e.categorical||!e.categorical.categories)return!1;var i=e.categorical.categories,r=i["for"]["in"].items;if(_.isEmpty(r))return!1;var o=r[0].type;if(!e.metadata)return!1;var n=e.metadata.objects;return a.getIsScalar(n,t.columnChartProps.categoryAxis.axisType,o)},a.prototype.populateObjectProperties=function(i){if(i&&i.length>0){var a=i[0].metadata;a?(this.legendObjectProperties=e.DataViewObjects.getObject(a.objects,"legend",{}),this.xAxisReferenceLines=e.DataViewObjects.getUserDefinedObjects(a.objects,"xAxisReferenceLine"),this.y1AxisReferenceLines=e.DataViewObjects.getUserDefinedObjects(a.objects,"y1AxisReferenceLine")):this.legendObjectProperties={},this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(a),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(a)}},a.prototype.updateInternal=function(r,o){var n=this.dataViews=r.dataViews;if(this.currentViewport=r.viewport,n){if(0===this.layers.length){var s=this.extractMetadataObjects(n);this.layers=this.createAndInitLayers(s)}var l=this.layers;if(null!=o){if(!_.isEmpty(n)){this.populateObjectProperties(n),this.axes.update(n),this.svgAxes.update(this.categoryAxisProperties,this.valueAxisProperties);var c=n[0];if(c.metadata&&(this.background={image:e.DataViewObjects.getValue(c.metadata.objects,t.scatterChartProps.plotArea.image),transparency:e.DataViewObjects.getValue(c.metadata.objects,t.scatterChartProps.plotArea.transparency,t.visualBackgroundHelper.getDefaultTransparency())},this.cartesianLoadMoreEnabled)){var u=!0,h=c&&c.categorical&&_.first(c.categorical.categories);h&&h.source&&(u=t.CartesianChart.getIsScalar(c.metadata.objects,t.columnChartProps.categoryAxis.axisType,h.source.type)),u&&this.loadMoreDataHandler?this.loadMoreDataHandler=null:u||this.loadMoreDataHandler||(this.loadMoreDataHandler=new v(null,this.hostServices.loadMoreData,a.LoadMoreThreshold))}}this.sharedColorPalette.clearPreferredScale();var d=i(n),p=_.filter(n,function(e){return t.TrendLineHelper.isDataViewForRegression(e)});this.trendLines=[];for(var g=0,m=l.length;m>g;g++){var f=d[g];if(l[g].setData(f?[f]:[]),this.supportsTrendLines(g)){var y=p[g];if(y){var b=g>0,C=t.TrendLineHelper.readDataView(y,f,b,this.sharedColorPalette);(x=this.trendLines).push.apply(x,C)}}m>1&&this.sharedColorPalette.rotateScale()}}if(this.loadMoreDataHandler&&null!=o&&this.loadMoreDataHandler.onLoadMoreDataCompleted(),this.render(!this.hasSetData||r.suppressAnimations,r.resizeMode,o),this.hasSetData=this.hasSetData||n&&n.length>0,n&&n.length>0){var S=t.getInvalidValueWarnings(n,!1,!1,!1);this.axes.addWarnings(S),S&&S.length>0&&this.hostServices.setWarnings(S)}var x}},a.prototype.onDataChanged=function(t){this.updateInternal({dataViews:t.dataViews,suppressAnimations:t.suppressAnimations,viewport:this.currentViewport},null!=t.operationKind?t.operationKind:e.VisualDataChangeOperationKind.Create)},a.prototype.onResizing=function(e,t){this.updateInternal({dataViews:this.dataViews,suppressAnimations:!0,viewport:e,resizeMode:t})},a.prototype.scrollTo=function(e){this.scrollableAxes.scrollTo(e)},a.prototype.enumerateObjectInstances=function(i){var a=new t.ObjectEnumerationBuilder,r=this.layers?this.layers.length:0;if("legend"===i.objectName){if(!this.shouldShowLegendCard())return;var o=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.show,this.legend.isVisible()),n=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.showTitle,!0),s=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.titleText,this.layerLegendData?this.layerLegendData.title:""),l=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.labelColor,t.LegendData.DefaultLegendLabelFillColor),c=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.fontSize,this.layerLegendData&&this.layerLegendData.fontSize?this.layerLegendData.fontSize:t.SVGLegend.DefaultFontSizeInPt);a.pushInstance({selector:null,properties:{show:o,position:t.LegendPosition[this.legend.getOrientation()],showTitle:n,titleText:s,labelColor:l,fontSize:c},objectName:i.objectName})}else if("categoryAxis"===i.objectName&&this.axes.hasCategoryAxis())this.getCategoryAxisValues(a);else if("valueAxis"===i.objectName)this.getValueAxisValues(a);else if("y1AxisReferenceLine"===i.objectName){var u=this.sharedColorPalette.getColorByIndex(0).value;t.ReferenceLineHelper.enumerateObjectInstances(a,this.y1AxisReferenceLines,u,i.objectName)}else if("xAxisReferenceLine"===i.objectName){var u=this.sharedColorPalette.getColorByIndex(0).value;t.ReferenceLineHelper.enumerateObjectInstances(a,this.xAxisReferenceLines,u,i.objectName)}else"trend"===i.objectName?this.supportsTrendLines()&&t.TrendLineHelper.enumerateObjectInstances(a,this.trendLines):"plotArea"===i.objectName&&t.visualBackgroundHelper.enumeratePlot(a,this.background);if("dataPoint"===i.objectName&&t.ComboChart.isComboChart(this.type))t.ComboChart.enumerateDataPoints(a,i,this.layers);else for(var h=0,d=r;d>h;h++){var p=this.layers[h];p.enumerateObjectInstances&&p.enumerateObjectInstances(a,i)}return a.complete()},a.prototype.supportsTrendLines=function(e){var t=i(this.dataViews);if(_.isEmpty(this.layers))return!1;var a=null==e?this.layers:[this.layers[e]];return _.all(a,function(e,i){return t[i]?e.supportsTrendLine&&e.supportsTrendLine():!0})},a.prototype.shouldShowLegendCard=function(){var e=this.layers,t=this.dataViews;if(e&&t)for(var i=e.length,a=0,r=0;i>r;r++){if(e[r].hasLegend())return!0;var o=t[r];if(o&&o.categorical&&o.categorical.values&&o.categorical.values.length>0&&(a++,a>1))return!0}return!1},a.prototype.getAxisScaleOptions=function(e){var i=[l];return this.axes.isLogScaleAllowed(e)&&i.push(t.axisScale.log),i},a.prototype.getCategoryAxisValues=function(e){if(this.categoryAxisProperties){var i=t.axisType.both,a=!1,r=this.getAxisScaleOptions(0);this.layers&&this.layers[0].getSupportedCategoryAxisType&&(i=this.layers[0].getSupportedCategoryAxisType(),a=i===t.axisType.scalar?!0:t.CartesianHelper.isScalar(i===t.axisType.both,this.categoryAxisProperties)),a||(this.categoryAxisProperties.start=null,this.categoryAxisProperties.end=null);var o={selector:null,properties:{},objectName:"categoryAxis",validValues:{axisScale:r,axisStyle:this.axes.categoryAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly]}};if(o.properties.show=null!=this.categoryAxisProperties.show?this.categoryAxisProperties.show:!0,this.axes.isYAxisCategorical()&&(o.properties.position=this.valueAxisProperties&&null!=this.valueAxisProperties.position?this.valueAxisProperties.position:t.yAxisPosition.left),i===t.axisType.both&&(o.properties.axisType=a?t.axisType.scalar:t.axisType.categorical),a&&(o.properties.axisScale=this.categoryAxisProperties.axisScale||l,o.properties.start=this.categoryAxisProperties.start,o.properties.end=this.categoryAxisProperties.end),o.properties.showAxisTitle=null!=this.categoryAxisProperties.showAxisTitle?this.categoryAxisProperties.showAxisTitle:!1,o.properties.axisStyle=this.categoryAxisProperties.axisStyle?this.categoryAxisProperties.axisStyle:t.axisStyle.showTitleOnly,o.properties.labelColor=this.categoryAxisProperties.labelColor||t.DEFAULT_AXIS_COLOR,a){o.properties.labelDisplayUnits=this.categoryAxisProperties.labelDisplayUnits?this.categoryAxisProperties.labelDisplayUnits:0;var n=this.categoryAxisProperties.labelPrecision;o.properties.labelPrecision=void 0===n||0>n?t.dataLabelUtils.defaultLabelPrecision:n}e.pushInstance(o)}},a.prototype.getValueAxisValues=function(i){if(this.valueAxisProperties){var a=this.getAxisScaleOptions(1),r=this.getAxisScaleOptions(2),o={selector:null,properties:{},objectName:"valueAxis",validValues:{axisScale:a,secAxisScale:r,axisStyle:this.axes.valueAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly]}};if(o.properties.show=null!=this.valueAxisProperties.show?this.valueAxisProperties.show:!0,this.axes.isYAxisCategorical()||(o.properties.position=null!=this.valueAxisProperties.position?this.valueAxisProperties.position:t.yAxisPosition.left),o.properties.axisScale=this.valueAxisProperties.axisScale||l,o.properties.start=this.valueAxisProperties.start,o.properties.end=this.valueAxisProperties.end,o.properties.showAxisTitle=null!=this.valueAxisProperties.showAxisTitle?this.valueAxisProperties.showAxisTitle:!1,o.properties.axisStyle=null!=this.valueAxisProperties.axisStyle?this.valueAxisProperties.axisStyle:t.axisStyle.showTitleOnly,o.properties.labelColor=this.valueAxisProperties.labelColor||t.DEFAULT_AXIS_COLOR,7!==this.type&&8!==this.type){o.properties.labelDisplayUnits=this.valueAxisProperties.labelDisplayUnits?this.valueAxisProperties.labelDisplayUnits:0;var n=this.valueAxisProperties.labelPrecision;o.properties.labelPrecision=void 0===n||0>n?t.dataLabelUtils.defaultLabelPrecision:n}if(i.pushInstance(o),2===this.layers.length&&(o.properties.secShow=null!=this.valueAxisProperties.secShow?this.valueAxisProperties.secShow:this.axes.hasY2Axis(),o.properties.secShow&&(o.properties.axisLabel="")),this.axes.hasY2Axis()&&o.properties.secShow){i.pushContainer({displayName:e.data.createDisplayNameGetter("Visual_YAxis_ShowSecondary")});var s={selector:null,properties:{},objectName:"valueAxis"};s.properties.secAxisLabel="",s.properties.secPosition=null!=this.valueAxisProperties.secPosition?this.valueAxisProperties.secPosition:t.yAxisPosition.right,s.properties.secAxisScale=this.valueAxisProperties.secAxisScale||l,s.properties.secStart=this.valueAxisProperties.secStart,s.properties.secEnd=this.valueAxisProperties.secEnd,s.properties.secShowAxisTitle=null!=this.valueAxisProperties.secShowAxisTitle?this.valueAxisProperties.secShowAxisTitle:!1,i.pushInstance(s).pushInstance({selector:null,properties:{secAxisStyle:this.valueAxisProperties.secAxisStyle?this.valueAxisProperties.secAxisStyle:t.axisStyle.showTitleOnly,labelColor:this.valueAxisProperties.secLabelColor,secLabelDisplayUnits:this.valueAxisProperties.secLabelDisplayUnits?this.valueAxisProperties.secLabelDisplayUnits:0,secLabelPrecision:this.valueAxisProperties.secLabelPrecision<0?0:this.valueAxisProperties.secLabelPrecision},objectName:"valueAxis",validValues:{secAxisStyle:this.axes.secondaryValueAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly],axisScale:a}}),i.popContainer()}}},a.prototype.onClearSelection=function(){if(this.hasSetData)for(var e=0,t=this.layers.length;t>e;e++){var i=this.layers[e];i.onClearSelection(),i.render(!0)}},a.prototype.extractMetadataObjects=function(e){var t;if(e&&e.length>0){var i=e[0].metadata;i&&(t=i.objects)}return t},a.prototype.createAndInitLayers=function(t){var i=this,a=f.createLayers(this.type,t,this.interactivityService,this.animator,this.axes.isScrollable,this.tooltipsEnabled,this.tooltipBucketEnabled,this.lineChartLabelDensityEnabled,this.cartesianLoadMoreEnabled),r=e.Prototype.inherit(this.visualInitOptions);r.svg=this.svgAxes.getScrollableRegion(),r.labelsContext=this.svgAxes.getLabelsRegion(),r.cartesianHost={updateLegend:function(e){return i.legend.drawLegend(e,i.currentViewport)},getSharedColors:function(){return i.sharedColorPalette},triggerRender:function(e){return i.render(e)}},r.chartType=this.type;for(var o=0,n=a.length;n>o;o++)a[o].init(r);return a},a.prototype.renderLegend=function(){for(var e=this.layers,i={title:"",dataPoints:[]},a=function(a,o){r.layerLegendData=e[a].calculateLegend(),r.layerLegendData&&(i.title=0===a?r.layerLegendData.title||"":i.title,i.labelColor=r.layerLegendData.labelColor,_.isEmpty(r.layerLegendData.dataPoints)||r.layerLegendData.dataPoints.forEach(function(e){return e.layerNumber=a}),i.dataPoints=i.dataPoints.concat(r.layerLegendData.dataPoints||[]),i.fontSize=r.layerLegendData.fontSize||t.SVGLegend.DefaultFontSizeInPt,r.layerLegendData.grouped&&(i.grouped=!0))},r=this,o=0,n=e.length;n>o;o++)a(o,n);var s=this.legendObjectProperties;if(s){t.LegendData.update(i,s);var l=s[t.legendProps.position];l&&this.legend.changeOrientation(t.LegendPosition[l])}else this.legend.changeOrientation(t.LegendPosition.Top);(1===i.dataPoints.length&&!i.grouped||this.hideLegends())&&(i.dataPoints=[]),this.legend.drawLegend(i,this.currentViewport)},a.prototype.hideLegends=function(){return!!(this.cartesianSmallViewPortProperties&&this.cartesianSmallViewPortProperties.hideLegendOnSmallViewPort&&this.currentViewport.height<this.cartesianSmallViewPortProperties.MinHeightLegendVisible)},a.prototype.render=function(i,r,o){var n=this;this.visualInitOptions.interactivity&&this.visualInitOptions.interactivity.isInteractiveLegend||this.renderLegend();var s,l=this.legendMargins=this.legend.getMargins(),c=this.legend.getOrientation(),u=this.hideAxisLabels(l),h={height:this.currentViewport.height-l.height,width:this.currentViewport.width-l.width},d=e.Prototype.inherit(g.AxisPadding);this.isPlayAxis()&&(h.height-=a.PlayAxisBottomMargin,s={left:t.Legend.isLeft(c)?l.width:0,top:t.Legend.isTop(c)?l.height+h.height:h.height,height:a.PlayAxisBottomMargin,width:h.width}),this.chartAreaSvg.attr({width:h.width,height:h.height}),t.Legend.positionChartArea(this.chartAreaSvg,this.legend);var p=this.calculateInteractivityRightMargin(),m=this.getMinimumDomainExtents(),f=m[0],y=m[1],v=this.axes.negotiateAxes(this.layers,h,d,s,u,a.AxisTextProperties,p,f,y),b=v.axes.x.isCategoryAxis?v.axes.x:v.axes.y1;this.loadMoreDataHandler&&this.loadMoreDataHandler.setScale(b.scale);var C=!this.renderedPlotArea||this.renderedPlotArea.height!==v.plotArea.height||this.renderedPlotArea.width!==v.plotArea.width;i=i||C,this.scrollableAxes.render(v,this.layers,i,function(e,t,i){return n.renderPlotArea(e,t,i,l,r)},this.loadMoreDataHandler,o===e.VisualDataChangeOperationKind.Append),this.chartAreaSvg.on("wheel",function(){if(n.axes.isXScrollBarVisible||n.axes.isYScrollBarVisible){t.TooltipManager.ToolTipInstance.hide();var e=d3.event,i=e.deltaY;n.scrollableAxes.scrollDelta(i)}}),this.renderedPlotArea=v.plotArea},a.prototype.getMinimumDomainExtents=function(){var e=[],i=[];if(!_.isEmpty(this.xAxisReferenceLines)){var a=this.xAxisReferenceLines[0].object,r=t.ReferenceLineHelper.extractReferenceLineValue(a);e.push(r)}if(!_.isEmpty(this.y1AxisReferenceLines)){var o=this.y1AxisReferenceLines[0].object,r=t.ReferenceLineHelper.extractReferenceLineValue(o);i.push(r)}var n={min:d3.min(e),max:d3.max(e)},s={min:d3.min(i),max:d3.max(i)};return[n,s]},a.prototype.getPlotAreaRect=function(e,i){var a={left:e.margin.left,top:e.margin.top,width:e.plotArea.width,height:e.plotArea.height};if(this.legend){var r=this.legend.getOrientation();t.Legend.isTop(r)?a.top+=i.height:t.Legend.isLeft(r)&&(a.left+=i.width)}return a},a.prototype.renderBackgroundImage=function(e){t.visualBackgroundHelper.renderBackgroundImage(this.background,this.element,e)},a.prototype.hideAxisLabels=function(e){return!(!(this.cartesianSmallViewPortProperties&&this.cartesianSmallViewPortProperties.hideAxesOnSmallViewPort&&this.currentViewport.height<this.cartesianSmallViewPortProperties.MinHeightAxesVisible)||this.visualInitOptions.interactivity.isInteractiveLegend)},a.prototype.calculateInteractivityRightMargin=function(){return this.visualInitOptions.interactivity&&this.visualInitOptions.interactivity.isInteractiveLegend&&!this.trimOrdinalDataOnOverflow?u:0},a.prototype.renderPlotArea=function(e,i,a,r,o){var n=i.axes,s=i.plotArea,l=this.getPlotAreaRect(i,r),c=t.AnimatorCommon.GetAnimationDuration(this.animator,a),u=this.animator&&this.animator.getEasing();this.renderBackgroundImage(l),_.isEmpty(u)?this.svgAxes.renderAxes(i,c):this.svgAxes.renderAxes(i,c,u),this.renderReferenceLines(i),this.renderLayers(e,s,n,a,o),this.renderTrendLines(i)},a.prototype.renderTrendLines=function(e){var i=this.svgAxes.getScrollableRegion();t.TrendLineHelper.render(this.trendLines,i,e.axes,e.plotArea)},a.prototype.renderReferenceLines=function(e){var i=e.axes,a=e.plotArea,r=this.svgAxes.getScrollableRegion(),o=this.sharedColorPalette.getColorByIndex(0).value,n=!1;if(this.y1AxisReferenceLines)for(var s=0,l=this.y1AxisReferenceLines;s<l.length;s++){var c=l[s],u=c.object;if(u[t.ReferenceLineHelper.referenceLineProps.show]){var h=!i.y1.isCategoryAxis,d={graphicContext:r,referenceLineProperties:u,axes:i,viewport:a,classAndSelector:this.y1RefLine,defaultColor:o,isHorizontal:h};t.ReferenceLineHelper.render(d),n=!0}}n||r.selectAll(this.y1RefLine.selector).remove();var p=!1;if(this.xAxisReferenceLines)for(var g=0,m=this.xAxisReferenceLines;g<m.length;g++){var c=m[g],u=c.object;if(u[t.ReferenceLineHelper.referenceLineProps.show]){
var h=!1,f={graphicContext:r,referenceLineProperties:u,axes:i,viewport:a,classAndSelector:this.xRefLine,defaultColor:o,isHorizontal:h};t.ReferenceLineHelper.render(f),p=!0}}p||r.selectAll(this.xRefLine.selector).remove()},a.prototype.getReferenceLineLabels=function(e,i){var a=this.sharedColorPalette.getColorByIndex(0).value,r=[];if(this.y1AxisReferenceLines)for(var o=0,n=this.y1AxisReferenceLines;o<n.length;o++){var s=n[o],l=s.object;if(l[t.ReferenceLineHelper.referenceLineProps.show]&&l[t.ReferenceLineHelper.referenceLineProps.dataLabelShow]){var c=!e.y1.isCategoryAxis,u={referenceLineProperties:l,axes:e,viewport:i,defaultColor:a,isHorizontal:c,key:JSON.stringify({type:"y1AxisReferenceLine",id:s.id})};r.push(t.ReferenceLineHelper.createLabelDataPoint(u))}}if(this.xAxisReferenceLines)for(var h=0,d=this.xAxisReferenceLines;h<d.length;h++){var s=d[h],l=s.object;if(l[t.ReferenceLineHelper.referenceLineProps.show]&&l[t.ReferenceLineHelper.referenceLineProps.dataLabelShow]){var c=!1,p={referenceLineProperties:l,axes:e,viewport:i,defaultColor:a,isHorizontal:c,key:JSON.stringify({type:"xAxisReferenceLine",id:s.id})};r.push(t.ReferenceLineHelper.createLabelDataPoint(p))}}return r},a.prototype.renderDataLabels=function(i,a,r,o,n){var s=this.svgAxes.getLabelBackground(),l=this.svgAxes.getLabelsRegion();if(this.behavior){var c=t.NewDataLabelUtils.getDataLabelLayoutOptions(this.type),u=new e.LabelLayout(c),h=u.layout(i,r);n&&t.NewDataLabelUtils.drawLabelBackground(s,h,"#FFFFFF",.7);var d=void 0,p=this.animator;if(p&&!o){var g=this.isPlayAxis(),m=g?t.PlayChart.FrameAnimationDuration:p.getDuration();d=t.NewDataLabelUtils.animateDefaultLabels(l,h,m,a,g?"linear":p.getEasing())}else d=t.NewDataLabelUtils.drawDefaultLabels(l,h,a);if(c.allowLeaderLines){var f=_.filter(h,function(e){return null!=e.leaderLinePoints&&!_.isEmpty(e.leaderLinePoints)&&null!=e.identity});t.NewDataLabelUtils.drawLabelLeaderLines(l,f,function(e){return e.identity.getKey()})}if(this.interactivityService&&this.isLabelInteractivityEnabled){var y={labelItems:d};this.interactivityService.bind(h,new t.LabelsBehavior,y,{isLabels:!0})}}else{var u=new e.LabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0}),h=u.layout(i,r);n&&t.NewDataLabelUtils.drawLabelBackground(s,h,"#FFFFFF",.7),t.NewDataLabelUtils.drawDefaultLabels(l,h,a)}},a.prototype.renderLayers=function(e,i,a,r,o){for(var n=[],s=[],l=[],c=!0,u=0,h=e.length;h>u;u++){var d=e[u].render(r,o);if(d){if(this.behavior&&(s=s.concat(d.dataPoints),l.push(d.behaviorOptions)),d.labelDataPointGroups)for(var p=d.labelDataPointGroups,g=0,m=p;g<m.length;g++){var f=m[g];f&&n.push({labelDataPoints:t.NewDataLabelUtils.removeDuplicates(f.labelDataPoints||[]),maxNumberOfLabels:f.maxNumberOfLabels})}else{var y=d.labelDataPoints||[];n.push({labelDataPoints:t.NewDataLabelUtils.removeDuplicates(y),maxNumberOfLabels:y.length})}c=c&&d.labelsAreNumeric}}var v=this.getReferenceLineLabels(a,i);if(_.isEmpty(v)||n.unshift({labelDataPoints:v,maxNumberOfLabels:v.length}),this.renderDataLabels(n,c,i,r,t.ComboChart.isComboChart(this.type)),this.interactivityService){var b={layerOptions:l,clearCatcher:this.clearCatcher};this.interactivityService.bind(s,this.behavior,b)}},a.getPreferredPlotArea=function(e,t,i,r,o,n,s){n||(n={top:0,right:0,bottom:0,left:0});var l={height:i.height-n.top-n.bottom,width:i.width-n.left-n.right};if(!o&&r){var c=a.getPreferredCategorySpan(e,t,s);l.width=Math.max(c,l.width)}return l},a.getPreferredCategorySpan=function(e,t,i){var r=t*e;return i?r:r+t*a.OuterPaddingRatio*2},a.getLayout=function(t,i){var r=i.categoryCount,o=i.availableWidth,n=i.domain,s=i.trimOrdinalDataOnOverflow,l=!!i.isScalar,c=!!i.isScrollable,u=a.getCategoryThickness(t?t.series:null,r,o,n,l,s),h=u*a.OuterPaddingRatio*2,d=e.Double.floorWithPrecision((o-h)/u),p=Math.min(d,r),g=r>p&&c,m=a.OuterPaddingRatio;if(!l&&!g){var f=(o-u*p)/2;m=f/u}return!l&&c&&(p=r),{categoryCount:p,categoryThickness:u,outerPaddingRatio:m,isScalar:l}},a.getCategoryThickness=function(e,t,i,r,o,n){var s;if(2>t)s=i*(1-a.OuterPaddingRatio);else if(o&&r&&r.length>1){var l=a.getMinInterval(e),c=r[r.length-1]-r[0],u=l/(c+l*a.OuterPaddingRatio*2);s=i*u,s=Math.max(s,a.MinScalarRectThickness)}else s=i/(t+2*a.OuterPaddingRatio),n&&(s=Math.max(s,a.MinOrdinalRectThickness));var h=i/(3+2*a.OuterPaddingRatio);return s=Math.min(s,h),!o&&t>=3&&n?Math.max(s,a.MinOrdinalRectThickness):s},a.getMinInterval=function(e){var t=Number.MAX_VALUE;if(e.length>0)for(var i=e[0].data.filter(function(e){return!e.highlight}),a=0,r=i.length-1;r>a;a++)t=Math.min(t,Math.abs(i[a+1].categoryValue-i[a].categoryValue));return t},a.applyLoadMoreEnabledToMapping=function(e,t){var i=100,a=60;if(e){var r=t.categorical;if(r){var o=r.categories,n=r.values;o&&(o.dataReductionAlgorithm={window:{count:i}}),n&&n.group&&(n.group.dataReductionAlgorithm={top:{count:a}})}}},a.MinOrdinalRectThickness=20,a.MinScalarRectThickness=2,a.OuterPaddingRatio=.4,a.InnerPaddingRatio=.2,a.TickLabelPadding=2,a.LoadMoreThreshold=1,a.ClassName="cartesianChart",a.PlayAxisBottomMargin=80,a.FontSize=11,a.FontSizeString=jsCommon.PixelConverter.toString(a.FontSize),a.AxisTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:a.FontSizeString},a}();t.CartesianChart=h;var d=function(){function e(e){this.brush=d3.svg.brush(),this.brushWidth=e}return e.prototype.init=function(e){this.element=e},e.prototype.remove=function(){this.element.selectAll(e.Brush.selector).remove(),this.brushGraphicsContext=void 0},e.prototype.getExtent=function(){return this.brush.extent()},e.prototype.setExtent=function(e){this.brush.extent(e)},e.prototype.setScale=function(e){this.isHorizontal?this.brush.x(e):this.brush.y(e)},e.prototype.setOrientation=function(e){this.isHorizontal=e},e.prototype.renderBrush=function(i,a,r,o){var n=this;this.brushGraphicsContext||(this.brushGraphicsContext=this.element.append("g").classed(e.Brush["class"],!0)),this.scrollCallback=o,this.brush.on("brushstart",function(){return n.brushStartExtent=n.brush.extent()}).on("brush",function(){window.requestAnimationFrame(o)}).on("brushend",function(){n.resizeExtent(i),n.updateExtentPosition(i),n.brushStartExtent=null});var s=this.brushGraphicsContext.attr({transform:t.SVGUtil.translate(a,r),"drag-resize-disabled":"true"}).call(this.brush);s.selectAll(".resize").remove(),this.isHorizontal?s.selectAll("rect").attr("height",this.brushWidth):s.selectAll("rect").attr("width",this.brushWidth)},e.prototype.scroll=function(e){this.updateExtentPosition(e),this.scrollCallback()},e.prototype.updateExtentPosition=function(e){var t=this.brush.extent(),i=t[0],a=e/2;if(t[0]===t[1]&&(i-=a),t[1]-t[0]>e){var r=(t[1]-t[0])/2;i=t[0]<this.brushStartExtent[0]?t[0]+r-a:t[1]-r-a}this.isHorizontal?this.brushGraphicsContext.select(".extent").attr("x",i):this.brushGraphicsContext.select(".extent").attr("y",i)},e.prototype.resizeExtent=function(e){this.isHorizontal?this.brushGraphicsContext.select(".extent").attr("width",e):this.brushGraphicsContext.select(".extent").attr("height",e)},e.Brush=s("brush"),e}(),p=function(){function i(e,t){this.axes=e,this.brush=t}return i.prototype.filterDataToViewport=function(e,i,a,r,o,n){if(r){var s,l=[],c=t.AxisHelper.lookupOrdinalIndex(r,o[0]),u=c+n,h=r.domain();if(s=h.slice(c,u),s&&s.length>0){for(var d=0;d<i.length;d++)l[d]=i[d].setFilteredData(s[0],s[s.length-1]+1);e.domain(s);var p=void 0;p=this.axes.isXScrollBarVisible?a.x:a.y1,p.axis.scale(e),p.scale(e),p.axis.ticks(s.length),p.axis.tickValues(s);var g=p.axis.tickFormat();p.values=_.map(s,function(e){return g(e)})}return{startIndex:c,endIndex:u-1}}},i.prototype.render=function(t,a,r,o,n,s){var l=this,c=t.plotArea;if(!(c.width<1||c.height<1)){this.axisScale=null;var u,d,p,g,m,f,y=this.axes.isXScrollBarVisible||this.axes.isYScrollBarVisible;if(n||y)if(this.axes.isYAxisCategorical()){this.axisScale=t.axes.y1.scale,u=t.viewport.width,d=t.margin.top,m=t.axes.y1.categoryThickness;var v=t.axes.y1.outerPadding;g=e.Double.floorWithPrecision((c.height-2*v)/m),p=(g+1)*m,f=c.height}else{this.axisScale=t.axes.x.scale,u=t.margin.left,d=t.viewport.height,m=t.axes.x.categoryThickness;var v=t.axes.x.outerPadding;g=e.Double.floorWithPrecision((c.width-2*v)/m),p=(g+1)*m,f=c.width}if(!y)return n&&(n.viewportDataRange={startIndex:0,endIndex:g},n.shouldLoadMoreData()&&n.loadMoreData()),this.brush.remove(),void o(a,t,r);if(!(1>g)){this.scrollScale=this.axisScale.copy(),this.scrollScale.rangeBands([0,p]),this.brushMinExtent=this.scrollScale(g-1),this.axisScale.rangeBands([0,f],h.InnerPaddingRatio,h.OuterPaddingRatio),this.brush.setOrientation(this.axes.isXScrollBarVisible),this.brush.setScale(this.scrollScale),this.brush.setExtent([0,this.brushMinExtent]);var b=function(e,i){var r=l.filterDataToViewport(l.axisScale,a,t.axes,l.scrollScale,e,g);n&&(n.viewportDataRange=r,n.shouldLoadMoreData()&&n.loadMoreData()),o(a,t,i)},C=function(){return l.onBrushed(p,b)};if(this.brush.renderBrush(this.brushMinExtent,u,d,C),s&&n){var S=n.viewportDataRange?n.viewportDataRange.startIndex:0;i.clampBrushExtent(this.brush,p,this.brushMinExtent),this.scrollTo(S)}else b(this.brush.getExtent(),r)}}},i.prototype.scrollDelta=function(e){if(this.axisScale&&!_.isEmpty(this.axisScale.domain())){var t=this.axisScale.domain()[0],i=t+Math.round(e/h.MinOrdinalRectThickness);this.scrollTo(i)}},i.prototype.scrollTo=function(e){var t=_.last(this.scrollScale.domain());e=Math.max(0,Math.min(e,t));var a=this.brush.getExtent(),r=a[1]-a[0],o=(this.scrollScale(1)-this.scrollScale(0))/2;a[0]=this.scrollScale(e)+o,a[1]=a[0]+r+o,this.brush.setExtent(a);var n=this.scrollScale.rangeExtent()[1];i.clampBrushExtent(this.brush,n,this.brushMinExtent),this.brush.scroll(n)},i.prototype.onBrushed=function(e,t){var a=this.brush;i.clampBrushExtent(this.brush,e,this.brushMinExtent);var r=a.getExtent();t(r,!0)},i.clampBrushExtent=function(e,t,i){var a=e.getExtent(),r=a[1]-a[0];if(!(r===i&&a[1]<=t&&a[0]>=0)){if(r>i){var o=(r-i)/2;a[0]+=o,a[1]-=o}else if(i>r){var o=(i-r)/2;a[0]-=o,a[1]+=o}a[0]<0?(a[0]=0,a[1]=i):a[0]>t-i&&(a[0]=t-i,a[1]=t),e.setExtent(a)}},i.ScrollbarWidth=10,i}(),g=function(){function i(e){this.axes=e}return i.prototype.getScrollableRegion=function(){return this.axisGraphicsContextScrollable},i.prototype.getLabelsRegion=function(){return this.labelRegion},i.prototype.getLabelBackground=function(){return this.labelBackgroundRegion},i.prototype.getXAxis=function(){return this.xAxisGraphicsContext},i.prototype.getY1Axis=function(){return this.y1AxisGraphicsContext},i.prototype.getY2Axis=function(){return this.y2AxisGraphicsContext},i.prototype.update=function(e,t){this.categoryAxisProperties=e,this.valueAxisProperties=t},i.prototype.init=function(e){var a=this.axisGraphicsContext=e.append("g").classed(i.AxisGraphicsContext["class"],!0);this.svgScrollable=e.append("svg").classed("svgScrollable",!0).style("overflow","hidden");var r=this.axisGraphicsContextScrollable=this.svgScrollable.append("g").classed(i.AxisGraphicsContext["class"],!0);this.labelBackgroundRegion=this.svgScrollable.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass["class"],!0),this.labelRegion=this.svgScrollable.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass["class"],!0);var o=this.axes.showLinesOnX,n=this.axes.showLinesOnY,s=n,l=!s;l?(this.y1AxisGraphicsContext=r.append("g").attr("class","y axis"),this.y2AxisGraphicsContext=r.append("g").attr("class","y axis")):(this.y1AxisGraphicsContext=a.append("g").attr("class","y axis"),this.y2AxisGraphicsContext=a.append("g").attr("class","y axis")),s?this.xAxisGraphicsContext=r.append("g").attr("class","x axis"):this.xAxisGraphicsContext=a.append("g").attr("class","x axis"),this.xAxisGraphicsContext.classed("showLinesOnAxis",o),this.y1AxisGraphicsContext.classed("showLinesOnAxis",n),this.y2AxisGraphicsContext.classed("showLinesOnAxis",n),this.xAxisGraphicsContext.classed("hideLinesOnAxis",!o),this.y1AxisGraphicsContext.classed("hideLinesOnAxis",!n),this.y2AxisGraphicsContext.classed("hideLinesOnAxis",!n)},i.updateAnimatedTickTooltips=function(e,t){e.each("end",function(){d3.select(this).selectAll("text").append("title").text(function(e,i){return t[i]})})},i.updateTickTooltips=function(e,t){e.selectAll("text").append("title").text(function(e,i){return t[i]})},i.prototype.renderAxes=function(a,r,o){void 0===o&&(o="cubic-in-out");var n,s,l,c=a.marginLimits,u=a.plotArea,d=a.viewport,p=a.margin,g=a.axes,m=a.tickLabelMargins,f=c.bottom,y=c.left;if(this.axes.shouldRenderAxis(g.x)){n=g.x.isCategoryAxis?this.categoryAxisProperties&&this.categoryAxisProperties.labelColor?this.categoryAxisProperties.labelColor:null:this.valueAxisProperties&&this.valueAxisProperties.labelColor?this.valueAxisProperties.labelColor:null,g.x.axis.orient("bottom"),!g.x.willLabelsFit&&t.AxisHelper.isOrdinalScale(g.x.scale)&&g.x.axis.tickPadding(i.TickPaddingRotatedX);var v=this.xAxisGraphicsContext;r?v.transition().duration(r).ease(o).call(g.x.axis).call(i.updateAnimatedTickTooltips,g.x.values):v.call(g.x.axis),v.call(i.darkenZeroLine).call(i.setAxisLabelColor,n);var b=v.selectAll("text");g.x.willLabelsWordBreak?b.call(t.AxisHelper.LabelLayoutStrategy.wordBreak,g.x,f):b.call(t.AxisHelper.LabelLayoutStrategy.rotate,f,e.TextMeasurementService.getTailoredTextOrDefault,h.AxisTextProperties,!g.x.willLabelsFit&&t.AxisHelper.isOrdinalScale(g.x.scale),f===m.xMax,g.x,p,this.axes.isXScrollBarVisible||this.axes.isYScrollBarVisible),r||i.updateTickTooltips(v,g.x.values)}else this.xAxisGraphicsContext.selectAll("*").remove();if(this.axes.shouldRenderAxis(g.y1)){s=g.y1.isCategoryAxis?this.categoryAxisProperties&&this.categoryAxisProperties.labelColor?this.categoryAxisProperties.labelColor:null:this.valueAxisProperties&&this.valueAxisProperties.labelColor?this.valueAxisProperties.labelColor:null;var C=this.axes.shouldShowY1OnRight(),S=C?a.tickPadding.right:a.tickPadding.left;g.y1.axis.tickSize(-u.width).tickPadding(S).orient(this.axes.getYAxisOrientation().toLowerCase());var x=this.y1AxisGraphicsContext;if(r?x.transition().duration(r).ease(o).call(g.y1.axis).call(i.updateAnimatedTickTooltips,g.y1.values):x.call(g.y1.axis),x.call(i.darkenZeroLine).call(i.setAxisLabelColor,s),m.yLeft>=y&&x.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.clip,y-S,e.TextMeasurementService.svgEllipsis),r||i.updateTickTooltips(x,g.y1.values),!g.y2||this.valueAxisProperties&&null!=this.valueAxisProperties.secShow&&!this.valueAxisProperties.secShow)this.y2AxisGraphicsContext.selectAll("*").remove();else{l=this.valueAxisProperties&&this.valueAxisProperties.secLabelColor?this.valueAxisProperties.secLabelColor:null;var w=C?a.tickPadding.left:a.tickPadding.right;g.y2.axis.tickSize(i.Y2TickSize).tickPadding(w).orient(C?t.yAxisPosition.left.toLowerCase():t.yAxisPosition.right.toLowerCase());var P=this.y2AxisGraphicsContext;r?P.transition().duration(r).ease(o).call(g.y2.axis).call(i.updateAnimatedTickTooltips,g.y2.values):P.call(g.y2.axis),P.call(i.darkenZeroLine).call(i.setAxisLabelColor,l),m.yRight>=y&&P.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.clip,y-w,e.TextMeasurementService.svgEllipsis),r||i.updateTickTooltips(P,g.y2.values)}}else this.y1AxisGraphicsContext.selectAll("*").remove(),this.y2AxisGraphicsContext.selectAll("*").remove();var D=a.axisLabels,L=null!=D.x||null!=D.y||null!=D.y2;if(L){var T=!this.axes.shouldRenderAxisTitle(g.x,!0,!1),_=!this.axes.shouldRenderAxisTitle(g.y1,!0,!1),V=!this.axes.shouldRenderAxisTitle(g.y2,!1,!0),M={axisLabels:D,viewport:d,margin:p,hideXAxisTitle:T,hideYAxisTitle:_,hideY2AxisTitle:V,xLabelColor:n,yLabelColor:s,y2LabelColor:l,fontSize:i.AxisLabelFontSize};this.renderAxesLabels(M)}else this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();this.translateAxes(d,p)},i.prototype.renderAxesLabels=function(i){this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();var a=i.margin,r=i.viewport.width-(a.left+a.right),o=i.viewport.height,n=i.fontSize,s=n,l=this.axes.shouldShowY1OnRight();if(!i.hideXAxisTitle){var c=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.axisLabels.x).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"xAxisLabel",transform:t.SVGUtil.translate(r/2,o-s)})})});c.style("fill",i.xLabelColor?i.xLabelColor.solid.color:null),c.call(t.AxisHelper.LabelLayoutStrategy.clip,r,e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.x])}if(!i.hideYAxisTitle){var u=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.axisLabels.y).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"yAxisLabel",transform:"rotate(-90)",y:l?r+a.right-n:-a.left,x:-((o-a.top-a.bottom)/2),dy:"1em"})})});u.style("fill",i.yLabelColor?i.yLabelColor.solid.color:null),u.call(t.AxisHelper.LabelLayoutStrategy.clip,o-(a.bottom+a.top),e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.y])}if(!i.hideY2AxisTitle&&i.axisLabels.y2){var h=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.axisLabels.y2).call(function(e){e.each(function(){var e=d3.select(this);e.attr({"class":"yAxisLabel",transform:"rotate(-90)",y:l?-a.left:r+a.right-n,x:-((o-a.top-a.bottom)/2),dy:"1em"})})});h.style("fill",i.y2LabelColor?i.y2LabelColor.solid.color:null),h.call(t.AxisHelper.LabelLayoutStrategy.clip,o-(a.bottom+a.top),e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.y2])}},i.prototype.translateAxes=function(e,i){var a=e.width-(i.left+i.right),r=e.height-(i.top+i.bottom),o=this.axes.shouldShowY1OnRight();this.xAxisGraphicsContext.attr("transform",t.SVGUtil.translate(0,r)),this.y1AxisGraphicsContext.attr("transform",t.SVGUtil.translate(o?a:0,0)),this.y2AxisGraphicsContext.attr("transform",t.SVGUtil.translate(o?0:a,0)),this.svgScrollable.attr({x:0,width:e.width,height:e.height}),this.axisGraphicsContext.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.labelRegion.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.labelBackgroundRegion.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.axes.isXScrollBarVisible?(this.svgScrollable.attr({x:i.left}),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(0,i.top)),this.labelRegion.attr("transform",t.SVGUtil.translate(0,i.top)),this.labelBackgroundRegion.attr("transform",t.SVGUtil.translate(0,i.top)),this.svgScrollable.attr("width",a)):this.axes.isYScrollBarVisible&&this.svgScrollable.attr("height",r+i.top)},i.darkenZeroLine=function(e){e.selectAll("g.tick line").classed("zero-line",!1);var t=e.selectAll("g.tick").filter(function(e){return 0===e}).node();t&&d3.select(t).select("line").classed("zero-line",!0)},i.setAxisLabelColor=function(e,t){e.selectAll("g.tick text").style("fill",t?t.solid.color:null)},i.AxisPadding={left:10,right:10,top:0,bottom:13},i.AxisGraphicsContext=s("axisGraphicsContext"),i.TickPaddingRotatedX=5,i.AxisLabelFontSize=11,i.Y2TickSize=-6,i}();t.SvgCartesianAxes=g;var m=function(){function i(e,a,r){this.scrollbarWidth=a,this.isScrollable=e,this.maxMarginFactor=i.MaxMarginFactor,this.yAxisOrientation=t.yAxisPosition.left,this.trimOrdinalDataOnOverflow=r}return i.prototype.shouldShowY1OnRight=function(){return this.yAxisOrientation===t.yAxisPosition.right},i.prototype.isYAxisCategorical=function(){return this.layout&&this.layout.axes.y1.isCategoryAxis},i.prototype.hasCategoryAxis=function(){var e=this.layout&&this.layout.axes;return e?this.isYAxisCategorical()?e.y1&&null!=e.y1.axis:e.x&&null!=e.x.axis:!1},i.prototype.hasY2Axis=function(){return this.layout&&null!=this.layout.axes.y2},i.prototype.getYAxisOrientation=function(){return this.yAxisOrientation},i.prototype.setAxisLinesVisibility=function(e){this.showLinesOnX=n.hasFlag(e,3)||n.hasFlag(e,1),this.showLinesOnY=n.hasFlag(e,3)||n.hasFlag(e,2)},i.prototype.setMaxMarginFactor=function(e){this.maxMarginFactor=e},i.prototype.update=function(e){if(e&&e.length>0){var i=e[0].metadata;this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(i),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(i)}var a=this.valueAxisProperties.position;this.yAxisOrientation=a?a.toString():t.yAxisPosition.left},i.prototype.addWarnings=function(e){var i=this.layout&&this.layout.axes;(i&&i.x&&i.x.hasDisallowedZeroInDomain||i.y1&&i.y1.hasDisallowedZeroInDomain||i.y2&&i.y2.hasDisallowedZeroInDomain)&&e.unshift(new t.ZeroValueWarning)},i.prototype.calculateAxes=function(i,n,s,c,u,h,d,p,g,m){var f,y={viewport:n,margin:s,forcedXDomain:[this.categoryAxisProperties?this.categoryAxisProperties.start:null,this.categoryAxisProperties?this.categoryAxisProperties.end:null],forceMerge:this.valueAxisProperties&&this.valueAxisProperties.secShow===!1,showCategoryAxisLabel:!1,showValueAxisLabel:!1,trimOrdinalDataOnOverflow:this.trimOrdinalDataOnOverflow,categoryAxisScaleType:this.categoryAxisProperties&&null!=this.categoryAxisProperties.axisScale?this.categoryAxisProperties.axisScale:l,valueAxisScaleType:this.valueAxisProperties&&null!=this.valueAxisProperties.axisScale?this.valueAxisProperties.axisScale:l,categoryAxisDisplayUnits:this.categoryAxisProperties&&null!=this.categoryAxisProperties.labelDisplayUnits?this.categoryAxisProperties.labelDisplayUnits:0,valueAxisDisplayUnits:this.valueAxisProperties&&null!=this.valueAxisProperties.labelDisplayUnits?this.valueAxisProperties.labelDisplayUnits:0,categoryAxisPrecision:this.categoryAxisProperties?t.CartesianHelper.getPrecision(this.categoryAxisProperties.labelPrecision):null,valueAxisPrecision:this.valueAxisProperties?t.CartesianHelper.getPrecision(this.valueAxisProperties.labelPrecision):null,playAxisControlLayout:c,ensureXDomain:g,ensureYDomain:m},v=this.valueAxisProperties&&this.valueAxisProperties.secShow===!0,b=!1;a(i)&&!v&&(f=o(i,y),b=f.merged,b?y.forcedYDomain=f.domain:y.forcedTickCount=f.tickCount),this.valueAxisProperties&&(y.forcedYDomain=t.AxisHelper.applyCustomizedDomain([this.valueAxisProperties.start,this.valueAxisProperties.end],y.forcedYDomain));for(var C,S=0,x=i.length;x>S;S++){var w=i[S];1!==S||b||(y.forcedYDomain=this.valueAxisProperties?[this.valueAxisProperties.secStart,this.valueAxisProperties.secEnd]:null,y.valueAxisScaleType=this.valueAxisProperties&&null!=this.valueAxisProperties.secAxisScale?this.valueAxisProperties.secAxisScale:l,y.valueAxisDisplayUnits=this.valueAxisProperties&&null!=this.valueAxisProperties.secLabelDisplayUnits?this.valueAxisProperties.secLabelDisplayUnits:0,y.valueAxisPrecision=this.valueAxisProperties?t.CartesianHelper.getPrecision(this.valueAxisProperties.secLabelPrecision):null),y.showCategoryAxisLabel=!!this.categoryAxisProperties&&!!this.categoryAxisProperties.showAxisTitle,y.showValueAxisLabel=r(S,this.valueAxisProperties,b);var P=w.calculateAxesProperties(y);if(0===S)C={x:P[0],y1:P[1]};else if(P&&!C.y2)if(C.x.usingDefaultDomain||_.isEmpty(C.x.dataDomain)){y.showValueAxisLabel=!!this.valueAxisProperties&&!!this.valueAxisProperties.showAxisTitle;var D=w.calculateAxesProperties(y);C.x=D[0],C.y1=D[1]}else w.overrideXScale(C.x),b||P[1].usingDefaultDomain||(C.y2=P[1]);if(d&&d.x)C.x.willLabelsFit=d.x.willLabelsFit,C.x.willLabelsWordBreak=d.x.willLabelsWordBreak;else{var L=n.width-(s.left+s.right);C.x.willLabelsFit=t.AxisHelper.LabelLayoutStrategy.willLabelsFit(C.x,L,e.TextMeasurementService.measureSvgTextWidth,u),C.x.willLabelsWordBreak=!C.x.willLabelsFit&&!h&&t.AxisHelper.LabelLayoutStrategy.willLabelsWordBreak(C.x,s,L,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,e.TextMeasurementService.getTailoredTextOrDefault,u)}}return p&&(C.x.axisLabel=null,C.y1.axisLabel=null,C.y2&&(C.y2.axisLabel=null)),this.addUnitTypeToAxisLabels(C),C},i.prototype.negotiateAxes=function(a,r,o,n,s,l,c,u,h){var d=e.Prototype.inherit(i.MinimumMargin),p=e.Prototype.inherit(r),g=p.width*this.maxMarginFactor,m=Math.max(i.MinimumMargin.bottom,Math.ceil(p.height*this.maxMarginFactor)),f={left:g,right:g,top:0,bottom:m},y=this.calculateAxes(a,p,d,n,l,!1,null,s,u,h),v=this.shouldRenderAxis(y.x),b=this.shouldRenderAxis(y.y1),C=this.shouldRenderAxis(y.y2,!0),S=this.shouldShowY1OnRight(),x={width:p.width-(d.left+d.right),height:p.height-(d.top+d.bottom)},w=!1;_.isEmpty(a)||a[0].getVisualCategoryAxisIsScalar&&(w=a[0].getVisualCategoryAxisIsScalar());var P=void 0;P=t.AxisHelper.getTickLabelMargins(x,f.left,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,y,f.bottom,l,!1,S,v,b,C),d=this.updateAxisMargins(y,P,o,S,b,C,w?0:c);var D=y.y1&&y.y1.values.length,L=y.y2&&y.y2.values.length,T=y.x&&y.x.willLabelsFit,V=y.x&&y.x.willLabelsWordBreak;y=this.calculateAxes(a,p,d,n,l,!1,null,s,u,h),x.width=p.width-(d.left+d.right),x.height=p.height-(d.top+d.bottom);var M=this.getPreferredPlotArea(y,a,w),N=!this.willAllCategoriesFitInPlotArea(x,M),A=!(y.y1&&y.y1.values.length!==D||y.y2&&y.y2.values.length!==L||y.x&&y.x.willLabelsFit!==T||y.x&&y.x.willLabelsWordBreak!==V||N);if(this.isXScrollBarVisible=!1,this.isYScrollBarVisible=!1,!A){P=t.AxisHelper.getTickLabelMargins(x,f.left,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,y,f.bottom,l,N,S,v,b,C),d=this.updateAxisMargins(y,P,o,S,b,C,w?0:c),y=this.calculateAxes(a,p,d,n,l,N,y,s,u,h),x.width=p.width-(d.left+d.right),x.height=p.height-(d.top+d.bottom),M=this.getPreferredPlotArea(y,a,w);var O=!this.willAllCategoriesFitInPlotArea(x,M);O&&(this.showLinesOnY&&(this.isXScrollBarVisible=!0,x.height-=this.scrollbarWidth,p.height-=this.scrollbarWidth),this.showLinesOnX&&(this.isYScrollBarVisible=!0,x.width-=this.scrollbarWidth,p.width-=this.scrollbarWidth),y=this.calculateAxes(a,p,d,n,l,!0,y,s,u,h))}var I=s?{x:null,y:null,y2:null}:{x:y.x.axisLabel,y:y.y1.axisLabel,y2:y.y2?y.y2.axisLabel:null};return this.layout={axes:y,axisLabels:I,margin:d,marginLimits:f,viewport:p,plotArea:x,preferredPlotArea:M,tickLabelMargins:P,tickPadding:o,rotateXTickLabels90:N},this.layout},i.prototype.getPreferredPlotArea=function(e,t,i){var a;if(!i&&this.isScrollable&&!_.isEmpty(t)&&t[0].getPreferredPlotArea){var r=this.showLinesOnY?e.x.categoryThickness:e.y1.categoryThickness,o=this.showLinesOnY?e.x.dataDomain.length:e.y1.dataDomain.length;a=t[0].getPreferredPlotArea(i,o,r)}return a},i.prototype.willAllCategoriesFitInPlotArea=function(t,i){return this.showLinesOnY&&i&&e.Double.greaterWithPrecision(i.width,t.width)?!1:!(this.showLinesOnX&&i&&e.Double.greaterWithPrecision(i.height,t.height))},i.prototype.updateAxisMargins=function(t,a,r,o,n,s,l){var c=o?a.yRight:a.yLeft,u=o?a.yLeft:a.yRight,h=a.xMax;c+=r.left,(s&&!o||o&&n)&&(u+=r.right),h+=r.bottom;var d={x:t.x.axisLabel,y:t.y1.axisLabel,y2:t.y2?t.y2.axisLabel:null};null!=d.x&&(h+=i.XAxisLabelPadding),null!=d.y&&(c+=i.YAxisLabelPadding),null!=d.y2&&(u+=i.YAxisLabelPadding);var p=e.Prototype.inherit(i.MinimumMargin);return p.left=o?u:c,p.right=o?c:u,p.right+=l,p.bottom=h,p},i.prototype.isLogScaleAllowed=function(e){var t=this.layout&&this.layout.axes;if(!t)return!1;switch(e){case 0:return t.x.isLogScaleAllowed;case 1:return t.y1.isLogScaleAllowed;case 2:return t.y2&&t.y2.isLogScaleAllowed}},i.prototype.axesHaveTicks=function(e){if(!this.layout)return!1;var i=this.layout.margin,a=e.width-(i.left+i.right),r=e.height-(i.top+i.bottom);return 0!==t.AxisHelper.getRecommendedNumberOfTicksForXAxis(a)||0!==t.AxisHelper.getRecommendedNumberOfTicksForYAxis(r)},i.prototype.shouldRenderAxisTitle=function(e,t,i){var a=i?"secShowAxisTitle":"showAxisTitle";return!!this.getAxisProperty(e,a,t)},i.prototype.shouldRenderAxis=function(e,t){if(void 0===t&&(t=!1),!e)return!1;var i=t?"secShow":"show";return this.getAxisProperty(e,i,!0)&&e.values&&e.values.length>0},i.prototype.getAxisProperty=function(e,t,i){if(!e)return i;var a=e.isCategoryAxis?this.categoryAxisProperties:this.valueAxisProperties;return a&&null!=a[t]?a[t]:i},i.prototype.addUnitTypeToAxisLabels=function(e){var a=i.getUnitType(e.x.formatter);if(e.x.isCategoryAxis?this.categoryAxisHasUnitType=null!=a:this.valueAxisHasUnitType=null!=a,e.x.axisLabel&&a&&(e.x.isCategoryAxis?e.x.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,e.x.axisLabel,a):e.x.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.x.axisLabel,a)),a=i.getUnitType(e.y1.formatter),e.y1.isCategoryAxis?this.categoryAxisHasUnitType=null!=a:this.valueAxisHasUnitType=null!=a,e.y1.axisLabel&&a&&(e.y1.isCategoryAxis?e.y1.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,e.y1.axisLabel,a):e.y1.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.y1.axisLabel,a)),e.y2){var r=i.getUnitType(e.y2.formatter);this.secondaryValueAxisHasUnitType=null!=r,e.y2.axisLabel&&r&&(e.y2.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.y2.axisLabel,r,!0))}},i.getUnitType=function(e){return e&&e.displayUnit&&e.displayUnit.value>1?e.displayUnit.title:void 0},i.YAxisLabelPadding=20,i.XAxisLabelPadding=18,i.MaxMarginFactor=.25,i.MinimumMargin={left:1,right:1,top:8,bottom:25},i}();t.CartesianAxes=m;var f;!function(e){function i(e,i,c,u,h,d,p,g,m){void 0===h&&(h=!1);var f=[],y={isScrollable:h,animator:u,interactivityService:c,tooltipsEnabled:d,tooltipBucketEnabled:p,lineChartLabelDensityEnabled:g,cartesianLoadMoreEnabled:m};switch(e){case 1:f.push(a(2,!1,y));break;case 0:f.push(a(1,!1,y));break;case 2:f.push(a(16,!1,y));break;case 9:f.push(r(y));break;case 12:f.push(o(y));break;case 11:f.push(n(y));break;case 4:f.push(s(t.ColumnChartType.stackedColumn,y));break;case 3:f.push(s(t.ColumnChartType.clusteredColumn,y));break;case 8:f.push(s(t.ColumnChartType.hundredPercentStackedColumn,y));break;case 6:f.push(s(t.ColumnChartType.stackedBar,y));break;case 5:f.push(s(t.ColumnChartType.clusteredBar,y));break;case 7:f.push(s(t.ColumnChartType.hundredPercentStackedBar,y));break;case 10:var v=l();f.push(s(v,y)),f.push(a(1,!0,y));break;case 13:f.push(s(t.ColumnChartType.clusteredColumn,y)),f.push(a(1,!0,y));break;case 14:f.push(s(t.ColumnChartType.stackedColumn,y)),f.push(a(1,!0,y));break;case 15:f.push(s(t.ColumnChartType.clusteredColumn,y)),f.push(n(y));break;case 16:f.push(s(t.ColumnChartType.stackedColumn,y)),f.push(n(y))}return f}function a(e,i,a,r){var o={animator:a.animator,interactivityService:a.interactivityService,isScrollable:a.isScrollable,tooltipsEnabled:!r&&a.tooltipsEnabled,tooltipBucketEnabled:a.tooltipBucketEnabled,chartType:e,lineChartLabelDensityEnabled:a.lineChartLabelDensityEnabled,cartesianLoadMoreEnabled:a.cartesianLoadMoreEnabled,isTrendLayer:r};return i&&(o.chartType=8|o.chartType),new t.LineChart(o)}function r(e){return e.isScrollable=!1,new t.ScatterChart(e)}function o(e){return new t.WaterfallChart(e)}function n(e){return new t.DataDotChart(e)}function s(e,i){var a={animator:i.animator,interactivityService:i.interactivityService,isScrollable:i.isScrollable,tooltipsEnabled:i.tooltipsEnabled,tooltipBucketEnabled:i.tooltipBucketEnabled,cartesianLoadMoreEnabled:i.cartesianLoadMoreEnabled,chartType:e};return new t.ColumnChart(a)}function l(e){var i=t.ColumnChartType.clusteredColumn;if(e){var a=e.general;if(a){switch(a.visualType1){case"Column":i=t.ColumnChartType.clusteredColumn;break;case"ColumnStacked":i=t.ColumnChartType.stackedColumn}a.visualType2}}return i}e.createLayers=i}(f||(f={}));var y=function(){function e(e){this.palette=e,this.clearPreferredScale()}return e.prototype.getColorScaleByKey=function(e){return this.setPreferredScale(e),this.preferredScale},e.prototype.getNewColorScale=function(){return this.preferredScale},e.prototype.getColorByIndex=function(e){return this.palette.getColorByIndex(e)},e.prototype.getSentimentColors=function(){return this.palette.getSentimentColors()},e.prototype.getBasePickerColors=function(){return this.palette.getBasePickerColors();
},e.prototype.clearPreferredScale=function(){this.preferredScale=this.palette.getNewColorScale(),this.rotated=!1},e.prototype.rotateScale=function(){this.preferredScale=this.preferredScale.clone(),this.preferredScale.clearAndRotateScale(),this.rotated=!0},e.prototype.setPreferredScale=function(e){this.rotated||(this.preferredScale=this.palette.getColorScaleByKey(e))},e}();t.SharedColorPalette=y;var v=function(){function e(e,t,i){void 0===i&&(i=0),this.loadMoreThreshold=i,this.loadMoreCallback=t,this.setScale(e)}return e.prototype.setScale=function(e){e&&(this.loadMoreThresholdIndex=e.domain().length-1-this.loadMoreThreshold)},e.prototype.isLoadingMoreData=function(){return this.loadingMoreData},e.prototype.onLoadMoreDataCompleted=function(){this.loadingMoreData=!1},e.prototype.shouldLoadMoreData=function(){var e=this.viewportDataRange;return!e||this.isLoadingMoreData()?!1:e.endIndex>=this.loadMoreThresholdIndex},e.prototype.loadMoreData=function(){this.isLoadingMoreData()||(this.loadingMoreData=!0,this.loadMoreCallback())},e}();t.CartesianLoadMoreDataHandler=v}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.EnumExtensions,a=e.data.DataRoleHelper,r=2,o=4,n=8,s=16,l=32|s;!function(e){e[e.clusteredBar=r|n]="clusteredBar",e[e.clusteredColumn=o|n]="clusteredColumn",e[e.hundredPercentStackedBar=r|l]="hundredPercentStackedBar",e[e.hundredPercentStackedColumn=o|l]="hundredPercentStackedColumn",e[e.stackedBar=r|s]="stackedBar",e[e.stackedColumn=o|s]="stackedColumn"}(t.ColumnChartType||(t.ColumnChartType={}));var c=t.ColumnChartType,u={category:"Category",series:"Series",y:"Y"},h=function(){function h(e){var t=e.chartType;this.chartType=t,this.categoryAxisType=null,this.animator=e.animator,this.isScrollable=e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,this.interactivityService=e.interactivityService}return h.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories)if(i.categorical.dataVolume=4,t.CartesianChart.detectScalarMapping(i)){var a=i.categorical.categories;a.dataReductionAlgorithm={sample:{}}}else t.CartesianChart.applyLoadMoreEnabledToMapping(e.cartesianLoadMoreEnabled,i)},h.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(!i||!i.categorical||!i.categorical.categories)return null;var a=i.categorical.categories,r=a["for"]["in"].items;if(!_.isEmpty(r)){var o=r[0].type,n=void 0;if(i.metadata&&(n=i.metadata.objects),!t.CartesianChart.getIsScalar(n,t.columnChartProps.categoryAxis.axisType,o))return["Category","Y"]}return null},h.prototype.updateVisualMetadata=function(e,t,i){this.xAxisProperties=e,this.yAxisProperties=t,this.margin=i},h.prototype.init=function(e){this.svg=e.svg,this.svg.classed(h.ColumnChartClassName,!0),this.unclippedGraphicsContext=this.svg.append("g").classed("columnChartUnclippedGraphicsContext",!0),this.mainGraphicsContext=this.unclippedGraphicsContext.append("svg").classed("columnChartMainGraphicsContext",!0),this.style=e.style,this.currentViewport=e.viewport,this.hostService=e.host,this.interactivity=e.interactivity,this.colors=this.style.colorPalette.dataColors,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.isComboChart=t.ComboChart.isComboChart(e.chartType),this.element=e.element},h.prototype.getCategoryLayout=function(e,i){var a;a=h.isBar(this.chartType)?this.currentViewport.height-(this.margin.top+this.margin.bottom):this.currentViewport.width-(this.margin.left+this.margin.right);var r=this.data?this.data.categoryMetadata:void 0,o=t.AxisHelper.getCategoryValueType(r),n=this.data?this.data.scalarCategoryAxis:!1,s=t.AxisHelper.createDomain(this.data.series,o,n,i.forcedXDomain,i.ensureXDomain);return t.CartesianChart.getLayout(this.data,{availableWidth:a,categoryCount:e,domain:s,isScalar:n,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:i.trimOrdinalDataOnOverflow})},h.converter=function(i,a,r,o,n,s,l,c,p){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===n&&(n=null),void 0===c&&(c=!0);var g=t.CartesianHelper.getCategoryAxisProperties(n),m=t.CartesianHelper.getValueAxisProperties(n);o=t.CartesianHelper.isScalar(o,g);var f=t.ColumnUtil.applyUserMinMax(o,i.categorical,g),y=new d(i),v=t.converterHelper.getPivotedCategories(f,t.columnChartProps.general.formatString),b=v.categories,C=v.categoryFormatter,S=v.categoryIdentities,x=f&&f.categories&&f.categories.length>0?f.categories[0].source:void 0,w=t.dataLabelUtils.getDefaultColumnLabelSettings(r||h.isStacked(s)),P=t.LegendData.DefaultLegendLabelFillColor,D=void 0,L=void 0;if(n&&n.objects){var T=n.objects;D=e.DataViewObjects.getFillColor(T,t.columnChartProps.dataPoint.defaultColor),L=e.DataViewObjects.getValue(T,t.columnChartProps.dataPoint.showAllDataPoints),P=e.DataViewObjects.getFillColor(T,t.columnChartProps.legend.labelColor,t.LegendData.DefaultLegendLabelFillColor);var _=T.labels;t.dataLabelUtils.updateLabelSettingsFromLabelsObject(_,w)}for(var V=y.getLegend(a,P,D),M=V.legend.dataPoints,N=V.seriesSources,A=h.createDataPoints(i,b,S,M,V.seriesObjects,y,w,r,o,t.converterHelper.categoryIsAlsoSeriesRole(i,u.series,u.category),v.categoryObjects,D,s,x,c,p),O=A.series,I=[],R=0,F=M.length;F>R;R++)I.push(N[R]);var H=t.converterHelper.createAxesLabels(g,m,x,I);if(!h.isColumn(s)){var z=H.xAxisLabel;H.xAxisLabel=H.yAxisLabel,H.yAxisLabel=z}if(l){for(var G=0,k=O;G<k.length;G++){var j=k[G];l.applySelectionStateToData(j.data)}l.applySelectionStateToData(V.legend.dataPoints)}return{categories:b,categoryFormatter:C,series:O,valuesMetadata:I,legendData:V.legend,hasHighlights:A.hasHighlights,categoryMetadata:x,scalarCategoryAxis:o,labelSettings:w,axesLabels:{x:H.xAxisLabel,y:H.yAxisLabel},hasDynamicSeries:A.hasDynamicSeries,isMultiMeasure:A.isMultiMeasure,defaultDataPointColor:D,showAllDataPoints:L}},h.canSupportOverflow=function(e,t){return!h.isStacked(e)||1===t},h.createDataPoints=function(i,r,o,n,s,l,c,u,d,p,g,m,f,y,v,b){void 0===u&&(u=!1),void 0===d&&(d=!1);var C=i.categorical,S=e.data.createIDataViewCategoricalReader(i),x=C&&C.values?C.values.grouped():void 0,w=r.length,P=S.hasValues("Y")?S.getSeriesCount("Y"):void 0,D=[];if(1>P||1>w)return{series:D,hasHighlights:!1,hasDynamicSeries:!1,isMultiMeasure:!1};var L=C.categories;y=_.isEmpty(L)?null:L[0].source;for(var T=t.AxisHelper.getCategoryValueType(y),V=t.AxisHelper.isDateTime(T),M=[],N=[],A=[],O=[],I=!(!C.values||!C.values.source),R=!I&&P>1,F=!1,H=l.hasHighlightValues(0),z=0;P>z;z++){for(var G=[],k=[],j=0;w>j;j++){var E=l.getValueBySeriesAndCategory(z,j);if(G[j]=E,H){var B=l.getHighlightBySeriesAndCategory(z,j);k[j]=B,E>=0&&B>=0&&E>=B||0>=E&&0>=B&&B>=E||(F=!0)}}A.push(G),H&&O.push(k)}F&&!h.canSupportOverflow(f,P)&&(F=!1,H=!1,A=O);for(var W=g,U=t.columnChartProps.general.formatString,z=0;P>z;z++){var Y=[],K=n[z],X=void 0;if(!I){var q=!_.isEmpty(x)&&x[0].values?x[0].values[z]:null,$=q&&q.source&&q.source.objects?q.source.objects.labels:null;$&&(X=e.Prototype.inherit(c),t.dataLabelUtils.updateLabelSettingsFromLabelsObject($,X))}D.push({displayName:K.label,key:"series"+z,index:z,data:Y,identity:K.identity,color:K.color,labelSettings:X}),P>1&&(W=s[z]);for(var Q=S.getValueMetadataColumn("Y",z),Z=t.GradientUtils.getGradientMeasureIndex(C),J=t.GradientUtils.getGradientValueColumn(C),ee=a.getMeasureIndexOfRole(x,"Y"),te=t.valueFormatter.getLocalizedString("Percentage"),j=0;w>j;j++){0===z&&(M.push(0),N.push(0));var E=t.AxisHelper.normalizeNonFiniteNumber(A[z][j]);if(!(null==E&&z>0)){var ie=E,ae=r[j];if((!V||null==ae||ae instanceof Date)&&(V&&ae&&(ae=ae.getTime()),!d||null!=ae&&!isNaN(ae))){var re=void 0;u&&(re=t.StackedUtil.getStackedMultiplier(C,j,P,w,l));var oe=E,ne=0>E;re&&(E*=ne?re.neg:re.pos);var se=Math.abs(E),le=void 0;ne?(le=N[j],isNaN(se)||(N[j]-=se)):(isNaN(se)||(M[j]+=se),le=M[j]);var ce=x&&x.length>z&&x[z].values?x[z].values[ee]:null,ue=_.isEmpty(C.categories)?null:C.categories[0],he=t.SelectionIdBuilder.builder().withCategory(ue,j).withSeries(C.values,ce).withMeasure(l.getMeasureNameByIndex(z)).createSelectionId(),de=S.getCategoryValue("Category",j),pe=h.getDataPointColor(K,j,W),ge=0===Z?null:J,me=void 0,fe=void 0,ye=void 0,B=void 0,ve=void 0,be=void 0;if(H){me=S.getHighlight("Y",j,z),fe=me;var Ce=!0;null===me&&(me=0,Ce=!1),u&&(me*=re.pos),ye=Math.abs(me),ve=le,me>0?ve-=se-ye:0===me&&E>0&&(ve-=se),be=t.SelectionId.createWithHighlight(he);var Se=void 0,xe=void 0;if(Ce&&null!=fe&&null!=me){var we=t.valueFormatter.format(me,te);xe=t.converterHelper.formatFromMetadataColumn(fe,Q,U),Se=xe+" ("+we+")"}B=u?Se:xe}var Pe=void 0;if(v){if(Pe=[],ue&&Pe.push({displayName:S.getCategoryDisplayName("Category"),value:t.converterHelper.formatFromMetadataColumn(de,ue.source,U)}),I&&(ue&&ue.source===C.values.source||Pe.push({displayName:C.values.source.displayName,value:t.converterHelper.formatFromMetadataColumn(x[z].name,C.values.source,U)})),null!=ie){var De=void 0,Le=t.converterHelper.formatFromMetadataColumn(ie,Q,U);if(u){var Te=t.valueFormatter.format(se,te);De=Le+" ("+Te+")"}else De=Le;Pe.push({displayName:Q.displayName,value:De})}if(null!=B&&Pe.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:B}),ge&&null!=ge.values[j]&&Pe.push({displayName:ge.source.displayName,value:t.converterHelper.formatFromMetadataColumn(ge.values[j],ge.source,U)}),b){var _e=S.getAllValuesForRole("Tooltips",j,I?z:void 0),Ve=S.getAllValueMetadataColumnsForRole("Tooltips",I?z:void 0);if(_e&&Ve)for(var Me=0;Me<_e.length;Me++)null!=_e[Me]&&Pe.push({displayName:Ve[Me].displayName,value:t.converterHelper.formatFromMetadataColumn(_e[Me],Ve[Me],U)})}}var Ne=D[z],Ae=Ne.labelSettings?Ne.labelSettings:c,Oe=Ae.labelColor,Ie=void 0;h.isStacked(f)&&(Ie=this.getStackedLabelColor(ne,z,P,j,A),Oe=Ie||z===P-1&&!ne?Oe:t.dataLabelUtils.defaultInsideLabelColor);var Re={categoryValue:ae,value:E,position:le,valueAbsolute:se,valueOriginal:oe,seriesIndex:z,labelSettings:Ae,categoryIndex:j,color:pe,selected:!1,originalValue:E,originalPosition:le,originalValueAbsolute:se,identity:he,key:he.getKey(),tooltipInfo:Pe,labelFill:Oe,labelFormatString:Q.format,lastSeries:Ie,chartType:f};if(Y.push(Re),H){var Fe={categoryValue:ae,value:me,position:ve,valueAbsolute:ye,valueOriginal:fe,seriesIndex:z,labelSettings:Ae,categoryIndex:j,color:pe,selected:!1,highlight:!0,originalValue:E,originalPosition:le,originalValueAbsolute:se,drawThinner:F,identity:be,key:be.getKey(),tooltipInfo:Pe,labelFormatString:Q.format,labelFill:Oe,lastSeries:Ie,chartType:f};Y.push(Fe)}}}}}return{series:D,hasHighlights:H,hasDynamicSeries:I,isMultiMeasure:R}},h.getDataPointColor=function(i,a,r){if(r){var o=e.DataViewObjects.getFillColor(r[a],t.columnChartProps.dataPoint.fill);if(o)return o}return i.color},h.getStackedLabelColor=function(e,i,a,r,o){for(var n=!(e&&i===a-1&&1!==a),s=i+1;a>s;s++){var l=t.AxisHelper.normalizeNonFiniteNumber(o[s][r]);if(null!==l&&((!e||e&&0===i)&&l>0||e&&0!==i)){n=!1;break}}return n},h.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var o=0,n=t.length;n>o;o++){var s=r[o]=e.Prototype.inherit(t[o]);s.data=t[o].data.filter(function(e){return e.categoryIndex>=a&&e.categoryIndex<i})}return r},h.getInteractiveColumnChartDomElement=function(e){return e.children("svg").get(0)},h.prototype.setData=function(e){var i=h.isStacked100(this.chartType);if(this.data={categories:[],categoryFormatter:null,series:[],valuesMetadata:[],legendData:null,hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,labelSettings:t.dataLabelUtils.getDefaultColumnLabelSettings(i||h.isStacked(this.chartType)),axesLabels:{x:null,y:null},hasDynamicSeries:!1,defaultDataPointColor:null,isMultiMeasure:!1},e.length>0){var a=this.dataView=e[0];if(a&&a.categorical){var r=a.categorical.categories,o=r&&r.length>0?r[0].source:null,n=t.AxisHelper.getCategoryValueType(o);this.data=h.converter(a,this.cartesianVisualHost.getSharedColors(),i,t.CartesianChart.getIsScalar(a.metadata?a.metadata.objects:null,t.columnChartProps.categoryAxis.axisType,n),a.metadata,this.chartType,this.interactivityService,this.tooltipsEnabled,this.tooltipBucketEnabled)}}this.setChartStrategy()},h.prototype.setChartStrategy=function(){switch(this.chartType){case c.clusteredBar:this.columnChart=new t.ClusteredBarChartStrategy;break;case c.clusteredColumn:this.columnChart=new t.ClusteredColumnChartStrategy;break;case c.stackedBar:case c.hundredPercentStackedBar:this.columnChart=new t.StackedBarChartStrategy;break;case c.stackedColumn:case c.hundredPercentStackedColumn:default:this.columnChart=new t.StackedColumnChartStrategy}if(h.isStacked(this.chartType)&&1===this.data.series.length)switch(this.chartType){case c.stackedBar:this.columnChart=new t.ClusteredBarChartStrategy;break;case c.stackedColumn:this.columnChart=new t.ClusteredColumnChartStrategy}},h.prototype.calculateLegend=function(){if(this.interactivity&&this.interactivity.isInteractiveLegend)return this.createInteractiveLegendDataPoints(0);var e=this.data?this.data.legendData:null,t=e?e.dataPoints:[];return _.isEmpty(t)?null:e},h.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},h.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"dataPoint":this.dataView&&!t.GradientUtils.hasGradientRole(this.dataView.categorical)&&this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e)}},h.prototype.enumerateDataLabels=function(e){var i=this.data,a=this.data.labelSettings,r=i.series.length,o=!i.hasDynamicSeries&&(r>1||!i.categoryMetadata);if(t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,a,null,o)),0!==r&&o&&a.showLabelPerSeries)for(var n=0;r>n;n++){var s=i.series[n],l=s.labelSettings?s.labelSettings:this.data.labelSettings;e.pushContainer({displayName:s.displayName}),t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,l,s)),e.popContainer()}},h.prototype.getLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:!h.isStacked100(this.chartType),precision:!0,selector:i&&i.identity?i.identity.getSelector():null,showAll:a,fontSize:!0}},h.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.series.length;if(0!==a)if(i.hasDynamicSeries||a>1||!i.categoryMetadata)for(var r=0;a>r;r++){var o=i.series[r];e.pushInstance({objectName:"dataPoint",displayName:o.displayName,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}}})}else{var n=i.series[0].data,s=i.categoryFormatter;if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:i.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!i.showAllDataPoints}}),i.showAllDataPoints)for(var r=0;r<n.length;r++){var l=n[r],c=i.categories[r];e.pushInstance({objectName:"dataPoint",displayName:s?s.format(c):c,selector:t.ColorHelper.normalizeSelector(l.identity.getSelector(),!0),properties:{fill:{solid:{color:l.color}}}})}}}},h.prototype.calculateAxesProperties=function(i){var a=this.data;this.currentViewport=i.viewport;var r=this.margin=i.margin,o=a&&a.categories?a.categories.length:0,n=a?this.getCategoryLayout(o,i):{categoryCount:0,categoryThickness:t.CartesianChart.MinOrdinalRectThickness,outerPaddingRatio:t.CartesianChart.OuterPaddingRatio,isScalar:!1};if(this.categoryAxisType=n.isScalar?t.axisType.scalar:null,a&&!n.isScalar&&!this.isScrollable&&i.trimOrdinalDataOnOverflow){var s=Math.min(o,n.categoryCount);s!==o&&(a=e.Prototype.inherit(a),a.series=h.sliceSeries(a.series,s),a.categories=a.categories.slice(0,s))}this.columnChart.setData(a);var l=this.getPreferredPlotArea(n.isScalar,n.categoryCount,n.categoryThickness),c=h.isStacked100(this.chartType),u={height:l.height,width:l.width,duration:0,hostService:this.hostService,unclippedGraphicsContext:this.unclippedGraphicsContext,mainGraphicsContext:this.mainGraphicsContext,margin:this.margin,layout:n,animator:this.animator,interactivityService:this.interactivityService,viewportHeight:this.currentViewport.height-(r.top+r.bottom),viewportWidth:this.currentViewport.width-(r.left+r.right),is100Pct:c,isComboChart:this.isComboChart};this.ApplyInteractivity(u),this.columnChart.setupVisualProps(u);var d,p,g=h.isBar(this.chartType);if(g){var m=i.forcedXDomain;i.forcedXDomain=i.forcedYDomain,i.forcedYDomain=m,d=i.ensureYDomain}else p=i.ensureYDomain;return this.xAxisProperties=this.columnChart.setXScale(c,i.forcedTickCount,i.forcedXDomain,g?i.valueAxisScaleType:i.categoryAxisScaleType,g?i.valueAxisDisplayUnits:i.categoryAxisDisplayUnits,g?i.valueAxisPrecision:i.categoryAxisPrecision,d),this.yAxisProperties=this.columnChart.setYScale(c,i.forcedTickCount,i.forcedYDomain,g?i.categoryAxisScaleType:i.valueAxisScaleType,g?i.categoryAxisDisplayUnits:i.valueAxisDisplayUnits,g?i.categoryAxisPrecision:i.valueAxisPrecision,p),i.showCategoryAxisLabel&&this.xAxisProperties.isCategoryAxis||i.showValueAxisLabel&&!this.xAxisProperties.isCategoryAxis?this.xAxisProperties.axisLabel=a.axesLabels.x:this.xAxisProperties.axisLabel=null,i.showValueAxisLabel&&!this.yAxisProperties.isCategoryAxis||i.showCategoryAxisLabel&&this.yAxisProperties.isCategoryAxis?this.yAxisProperties.axisLabel=a.axesLabels.y:this.yAxisProperties.axisLabel=null,[this.xAxisProperties,this.yAxisProperties]},h.prototype.getPreferredPlotArea=function(e,i,a){var r={height:this.currentViewport.height-this.margin.top-this.margin.bottom,width:this.currentViewport.width-this.margin.left-this.margin.right};if(this.isScrollable&&!e){var o=t.CartesianChart.getPreferredCategorySpan(i,a);h.isBar(this.chartType)?r.height=Math.max(o,r.height):r.width=Math.max(o,r.width)}return r},h.prototype.ApplyInteractivity=function(e){var t=this,i=this.interactivity;if(i&&(i.dragDataPoint&&(e.onDragStart=function(e){e.identity&&t.hostService.onDragStart({event:d3.event,data:{data:e.identity.getSelector()}})}),i.isInteractiveLegend)){var a=function(){var e=d3.mouse(t.mainGraphicsContext[0][0]),i=e[0],a=e[1],r=t.columnChart.getClosestColumnIndex(i,a);t.selectColumn(r)},r=h.getInteractiveColumnChartDomElement(this.element);this.svg.on("click",a),d3.select(r).on("click",a).style("touch-action","none");var o=d3.behavior.drag().origin(Object).on("drag",a);this.svg.call(o),d3.select(r).call(o)}},h.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){var i=this.createInteractiveLegendDataPoints(e),a=i.dataPoints;this.cartesianVisualHost.updateLegend(i),a.length>0&&this.columnChart.selectColumn(e,this.lastInteractiveSelectedColumnIndex),this.lastInteractiveSelectedColumnIndex=e}},h.prototype.createInteractiveLegendDataPoints=function(e){var i=this.data;if(!i||_.isEmpty(i.series))return{dataPoints:[]};for(var a=t.columnChartProps.general.formatString,r=[],o=i.categories&&i.categories[e],n=i.series,s=i.legendData&&i.legendData.dataPoints,l=new d(this.dataView),c=0,u=n.length;u>c;c++){var h=l.getValueBySeriesAndCategory(c,e),p=i.valuesMetadata[c],g=t.converterHelper.getFormattedLegendLabel(p,this.dataView.categorical.values,a),m=void 0;if(1===n.length){var f=n[0];m=f.data.length>e&&f.data[e].color}else m=s.length>c&&s[c].color;r.push({color:m,icon:t.LegendIcon.Box,label:g,category:i.categoryFormatter?i.categoryFormatter.format(o):o,measure:t.valueFormatter.format(h,t.valueFormatter.getFormatString(p,a)),identity:t.SelectionId.createNull(),selected:!1})}return{dataPoints:r}},h.prototype.overrideXScale=function(e){this.xAxisProperties=e},h.prototype.render=function(e){var i=this.columnChart.drawColumns(!e),a=this.data,r=this.margin,o=this.currentViewport,n=o.height-(r.top+r.bottom),s=o.width-(r.left+r.right);this.mainGraphicsContext.attr("height",n).attr("width",s),this.tooltipsEnabled&&t.TooltipManager.addTooltip(i.eventGroup,function(e){return e.data.tooltipInfo});var l=[],c=void 0;if(this.interactivityService){for(var u=0,h=a.series.length;h>u;u++)l=l.concat(a.series[u].data);c={datapoints:l,eventGroup:i.eventGroup,bars:i.shapesSelection,hasHighlights:a.hasHighlights,mainGraphicsContext:this.mainGraphicsContext,viewport:i.viewport,axisOptions:i.axisOptions,showLabel:a.labelSettings.show}}return this.interactivity&&this.interactivity.isInteractiveLegend&&this.data.series.length>0&&this.selectColumn(t.CartesianHelper.findMaxCategoryIndex(this.data.series),!0),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:l,behaviorOptions:c,labelDataPoints:i.labelDataPoints,labelsAreNumeric:!0}},h.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},h.prototype.getVisualCategoryAxisIsScalar=function(){return this.data?this.data.scalarCategoryAxis:!1},h.prototype.getSupportedCategoryAxisType=function(){var e=this.data?this.data.categoryMetadata:void 0,i=t.AxisHelper.getCategoryValueType(e),a=t.AxisHelper.isOrdinal(i);return a?t.axisType.categorical:t.axisType.both},h.prototype.setFilteredData=function(t,i){var a=e.Prototype.inherit(this.data);return a.series=h.sliceSeries(a.series,i,t),a.categories=a.categories.slice(t,i),this.columnChart.setData(a),a},h.getLabelFill=function(e,i,a){return e?e:i&&!a?t.NewDataLabelUtils.defaultInsideLabelColor:t.NewDataLabelUtils.defaultLabelColor},h.prototype.supportsTrendLine=function(){var e=this.data?this.data.scalarCategoryAxis:!1;return this.chartType===c.clusteredColumn&&e},h.isBar=function(e){return i.hasFlag(e,r)},h.isColumn=function(e){return i.hasFlag(e,o)},h.isClustered=function(e){return i.hasFlag(e,n)},h.isStacked=function(e){return i.hasFlag(e,s)},h.isStacked100=function(e){return i.hasFlag(e,l)},h.ColumnChartClassName="columnChart",h.clusteredValidLabelPositions=[16,4,1,2],h.stackedValidLabelPositions=[1,4,2],h.SeriesClasses=jsCommon.CssConstants.createClassAndSelector("series"),h}();t.ColumnChart=h;var d=function(){function i(t){this.dataView=t&&t.categorical,this.reader=e.data.createIDataViewCategoricalReader(t)}return i.prototype.getLegend=function(e,i,r){var o=[],n=[],s=[],l=!1,c=new t.ColorHelper(e,t.columnChartProps.dataPoint.fill,r),u=void 0;if(this.dataView&&this.dataView.values){for(var h=this.dataView.values,d=h.grouped(),p=!(!h||!h.source),g=t.columnChartProps.general.formatString,m=0,f=d.length;f>m;m++)for(var y=d[m],v=y.objects,b=y.values,C=0,S=b.length;S>C;C++){var x=b[C],w=x.source;if(!a.hasRole(w,"Gradient")&&!a.hasRole(w,"Tooltips")||a.hasRole(w,"Y")){n.push(w),s.push(x.objects);var P=x.identity?t.SelectionId.createWithIdAndMeasure(x.identity,w.queryName):t.SelectionId.createWithMeasure(this.getMeasureNameByIndex(C)),D=t.converterHelper.getFormattedLegendLabel(w,h,g),L=p?c.getColorForSeriesValue(v,h.identityFields,w.groupName):c.getColorForMeasure(w.objects,w.queryName);o.push({icon:t.LegendIcon.Box,color:L,label:D,identity:P,selected:!1}),x.identity&&void 0!==w.groupName&&(l=!0)}}var T=this.dataView.values;u=T&&T.source?T.source.displayName:""}var _={title:u,dataPoints:o,grouped:l,labelColor:i};return{legend:_,seriesSources:n,seriesObjects:s}},i.prototype.getValueBySeriesAndCategory=function(e,t){return this.reader.getValue("Y",t,e)},i.prototype.getMeasureNameByIndex=function(e){return this.dataView.values[e].source.queryName},i.prototype.hasHighlightValues=function(e){var t=this.dataView&&this.dataView.values?this.dataView.values[e]:void 0;return t&&!!t.highlights},i.prototype.getHighlightBySeriesAndCategory=function(e,t){return this.dataView.values[e].highlights[t]},i}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.PixelConverter,a=function(){function a(){}return a.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},a.prototype.setData=function(e){this.data=e},a.prototype.setXScale=function(e,i,a,r,o,n,s){var l,c,u=this.width;a&&2===a.length&&(l=a[0],c=a[1]);var h=this.xProps=t.ColumnUtil.getCategoryAxis(this.data,u,this.categoryLayout,!1,l,c,r,o,n,s),d=this.data.series.length,p=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio)/d;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map(function(e){return e.index})).rangeBands([0,d*p]),h},a.prototype.setYScale=function(e,i,a,r,o,n,s){var l=this.viewportHeight,c=t.AxisHelper.createValueDomain(this.data.series,!0)||t.emptyDomain,u=t.AxisHelper.combineDomain(a,c,s),h=t.AxisHelper.scaleShouldClamp(u,c);return this.yProps=t.AxisHelper.createAxis({pixelSpan:l,dataDomain:u,metaDataColumn:this.data.valuesMetadata[0],formatString:t.valueFormatter.getFormatString(this.data.valuesMetadata[0],t.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:o,axisPrecision:n,shouldClamp:h}),this.yProps},a.prototype.drawColumns=function(e){var i=this.data;this.columnsCenters=null;var r=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),o=r/i.series.length,n={columnWidth:o,categoryWidth:r,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin},s=this.layout=a.getLayout(i,n),l=i.labelSettings,c=[];l&&l.show&&(c=this.createLabelDataPoints());var u,h,d=t.ColumnUtil.drawSeries(i,this.graphicsContext.mainGraphicsContext,n);return this.animator&&e&&(u=this.animator.animate({viewModel:i,series:d,layout:s,itemCS:a.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),h=u.shapes),this.animator&&e&&!u.failed||(h=t.ColumnUtil.drawDefaultShapes(i,d,s,a.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),t.ColumnUtil.applyInteractivity(h,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:h,viewport:{height:this.height,width:this.width},axisOptions:n,labelDataPoints:c}},a.prototype.selectColumn=function(e,i){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,a.classes.item.selector,e,i),this.moveHandle(e)},a.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},a.prototype.getColumnsCenters=function(){var e=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map(function(t){return e.xProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.columnsCenters},a.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=t[e],a=d3.select(".interactive-hover-line");if(a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({x1:i,x2:i}),r.select("circle").attr({cx:i})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:i,x2:i,y1:0,y2:this.height}),r.append("circle").attr({cx:i,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},a.getLayout=function(e,i){var a=i.columnWidth,r=.5*a,o=r/2,n=i.isScalar,s=i.xScale,l=i.yScale,c=i.seriesOffsetScale,u=l(0),h=0;return n&&(h=i.categoryWidth/2),{shapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h+(e.drawThinner?o:0)},y:function(e){return u+t.AxisHelper.diffScaled(l,Math.max(0,e.value),0)},height:function(e){return Math.abs(t.AxisHelper.diffScaled(l,0,e.value))}},shapeLayoutWithoutHighlights:{width:function(e){return a},x:function(e){return s(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h},y:function(e){return u+t.AxisHelper.diffScaled(l,Math.max(0,e.originalValue),0)},height:function(e){return Math.abs(t.AxisHelper.diffScaled(l,0,e.originalValue))}},zeroShapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h+(e.drawThinner?o:0)},y:function(e){return u},height:function(e){return 0}}}},a.prototype.createLabelDataPoints=function(){for(var a=[],r=this.data,o=r.series,n=t.NewDataLabelUtils.createColumnFormatterCacheManager(),s=this.layout.shapeLayout,l=0,c=o;l<c.length;l++){var u=c[l],h=u.labelSettings?u.labelSettings:r.labelSettings;if(h.show)for(var d=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yProps.formatter,h),p=0,g=u.data;p<g.length;p++){var m=g[p];if((!r.hasHighlights||m.highlight)&&null!=m.value){var f={left:s.x(m),top:s.y(m),width:s.width(m),height:s.height(m)},y=m.labelFormatString,v=n.getOrCreate(y,h,d),b=t.NewDataLabelUtils.getLabelFormattedText(v.format(m.value)),C={text:b,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},S=e.TextMeasurementService.measureSvgTextWidth(C),x=e.TextMeasurementService.estimateSvgTextHeight(C,!0);a.push({isPreferred:!0,text:b,textSize:{width:S,height:x},outsideFill:t.ColumnChart.getLabelFill(h.labelColor,!1,this.isComboChart),insideFill:t.ColumnChart.getLabelFill(h.labelColor,!0,this.isComboChart),parentType:1,parentShape:{rect:f,orientation:m.value>=0?1:2,validPositions:t.ColumnChart.clusteredValidLabelPositions},identity:m.identity,fontSize:h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}}}return a},a.classes={item:{"class":"column",selector:".column"}},a}();t.ClusteredColumnChartStrategy=a;var r=function(){function a(){}return a.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},a.prototype.setData=function(e){this.data=e},a.prototype.setYScale=function(e,i,a,r,o,n,s){var l,c,u=this.height;a&&2===a.length&&(l=a[0],c=a[1]);var h=this.yProps=t.ColumnUtil.getCategoryAxis(this.data,u,this.categoryLayout,!0,l,c,r,o,n,s),d=this.data.series.length,p=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio)/d;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map(function(e){return e.index})).rangeBands([0,d*p]),h},a.prototype.setXScale=function(e,i,a,r,o,n,s){var l=this.width,c=t.AxisHelper.createValueDomain(this.data.series,!0)||t.emptyDomain,u=t.AxisHelper.combineDomain(a,c,s),h=t.AxisHelper.scaleShouldClamp(u,c);return this.xProps=t.AxisHelper.createAxis({pixelSpan:l,dataDomain:u,metaDataColumn:this.data.valuesMetadata[0],formatString:t.valueFormatter.getFormatString(this.data.valuesMetadata[0],t.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:o,axisPrecision:n,shouldClamp:h}),this.xProps.axis.tickSize(-this.viewportHeight,0),this.xProps},a.prototype.drawColumns=function(e){var i=this.data;this.barsCenters=null;var r=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),o=r/i.series.length,n={columnWidth:o,categoryWidth:r,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,
isScalar:this.categoryLayout.isScalar,margin:this.margin},s=this.layout=a.getLayout(i,n),l=i.labelSettings,c=[];l&&l.show&&(c=this.createLabelDataPoints());var u,h,d=t.ColumnUtil.drawSeries(i,this.graphicsContext.mainGraphicsContext,n);return this.animator&&e&&(u=this.animator.animate({viewModel:i,series:d,layout:s,itemCS:a.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),h=u.shapes),this.animator&&e&&!u.failed||(h=t.ColumnUtil.drawDefaultShapes(i,d,s,a.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),t.ColumnUtil.applyInteractivity(h,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:h,viewport:{height:this.height,width:this.width},axisOptions:n,labelDataPoints:c}},a.prototype.selectColumn=function(e,i){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,a.classes.item.selector,e,i),this.moveHandle(e)},a.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},a.prototype.getBarsCenters=function(){var e=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map(function(t){return e.yProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.barsCenters},a.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=t[e],a=d3.select(".interactive-hover-line");if(a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({y1:i,y2:i}),r.select("circle").attr({cy:i})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:i,y2:i}),r.append("circle").attr({cx:0,cy:i,r:"6px"}).classed("drag-handle",!0)}},a.getLayout=function(e,i){var a=i.columnWidth,r=.5*a,o=r/2,n=i.isScalar,s=i.xScale,l=i.yScale,c=i.seriesOffsetScale,u=s(0),h=0;return n&&(h=i.categoryWidth/2),{shapeLayout:{width:function(e){return Math.abs(t.AxisHelper.diffScaled(s,0,e.value))},x:function(e){return u+t.AxisHelper.diffScaled(s,Math.min(0,e.value),0)},y:function(e){return l(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h+(e.drawThinner?o:0)},height:function(e){return e.drawThinner?r:a}},shapeLayoutWithoutHighlights:{width:function(e){return Math.abs(t.AxisHelper.diffScaled(s,0,e.originalValue))},x:function(e){return u+t.AxisHelper.diffScaled(s,Math.min(0,e.originalValue),0)},y:function(e){return l(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h},height:function(e){return a}},zeroShapeLayout:{width:function(e){return 0},x:function(e){return u+t.AxisHelper.diffScaled(s,Math.min(0,e.value),0)},y:function(e){return l(n?e.categoryValue:e.categoryIndex)+c(e.seriesIndex)-h+(e.drawThinner?o:0)},height:function(e){return e.drawThinner?r:a}}}},a.prototype.createLabelDataPoints=function(){for(var a=[],r=this.data,o=r.series,n=t.NewDataLabelUtils.createColumnFormatterCacheManager(),s=this.layout.shapeLayout,l=0,c=o;l<c.length;l++){var u=c[l],h=u.labelSettings?u.labelSettings:r.labelSettings;if(h.show)for(var d=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yProps.formatter,h),p=0,g=u.data;p<g.length;p++){var m=g[p];if(!(this.interactivityService&&this.interactivityService.hasSelection()&&!m.selected||r.hasHighlights&&!m.highlight||null==m.value)){var f=m.labelFormatString,y=n.getOrCreate(f,h,d),v=t.NewDataLabelUtils.getLabelFormattedText(y.format(m.value)),b={text:v,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},C=e.TextMeasurementService.measureSvgTextWidth(b),S=e.TextMeasurementService.estimateSvgTextHeight(b,!0),x={left:s.x(m),top:s.y(m),width:s.width(m),height:s.height(m)};a.push({isPreferred:!0,text:v,textSize:{width:C,height:S},outsideFill:t.ColumnChart.getLabelFill(h.labelColor,!1,this.isComboChart),insideFill:t.ColumnChart.getLabelFill(h.labelColor,!0,this.isComboChart),parentType:1,parentShape:{rect:x,orientation:m.value>=0?3:4,validPositions:t.ColumnChart.clusteredValidLabelPositions},identity:m.identity,fontSize:h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}}}return a},a.classes={item:{"class":"bar",selector:".bar"}},a}();t.ClusteredBarChartStrategy=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.PixelConverter,a=function(){function a(){}return a.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},a.prototype.setData=function(e){this.data=e},a.prototype.setXScale=function(e,i,a,r,o,n,s){var l,c,u=this.width;a&&2===a.length&&(l=a[0],c=a[1]);var h=this.xProps=t.ColumnUtil.getCategoryAxis(this.data,u,this.categoryLayout,!1,l,c,r,o,n,s);return h},a.prototype.setYScale=function(e,i,a,r,o,n,s){var l=this.viewportHeight,c=t.StackedUtil.calcValueDomain(this.data.series,e),u=[c.min,c.max],h=t.AxisHelper.combineDomain(a,u,s),d=t.AxisHelper.scaleShouldClamp(h,u),p=this.data.valuesMetadata[0],g=e?this.graphicsContext.hostService.getLocalizedString("Percentage"):t.valueFormatter.getFormatString(p,t.columnChartProps.general.formatString);return this.yProps=t.AxisHelper.createAxis({pixelSpan:l,dataDomain:h,metaDataColumn:p,formatString:g,outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:o,axisPrecision:n,is100Pct:e,shouldClamp:d}),this.yProps},a.prototype.drawColumns=function(e){var i=this.data;this.columnsCenters=null;var r={columnWidth:this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},o=this.layout=a.getLayout(i,r),n=i.labelSettings,s=[];n&&n.show&&(s=this.createLabelDataPoints());var l,c,u=t.ColumnUtil.drawSeries(i,this.graphicsContext.mainGraphicsContext,r);return this.animator&&e&&(l=this.animator.animate({viewModel:i,series:u,layout:o,itemCS:a.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),c=l.shapes),this.animator&&e&&!l.failed||(c=t.ColumnUtil.drawDefaultShapes(i,u,o,a.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),t.ColumnUtil.applyInteractivity(c,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:c,viewport:{height:this.height,width:this.width},axisOptions:r,labelDataPoints:s}},a.prototype.selectColumn=function(e,i){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,a.classes.item.selector,e,i),this.moveHandle(e)},a.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(e,this.getColumnsCenters())},a.prototype.getColumnsCenters=function(){var e=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map(function(t){return e.xProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.columnsCenters},a.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=t[e],a=d3.select(".interactive-hover-line");if(a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({x1:i,x2:i}),r.select("circle").attr({cx:i})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:i,x2:i,y1:0,y2:this.height}),r.append("circle").attr({cx:i,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},a.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,o=t.yScale,n=0;return a&&(n=i/2),{shapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return o(e.position)},height:function(e){return o(e.position-e.valueAbsolute)-o(e.position)}},shapeLayoutWithoutHighlights:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return o(e.originalPosition)},height:function(e){return o(e.originalPosition-e.originalValueAbsolute)-o(e.originalPosition)}},zeroShapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-n},y:function(e){return o(e.value>=0?e.position-e.valueAbsolute:e.position)},height:function(e){return 0}}}},a.prototype.createLabelDataPoints=function(){for(var a=[],r=this.data,o=r.series,n=t.NewDataLabelUtils.createColumnFormatterCacheManager(),s=this.layout.shapeLayout,l=0,c=o;l<c.length;l++){var u=c[l],h=u.labelSettings?u.labelSettings:r.labelSettings;if(h.show)for(var d=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yProps.formatter,h),p=0,g=u.data;p<g.length;p++){var m=g[p];if((!r.hasHighlights||m.highlight)&&null!=m.value){var f={left:s.x(m),top:s.y(m),width:s.width(m),height:s.height(m)},y="";y=this.graphicsContext.is100Pct?t.NewDataLabelUtils.hundredPercentFormat:m.labelFormatString;var v=n.getOrCreate(y,h,d),b=t.NewDataLabelUtils.getLabelFormattedText(v.format(m.value)),C={text:b,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},S=e.TextMeasurementService.measureSvgTextWidth(C),x=e.TextMeasurementService.estimateSvgTextHeight(C,!0);a.push({isPreferred:!0,text:b,textSize:{width:S,height:x},outsideFill:t.ColumnChart.getLabelFill(h.labelColor,!1,this.isComboChart),insideFill:t.ColumnChart.getLabelFill(h.labelColor,!0,this.isComboChart),parentType:1,parentShape:{rect:f,orientation:m.value>=0?1:2,validPositions:t.ColumnChart.stackedValidLabelPositions},identity:m.identity,fontSize:h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}}}return a},a.classes={item:{"class":"column",selector:".column"},highlightItem:{"class":"highlightColumn",selector:".highlightColumn"}},a}();t.StackedColumnChartStrategy=a;var r=function(){function a(){}return a.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},a.prototype.setData=function(e){this.data=e},a.prototype.setYScale=function(e,i,a,r,o,n,s){var l,c,u=this.height;a&&2===a.length&&(l=a[0],c=a[1]);var h=this.yProps=t.ColumnUtil.getCategoryAxis(this.data,u,this.categoryLayout,!0,l,c,r,o,n,s);return h},a.prototype.setXScale=function(e,i,a,r,o,n,s){var l=this.width,c=t.StackedUtil.calcValueDomain(this.data.series,e),u=[c.min,c.max],h=t.AxisHelper.combineDomain(a,u,s),d=t.AxisHelper.scaleShouldClamp(h,u),p=this.data.valuesMetadata[0],g=e?this.graphicsContext.hostService.getLocalizedString("Percentage"):t.valueFormatter.getFormatString(p,t.columnChartProps.general.formatString);return this.xProps=t.AxisHelper.createAxis({pixelSpan:l,dataDomain:h,metaDataColumn:p,formatString:g,outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:o,axisPrecision:n,is100Pct:e,shouldClamp:d}),this.xProps.axis.tickSize(-this.viewportHeight,0),this.xProps},a.prototype.drawColumns=function(e){var i=this.data;this.barsCenters=null;var r={columnWidth:this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},o=this.layout=a.getLayout(i,r),n=i.labelSettings,s=[];n&&n.show&&(s=this.createLabelDataPoints());var l,c,u=t.ColumnUtil.drawSeries(i,this.graphicsContext.mainGraphicsContext,r);return this.animator&&e&&(l=this.animator.animate({viewModel:i,series:u,layout:o,itemCS:a.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),c=l.shapes),this.animator&&e&&!l.failed||(c=t.ColumnUtil.drawDefaultShapes(i,u,o,a.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),t.ColumnUtil.applyInteractivity(c,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:c,viewport:{height:this.height,width:this.width},axisOptions:r,labelDataPoints:s}},a.prototype.selectColumn=function(e,i){t.ColumnUtil.setChosenColumnOpacity(this.graphicsContext.mainGraphicsContext,a.classes.item.selector,e,i),this.moveHandle(e)},a.prototype.getClosestColumnIndex=function(e,i){return t.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},a.prototype.getBarsCenters=function(){var e=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map(function(t){return e.yProps.scale(e.categoryLayout.isScalar?t.categoryValue:t.categoryIndex)+a})}}return this.barsCenters},a.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=t[e],a=d3.select(".interactive-hover-line");if(a.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(a.node().parentNode)),this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({y1:i,y2:i}),r.select("circle").attr({cy:i})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:i,y2:i}),r.append("circle").classed("drag-handle",!0).attr({cx:0,cy:i,r:"6px"})}},a.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,o=t.yScale,n=0;return a&&(n=i/2),{shapeLayout:{width:function(e){return r(e.position)-r(e.position-e.valueAbsolute)},x:function(e){return r(e.position-e.valueAbsolute)},y:function(e){return o(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}},shapeLayoutWithoutHighlights:{width:function(e){return r(e.originalPosition)-r(e.originalPosition-e.originalValueAbsolute)},x:function(e){return r(e.originalPosition-e.originalValueAbsolute)},y:function(e){return o(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}},zeroShapeLayout:{width:function(e){return 0},x:function(e){return r(e.value>=0?e.position-e.valueAbsolute:e.position)},y:function(e){return o(a?e.categoryValue:e.categoryIndex)-n},height:function(e){return i}}}},a.prototype.createLabelDataPoints=function(){for(var a=[],r=this.data,o=r.series,n=t.NewDataLabelUtils.createColumnFormatterCacheManager(),s=this.layout.shapeLayout,l=0,c=o;l<c.length;l++){var u=c[l],h=u.labelSettings?u.labelSettings:r.labelSettings;if(h.show)for(var d=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yProps.formatter,h),p=0,g=u.data;p<g.length;p++){var m=g[p];if(!(this.interactivityService&&this.interactivityService.hasSelection()&&!m.selected||r.hasHighlights&&!m.highlight||null==m.value)){var f=void 0;f=this.graphicsContext.is100Pct?t.NewDataLabelUtils.hundredPercentFormat:m.labelFormatString;var y=n.getOrCreate(f,h,d),v=t.NewDataLabelUtils.getLabelFormattedText(y.format(m.value)),b={text:v,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},C=e.TextMeasurementService.measureSvgTextWidth(b),S=e.TextMeasurementService.estimateSvgTextHeight(b,!0),x={left:s.x(m),top:s.y(m),width:s.width(m),height:s.height(m)};a.push({isPreferred:!0,text:v,textSize:{width:C,height:S},outsideFill:t.ColumnChart.getLabelFill(h.labelColor,!1,this.isComboChart),insideFill:t.ColumnChart.getLabelFill(h.labelColor,!0,this.isComboChart),parentType:1,parentShape:{rect:x,orientation:m.value>=0?3:4,validPositions:t.ColumnChart.stackedValidLabelPositions},identity:m.identity,fontSize:h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}}}return a},a.classes={item:{"class":"bar",selector:".bar"},highlightItem:{"class":"highlightBar",selector:".highlightBar"}},a}();t.StackedBarChartStrategy=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var a=t.utility.SelectionManager,r=function(){function i(){}return i.converter=function(e){var a={size:i.getSize(e),color:i.getFill(e).solid.color,text:i.DefaultText,toolTipInfo:[{displayName:"Test",value:"1...2....3... can you see me? I am sending random strings to the tooltip"}],selector:t.SelectionId.createNull()},r=e.table;return r?(a.text=r.rows[0][0],e.categorical&&(a.selector=e.categorical.categories[0].identity?t.SelectionId.createWithId(e.categorical.categories[0].identity[0]):t.SelectionId.createNull()),a):a},i.prototype.init=function(e){this.root=d3.select(e.element.get(0)).append("svg").classed("hello",!0),this.svgText=this.root.append("text").style("cursor","pointer").style("stroke","green").style("stroke-width","0px").attr("text-anchor","middle"),this.selectiionManager=new a({hostServices:e.host})},i.prototype.update=function(a){if(a.dataViews||a.dataViews[0]){var r=this.dataView=a.dataViews[0],o=a.viewport,n=i.converter(r);this.root.attr({height:o.height,width:o.width});var s={fontFamily:"tahoma",fontSize:n.size+"px",text:n.text},l=e.TextMeasurementService.estimateSvgTextHeight(s),c=this.selectiionManager;this.svgText.style({fill:n.color,"font-size":s.fontSize,"font-family":s.fontFamily}).attr({y:o.height/2+l/3+"px",x:o.width/2}).text(n.text).on("click",function(){var e=this;c.select(n.selector).then(function(t){return d3.select(e).style("stroke-width",t.length>0?"2px":"0px")})}).data([n]),t.TooltipManager.addTooltip(this.svgText,function(e){return e.data.toolTipInfo})}},i.getFill=function(e){if(e){var t=e.metadata.objects;if(t){var i=t.general;if(i){var a=i.fill;if(a)return a}}}return{solid:{color:"red"}}},i.getSize=function(e){if(e){var t=e.metadata.objects;if(t){var i=t.general;if(i){var a=i.size;if(a)return a}}}return 100},i.prototype.enumerateObjectInstances=function(e){var t=[],a=this.dataView;switch(e.objectName){case"general":var r={objectName:"general",displayName:"General",selector:null,properties:{fill:i.getFill(a),size:i.getSize(a)}};t.push(r)}return t},i.prototype.destroy=function(){this.root=null},i.capabilities={dataRoles:[{displayName:"Values",name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure}],dataViewMappings:[{table:{rows:{"for":{"in":"Values"},dataReductionAlgorithm:{window:{count:100}}},rowCount:{preferred:{min:1}}}}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{fill:{type:{fill:{solid:{color:!0}}},displayName:"Fill"},size:{type:{numeric:!0},displayName:"Size"}}}}},i.DefaultText="Invalid DV",i}();i.HelloIVisual=r}(i=t.samples||(t.samples={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t,i,a){if(a){for(var r,o=a.length,n=0;o>n;n++){var s=a[n];if(s.enumerateObjectInstances){if(s instanceof e.ColumnChart){r=n;continue}s.enumerateObjectInstances(t,i)}}void 0!==r&&a[r].enumerateObjectInstances(t,i)}}function a(t){var i=!_.isEmpty(t.dataViewMappings)&&t.dataViewMappings[0];if(i){var a=i.categorical&&i.categorical.values,r=a.group&&!_.isEmpty(a.group.select)&&a.group.select[0];_.isEmpty(r["for"]["in"].items)&&(a.group.by.items=void 0)}i&&i.categorical&&(i.categorical.dataVolume=4,e.CartesianChart.applyLoadMoreEnabledToMapping(t.cartesianLoadMoreEnabled,i));var o=t.dataViewMappings.length>1&&t.dataViewMappings[1];o&&o.categorical&&(o.categorical.dataVolume=4,e.CartesianChart.applyLoadMoreEnabledToMapping(t.cartesianLoadMoreEnabled,o))}function r(t){if(t&&t.dataViewMappings.length>0){var i=t.dataViewMappings[0];if(!e.CartesianChart.detectScalarMapping(i))return["Category","Y","Y2"]}return null}function o(e){return 10===e||13===e||14===e||15===e||16===e}t.capabilities=e.comboChartCapabilities,t.enumerateDataPoints=i,t.customizeQuery=a,t.getSortableRoles=r,t.isComboChart=o}(t=e.ComboChart||(e.ComboChart={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,i=function(){function e(e,t){this.basePickerColors=[{value:"#FFFFFF"},{value:"#000000"},{value:"#00B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C811"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"}],this.colors=e||r.getDefaultTheme(),this.sentimentColors=t||r.defaultSentimentColors,this.scales={}}return e.prototype.getColorScaleByKey=function(e){var t=this.scales[e];return void 0===t&&(t=this.createScale(),this.scales[e]=t),t},e.prototype.getNewColorScale=function(){return this.createScale()},e.prototype.getColorByIndex=function(e){return this.colors[e]},e.prototype.getSentimentColors=function(){return this.sentimentColors},e.prototype.getBasePickerColors=function(){return this.basePickerColors},e.prototype.getAllColors=function(){return this.colors},e.prototype.createScale=function(){return a.createFromColors(this.colors)},e}();e.DataColorPalette=i;var a=function(){function e(e){this.scale=e}return e.prototype.getColor=function(e){return this.scale(e)},e.prototype.clearAndRotateScale=function(){var e=this.scale.domain().length,i=t.rotate(this.scale.range(),e);this.scale=d3.scale.ordinal().range(i)},e.prototype.clone=function(){return new e(this.scale.copy())},e.prototype.getDomain=function(){return this.scale.domain()},e.createFromColors=function(t){return new e(d3.scale.ordinal().range(t))},e}();e.D3ColorScale=a;var r=function(){function e(){}return e.getDefaultTheme=function(){if(!e.defaultTheme){e.defaultTheme=[];for(var t=e.defaultBaseColors,i=0;i<e.colorSectorCount;++i)for(var a=0,r=t.length;r>a;++a)e.defaultTheme.push({value:jsCommon.Color.rotate(t[a].value,i/e.colorSectorCount)})}return e.defaultTheme},e.colorSectorCount=12,e.defaultBaseColors=[{value:"#01B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C80F"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"},{value:"#3599B8"},{value:"#DFBFBF"},{value:"#4AC5BB"},{value:"#5F6B6D"},{value:"#FB8281"},{value:"#F4D25A"},{value:"#7F898A"},{value:"#A4DDEE"},{value:"#FDAB89"},{value:"#B687AC"},{value:"#28738A"},{value:"#A78F8F"},{value:"#168980"},{value:"#293537"},{value:"#BB4A4A"},{value:"#B59525"},{value:"#475052"},{value:"#6A9FB0"},{value:"#BD7150"},{value:"#7B4F71"},{value:"#1B4D5C"},{value:"#706060"},{value:"#0F5C55"},{value:"#1C2325"},{value:"#7D3231"},{value:"#796419"},{value:"#303637"},{value:"#476A75"},{value:"#7E4B36"},{value:"#52354C"},{value:"#0D262E"},{value:"#544848"}],e.defaultSentimentColors=[{value:"#C0433A"},{value:"#E8D62E"},{value:"#79C75B"}],e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function i(e){this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}return i.prototype.init=function(e){this.options=e,this.svg=e.svg,this.svg.classed(i.ClassName,!0),this.mainGraphicsG=this.svg.append("g").classed("dataDotChartMainGraphicsContext",!0),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.currentViewport=e.viewport,this.hostService=e.host,this.cartesianVisualHost=e.cartesianHost,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity,this.element=e.element},i.prototype.setData=function(a){if(this.data={series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1},a.length>0){var r=a[0];if(r&&r.categorical){var o=this.dataViewCategorical=r.categorical,n=o.categories,s=e.ValueType.fromDescriptor({text:!0});n&&n.length>0&&n[0].source&&n[0].source.type&&(s=n[0].source.type),this.data=i.converter(r,t.valueFormatter.format(null),this.interactivityService)}}},i.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a&&a.series&&a.series.data&&(a.series={data:a.series.data.slice(t,i),xCol:a.series.xCol,yCol:a.series.yCol}),a},i.prototype.calculateAxesProperties=function(a){var r=this;this.currentViewport=a.viewport,this.margin=a.margin;var o=this.clippedData=this.data,n=this.currentViewport,s=this.margin,l=o?o.series:null,c=l&&l.data&&l.data.length>0?[l]:[],u=l&&l.data?l.data.length:0;o.hasHighlights&&(u/=2);var h,d,p=n.width-(s.left+s.right),g=n.height-(s.top+s.bottom);i.hasDataPoint(l)&&(h=l.xCol,d=l.yCol);var m=t.CartesianChart.getLayout(null,{availableWidth:p,categoryCount:u,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:a.trimOrdinalDataOnOverflow}),f=m.categoryThickness*t.CartesianChart.OuterPaddingRatio;this.isScrollable||(this.clippedData=i.createClippedDataIfOverflowed(o,m.categoryCount));var y=t.AxisHelper.createValueDomain(c,!0)||t.emptyDomain,v=t.AxisHelper.combineDomain(a.forcedYDomain,y,a.ensureYDomain);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:g,dataDomain:v,metaDataColumn:d,formatString:t.valueFormatter.getFormatString(d,i.formatStringProp),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1});var b=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0}),C=t.AxisHelper.createDomain(c,b,!1,a.forcedXDomain,a.ensureXDomain);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:p,dataDomain:C,metaDataColumn:h,formatString:t.valueFormatter.getFormatString(h,i.formatStringProp),outerPadding:f,isScalar:!1,isVertical:!1,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,categoryThickness:m.categoryThickness,getValueFn:function(e,t){return r.lookupXValue(e,t)},isCategoryAxis:!0}),[this.xAxisProperties,this.yAxisProperties]},i.createClippedDataIfOverflowed=function(t,i){var a=t.hasHighlights?Math.min(t.series.data.length,2*i):Math.min(t.series.data.length,i);if(a>=t.series.data.length)return t;var r=e.Prototype.inherit(t);return r.series=e.Prototype.inherit(t.series),r.series.data=r.series.data.slice(0,a),r},i.hasDataPoint=function(e){return e&&e.data&&e.data.length>0},i.prototype.lookupXValue=function(e,i){var a=this.data,r=t.AxisHelper.isDateTime(i);if(r)return new Date(e);if(a&&a.series){var o=a.series.data;if(o){var n=o[e];if(n)return n.categoryValue}}return e},i.prototype.overrideXScale=function(e){this.xAxisProperties=e},i.prototype.render=function(a){var r=this;if(this.clippedData){var o=this.clippedData,n=o.series.data,s=o.hasHighlights,l=this.margin,c=this.currentViewport,u=c.width-(l.left+l.right),h=c.height-(l.top+l.bottom),d=this.xAxisProperties.scale,p=this.yAxisProperties.scale,g=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),m=g/2,f=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),y=this.interactivityService?this.interactivityService.hasSelection():!1;this.mainGraphicsContext.attr("width",u).attr("height",h);var v=this.mainGraphicsContext.selectAll(i.DotClassSelector).data(n,function(e){return e.identity.getKey()});v.enter().append("circle").classed(i.DotClassName,!0),v.style({fill:f.value}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,y,s)}).classed("null-value",function(e){return null===e.value}).attr({r:function(e){return m},cx:function(e){return d(e.categoryIndex)+m},cy:function(e){return p(e.value)}}),v.exit().remove();var b=this.mainGraphicsContext.selectAll(i.DotLabelClassSelector).data(n,function(e){return e.identity.getKey()});b.enter().append("text").classed(i.DotLabelClassName,!0).attr({"text-anchor":i.DotLabelTextAnchor,dy:i.DotLabelVerticalOffset}),b.classed("null-value",function(e){return null===e.value}).classed("overflowed",!1).attr({x:function(e){return d(e.categoryIndex)+m},y:function(e){return p(e.value)}}).text(function(e){return r.yAxisProperties.formatter.format(e.value)});var C=!1;b.each(function(){if(!C&&!$("<div>").addClass($(this).attr("class")).hasClass("null-value")){var t=e.TextMeasurementService.measureSvgTextElementWidth(this);t>g&&(b.classed("overflowed",!0),C=!0)}}),b.exit().remove();var S=void 0;return this.interactivityService&&(S={dots:v,dotLabels:b,datapoints:n}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:n,behaviorOptions:S,labelDataPoints:[],labelsAreNumeric:!0}}},i.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},i.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},i.prototype.createLegendDataPoints=function(a){var r=this.data;if(!r)return null;var o,n=r.series,s=n.data,l=[],c=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0});if(r.series&&r.series.data){var u=r.series.data[0];o=u&&this.lookupXValue(u.categoryValue,c)}if(n.yCol){var h=i.formatStringProp,d=s[a],p=d&&d.value,g=t.converterHelper.getFormattedLegendLabel(n.yCol,this.dataViewCategorical.values,h),m=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),f=this.dataViewCategorical.values,y=f&&f.length>a?t.SelectionId.createWithIdAndMeasure(f[a].identity,f[a].source.queryName):t.SelectionId.createWithMeasure(f.source.queryName);l.push({color:m.value,icon:t.LegendIcon.Line,label:g,category:t.valueFormatter.format(o,t.valueFormatter.getFormatString(n.xCol,h)),measure:t.valueFormatter.format(p,t.valueFormatter.getFormatString(n.yCol,h)),identity:y,selected:!1})}return{dataPoints:l}},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.converter=function(e,i,a){var r=e.categorical,o=r.categories&&r.categories.length>0?r.categories[0]:{source:void 0,values:[i],identity:void 0},n=t.AxisHelper.getCategoryValueType(o.source),s=t.AxisHelper.isDateTime(n),l=o.values;if(!_.isEmpty(r.values)){for(var c=r.values[0],u=!!c.highlights,h=[],d=0,p=c.values.length;p>d;d++){var g=o.identity?t.SelectionId.createWithIdAndMeasure(o.identity[d],c.source.queryName):t.SelectionId.createWithMeasure(c.source.queryName),m=l[d];if((!s||null==m||m instanceof Date)&&(h.push({categoryValue:s&&m?m.getTime():m,value:c.values[d],categoryIndex:d,seriesIndex:0,selected:!1,identity:g,highlight:!1}),u)){var f=t.SelectionId.createWithHighlight(g),y=c.highlights[d];h.push({categoryValue:s&&m?m.getTime():m,value:y,categoryIndex:d,seriesIndex:0,selected:!1,identity:f,highlight:!0})}}return a&&a.applySelectionStateToData(h),{series:{xCol:o.source,yCol:c.source,data:h},hasHighlights:u,hasDynamicSeries:!0}}return{series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1}},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.ClassName="dataDotChart",i.DotClassName="dot",i.DotClassSelector=".dot",i.DotColorKey="dataDot",i.DotLabelClassName="label",
i.DotLabelClassSelector=".label",i.DotLabelVerticalOffset="0.4em",i.DotLabelTextAnchor="middle",i}();t.DataDotChart=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants.createClassAndSelector,a=jsCommon.PixelConverter,r=function(){function r(e){this.labelPositionObjects=[t.labelPosition.outsideEnd,t.labelPosition.insideCenter],e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,e.funnelSmallViewPortProperties&&(this.funnelSmallViewPortProperties=e.funnelSmallViewPortProperties),e.animator&&(this.animator=e.animator),e.behavior&&(this.behavior=e.behavior))}return r.converter=function(i,a,o,n,s,l){void 0===s&&(s=!0);for(var c=e.data.createIDataViewCategoricalReader(i),u=[],h=t.funnelChartProps.general.formatString,d=i.categorical,p=c.hasHighlights("Y"),g=[],m=0,f=c.getSeriesCount("Y");f>m;m++)g.push(c.getValueMetadataColumn("Y",m));var y,v,b,C,S=!1,x=!1,w=!1,P=[],D=t.dataLabelUtils.getDefaultFunnelLabelSettings(),L=t.dataLabelUtils.getDefaultLabelSettings(!0),T=new t.ColorHelper(a,t.funnelChartProps.dataPoint.fill,n),V=t.GradientUtils.getGradientValueColumn(d);if(i&&i.metadata&&i.metadata.objects){var M=i.metadata.objects.labels;M&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(M,D);var N=i.metadata.objects.percentBarLabel;N&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(N,L)}if(!c.hasValues("Y"))return{slices:u,categoryLabels:P,valuesMetadata:g,hasHighlights:p,highlightsOverflow:S,canShowDataLabels:!0,dataLabelsSettings:D,hasNegativeValues:x,allValuesAreNegative:w,percentBarLabelSettings:L};y=c.getValue("Y",0,0),p&&(v=c.getHighlight("Y",0,0));var A=t.valueFormatter.getLocalizedString("Percentage");if(c.hasCategories())for(var O=0,I=c.getCategoryCount();I>O;O++){var R=c.getCategoryColumn("Category"),F=c.getCategoryValue("Category",O),H=c.getValueMetadataColumn("Y"),z=t.SelectionIdBuilder.builder().withCategory(R,O).withMeasure(H.queryName).createSelectionId(),G=c.getValue("Y",O),k=t.converterHelper.formatFromMetadataColumn(F,R.source,h),j=void 0;if(s){j=[],j.push({displayName:R.source.displayName,value:k}),null!=G&&j.push({displayName:H.displayName,value:t.converterHelper.formatFromMetadataColumn(G,H,h)});var E=void 0;p&&(E=c.getHighlight("Y",O),null!=E&&j.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(E,H,h)}));var B=V?V.source:void 0;if(B&&B!==H&&null!=V.values[O]&&j.push({displayName:B.displayName,value:t.converterHelper.formatFromMetadataColumn(c.getValue("Gradient",O),B,h)}),p?r.addFunnelPercentsToTooltip(A,j,o,v?E/v:null,C?E/C:null,!0):r.addFunnelPercentsToTooltip(A,j,o,y?G/y:null,b?G/b:null),l){var W=c.getAllValuesForRole("Tooltips",O,void 0),U=c.getAllValueMetadataColumnsForRole("Tooltips",void 0);if(W&&U)for(var Y=0;Y<W.length;Y++)null!=W[Y]&&j.push({displayName:U[Y].displayName,value:t.converterHelper.formatFromMetadataColumn(W[Y],U[Y],h)})}}var K=T.getColorForMeasure(c.getCategoryObjects("Category",O),"");if(u.push({label:k,value:G,originalValue:G,categoryOrMeasureIndex:O,identity:z,selected:!1,key:z.getKey(),tooltipInfo:j,color:K,labelFill:D.labelColor}),p){var X=t.SelectionId.createWithHighlight(z),E=c.getHighlight("Y",O);u.push({label:k,value:G,originalValue:G,categoryOrMeasureIndex:O,identity:X,selected:!1,key:X.getKey(),highlight:!0,highlightValue:E,originalHighlightValue:E,tooltipInfo:j,color:K}),C=E}b=G}else for(var O=0,m=0,f=c.getSeriesCount("Y");f>m;m++){var G=c.getValue("Y",O,m),H=c.getValueMetadataColumn("Y",m),z=t.SelectionId.createWithMeasure(H.queryName),j=void 0,K=T.getColorForMeasure(H.objects,"");if(s){if(j=[],null!=G&&j.push({displayName:H.displayName,value:t.converterHelper.formatFromMetadataColumn(G,H,h)}),p){var E=c.getHighlight("Y",O,m);null!=E&&j.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(E,H,h)}),r.addFunnelPercentsToTooltip(A,j,o,v?E/v:null,C?E/C:null,!0)}else r.addFunnelPercentsToTooltip(A,j,o,y?G/y:null,b?G/b:null);if(l){var W=c.getAllValuesForRole("Tooltips",O,void 0),U=c.getAllValueMetadataColumnsForRole("Tooltips",void 0);if(W&&U)for(var Y=0;Y<W.length;Y++)null!=W[Y]&&j.push({displayName:U[Y].displayName,value:t.converterHelper.formatFromMetadataColumn(W[Y],U[Y],h)})}}if(u.push({label:H.displayName,value:G,originalValue:G,categoryOrMeasureIndex:m,identity:z,selected:!1,key:z.getKey(),tooltipInfo:j,color:K,labelFill:D.labelColor}),p){var X=t.SelectionId.createWithHighlight(z),q=c.getHighlight("Y",O,m);u.push({label:H.displayName,value:G,originalValue:G,categoryOrMeasureIndex:m,identity:X,key:X.getKey(),selected:!1,highlight:!0,originalHighlightValue:q,highlightValue:q,tooltipInfo:j,color:K}),C=q}b=G}for(var $=0;$<u.length;$+=p?2:1){var Q=u[$];P.push(Q.label)}w=u.length>0&&_.every(u,function(e){return(e.highlight?e.highlightValue<=0:!0)&&e.value<0});for(var Z=0,J=u;Z<J.length;Z++){var Q=J[Z];if(w)Q.value=Math.abs(Q.value),Q.highlight&&(Q.highlightValue=Math.abs(Q.highlightValue));else{var G=Q.value,ee=0>G;ee&&(Q.value=0);var te=!1;if(Q.highlight){var E=Q.highlightValue;te=0>E,Q.highlightValue=te?0:E}x||(x=ee||te)}Q.highlightValue>Q.value&&(S=!0)}return{slices:u,categoryLabels:P,valuesMetadata:g,hasHighlights:p,highlightsOverflow:S,canShowDataLabels:!0,dataLabelsSettings:D,hasNegativeValues:x,allValuesAreNegative:w,percentBarLabelSettings:L}},r.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"dataPoint":var a=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,o=t.GradientUtils.hasGradientRole(a);o||this.enumerateDataPoints(i);break;case"labels":var n=r.getLabelSettingsOptions(i,this.data.dataLabelsSettings,!0,this.labelPositionObjects);t.dataLabelUtils.enumerateDataLabels(n);break;case"percentBarLabel":var s=r.getLabelSettingsOptions(i,this.data.percentBarLabelSettings,!1);t.dataLabelUtils.enumerateDataLabels(s)}return i.complete()},r.getLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:i,precision:i,position:i,positionObject:a,fontSize:!0}},r.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.slices;e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:this.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}});for(var r=0;r<a.length;r++){var o=a[r];if(!o.highlight){var n=o.color,s=o.identity.getSelector(),l=!!s.data;e.pushInstance({objectName:"dataPoint",displayName:o.label,selector:t.ColorHelper.normalizeSelector(s,l),properties:{fill:{solid:{color:n}}}})}}}},r.prototype.init=function(e){this.options=e;var i=e.element,a=this.svg=d3.select(i.get(0)).append("svg").classed(r.VisualClassName,!0);this.behavior&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.currentViewport=e.viewport,this.margin={left:5,right:5,top:0,bottom:0};var o=e.style;this.colors=o.colorPalette.dataColors,this.hostServices=e.host,this.behavior&&(this.interactivityService=t.createInteractivityService(this.hostServices)),this.percentGraphicsContext=a.append("g").classed(r.Selectors.percentBar.root["class"],!0),this.funnelGraphicsContext=a.append("g"),this.axisGraphicsContext=a.append("g"),this.updateViewportProperties()},r.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},r.prototype.update=function(i){this.data={slices:[],categoryLabels:[],valuesMetadata:[],hasHighlights:!1,highlightsOverflow:!1,canShowDataLabels:!0,dataLabelsSettings:t.dataLabelUtils.getDefaultFunnelLabelSettings(),hasNegativeValues:!1,allValuesAreNegative:!1,percentBarLabelSettings:t.dataLabelUtils.getDefaultLabelSettings(!0)};var a=this.dataViews=i.dataViews;if(this.currentViewport=i.viewport,a&&a.length>0){var o=a[0];if(o.metadata&&o.metadata.objects){var n=e.DataViewObjects.getFillColor(o.metadata.objects,t.funnelChartProps.dataPoint.defaultColor);n&&(this.defaultDataPointColor=n)}o.categorical&&(this.data=r.converter(o,this.colors,this.hostServices,this.defaultDataPointColor,this.tooltipsEnabled,this.tooltipBucketEnabled),this.interactivityService&&this.interactivityService.applySelectionStateToData(this.data.slices));var s=t.getInvalidValueWarnings(a,!1,!1,!1);this.data.allValuesAreNegative?s.unshift(new t.AllNegativeValuesWarning):this.data.hasNegativeValues&&s.unshift(new t.NegativeValuesNotSupportedWarning),this.hostServices.setWarnings(s)}this.updateViewportProperties(),this.updateInternal(i.suppressAnimations)},r.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},r.prototype.onResizing=function(e){this.currentViewport=e,this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:this.currentViewport})},r.prototype.getMaxLabelLength=function(t,i){for(var a=0,o=e.TextMeasurementService.measureSvgTextWidth,n=0,s=t.length;s>n;n++)i.text=t[n],a=Math.max(a,o(i));return a+r.LabelFunnelPadding},r.prototype.updateInternal=function(e){if(null!=this.data){var i=this.data,a=i.slices,o=a.filter(function(e){return!e.highlight}),n=this.isHidingPercentBars(),s=this.setUpAxis(),l=s.margin,c=this.funnelGraphicsContext.attr("transform",t.SVGUtil.translate(l.left,l.top));this.percentGraphicsContext.attr("transform",t.SVGUtil.translate(l.left,l.top)),this.svg.style("font-family",t.dataLabelUtils.StandardFontFamily);var u,h,d,p=r.getLayout(i,s),g=t.dataLabelUtils.getFunnelChartLabelLayout(i,s,r.InnerTextMinimumPadding,i.dataLabelsSettings,this.currentViewport);if(this.animator&&!e){var m={viewModel:i,interactivityService:this.interactivityService,layout:p,axisGraphicsContext:this.axisGraphicsContext,shapeGraphicsContext:c,percentGraphicsContext:this.percentGraphicsContext,labelGraphicsContext:this.svg,axisOptions:s,slicesWithoutHighlights:o,labelLayout:g,isHidingPercentBars:n,visualInitOptions:this.options};u=this.animator.animate(m),h=u.shapes,d=u.dataLabels}if((!this.animator||e||u.failed)&&(r.drawDefaultAxis(this.axisGraphicsContext,s,n),h=r.drawDefaultShapes(i,a,c,p,this.interactivityService&&this.interactivityService.hasSelection()),r.drawPercentBars(i,this.percentGraphicsContext,p,n),i.dataLabelsSettings.show&&i.canShowDataLabels?d=t.dataLabelUtils.drawDefaultLabelsForFunnelChart(i.slices,this.svg,g):t.dataLabelUtils.cleanDataLabels(this.svg)),this.interactivityService){var f=r.drawInteractorShapes(a,c,p),y={bars:h,interactors:f,clearCatcher:this.clearCatcher,hasHighlights:i.hasHighlights};this.interactivityService.bind(a,this.behavior,y),this.tooltipsEnabled&&t.TooltipManager.addTooltip(f,function(e){return e.data.tooltipInfo})}this.tooltipsEnabled&&t.TooltipManager.addTooltip(h,function(e){return e.data.tooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},r.prototype.getUsableVerticalSpace=function(){var e=this.data.categoryLabels,t=this.margin,i=this.currentViewport.height-(t.top+t.bottom);return i-r.MinBarThickness*e.length},r.prototype.isHidingPercentBars=function(){var e=this.data;if(e.percentBarLabelSettings.show){var t=this.getPercentBarTextHeight(),i=this.getUsableVerticalSpace()-2*r.MinBarThickness*r.PercentBarToBarRatio-2*t;return 0>=i}return!0},r.prototype.isSparklines=function(){return this.getUsableVerticalSpace()<=0},r.prototype.setUpAxis=function(){var e=this.data,t=e.slices,i=e.categoryLabels,a=this.currentViewport,o=this.margin,n=this.isSparklines(),s=this.isHidingPercentBars(),l=s?0:this.getPercentBarTextHeight(),c=a.height-(o.top+o.bottom)-2*l,u=r.MaxMarginFactor;if(i.length>0&&n)i=[],e.canShowDataLabels=!1;else if(this.showCategoryLabels()){var h=r.getTextProperties(),d=this.getMaxLabelLength(i,h),p=a.width*u,g=Math.min(d,p);o.left=g+r.YAxisPadding}else i=[];var m=a.width-(o.left+o.right),f=r.BarToSpaceRatio,y=d3.max(t.map(function(e){return e.value}));if(e.hasHighlights){var v=d3.max(t.map(function(e){return e.highlightValue}));y=d3.max([y,v])}var b,C=0,S=0,x=c;b=s?c-i.length*r.MaxBarHeight:c-i.length*r.MaxBarHeight-2*r.MaxBarHeight*r.PercentBarToBarRatio,i.length>0&&b>0&&(S=Math.ceil(b/2),x=Math.ceil(c-b/2)),s||(S+=l,x+=l);var w=d3.scale.linear().domain([C,y]).range([m,0]),P=d3.scale.ordinal().domain(d3.range(0,e.categoryLabels.length)).rangeBands([S,x],f,s?f:r.PercentBarToBarRatio);return{margin:o,valueScale:w,categoryScale:P,maxScore:y,maxWidth:m,rangeStart:S,rangeEnd:x,barToSpaceRatio:f,categoryLabels:i}},r.prototype.getPercentBarTextHeight=function(){var t=r.getTextProperties(this.data.percentBarLabelSettings.fontSize);return e.TextMeasurementService.estimateSvgTextHeight(t)},r.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},r.getLayout=function(i,o){var n=i.highlightsOverflow,s=o.categoryScale,l=o.valueScale,c=o.maxScore,u=s.rangeBand(),h=Math.ceil(u/2),d=u*r.OverflowingHighlightWidthRatio,p=d/2,g=o.categoryLabels.length-1,m=Math.abs(l(c)-l(0)),f=function(e){return(m-Math.abs(l(e)-l(0)))/2},y=function(e){return Math.max(r.MinimumInteractorSize,Math.abs(l(e)-l(0)))},v=a.fromPoint(i.percentBarLabelSettings.fontSize),b=r.getTextProperties(i.percentBarLabelSettings.fontSize),C=e.TextMeasurementService.estimateSvgTextBaselineDelta(b),S=e.TextMeasurementService.estimateSvgTextHeight(b)-C;return{percentBarLayout:{mainLine:{x2:function(e){return Math.abs(l(e.value)-l(0))},transform:function(e){var i=l(e.value)-f(e.value),a=e.isTop?s(0)-h:s(g)+u+h;return t.SVGUtil.translate(i,a)}},leftTick:{y2:function(e){return h},transform:function(e){var i=l(e.value)-f(e.value),a=e.isTop?s(0)-h-h/2:s(g)+u+h-h/2;return t.SVGUtil.translate(i,a)}},rightTick:{y2:function(e){return h},transform:function(e){var i=l(e.value)-f(e.value),a=Math.abs(l(e.value)-l(0)),r=i+a,o=e.isTop?s(0)-h-h/2:s(g)+u+h-h/2;return t.SVGUtil.translate(r,o)}},text:{x:function(e){return Math.ceil(Math.abs(l(c)-l(0))/2)},y:function(e){return e.isTop?-h/2-C:S+h/2},style:function(){return"font-size: "+v+";"},transform:function(e){var i=e.isTop?s(0)-h:s(g)+u+h;return t.SVGUtil.translate(0,i)},fill:i.percentBarLabelSettings.labelColor,maxWidth:m}},shapeLayout:{height:function(e){return e.highlight&&n?d:u},width:function(e){return Math.abs(l(r.getFunnelSliceValue(e))-l(0))},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&n?p:0)},x:function(e){var t=r.getFunnelSliceValue(e);return l(t)-f(t)}},shapeLayoutWithoutHighlights:{height:function(e){return u},width:function(e){return Math.abs(l(e.value)-l(0))},y:function(e){return s(e.categoryOrMeasureIndex)+0},x:function(e){return l(e.value)-f(e.value)}},zeroShapeLayout:{height:function(e){return e.highlight&&n?d:u},width:function(e){return 0},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&n?p:0)},x:function(e){return l((l.domain()[0]+l.domain()[1])/2)}},interactorLayout:{height:function(e){return e.highlight&&n?d:u},width:function(e){return y(r.getFunnelSliceValue(e))},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&n?p:0)},x:function(e){var t=y(r.getFunnelSliceValue(e));return(m-t)/2}}}},r.drawDefaultAxis=function(i,a,o){var n=d3.range(0,a.categoryLabels.length),s=d3.scale.ordinal().domain(n).rangeBands([a.rangeStart,a.rangeEnd],a.barToSpaceRatio,o?a.barToSpaceRatio:r.PercentBarToBarRatio),l=d3.svg.axis().scale(s).orient("right").tickPadding(r.TickPadding).innerTickSize(r.InnerTickSize).ticks(n.length).tickValues(n).tickFormat(function(e){return a.categoryLabels[e]});i.attr("class","axis hideLinesOnAxis").attr("transform",t.SVGUtil.translate(0,a.margin.top)).call(l),i.selectAll(".tick").call(t.tooltipUtils.tooltipUpdate,a.categoryLabels);var c=a.margin.left-r.LabelFunnelPadding;i.selectAll(".tick text").call(t.AxisHelper.LabelLayoutStrategy.clip,c,e.TextMeasurementService.svgEllipsis)},r.drawDefaultShapes=function(e,i,a,o,n){var s=e.hasHighlights,l=a.selectAll(r.Selectors.funnel.bars.selector).data(i,function(e){return e.key});return l.enter().append("rect").attr("class",function(e){return e.highlight?r.FunnelBarHighlightClass:r.Selectors.funnel.bars["class"]}),l.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,n,s)}}).attr(o.shapeLayout),l.exit().remove(),l},r.getFunnelSliceValue=function(e,t){return void 0===t&&(t=!1),t?e.highlight?e.originalHighlightValue:e.originalValue:e.highlight?e.highlightValue:e.value},r.drawInteractorShapes=function(e,t,i){var a=e.filter(function(e){return!e.highlight&&i.interactorLayout.width(e)===r.MinimumInteractorSize}),o=t.selectAll(r.Selectors.funnel.interactors.selector).data(a,function(e){return e.key});return o.enter().append("rect").attr("class",r.Selectors.funnel.interactors["class"]),o.style("fill-opacity",0).attr(i.interactorLayout),o.exit().remove(),o},r.drawPercentBarComponents=function(i,a,o,n){var s=i.selectAll(r.Selectors.percentBar.mainLine.selector).data(a);s.exit().remove(),s.enter().append("line").classed(r.Selectors.percentBar.mainLine["class"],!0),s.attr(o.percentBarLayout.mainLine);var l=i.selectAll(r.Selectors.percentBar.leftTick.selector).data(a);l.exit().remove(),l.enter().append("line").classed(r.Selectors.percentBar.leftTick["class"],!0),l.attr(o.percentBarLayout.leftTick);var c=i.selectAll(r.Selectors.percentBar.rightTick.selector).data(a);c.exit().remove(),c.enter().append("line").classed(r.Selectors.percentBar.rightTick["class"],!0),c.attr(o.percentBarLayout.rightTick);var u=i.selectAll(r.Selectors.percentBar.text.selector).data(a),h=t.valueFormatter.getLocalizedString("Percentage1");u.exit().remove(),u.enter().append("text").classed(r.Selectors.percentBar.text["class"],!0),u.attr(o.percentBarLayout.text).text(function(e){return t.dataLabelUtils.getLabelFormattedText({label:e.percent,format:h,fontSize:n.fontSize,maxWidth:o.percentBarLayout.text.maxWidth})}).append("title").text(function(t){return e.formattingService.formatValue(t.percent,h)})},r.drawPercentBars=function(e,t,i,a){if(a||!e.slices||(e.hasHighlights?e.slices.length/2:e.slices.length)<2)return void r.drawPercentBarComponents(t,[],i,e.percentBarLabelSettings);var o=[e.slices[e.hasHighlights?1:0],e.slices[e.slices.length-1]],n=r.getFunnelSliceValue(o[0]);if(0>=n)return void r.drawPercentBarComponents(t,[],i,e.percentBarLabelSettings);var s=[{value:r.getFunnelSliceValue(o[0]),percent:1,isTop:!0},{value:r.getFunnelSliceValue(o[1]),percent:r.getFunnelSliceValue(o[1])/n,isTop:!1}];r.drawPercentBarComponents(t,s,i,e.percentBarLabelSettings)},r.prototype.showCategoryLabels=function(){return!(this.funnelSmallViewPortProperties&&this.funnelSmallViewPortProperties.hideFunnelCategoryLabelsOnSmallViewPort&&this.currentViewport.height<this.funnelSmallViewPortProperties.minHeightFunnelCategoryLabelsVisible)},r.addFunnelPercentsToTooltip=function(e,i,a,r,o,n){null!=r&&i.push({displayName:a.getLocalizedString("Funnel_PercentOfFirst"+(n?"_Highlight":"")),value:t.valueFormatter.format(r,e)}),null!=o&&i.push({displayName:a.getLocalizedString("Funnel_PercentOfPrevious"+(n?"_Highlight":"")),value:t.valueFormatter.format(o,e)})},r.getTextProperties=function(e){return{fontSize:a.fromPoint(e||t.dataLabelUtils.DefaultFontSizeInPt),fontFamily:r.DefaultFontFamily}},r.DefaultBarOpacity=1,r.DimmedBarOpacity=.4,r.PercentBarToBarRatio=.75,r.TickPadding=0,r.InnerTickSize=0,r.MinimumInteractorSize=15,r.InnerTextClassName="labelSeries",r.Selectors={funnel:{bars:i("funnelBar"),highlights:i("highlight"),interactors:i("funnelBarInteractor")},percentBar:{root:i("percentBars"),mainLine:i("mainLine"),leftTick:i("leftTick"),rightTick:i("rightTick"),text:i("value")}},r.FunnelBarHighlightClass=[r.Selectors.funnel.bars["class"],r.Selectors.funnel.highlights["class"]].join(" "),r.YAxisPadding=10,r.VisualClassName="funnelChart",r.DefaultFontFamily="wf_standard-font",r.BarToSpaceRatio=.1,r.MaxBarHeight=40,r.MinBarThickness=12,r.LabelFunnelPadding=6,r.InnerTextMinimumPadding=10,r.OverflowingHighlightWidthRatio=.5,r.MaxMarginFactor=.25,r}();t.FunnelChart=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants.createClassAndSelector,a=jsCommon.PixelConverter,r=e.data.DataRoleHelper,o=function(){function o(e){this.lastAngle=-Math.PI/2,e&&(e.gaugeSmallViewPortProperties&&(this.gaugeSmallViewPortProperties=e.gaugeSmallViewPortProperties),this.animator=e.animator,this.tooltipsEnabled=e.tooltipsEnabled)}return o.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"axis":this.enumerateAxis(i);break;case"labels":var a=this.data?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultGaugeLabelSettings();t.dataLabelUtils.enumerateDataLabels(this.getDataLabelSettingsOptions(i,a));break;case"calloutValue":var a=this.data?this.data.calloutValueLabelsSettings:t.dataLabelUtils.getDefaultGaugeLabelSettings();t.dataLabelUtils.enumerateDataLabels(this.getDataLabelSettingsOptions(i,a));break;case"dataPoint":this.enumerateDataPoint(i)}return i.complete()},o.prototype.getDataLabelSettingsOptions=function(e,t){return{dataLabelsSettings:t,show:!0,precision:!0,displayUnits:!0,fontSize:!0,enumeration:e}},o.prototype.enumerateAxis=function(e){var t=this.dataViews[0];if(t&&t.metadata){var i=o.getGaugeObjectsProperties(t);e.pushInstance({selector:null,objectName:"axis",properties:i})}},o.prototype.enumerateDataPoint=function(e){var i=this.data?this.data.dataPointSettings:o.DefaultDataPointSettings,a={};a.fill={solid:{color:i.fillColor}},null!=i.targetColor&&(a.target={solid:{color:i.targetColor}}),e.pushInstance({selector:null,objectName:t.gaugeProps.dataPoint.target.objectName,properties:a})},o.getGaugeObjectsProperties=function(e){var i={},a=e.metadata.objects,o=!!a&&!!a.axis;return r.hasRoleInDataView(e,t.gaugeRoleNames.minValue)||(i.min=o?a.axis.min:void 0),r.hasRoleInDataView(e,t.gaugeRoleNames.maxValue)||(i.max=o?a.axis.max:void 0),r.hasRoleInDataView(e,t.gaugeRoleNames.targetValue)||(i.target=o?a.axis.target:void 0),i},o.prototype.init=function(e){this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.options=e,this.settings=o.DefaultStyleProperties,this.targetSettings=o.DefaultTargetSettings,this.setMargins(),this.color=d3.scale.ordinal().range(this.style.colorPalette.dataColors.getSentimentColors().map(function(e){return e.value})),this.hostService=e.host;var i=this.svg=d3.select(this.element.get(0)).append("svg");i.classed(o.VisualClassName,!0);var a=this.mainGraphicsContext=i.append("g");a.attr("class",o.MainGaugeGroupClassName),this.initKpiBands();var r=this.backgroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2).endAngle(Math.PI/2),n=this.foregroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2);this.backgroundArcPath=a.append("path").classed("backgroundArc",!0).attr("d",r),this.foregroundArcPath=a.append("path").datum({endAngle:-Math.PI/2}).classed("foregroundArc",!0).attr("d",n);var s=this.animatedNumberGrapicsContext=i.append("g");this.animatedNumber=new t.AnimatedNumber(s),this.animatedNumber.init(e);var l=this.gaugeVisualProperties=this.getGaugeVisualProperties(),c=this.getAnimatedNumberProperties(l.radius,l.innerRadiusFactor,l.top,l.left);this.animatedNumberGrapicsContext.attr("transform",c.transformString),this.animatedNumber.onResizing(c.viewport)},o.prototype.update=function(e){this.currentViewport=e.viewport;var i=this.dataViews=e.dataViews;if(i&&i[0]){this.data=o.converter(i[0],this.tooltipsEnabled),this.targetSettings=this.data.targetSettings,i[0]&&(i[0].single={value:this.data.total}),this.showTargetLabel=null!=this.targetSettings.target&&(this.currentViewport.width>o.MinWidthForTargetLabel||!this.showMinMaxLabelsOnBottom())&&this.showSideNumbersLabelText()&&this.data.dataLabelsSettings.show,this.setMargins(),this.gaugeVisualProperties=this.getGaugeVisualProperties(),this.drawViewPort(this.gaugeVisualProperties),this.updateInternal(e.suppressAnimations),this.updateCalloutValue(e.suppressAnimations);var a=t.getInvalidValueWarnings(i,!1,!1,!1);this.hostService.setWarnings(a)}},o.prototype.updateCalloutValue=function(e){if(this.data.calloutValueLabelsSettings.show){var t=this.getAnimatedNumberProperties(this.gaugeVisualProperties.radius,this.gaugeVisualProperties.innerRadiusFactor,this.gaugeVisualProperties.top,this.gaugeVisualProperties.left);this.animatedNumberGrapicsContext.attr("transform",t.transformString),this.animatedNumber.setTextColor(this.data.calloutValueLabelsSettings.labelColor);var i=this.data?this.data.total:null,a=this.getFormatter(this.data.calloutValueLabelsSettings,i);this.animatedNumber.setFormatter(a),this.animatedNumber.update({viewport:t.viewport,dataViews:this.dataViews,suppressAnimations:e}),this.animatedNumberGrapicsContext.selectAll("title").remove(),this.animatedNumberGrapicsContext.append("title").text([a.format(i)])}else this.animatedNumber.clear(),this.animatedNumberGrapicsContext.selectAll("title").remove()},o.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},o.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewMode:0,viewport:e})},o.getValidSettings=function(e){var t=e.max===o.MAX_VALUE?o.DEFAULT_MAX:e.max,i=e.min===o.MIN_VALUE?o.DEFAULT_MIN:e.min,a=e.target;return{min:i,max:t,target:a}},o.getGaugeData=function(e){var i={max:o.MAX_VALUE,min:o.MIN_VALUE,target:void 0,total:0,tooltipItems:[]};if(e&&e.categorical&&e.categorical.values&&e.metadata&&e.metadata.columns){for(var a=e.categorical.values,r=e.metadata.columns,n=0;n<a.length;n++){var s=r[n],l=a[n].values[0]||0;s&&s.roles&&(s.roles[t.gaugeRoleNames.y]?(i.total=l,l&&i.tooltipItems.push({displayName:a[n].source.displayName,value:t.converterHelper.formatFromMetadataColumn(l,a[n].source,o.formatStringProp)})):s.roles[t.gaugeRoleNames.minValue]?i.min=l:s.roles[t.gaugeRoleNames.maxValue]?i.max=l:s.roles[t.gaugeRoleNames.targetValue]&&(i.target=l,l&&i.tooltipItems.push({displayName:a[n].source.displayName,value:t.converterHelper.formatFromMetadataColumn(l,a[n].source,o.formatStringProp)})))}var c=o.getGaugeObjectsProperties(e);c&&!$.isEmptyObject(c)&&o.overrideGaugeSettings(i,c)}else i.tooltipItems=void 0;return i},o.overrideGaugeSettings=function(e,t){$.isNumeric(t.min)&&(e.min=t.min),$.isNumeric(t.max)&&(e.max=t.max),$.isNumeric(t.target)&&(e.target=t.target)},o.converter=function(e,i){void 0===i&&(i=!0);var a=o.getGaugeData(e),r=a.total,n=null,s=!1;e.metadata&&!_.isEmpty(e.metadata.columns)&&(n=t.valueFormatter.getFormatString(e.metadata.columns[0],o.formatStringProp,!0),null!=n&&(s=t.valueFormatter.getFormatMetadata(n).hasPercent)),r>0&&a.max===o.MAX_VALUE&&(a.max=s?o.DEFAULT_MAX:2*r);var l=o.getValidSettings(a),c=Math.max(r,l.min);c=Math.min(c,l.max);var u,h=l.min!==l.max?(c-l.min)/(l.max-l.min):0;return i&&e&&null!=a.tooltipItems&&(u=a.tooltipItems),{percent:h,adjustedTotal:c,total:r,metadataColumn:o.getMetaDataColumn(e),targetSettings:l,tooltipInfo:u,dataLabelsSettings:o.convertDataLabelSettings(e,"labels"),calloutValueLabelsSettings:o.convertDataLabelSettings(e,"calloutValue"),dataPointSettings:o.convertDataPointSettings(e,l)}},o.convertDataLabelSettings=function(e,i){var a=e.metadata,r=t.dataLabelUtils.getDefaultGaugeLabelSettings();if(a){var o=a.objects;if(o){var n=o[i];t.dataLabelUtils.updateLabelSettingsFromLabelsObject(n,r)}}return r},o.convertDataPointSettings=function(i,a){var r,n=o.DefaultDataPointSettings.fillColor;if(i&&i.metadata&&i.metadata.objects){var s=i.metadata.objects;n=e.DataViewObjects.getFillColor(s,t.gaugeProps.dataPoint.fill,o.DefaultDataPointSettings.fillColor),a&&null!=a.target&&(r=e.DataViewObjects.getFillColor(s,t.gaugeProps.dataPoint.target,o.DefaultDataPointSettings.targetColor))}else a&&null!=a.target&&(r=o.DefaultDataPointSettings.targetColor);return{fillColor:n,targetColor:r}},o.getMetaDataColumn=function(e){if(e&&e.metadata&&e.metadata.columns)for(var t=0,i=e.metadata.columns.length;i>t;t++){var a=e.metadata.columns[t];if(a.isMeasure)return a}return null},o.prototype.initKpiBands=function(){if(this.settings.kpiBands.show)for(var e=this.kpiArcs=[],t=this.kpiArcPaths=[],i=this.mainGraphicsContext,a=0;3>a;a++){var r=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(0).endAngle(0);e.push(r);var o=i.append("path").attr("d",r);t.push(o)}},o.prototype.updateKpiBands=function(e,t,i,a){if(this.settings.kpiBands.show)for(var r=0;r<a.length;r++)this.kpiArcs[r].innerRadius(e*t-(o.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness)).outerRadius(e*t-o.KpiBandDistanceFromMainArc).startAngle(a[r].start).endAngle(a[r].end),this.kpiArcPaths[r].attr("fill",a[r].fill).attr("d",this.kpiArcs[r]).attr("transform",i)},o.prototype.removeTargetElements=function(){this.targetLine&&(this.targetLine.remove(),this.targetText.remove(),this.targetConnector.remove(),this.targetLine=this.targetConnector=this.targetText=null)},o.prototype.getTargetRatio=function(){var e=this.targetSettings,t=e.max-e.min;return 0!==t?(e.target-e.min)/t:0},o.prototype.updateTargetLine=function(e,t,i,a){this.targetLine||(this.targetLine=this.mainGraphicsContext.append("line"));var r=this.getTargetRatio()*Math.PI,o=a-e*Math.sin(r),n=i-e*Math.cos(r),s=a-t*Math.sin(r),l=i-t*Math.cos(r);this.targetLine.attr({x1:l,y1:s,x2:n,y2:o})},o.prototype.getAnimatedNumberProperties=function(e,i,a,r){var n=Math.PI/4,s=1,l=e*i,c=l-(this.settings.kpiBands.show?o.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness:0),u=c*Math.cos(n),h=c*Math.sin(n),d=a-h,p=r-u;d*=s,p*=s;var g=2*u,m={transformString:t.SVGUtil.translate(p,d),viewport:{height:h,width:g}};return m},o.prototype.getGaugeVisualProperties=function(){var e=this.currentViewport,i=this.margin,a=e.width-i.right-i.left,r=a/2,n=e.height-i.top-i.bottom,s=Math.min(r,n),l=o.InnerRadiusFactor,c=i.left+r,u=s+(n-s)/2+i.top,h=t.SVGUtil.translate(c,u),d=s*l,p={radius:s,innerRadiusOfArc:d,left:c,top:u,height:n,width:a,margin:i,transformString:h,innerRadiusFactor:l};return p},o.prototype.drawViewPort=function(e){var t=this.settings.kpiBands.separationRadians,i=o.InnerRadiusFactor,a=this.backgroundArc,r=this.color,n=[{fill:r(0),start:-Math.PI/2,end:-Math.PI/2+Math.PI/4-t},{fill:r(1),start:-Math.PI/2+1*Math.PI/4+t,end:-Math.PI/2+3*Math.PI/4-t},{fill:r(2),start:-Math.PI/2+3*Math.PI/4+t,end:Math.PI/2}],s=e.radius,l=e.transformString;this.updateKpiBands(s,i,l,n),a.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2).endAngle(Math.PI/2),this.backgroundArcPath.attr("d",a).attr("transform",l);var c=this.foregroundArc;c.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2),this.foregroundArcPath.datum({endAngle:this.lastAngle}).attr("transform",l).attr("d",c);var u=e.innerRadiusOfArc,h=e.left,d=e.top,p=e.margin,g=e.height,m=this.targetSettings;this.settings.targetLine.show&&null!=m.target?m.min>m.target||m.max<m.target?this.removeTargetElements():(this.updateTargetLine(s,u,h,d),this.appendTargetTextAlongArc(s,g,e.width,p)):this.removeTargetElements(),this.svg.attr("height",this.currentViewport.height).attr("width",this.currentViewport.width)},o.prototype.createTicks=function(){for(var e=this.settings,t=this.targetSettings,i=t.max-t.min,a=e.labels.count,r=i/a,o=[],n=this.getFormatter(this.data.dataLabelsSettings,t.max),s=0;a+1>s;s++)o.push(n.format(t.min+s*r));return o},o.prototype.updateInternal=function(e){var i=this.gaugeVisualProperties.height,a=this.gaugeVisualProperties.width,r=this.gaugeVisualProperties.radius,o=this.margin,n=t.AnimatorCommon.GetAnimationDuration(this.animator,e),s=this.data,l=this.lastAngle=-Math.PI/2+Math.PI*s.percent,c=this.createTicks();this.foregroundArcPath.transition().ease(this.settings.transition.ease).duration(n).call(this.arcTween,[l,this.foregroundArc]),this.appendTextAlongArc(c,r,i,a,o),this.updateVisualConfigurations(),this.updateVisualStyles(),
this.tooltipsEnabled&&(t.TooltipManager.addTooltip(this.foregroundArcPath,function(e){return s.tooltipInfo}),t.TooltipManager.addTooltip(this.backgroundArcPath,function(e){return s.tooltipInfo}))},o.prototype.updateVisualStyles=function(){var e=this.data.dataLabelsSettings.labelColor||this.style.labelText.color.value;this.mainGraphicsContext.selectAll("text").style({fill:e})},o.prototype.updateVisualConfigurations=function(){var e=this.settings,t=this.data.dataPointSettings;this.mainGraphicsContext.select("line").attr({stroke:t.targetColor,"stroke-width":e.targetLine.thickness}),this.backgroundArcPath.style("fill",e.arcColors.background),this.foregroundArcPath.style("fill",t.fillColor)},o.prototype.appendTextAlongArc=function(i,r,n,s,l){if(this.svg.selectAll(o.LabelText.selector).remove(),this.data.dataLabelsSettings.show)for(var c=i.length,u=c-1,h=r+(n-r)/2+l.top,d=this.showMinMaxLabelsOnBottom(),p=a.fromPoint(this.data.dataLabelsSettings.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),g=this.settings.labels.padding,m=0;c>m;m++){var f={text:i[m],fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.dataLabelUtils.LabelTextProperties.fontWeight};if(Math.floor(c/2)!==m&&this.showSideNumbersLabelText()){var y=l.left+s/2-r*Math.cos(Math.PI*m/u),v=h-r*Math.sin(Math.PI*m/u),b=void 0,C=2*m>c,S=!1;!d||0!==m&&m!==c-1?(b=C?"start":"end",y+=g*(C?1:-1)):(S=!0,v+=g/2,b=C?"end":"start",f.text=e.TextMeasurementService.getTailoredTextOrDefault(f,r));var x=this.mainGraphicsContext.append("text").attr({x:y,y:v,dy:S?p:0,"class":o.LabelText["class"]}).style({"text-anchor":b,"font-size":p}).text(f.text).append("title").text(f.text);S||this.truncateTextIfNeeded(x,y,C)}}},o.prototype.truncateTextIfNeeded=function(i,a,r){var o=r?this.currentViewport.width-a:a;i.call(t.AxisHelper.LabelLayoutStrategy.clip,o,e.TextMeasurementService.svgEllipsis)},o.prototype.getFormatter=function(e,i){var a=0===e.displayUnits?i:null,r=t.valueFormatter.getFormatString(this.data.metadataColumn,o.formatStringProp),n=t.dataLabelUtils.getLabelPrecision(e.precision,r),s=t.dataLabelUtils.getOptionsForLabelFormatter(e,r,a,n);return s.formatSingleValues=!(e.displayUnits>0),t.valueFormatter.create(s)},o.prototype.appendTargetTextAlongArc=function(e,i,a,r){var n=this.targetSettings,s=n.target,l=this.getTargetRatio(),c=e+(i-e)/2+r.top,u=l>.5,h=this.settings.labels.padding,d=u?"start":"end",p=this.getFormatter(this.data.dataLabelsSettings,n.max),g=Math.asin(o.MinDistanceFromBottom/e)/Math.PI,m=g>l||l>1-g?u?1-g:g:l,f=r.left+a/2-(e+h)*Math.cos(Math.PI*m),y=c-(e+h)*Math.sin(Math.PI*m);this.targetText||(this.targetText=this.mainGraphicsContext.append("text").classed(o.TargetText["class"],!0)),this.targetText.attr({x:f,y:y}).style({"text-anchor":d,display:this.showTargetLabel?"":"none","font-size":this.style.labelText.fontSize}).text(p.format(s)),this.truncateTextIfNeeded(this.targetText,f,u),this.targetText.call(t.tooltipUtils.tooltipUpdate,[p.format(s)]),this.targetConnector||(this.targetConnector=this.mainGraphicsContext.append("line").classed(o.TargetConnector["class"],!0)),l===m?this.targetConnector.style("display","none"):this.targetConnector.attr({x1:r.left+a/2-e*Math.cos(Math.PI*l),y1:c-e*Math.sin(Math.PI*l),x2:f,y2:y}).style({"stroke-width":this.settings.targetLine.thickness,stroke:this.settings.targetLine.color,display:""})},o.prototype.arcTween=function(e,t){e.attrTween("d",function(e){var i=d3.interpolate(e.endAngle,t[0]);return function(a){return e.endAngle=i(a),t[1](e)}})},o.prototype.showMinMaxLabelsOnBottom=function(){if(this.currentViewport.height>this.currentViewport.width)return!0;if(this.data&&this.gaugeVisualProperties){var i=this.createTicks(),r=(this.currentViewport.width-2*this.gaugeVisualProperties.radius)/2,o=r-this.settings.labels.padding,n=e.TextMeasurementService.getMeasurementProperties($(this.svg.node()));n.fontSize=a.fromPoint(this.data.dataLabelsSettings.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt);for(var s=void 0,l=0,c=[i[0],i[i.length-1]];l<c.length;l++){var u=c[l];if(n.text=u,s=e.TextMeasurementService.measureSvgTextWidth(n),s>o)return!0}}return!1},o.prototype.setMargins=function(){if(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.smallGaugeMarginsOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible){var e=this.gaugeSmallViewPortProperties.GaugeMarginsOnSmallViewPort;return void(this.margin={top:e,bottom:e,left:e,right:e})}if(this.margin={top:o.DefaultTopBottomMargin,bottom:o.DefaultTopBottomMargin,left:o.DefaultLeftRightMargin,right:o.DefaultLeftRightMargin},!this.showSideNumbersLabelText()||this.showMinMaxLabelsOnBottom()){var i=this.targetSettings;if(this.showTargetLabel){var r=(i.target-i.min)/(i.max-i.min);r>.5?this.margin.left=o.ReducedLeftRightMargin:this.margin.right=o.ReducedLeftRightMargin}else this.margin.left=this.margin.right=o.ReducedLeftRightMargin}var n=0;this.data&&this.data.dataLabelsSettings&&this.data.dataLabelsSettings.fontSize&&this.data.dataLabelsSettings.fontSize>=t.NewDataLabelUtils.DefaultLabelFontSizeInPt&&(n=a.fromPointToPixel(this.data.dataLabelsSettings.fontSize-t.NewDataLabelUtils.DefaultLabelFontSizeInPt)),0!==n&&(this.margin.bottom+=n,this.margin.left+=n,this.margin.right+=n)},o.prototype.showSideNumbersLabelText=function(){return!(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.hideGaugeSideNumbersOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible)},o.MIN_VALUE=-(1/0),o.MAX_VALUE=+(1/0),o.MinDistanceFromBottom=10,o.MinWidthForTargetLabel=150,o.DefaultTopBottomMargin=20,o.DefaultLeftRightMargin=45,o.ReducedLeftRightMargin=15,o.DEFAULT_MAX=1,o.DEFAULT_MIN=0,o.VisualClassName="gauge",o.DefaultStyleProperties={transition:{ease:"bounce"},arcColors:{background:"#e9e9e9",foreground:"#00B8AA"},targetLine:{show:!0,color:"#666666",thickness:2},labels:{count:2,padding:5,fontSize:t.NewDataLabelUtils.DefaultLabelFontSizeInPt},kpiBands:{show:!1,separationRadians:Math.PI/128,thickness:5}},o.DefaultTargetSettings={min:0,max:1,target:void 0},o.DefaultDataPointSettings={fillColor:o.DefaultStyleProperties.arcColors.foreground,targetColor:o.DefaultStyleProperties.targetLine.color},o.InnerRadiusFactor=.7,o.KpiBandDistanceFromMainArc=2,o.MainGaugeGroupClassName="mainGroup",o.LabelText=i("labelText"),o.TargetConnector=i("targetConnector"),o.TargetText=i("targetText"),o.formatStringProp={objectName:"general",propertyName:"formatString"},o}();t.Gauge=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.Utility,i=function(){function i(){this.scalingType=e.imageScalingType.normal}return i.prototype.init=function(e){this.element=e.element},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"imageScaling":return this.enumerateImageScaling()}return null},i.prototype.enumerateImageScaling=function(){return[{selector:null,objectName:"imageScaling",properties:{imageScalingType:this.scalingType}}]},i.prototype.update=function(i){var a=i.dataViews;if(a&&0!==a.length){var r=a[0].metadata.objects;if(r&&r.general){var o=this.imageBackgroundElement;o||(o=$("<div class='imageBackground' />"),this.imageBackgroundElement=o,this.imageBackgroundElement.appendTo(this.element));var n=i.viewport;o.css("height",n.height),r.imageScaling?this.scalingType=r.imageScaling.imageScalingType.toString():this.scalingType=e.imageScalingType.normal;var s=r.general.imageUrl;t.isLocalUrl(s)&&o.css("backgroundImage","url("+s+")"),this.scalingType===e.imageScalingType.fit?o.css("background-size","100% 100%"):this.scalingType===e.imageScalingType.fill?o.css("background-size","cover"):o.css("background-size","contain")}}},i}();e.ImageVisual=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,i,a){if(!i||0===i.length)return s.status.NOGOAL;var r,o;if(2===i.length){if(r=Math.max.apply(Math,i),o=Math.min.apply(Math,i),e>=o&&r>=e)return s.status.IN_BETWEEN}else r=i[0],o=i[0];switch(a){case t.kpiDirection.positive:if(o>e)return s.status.DROP;break;case t.kpiDirection.negative:if(e>r)return s.status.DROP}return s.status.INCREASE}function a(e,i,a){if(!i||1!==i.length||0===i[0])return"";var r,o="+",n=i[0];switch(r=Math.abs(e-n),a){case t.kpiDirection.positive:n>e&&(o="-");break;case t.kpiDirection.negative:e>n&&(o="-")}var s=Number((100*r/n).toFixed(2));return"("+o+s+"%)"}function r(e){switch(e){case s.status.NOGOAL:return s.kpiTextGreyClass;case s.status.INCREASE:return s.kpiGreenClass;case s.status.IN_BETWEEN:return s.kpiYellowClass;case s.status.DROP:return s.kpiRedClass}}function o(e){switch(e){case s.status.NOGOAL:return s.kpiGraphGreyClass;case s.status.INCREASE:return s.kpiGreenClass;case s.status.IN_BETWEEN:return s.kpiYellowClass;case s.status.DROP:return s.kpiRedClass}}var n=e.data.DataRoleHelper,s=function(){function s(){}return s.prototype.init=function(e){s.getLocalizedString=e.host.getLocalizedString,this.rootElement=d3.select(e.element.get(0)).append("div").attr("text-align","center").classed("kpiVisual",!0),this.svg=this.rootElement.append("svg");var t=this.mainGroupElement=this.svg.append("g");this.areaFill=t.append("path"),this.textContainer=this.rootElement.append("div").classed("textContainer",!0),this.indicatorTextContainer=this.textContainer.append("div").classed("indicatorText",!0),this.absoluteGoalDistanceText=this.textContainer.append("div").classed("goalText",!0),this.kpiActualText=this.indicatorTextContainer.append("div").attr("id","indicatorText"),this.initIcons(),this.host=e.host},s.prototype.update=function(e){if(e.dataViews&&e.dataViews[0]){var t=this.dataView=e.dataViews[0],i=e.viewport;if((!t.categorical||!t.categorical.values||t.categorical.values.length<1)&&(!t.categorical||!t.categorical.categories||t.categorical.categories.length<1))return this.svg.attr("visibility","hidden"),void this.textContainer.attr("style","display:none");this.svg.attr("visibility","visible");var a=s.converter(t,i,s.getProp_KPIDirection(t));this.render(a,i)}},s.prototype.initIcons=function(){this.successMarkIcon=this.indicatorTextContainer.append("div").classed("powervisuals-glyph checkmark kpi-visual-green",!0),this.betweenIcon=this.indicatorTextContainer.append("div").classed("powervisuals-glyph circle-small kpi-visual-yellow",!0),this.exclamationMarkIcon=this.indicatorTextContainer.append("div").classed("powervisuals-glyph exclamation kpi-visual-red",!0),this.successMarkIcon.attr("style","display:none"),this.betweenIcon.attr("style","display:none"),this.exclamationMarkIcon.attr("style","display:none")},s.prototype.render=function(e,t){if(this.setShowDataMissingWarning(!(e.indicatorExists&&e.trendExists)),0===e.dataPoints.length||!e.indicatorExists||!e.trendExists)return this.areaFill.attr("visibility","hidden"),this.svg.attr("visibility","hidden"),void this.textContainer.attr("style","display:none");this.svg.attr({height:t.height,width:t.width});var n=s.status.NOGOAL;e.targetExists&&e.indicatorExists&&e.trendExists&&(n=i(e.actual,e.goals,e.directionType));var l=e.formattedValue,c=s.indicatorTextSizeInPx;this.textContainer.attr("style","width:"+t.width+"px;top:"+(t.height-c)/2+"px"),this.kpiActualText.classed(s.allColorClasses,!1).classed(r(n),!0).attr("text-anchor","middle").text(l);var u=null;switch(n){case s.status.INCREASE:u=this.successMarkIcon,this.exclamationMarkIcon.attr("style","display:none"),this.betweenIcon.attr("style","display:none");break;case s.status.IN_BETWEEN:u=this.betweenIcon,this.exclamationMarkIcon.attr("style","display:none"),this.successMarkIcon.attr("style","display:none");break;case s.status.DROP:u=this.exclamationMarkIcon,this.successMarkIcon.attr("style","display:none"),this.betweenIcon.attr("style","display:none");break;default:this.exclamationMarkIcon.attr("style","display:none"),this.successMarkIcon.attr("style","display:none"),this.betweenIcon.attr("style","display:none")}u&&u.attr("style","font-size:12px");var h=e.showGoal?e.formattedGoalString+" ":"",d=e.showDistanceFromGoal?a(e.actual,e.goals,e.directionType):"";if(this.absoluteGoalDistanceText.attr("text-anchor","middle").text(h+d),e.showTrendLine&&e.historyExists){var p=d3.svg.area().x(function(e){return e.x}).y0(t.height).y1(function(e){return e.y});this.areaFill.classed(s.allColorClasses,!1).classed(o(n),!0).attr("d",p(e.dataPoints)).attr("stroke","none").attr("visibility","visible").attr("fill-opacity",.2)}else this.areaFill.attr("visibility","hidden")},s.prototype.setShowDataMissingWarning=function(e){this.host.setWarnings(e?[new t.VisualKPIDataMissingWarning]:[])},s.getDefaultFormatSettings=function(){return{labelSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,t.Card.DefaultStyle.value.color),textSize:27,wordWrap:!1}},s.getFormatString=function(e){return t.valueFormatter.getFormatString(e,t.AnimatedText.formatStringProp)},s.getProp_Show_KPIGoal=function(t){return t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.showKPIGoal,!0):!0},s.getProp_Show_KPITrendLine=function(t){return t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.showKPITrendLine,!0):!0},s.getProp_Show_KPIDistance=function(t){return t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.showKPIDistance,!0):!0},s.getProp_KPIDirection=function(i){return i&&i.metadata?e.DataViewObjects.getValue(i.metadata.objects,s.directionTypeStringProp,t.kpiDirection.positive):t.kpiDirection.positive},s.getProp_Indicator_DisplayUnits=function(t){return s.initDefaultLabelSettings(),t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.indicatorDisplayUnitsProp,s.defaultLabelSettings.displayUnits):s.defaultLabelSettings.displayUnits},s.getProp_Indicator_Precision=function(t){return s.initDefaultLabelSettings(),t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.indicatorPrecisionProp,s.defaultLabelSettings.precision):s.defaultLabelSettings.precision},s.initDefaultLabelSettings=function(){s.defaultCardFormatSetting||(s.defaultCardFormatSetting=s.getDefaultFormatSettings(),s.defaultLabelSettings=s.defaultCardFormatSetting.labelSettings)},s.getFormattedValue=function(i,a,r,o,n){void 0===n&&(n=e.DisplayUnitSystemType.WholeUnits);var l=0===o,c=t.valueFormatter.create({format:s.getFormatString(i),value:o,precision:r,displayUnitSystemType:n,formatSingleValues:!!l,allowFormatBeautification:!0,columnType:i?i.type:void 0});return c.format(a)},s.getFormattedGoalString=function(e,t,i,a){if(!t||0===t.length)return"";var r=s.getLocalizedString("Visual_KPI_Goal_Title")+": "+s.getFormattedValue(e,t[0],i,a);return 2===t.length&&(r+=", "+s.getFormattedValue(e,t[1],i,a)),r},s.converter=function(i,a,r){var o=[],l=i.categorical,c=null,u=null,h="",d="",p=!1,g=!1,m=!1,f=!0;i.categorical.categories||(f=!1);for(var y=l.values,v=i.metadata.columns,b=0,C=v;b<C.length;b++){var S=C[b];n.hasRole(S,"Indicator")&&(g=!0,c=S),n.hasRole(S,"TrendLine")&&(m=!0),n.hasRole(S,"Goal")&&(p=!0,u=S)}if(!(g&&m&&y&&0!==y.length&&y[0].values&&i.categorical.values))return{dataPoints:o,directionType:r,actual:0,goals:[],formattedGoalString:h,targetExists:p,historyExists:f,indicatorExists:g,trendExists:m,formattedValue:d,showGoal:!1,showDistanceFromGoal:!1,showTrendLine:!1};var x,w;f&&(x=l.categories[0],w=x.values);for(var P,D=[],L=[],T=s.getColumnsByRole(y,"Indicator"),_=s.getColumnsByRole(y,"Goal"),V=0,M=y[0].values.length;M>V;V++){P=T[0].values[V];for(var N=[],A=0;A<_.length;A++)N.push(_[A].values[V]);L.push(N),D.push(P)}for(var O=Math.max.apply(Math,D),I=Math.min.apply(Math,D),R=a.height*s.trendAreaFilePercentage,F=s.getProp_Indicator_Precision(i),H=s.getProp_Indicator_DisplayUnits(i),V=0;V<D.length;V++){var z=R*(D[V]-I)/(O-I),G=null;f&&(G=t.SelectionId.createWithId(x.identity[V]).getSelector()),o.push({x:V*a.width/(D.length-1),y:a.height-z,actual:D[V],goals:L[V]})}var k,j;o.length>0&&(k=o[o.length-1].actual,j=o[o.length-1].goals),1===o.length&&(f=!1),d=s.getFormattedValue(c,k,F,H,e.DisplayUnitSystemType.DataLabels),h=s.getFormattedGoalString(u,j,F,H);var E=s.getProp_Show_KPIGoal(i),B=s.getProp_Show_KPIDistance(i),W=s.getProp_Show_KPITrendLine(i);return{dataPoints:o,directionType:r,actual:k,goals:j,formattedGoalString:h,targetExists:p,historyExists:f,indicatorExists:g,trendExists:m,formattedValue:d,showGoal:E,showDistanceFromGoal:B,showTrendLine:W}},s.getColumnsByRole=function(e,t){for(var i=[],a=0;a<e.length;a++)n.hasRole(e[a].source,t)&&i.push(e[a]);return i},s.prototype.enumerateObjectInstances=function(e){var t=[],i=this.dataView;switch(e.objectName){case"indicator":t.push({selector:null,objectName:"indicator",properties:{indicatorDisplayUnits:s.getProp_Indicator_DisplayUnits(i),indicatorPrecision:s.getProp_Indicator_Precision(i)}});case"trendline":t.push({selector:null,objectName:"trendline",properties:{show:s.getProp_Show_KPITrendLine(i)}});case"goals":t.push({selector:null,objectName:"goals",properties:{showGoal:s.getProp_Show_KPIGoal(i),showDistance:s.getProp_Show_KPIDistance(i)}});case"status":t.push({selector:null,objectName:"status",properties:{direction:s.getProp_KPIDirection(i)}})}return t},s.prototype.destroy=function(){this.svg=null},s.directionTypeStringProp={objectName:"status",propertyName:"direction"},s.showKPIGoal={objectName:"goals",propertyName:"showGoal"},s.showKPIDistance={objectName:"goals",propertyName:"showDistance"},s.showKPITrendLine={objectName:"trendline",propertyName:"show"},s.indicatorDisplayUnitsProp={objectName:"indicator",propertyName:"indicatorDisplayUnits"},s.indicatorPrecisionProp={objectName:"indicator",propertyName:"indicatorPrecision"},s.status={INCREASE:"increase",DROP:"drop",IN_BETWEEN:"in-between",NOGOAL:"no-goal"},s.statusBandingType={Below:"BELOW",Above:"ABOVE"},s.actualTextConsts={VERTICAL_OFFSET_FROM_HALF_HEIGHT:20,FONT_WIDTH_FACTOR:14,RIGHT_MARGIN:10},s.kpiRedClass="kpi-visual-red",s.kpiYellowClass="kpi-visual-yellow",s.kpiGreenClass="kpi-visual-green",s.kpiTextGreyClass="kpi-visual-text-grey",s.kpiGraphGreyClass="kpi-visual-graph-grey",s.allColorClasses=s.kpiRedClass+" "+s.kpiYellowClass+" "+s.kpiGreenClass+" "+s.kpiTextGreyClass+" "+s.kpiGraphGreyClass,s.trendAreaFilePercentage=1,s.estimatedIconHeightInPx=9,s.indicatorTextSizeInPx=60,s}();t.KPIStatusWithHistory=s}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.EnumExtensions,a=jsCommon.CssConstants.createClassAndSelector,r=jsCommon.PixelConverter,o=function(){function o(e){var t=this;this.deferDragMoveOperation=jsCommon.DeferUtility.deferUntilNextFrame(function(){if(t.lastDragMoveXPosition){var e=t.findIndex(t.lastDragMoveXPosition-t.margin.left);t.selectColumn(e),t.lastDragMoveXPosition=void 0}}),this.isScrollable=e.isScrollable?e.isScrollable:!1,this.tooltipsEnabled=e.tooltipsEnabled,this.lineType=e.chartType?e.chartType:1,this.interactivityService=e.interactivityService,this.animator=e.animator,this.lineChartLabelDensityEnabled=e.lineChartLabelDensityEnabled,this.lineClassAndSelector=o.LineClassSelector,this.tooltipBucketEnabled=e.tooltipBucketEnabled}return o.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories)if(i.categorical.dataVolume=4,t.CartesianChart.detectScalarMapping(i)){var a=i.categorical.categories;a.dataReductionAlgorithm={sample:{}}}else t.CartesianChart.applyLoadMoreEnabledToMapping(e.cartesianLoadMoreEnabled,i)},o.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(!i||!i.categorical||!i.categorical.categories)return null;var a=i.categorical.categories,r=a["for"]["in"].items;if(!_.isEmpty(r)){var o=r[0].type,n=void 0;if(i.metadata&&(n=i.metadata.objects),!t.CartesianChart.getIsScalar(n,t.lineChartProps.categoryAxis.axisType,o))return["Category","Y"]}return null},o.converter=function(i,a,r,o,n,s,l,c,u){void 0===c&&(c=!0),void 0===u&&(u=!1);var h=e.data.createIDataViewCategoricalReader(i),d=h.hasValues("Y")?"Y":"Y2",p=i.categorical,g=p.categories&&p.categories.length>0?p.categories[0]:{source:void 0,values:[a],identity:void 0},m=t.CartesianHelper.getCategoryAxisProperties(i.metadata);o=t.CartesianHelper.isScalar(o,m),p=t.ColumnUtil.applyUserMinMax(o,p,m);var f,y=t.lineChartProps.general.formatString,v=t.AxisHelper.getCategoryValueType(g.source,o),b=t.AxisHelper.isDateTime(v),C=g.values,S=[],x=[],w=h.getSeriesCount(d),P=!(!p.values||!p.values.source),D=p.values,L=t.dataLabelUtils.getDefaultLineChartLabelSettings(l);if(i.metadata&&i.metadata.objects){var T=i.metadata.objects;f=l?void 0:e.DataViewObjects.getFillColor(T,t.lineChartProps.dataPoint.defaultColor);var V=T.labels;t.dataLabelUtils.updateLineChartLabelSettingsFromLabelsObject(V,L)}var M,N=new t.ColorHelper(r,t.lineChartProps.dataPoint.fill,f);i.categorical.values&&(M=i.categorical.values.grouped());var A;s&&(A=p.values&&p.values.length>0?_.times(p.values[0].values.length,function(){return 0}):[]);for(var O=0;w>O;O++){var I=p.values[O],R=I.source,F=[],H=M[O],z=P&&H?t.SelectionId.createWithIdAndMeasure(H.identity,I.source.queryName):t.SelectionId.createWithMeasure(I.source.queryName),G=z.getKey(),k=this.getColor(N,P,D,M,O,H),j=void 0;if(!P){var E=M&&M.length>0&&M[0].values?M[0].values[O]:null,B=E&&E.source&&E.source.objects?E.source.objects.labels:null;B&&(j=e.Prototype.inherit(L),t.dataLabelUtils.updateLineChartLabelSettingsFromLabelsObject(B,j))}for(var W=j?j:L,U=I.highlights&&I.highlights.length>0,Y=h.hasCategories()?h.getCategoryCount():1,K=0;Y>K;K++){var X=C[K],q=t.AxisHelper.normalizeNonFiniteNumber(U?h.getHighlight(d,K,O):h.getValue(d,K,O));if((!o||null!=X&&null!=q)&&(!b||null==X||X instanceof Date)){var $=i.categorical,Q=void 0,Z=void 0;if(c&&(Q=[],g.source&&Q.push({displayName:g.source.displayName,value:t.converterHelper.formatFromMetadataColumn(X,g.source,y)}),P&&(g.source&&g.source===$.values.source||Q.push({displayName:$.values.source.displayName,value:t.converterHelper.formatFromMetadataColumn(M[O].name,$.values.source,y)})),null!=q&&Q.push({displayName:R.displayName,value:t.converterHelper.formatFromMetadataColumn(q,R,y)}),u)){Z=[];var J=h.getAllValuesForRole("Tooltips",K,P?O:void 0),ee=h.getAllValueMetadataColumnsForRole("Tooltips",P?O:void 0);if(J&&ee)for(var te=0;te<J.length;te++)null!=J[te]&&Z.push({displayName:ee[te].displayName,value:t.converterHelper.formatFromMetadataColumn(J[te],ee[te],y)})}var ie=g&&!_.isEmpty(g.identity)&&g.identity[K]?g.identity[K].key:K,ae={categoryValue:b&&X?X.getTime():X,value:q,categoryIndex:K,seriesIndex:O,tooltipInfo:Q,selected:!1,identity:z,key:JSON.stringify({series:G,category:ie}),labelFill:W.labelColor,labelFormatString:R.format,labelSettings:W,extraTooltipInfo:Z};s&&(A[K]+=q,ae.stackedValue=A[K]),g.objects&&g.objects[K]&&(ae.pointColor=e.DataViewObjects.getFillColor(g.objects[K],t.lineChartProps.dataPoint.fill)),F.push(ae),S[K]||(S[K]=ae)}}n&&n.applySelectionStateToData(F),F.length>0&&x.push({displayName:t.converterHelper.formatFromMetadataColumn(h.getValueDisplayName(d,O),h.getValueMetadataColumn(d,O),y),dynamicDisplayName:P?t.converterHelper.formatFromMetadataColumn(h.getSeriesName(O),h.getSeriesMetadataColumn(),y):void 0,key:G,lineIndex:O,color:k,xCol:g.source,yCol:h.getValueMetadataColumn(d,O),data:F,identity:z,selected:!1,labelSettings:j})}m=t.CartesianHelper.getCategoryAxisProperties(i.metadata);var re=t.CartesianHelper.getValueAxisProperties(i.metadata),oe=[];if(D)for(var ne=0;ne<D.length;ne++)D[ne]&&D[ne].source&&D[ne].source.displayName&&oe.push({displayName:D[ne].source.displayName});var se=t.converterHelper.createAxesLabels(m,re,g.source,oe);return n&&n.applySelectionStateToData(x),{series:x,isScalar:o,dataLabelsSettings:L,axesLabels:{x:se.xAxisLabel,y:se.yAxisLabel},hasDynamicSeries:P,categoryMetadata:g.source,categories:C,categoryData:S,seriesDisplayName:P?t.converterHelper.formatFromMetadataColumn(h.getSeriesDisplayName(),h.getSeriesMetadataColumn(),y):void 0}},o.getInteractiveLineChartDomElement=function(e){return e.children("svg").get(0)},o.getColor=function(e,t,i,a,r,o){var n;return t?a&&a[r]&&(n=a[r].objects):i[r]&&(n=i[r].source.objects),t&&o?e.getColorForSeriesValue(n,i.identityFields,o.name):e.getColorForMeasure(n,i[r].source.queryName)},o.createStackedValueDomain=function(e){if(0===e.length)return null;var t=d3.min(e,function(e){return d3.min(e.data,function(e){return e.stackedValue})}),i=d3.max(e,function(e){return d3.max(e.data,function(e){return e.stackedValue})});return[t,i]},o.prototype.init=function(e){var i=this;this.options=e,this.element=e.element,this.cartesainSVG=e.svg,this.host=e.host,this.currentViewport=e.viewport,this.colors=e.style.colorPalette.dataColors,this.isInteractiveChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.cartesianVisualHost=e.cartesianHost,this.scaleDetector=new t.SVGScaleDetector(this.cartesainSVG);var a=e.chartType;this.isComboChart=10===a||13===a||14===a;var r=e.svg;r.classed(o.ClassName,!0);var n=this.mainGraphicsSVG=r.append("svg").classed("lineChartSVG",!0);this.isComboChart||this.isInteractiveChart||(this.overlayRect=n.append(o.RectOverlayName).style("opacity",t.SVGUtil.AlmostZero)),this.mainGraphicsContext=n.append("g").classed(o.MainGraphicsContextClassName,!0),this.hoverLineContext=r.append("g").classed("hover-line",!0),this.hoverLineContext.append(o.LineElementName).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0);var s=this.hoverLine=this.hoverLineContext.select(o.LineElementName);if(this.isInteractiveChart&&s.classed("interactive",!0),s.style("opacity",t.SVGUtil.AlmostZero),this.selectionCircles=[],this.xAxisProperties={axis:null,scale:null,isScalar:null,axisType:null,formatter:null,graphicsContext:null,values:null,axisLabel:null,isCategoryAxis:!0},this.isInteractiveChart){var l=o.getInteractiveLineChartDomElement(this.element),c=function(){i.lastDragMoveXPosition=d3.mouse(l)[0],i.deferDragMoveOperation()},u=d3.behavior.drag().origin(Object).on("drag",c);d3.select(l).style("touch-action","none").call(u).on("click",c)}this.shouldAdjustMouseCoordsOnPathsForStroke=!jsCommon.BrowserUtils.isChrome()},o.prototype.setData=function(a){if(this.data={series:[],dataLabelsSettings:t.dataLabelUtils.getDefaultLineChartLabelSettings(this.isComboChart),axesLabels:{x:null,y:null},hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,categoryData:[]},a.length>0){var r=a[0];if(r&&r.categorical){var n=this.dataViewCat=r.categorical,s=n.categories,l=e.ValueType.fromDescriptor({text:!0});s&&s.length>0&&s[0].source&&s[0].source.type&&(l=s[0].source.type);var c=o.converter(r,t.valueFormatter.format(null),this.cartesianVisualHost.getSharedColors(),t.CartesianChart.getIsScalar(r.metadata?r.metadata.objects:null,t.lineChartProps.categoryAxis.axisType,l),this.interactivityService,i.hasFlag(this.lineType,16),this.isComboChart,this.tooltipsEnabled,this.tooltipBucketEnabled);this.data=c}}},o.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},o.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},o.prototype.setFilteredData=function(t,i){var a=i-t,r=this.clippedData=e.Prototype.inherit(this.data);return r.series=o.sliceSeries(r.series,a,t),r.categories=r.categories.slice(t,i),r},o.prototype.calculateAxesProperties=function(a){var r=this,n=this.data,s=a.viewport,l=a.margin;this.currentViewport=s,this.margin=l;var c=n.series&&n.series.length>0?n.series[0].data.length:0,u=t.CartesianChart.MinOrdinalRectThickness,h=this.data.isScalar,d=a.trimOrdinalDataOnOverflow,p=this.getPreferredPlotArea(h,c,u);if(this.clippedData=void 0,n&&!h&&!this.isScrollable&&d){var g=this.getCategoryCount(c),m=Math.min(c,g);m!==c&&(n=this.clippedData=e.Prototype.inherit(n),this.clippedData.series=o.sliceSeries(n.series,m))}var f,y;n.series&&n.series.length>0&&(f=n.series[0].xCol,y=n.series[0].yCol);var v=i.hasFlag(this.lineType,16)?o.createStackedValueDomain(n.series):t.AxisHelper.createValueDomain(n.series,!1),b=a.valueAxisScaleType===t.axisScale.log&&!t.AxisHelper.isLogScalePossible(v),C=t.AxisHelper.combineDomain(a.forcedYDomain,v,a.ensureYDomain);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:p.height,dataDomain:C,metaDataColumn:y,formatString:t.valueFormatter.getFormatString(y,t.lineChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:a.valueAxisScaleType,axisDisplayUnits:a.valueAxisDisplayUnits,axisPrecision:a.valueAxisPrecision,shouldClamp:!1});var S=this.data?this.data.categoryMetadata:void 0,x=t.AxisHelper.getCategoryValueType(S),w=t.AxisHelper.createDomain(n.series,x,this.data.isScalar,a.forcedXDomain,a.ensureXDomain),P=a.categoryAxisScaleType===t.axisScale.log&&!t.AxisHelper.isLogScalePossible(w);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:p.width,dataDomain:w,metaDataColumn:f,formatString:t.valueFormatter.getFormatString(f,t.lineChartProps.general.formatString),outerPadding:this.data.isScalar?o.ScalarOuterPadding:0,isScalar:this.data.isScalar,isVertical:!1,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,i){return t.CartesianHelper.lookupXValue(r.data,e,i,r.data.isScalar)},categoryThickness:t.CartesianChart.getCategoryThickness(n.series,c,this.getAvailableWidth(),w,h,d),isCategoryAxis:!0,scaleType:a.categoryAxisScaleType,axisDisplayUnits:a.categoryAxisDisplayUnits,axisPrecision:a.categoryAxisPrecision}),this.xAxisProperties.axisLabel=a.showCategoryAxisLabel?n.axesLabels.x:null,this.yAxisProperties.axisLabel=a.showValueAxisLabel?n.axesLabels.y:null,this.xAxisProperties.hasDisallowedZeroInDomain=P,this.yAxisProperties.hasDisallowedZeroInDomain=b,[this.xAxisProperties,this.yAxisProperties]},o.prototype.enumerateObjectInstances=function(e,t){switch(t.objectName){case"dataPoint":this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e)}},o.prototype.enumerateDataPoints=function(e){var i=this.data;if(i&&i.series&&0!==i.series.length)for(var a=t.lineChartProps.general.formatString,r=i.series,o=r.length,n=0;o>n;n++){var s=t.ColorHelper.normalizeSelector(r[n].identity.getSelector()),l=t.converterHelper.getFormattedLegendLabel(r[n].yCol,this.dataViewCat.values,a);e.pushInstance({objectName:"dataPoint",displayName:l,selector:s,properties:{fill:{solid:{color:i.defaultSeriesColor||r[n].color}}}})}},o.prototype.enumerateDataLabels=function(e){var i=this.data,a=this.data.dataLabelsSettings,r=i.series.length,o=this.showLabelPerSeries();if(t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,a,null,o)),0!==r&&o&&a.showLabelPerSeries)for(var n=0;r>n;n++){var s=i.series[n],l=s.labelSettings?s.labelSettings:this.data.dataLabelsSettings;e.pushContainer({displayName:s.displayName}),t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,l,s)),e.popContainer()}},o.prototype.supportsTrendLine=function(){var e=this.data?this.data.isScalar:!1;return!i.hasFlag(this.lineType,16)&&e},o.prototype.getLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:!0,precision:!0,selector:i&&i.identity?i.identity.getSelector():null,showAll:a,fontSize:!0,labelDensity:this.lineChartLabelDensityEnabled}},o.prototype.overrideXScale=function(e){this.xAxisProperties=e},o.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},o.prototype.render=function(e){var i=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.data.categoryData.length!==this.previousCategoryCount&&(i=0),this.previousCategoryCount=this.data.categoryData.length;var a;return a=this.isInteractiveChart?this.renderOld(i):this.renderNew(i),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),a},o.prototype.renderNew=function(e){var a=this,r=this.clippedData?this.clippedData:this.data;if(r){var n=r.categories.length*r.series.length;n>t.AnimatorCommon.MaxDataPointsToAnimate&&(e=0);
var s,l,c=i.hasFlag(this.lineType,16),u=this.margin,h=this.currentViewport,d=h.height-(u.top+u.bottom),p=h.width-(u.left+u.right),g=this.xAxisProperties.scale,m=this.yAxisProperties.scale,f=this.getXOfFirstCategory(),y=this.interactivityService&&this.interactivityService.hasSelection(),v=i.hasFlag(this.lineType,2)||i.hasFlag(this.lineType,16),b=function(e){return g(a.getXValue(e))+f};c?(s=function(e){return m(e.stackedValue-e.value)},l=function(e){return m(e.stackedValue)}):(s=m(0),l=function(e){return m(e.value)});var C;v&&(C=d3.svg.area().x(b).y0(s).y1(l).defined(function(e){return null!==e.value}));var S=d3.svg.line().x(b).y(l).defined(function(e){return null!==e.value});i.hasFlag(this.lineType,4)&&(S.interpolate("basis"),C&&C.interpolate("basis")),this.mainGraphicsSVG.attr("height",d).attr("width",p);var x=void 0;v&&(x=this.mainGraphicsContext.selectAll(o.CategoryAreaSelector.selector).data(r.series,function(e){return e.identity.getKey()}),x.enter().append(o.PathElementName).classed(o.CategoryAreaSelector["class"],!0),x.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return y&&!e.selected?o.DimmedAreaFillOpacity:o.AreaFillOpacity}).transition().ease("linear").duration(e).attr("d",function(e){return C(e.data)}),x.exit().remove());var w=this.mainGraphicsContext.selectAll(this.lineClassAndSelector.selector).data(r.series,function(e){return e.identity.getKey()});w.enter().append(o.PathElementName).classed(this.lineClassAndSelector["class"],!0),w.style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,y,!1)}).transition().ease("linear").duration(e).attr("d",function(e){return S(e.data)}),w.exit().remove();var P;this.interactivityService&&(P=this.mainGraphicsContext.selectAll(".interactivity-line").data(r.series,function(e){return e.identity.getKey()}),P.enter().append(o.PathElementName).classed("interactivity-line",!0).style("stroke-width",o.interactivityStrokeWidth),P.attr("d",function(e){return S(e.data)}),P.exit().remove());var D=this.mainGraphicsContext.selectAll(o.CategorySelector.selector).data(r.series,function(e){return e.identity.getKey()});D.enter().append("g").classed(o.CategorySelector["class"],!0),D.exit().remove();var L=D.selectAll(o.CategoryValuePoint.selector).data(function(e){return e.data.filter(function(t,i){return a.shouldDrawCircle(e,i)})},function(e){return e.key});L.enter().append(o.CircleElementName).classed(o.CategoryValuePoint["class"],!0),L.style("fill",function(){var e=d3.select(this.parentNode).datum();return e.color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,y,!1)}).transition().duration(e).attr({cx:function(e,t){return g(a.getXValue(e))+f},cy:function(e,t){return m(c?e.stackedValue:e.value)},r:o.CircleRadius}),L.exit().remove();var T;this.isComboChart||(T=D.selectAll(o.CategoryPointSelector.selector).data(function(e){return _.filter(e.data,function(e){return null!=e.pointColor})},function(e){return e.key}),T.enter().append(o.CircleElementName).classed(o.CategoryPointSelector["class"],!0),T.style("fill",function(e){return e.pointColor}).transition().duration(e).attr({cx:function(e){return g(a.getXValue(e))},cy:function(e){return m(c?e.stackedValue:e.value)},r:o.PointRadius}),T.exit().remove());var V;if(r.dataLabelsSettings.show&&(V=this.createLabelDataPoints()),this.tooltipsEnabled)if(this.isComboChart){var M=function(e){var t=e.elementCoordinates[0];return a.getTooltipInfoForCombo(e,t)};P&&t.TooltipManager.addTooltip(P,M,!0),t.TooltipManager.addTooltip(L,function(e){return e.data.tooltipInfo},!0),T&&t.TooltipManager.addTooltip(T,function(e){return e.data.tooltipInfo},!0)}else{this.overlayRect.attr({x:0,width:p,height:d});var M=function(e){var t=e.elementCoordinates[0],i=a.getCategoryIndexFromTooltipEvent(e,t),r=a.selectColumnForTooltip(i);return a.getSeriesTooltipInfo(r)},N=function(){a.hoverLine.style("opacity",t.SVGUtil.AlmostZero),a.hoverLineContext.selectAll(o.HoverLineCircleDot.selector).remove()};t.TooltipManager.addTooltip(this.mainGraphicsSVG,M,!0,N)}var A=void 0,O=void 0;if(this.interactivityService){A=r.series.slice();for(var I=0,R=r.series.length;R>I;I++)A=A.concat(r.series[I].data);O={lines:w,interactivityLines:P,dots:L,areas:x,tooltipOverlay:this.overlayRect}}return{dataPoints:A,behaviorOptions:O,labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:V}}},o.prototype.renderOld=function(e){var a=this,r=this.clippedData?this.clippedData:this.data;if(r){var n,s=this.margin,l=this.currentViewport,c=l.height-(s.top+s.bottom),u=this.xAxisProperties.scale,h=this.yAxisProperties.scale,d=this.interactivityService&&this.interactivityService.hasSelection();i.hasFlag(this.lineType,2)&&(n=d3.svg.area().x(function(e){return u(a.getXValue(e))}).y0(c).y1(function(e){return h(e.value)}).defined(function(e){return null!==e.value}));var p=d3.svg.line().x(function(e){return u(a.getXValue(e))}).y(function(e){return h(e.value)}).defined(function(e){return null!==e.value});i.hasFlag(this.lineType,4)&&(p.interpolate("basis"),n&&n.interpolate("basis"));var g=this.getXOfFirstCategory();if(this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(g,0)),this.mainGraphicsSVG.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),this.hoverLineContext.attr("transform",t.SVGUtil.translate(g,0)),i.hasFlag(this.lineType,2)){var m=this.mainGraphicsContext.selectAll(o.CategoryAreaSelector.selector).data(r.series,function(e){return e.identity.getKey()}),f=m.enter().append("g").classed(o.CategoryAreaSelector["class"],!0);f.append(o.PathElementName);var y=this.mainGraphicsContext.selectAll(o.CategoryAreaSelector.selector);y.select(o.PathElementName).transition().ease("linear").duration(e).attr("d",function(e){return n(e.data)}).style("fill",function(e){return e.color}).style("fill-opacity",function(e){return d&&!e.selected?o.DimmedAreaFillOpacity:o.AreaFillOpacity}),m.exit().remove()}var v=this.mainGraphicsContext.selectAll(o.CategorySelector.selector).data(r.series,function(e){return e.identity.getKey()}),b=v.enter().append("g").classed(o.CategorySelector["class"],!0);if(b.append(o.PathElementName),b.selectAll(o.CategoryValuePoint.selector).data(function(e){return e.data}).enter().append(o.CircleElementName).classed(o.CategoryValuePoint["class"],!0),v.exit().remove(),this.isInteractiveChart&&!this.dragHandle){var C=this.getAvailableHeight();this.dragHandle=this.hoverLineContext.append("circle").attr("cx",0).attr("cy",C).attr("r","6px").classed("drag-handle",!0)}for(var S=v.data().length;this.selectionCircles.length<S;){var x=this.hoverLineContext.append(o.CircleElementName).classed(o.CircleClassName,!0).attr("r",o.CircleRadius).style("opacity",0);this.selectionCircles.push(x)}for(;this.selectionCircles.length>S;)this.selectionCircles.pop().remove();var w=this.mainGraphicsContext.selectAll(o.CategorySelector.selector),P=w.select(o.PathElementName).classed(this.lineClassAndSelector["class"],!0).style("stroke",function(e){return e.color}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)});P.transition().ease("linear").duration(e).attr("d",function(e){return p(e.data)});var D=this,L=w.selectAll(o.CategoryValuePoint.selector),T=L.style("fill",function(){var e=d3.select(this.parentNode).datum();return e.color}).style("fill-opacity",function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,d,!1)}).transition().duration(e).attr({cx:function(e,t){var i=d3.select(this.parentNode).datum(),a=D.shouldDrawCircle(i,t);return a?u(D.getXValue(e)):0},cy:function(e,t){var i=d3.select(this.parentNode).datum(),a=D.shouldDrawCircle(i,t);return a?h(e.value):0},r:function(e,t){var i=d3.select(this.parentNode).datum(),a=D.shouldDrawCircle(i,t);return a?o.CircleRadius:0}});if(this.isInteractiveChart&&this.hasDataPoint(r.series)){var _=L.size(),V=0;T.each("end",function(){V++,V===_&&a.selectColumn(t.CartesianHelper.findMaxCategoryIndex(r.series),!0)})}var M=null;if(r.dataLabelsSettings.show){M=[];for(var N=0,A=r.series.length;A>N;N++)Array.prototype.push.apply(M,r.series[N].data)}v.exit().remove();var O;return r.dataLabelsSettings.show&&(O=this.createLabelDataPoints()),null==M?null:{dataPoints:M,behaviorOptions:null,labelDataPoints:null,labelsAreNumeric:null,labelDataPointGroups:O}}},o.prototype.getSeriesTooltipInfo=function(e){if(_.isEmpty(e))return null;var t="#000000",i="0",a=[],r=10,o=!_.isEmpty(e)&&e[0].seriesDisplayName,n=0;if(_.any(e,function(e){return!_.isEmpty(e.extraTooltipInfo)})){for(var s=0,l=e;s<l.length;s++){var c=l[s];if(n>=r)break;if(null!=c.value&&(o&&a.push({header:c.category,displayName:c.seriesDisplayName,value:c.seriesName}),a.push({header:c.category,color:c.color,displayName:c.measureDisplayName,value:c.measure}),n+=2,o&&!_.isEmpty(c.extraTooltipInfo)))for(var u=0,h=c.extraTooltipInfo;u<h.length;u++){var d=h[u];if(n>=r)break;a.push({header:c.category,color:t,displayName:d.displayName,value:d.value,opacity:i}),n++}}if(!o)for(var p=0,g=e[0].extraTooltipInfo;p<g.length;p++){var d=g[p];if(n>=r)break;a.push({header:e[0].category,color:t,displayName:d.displayName,value:d.value,opacity:i}),n++}}else for(var m=0,f=e;m<f.length;m++){var c=f[m];if(n>=r)break;null!=c.value&&(a.push({header:c.category,color:c.color,displayName:c.seriesName||c.measureDisplayName,value:c.measure}),n++)}return 0===a.length?null:a},o.prototype.getTooltipInfoForCombo=function(e,t){var i,a=this.getCategoryIndexFromTooltipEvent(e,t),r=e.data;return r&&r.data&&r.data.length&&(i=_.find(r.data,function(e){return e.categoryIndex===a})),i?i.tooltipInfo:void 0},o.prototype.getCategoryIndexFromTooltipEvent=function(e,t){if(e.data&&null!=e.data.categoryIndex)return e.data.categoryIndex;var i=e.data,a=0;if(i&&!_.isEmpty(i.data)&&this.xAxisProperties){t=this.adjustPathXCoordinate(t);var r=_.find(i.data,function(e,t,i){var a=i[t+1];return null!=e.value&&a&&null!=a.value});a=this.xAxisProperties.scale(this.getXValue(r))+this.getXOfFirstCategory()}return this.findIndex(t,a)},o.prototype.getVisualCategoryAxisIsScalar=function(){return this.data?this.data.isScalar:!1},o.prototype.getSupportedCategoryAxisType=function(){var i=this.dataViewCat?this.dataViewCat.categories:void 0,a=e.ValueType.fromDescriptor({text:!0});i&&i.length>0&&i[0].source&&i[0].source.type&&(a=i[0].source.type);var r=t.AxisHelper.isOrdinal(a);return r?t.axisType.categorical:t.axisType.both},o.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e,this.margin,!0)},o.prototype.getCategoryCount=function(e){var i=this.getAvailableWidth(),a=t.CartesianChart.MinOrdinalRectThickness;return Math.min(Math.round((i-a*t.CartesianChart.OuterPaddingRatio*2)/a),e)},o.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},o.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},o.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var o=0,n=t.length;n>o;o++)r[o]=e.Prototype.inherit(t[o]),r[o].data=t[o].data.slice(a,a+i);return r},o.prototype.getXOfFirstCategory=function(){if(!this.data.isScalar){var e=this.xAxisProperties.scale;if(e.rangeBand)return e.rangeBand()/2}return 0},o.prototype.hasDataPoint=function(e){if(0===e.length)return!1;for(var t=0,i=e.length;i>t;t++)if(e[t].data.length>0)return!0;return!1},o.prototype.getXValue=function(e){return this.data.isScalar?e.categoryValue:e.categoryIndex},o.prototype.shouldDrawCircle=function(e,t){var i=e.data.length,a=t===i-1,r=0===t;return t>i-1||null===e.data[t]||null===e.data[t].value?!1:r&&a?!0:r&&i>1&&null===e.data[t+1].value?!0:!r&&a&&null===e.data[t-1].value?!0:!r&&!a&&null===e.data[t-1].value&&null===e.data[t+1].value},o.prototype.selectColumnForTooltip=function(e,t){void 0===t&&(t=!1);var i=this.getChartX(e)+this.getXOfFirstCategory(),a=this.createTooltipDataPoints(e);return a.length>0&&this.setHoverLineForTooltip(i),this.setDotsForTooltip(i,a),a},o.prototype.setHoverLineForTooltip=function(e){e=e||0,this.hoverLine.attr("x1",e).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1)},o.prototype.setDotsForTooltip=function(e,t){var a=this,r=i.hasFlag(this.lineType,16),n=r?function(e){return a.yAxisProperties.scale(e.stackedValue)}:function(e){return a.yAxisProperties.scale(e.value)},s=this.hoverLineContext.selectAll(o.HoverLineCircleDot.selector).data(t);s.enter().append(o.CircleElementName).classed(o.HoverLineCircleDot["class"],!0),s.filter(function(e){return e.value}).attr("fill",function(e){return e.color}).attr("r",3).attr("cx",e).attr("cy",n),s.exit().remove()},o.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){this.lastInteractiveSelectedColumnIndex=e;var i=this.getChartX(e);this.setHoverLine(i,e);var a=this.createLegendDataPoints(e);a&&this.options.cartesianHost.updateLegend(a)}},o.prototype.setHoverLine=function(e,t){this.hoverLine.attr("x1",e).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1);var i=this;this.mainGraphicsContext.selectAll(o.CategorySelector.selector).selectAll(o.PathElementName).each(function(a){var r=this,o=a.color,n=i.selectionCircles[a.lineIndex];n.attr({cx:e,cy:function(){var t=d3.select(r).node(),a=i.getPosition(e,t);return a.y}}).style({opacity:function(){return _.some(a.data,function(e){return e.categoryIndex===t})?1:0},fill:o}),i.dragHandle&&i.dragHandle.attr("cx",e)})},o.prototype.getChartX=function(t){var i=0;this.data.isScalar?t>=0&&t<this.data.categoryData.length&&(i=Math.max(0,this.xAxisProperties.scale(this.data.categoryData[t].categoryValue))):i=Math.max(0,this.xAxisProperties.scale(t));var a=e.visuals.AxisHelper.extent(this.xAxisProperties.scale)[1];return i=Math.min(i,a),isNaN(i)?0:i},o.prototype.findIndex=function(i,a){var r=this.scaleDetector.getScale().x;e.Double.equalWithPrecision(r,1,1e-5)||(i/=r),a&&(i+=a);var o=e.visuals.AxisHelper.invertScale(this.xAxisProperties.scale,i);return this.data.isScalar&&(o=t.AxisHelper.findClosestXAxisIndex(o,this.data.categoryData)),o},o.prototype.getPosition=function(e,i){for(var a,r,o=i.getTotalLength(),n=0,s=o;;){if(r=Math.floor((n+s)/2),a=i.getPointAtLength(r),t.SVGUtil.ensureValidSVGPoint(a),(r===s||r===n)&&a.x!==e)break;if(a.x>e)s=r;else{if(!(a.x<e))break;n=r}}return a},o.prototype.createTooltipDataPoints=function(e){var i=this.data;if(!i||0===i.series.length||!i.categoryData)return[];var a,r=[],o=i.categoryData[e];this.data.isScalar?o&&(a=t.AxisHelper.isDateTime(this.xAxisProperties.axisType)?t.CartesianHelper.lookupXValue(this.data,o.categoryValue,this.xAxisProperties.axisType,this.data.isScalar):o.categoryValue):a=t.CartesianHelper.lookupXValue(this.data,e,this.xAxisProperties.axisType,this.data.isScalar);for(var n=t.lineChartProps.general.formatString,s=0,l=i.series;s<l.length;s++){var c=l[s],u=c.data,h=void 0;this.data.isScalar?o&&(h=u.filter(function(e){return e.categoryValue===o.categoryValue})[0]):h=u[e];var d=h&&h.value;if(null!=d){var p={color:c.color,category:t.valueFormatter.format(a,t.valueFormatter.getFormatString(c.xCol,n)),measureDisplayName:c.displayName,measure:t.valueFormatter.format(d,t.valueFormatter.getFormatString(c.yCol,n)),value:d,stackedValue:h.stackedValue,extraTooltipInfo:h.extraTooltipInfo};i.hasDynamicSeries&&(p.seriesDisplayName=i.seriesDisplayName,p.seriesName=c.dynamicDisplayName),r.push(p)}}return r},o.prototype.createLegendDataPoints=function(e){var i=this.data;if(i&&i.series&&!(i.series.length<1)){var a,r=[],o=i.categoryData[e];this.isInteractiveChart&&o&&(this.data.isScalar?(a=o.categoryValue,t.AxisHelper.isDateTime(this.xAxisProperties.axisType)&&(a=new Date(a))):a=t.CartesianHelper.lookupXValue(this.data,e,this.xAxisProperties.axisType,this.data.isScalar));for(var n=t.lineChartProps.general.formatString,s=null,l=0,c=i.series.length;c>l;l++){var u=i.series[l],h=u.data,d=void 0;if(this.isInteractiveChart){var p=void 0;if(this.data.isScalar){if(o)for(var g=o.categoryValue,m=0;m<h.length;m++)if(h[m].categoryValue===g){p=h[m];break}}else p=h[e];d=p&&p.value}var f=t.converterHelper.getFormattedLegendLabel(u.yCol,this.dataViewCat.values,n);s=u.yCol,r.push({color:u.color,icon:t.LegendIcon.Line,label:f,category:t.valueFormatter.format(a,t.valueFormatter.getFormatString(u.xCol,n)),measure:t.valueFormatter.format(d,t.valueFormatter.getFormatString(u.yCol,n)),identity:u.identity,selected:u.selected})}var y=this.dataViewCat?this.dataViewCat.values:null,v=y&&y.source?y.source.displayName:"";return{title:v,dataPoints:r}}},o.prototype.createLabelDataPoints=function(){var a,n,s,l,c,u,h=this,d=this.xAxisProperties.scale,p=this.yAxisProperties.scale,g=this.getXOfFirstCategory(),m=this.data,f=m.series,y=t.NewDataLabelUtils.createColumnFormatterCacheManager(),v=m.dataLabelsSettings,b=i.hasFlag(this.lineType,16),C=[];for(c=0,u=f.length;u>c;c++){var S=f[c];if(a=S.labelSettings?S.labelSettings:v,a.show){n=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yAxisProperties.formatter,a);var x=S.data;s=[],l=[];var w=function(i){if(null==i.value)return null;var s="";s=i.labelFormatString;var l,c=y.getOrCreate(s,a,n),u=t.NewDataLabelUtils.getLabelFormattedText(c.format(i.value)),m={text:u,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:r.fromPoint(a.fontSize),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},f=e.TextMeasurementService.measureSvgTextWidth(m)+t.NewDataLabelUtils.LabelDensityPadding,v=e.TextMeasurementService.estimateSvgTextHeight(m,!0),C=!1;if(b){var S=Math.max(i.stackedValue-i.value,p.domain()[0]),x=h.currentViewport.width;l={rect:{left:d(h.getXValue(i))-x/2,top:p(Math.max(i.stackedValue,i.stackedValue-i.value)),width:x,height:Math.abs(p(i.stackedValue)-p(S))},orientation:i.value>=0?1:2,validPositions:o.validStackedLabelPositions},C=!0}else l={point:{x:d(h.getXValue(i))+g,y:p(i.value)},radius:0,validPositions:h.lineChartLabelDensityEnabled?o.validLabelPositions:[1]};var w={isPreferred:!1,text:u,textSize:{width:f,height:v},outsideFill:a.labelColor?a.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:a.labelColor&&b?a.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:C?1:0,parentShape:l,fontSize:a.fontSize,identity:i.identity,key:i.key};return w};if(!_.isEmpty(x)){var P=x.length,D=x[P-1],L=w(D,c);L&&s.push(L);for(var T=0;P-1>T;T++){var V=w(x[T],c);V&&s.push(V)}}var M=x.length;C[c]={labelDataPoints:s,maxNumberOfLabels:M}}}return C},o.prototype.adjustPathXCoordinate=function(t){if(this.shouldAdjustMouseCoordsOnPathsForStroke){var i=this.scaleDetector.getScale().x;t-=e.Double.equalWithPrecision(i,1,1e-5)?o.pathXAdjustment:o.pathXAdjustment*i}return t},o.prototype.showLabelPerSeries=function(){var e=this.data;return!e.hasDynamicSeries&&(e.series.length>1||!e.categoryMetadata)},o.ClassName="lineChart",o.MainGraphicsContextClassName="mainGraphicsContext",o.CategorySelector=a("cat"),o.CategoryValuePoint=a("dot"),o.CategoryPointSelector=a("point"),o.CategoryAreaSelector=a("catArea"),o.HoverLineCircleDot=a("circle-item"),o.LineClassSelector=a("line"),o.PointRadius=5,o.CircleRadius=4,o.PathElementName="path",o.CircleElementName="circle",o.CircleClassName="selection-circle",o.LineElementName="line",o.RectOverlayName="rect",o.ScalarOuterPadding=10,o.interactivityStrokeWidth=10,o.pathXAdjustment=5,o.AreaFillOpacity=.4,o.DimmedAreaFillOpacity=.2,o.validLabelPositions=[1,2,8,4,64,128,16,32],o.validStackedLabelPositions=[1,4,2],o}();t.LineChart=o}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.Color,a=jsCommon.PixelConverter,r=t.shapes.Polygon,o=e.data.DataRoleHelper;t.MaxLevelOfDetail=23,t.MinLevelOfDetail=1,t.DefaultFillOpacity=.5,t.DefaultBackgroundColor="#000000",t.LeaderLineColor="#000000";var n=function(){function i(e){this.tooltipsEnabled=e}return i.prototype.init=function(e,i,a){this.mapControl=e,this.root=i;var r=d3.select(i[0]);r.attr("drag-resize-disabled","true");var o=this.svg=r.append("svg").style("position","absolute").style("pointer-events","none");if(a){var n=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(n)}this.bubbleGraphicsContext=o.append("g").classed("mapBubbles",!0),this.sliceGraphicsContext=o.append("g").classed("mapSlices",!0),this.labelBackgroundGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass["class"],!0),this.labelGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass["class"],!0),this.sliceLayout=d3.layout.pie().sort(null).value(function(e){return e.value}),this.arc=d3.svg.arc(),this.clearMaxDataPointRadius(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings()},i.prototype.setData=function(e){this.mapData=e},i.prototype.clearDataPoints=function(){this.mapData={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1}},i.prototype.getDataPointCount=function(){return this.mapData?_.filter(this.mapData.dataPoints,function(e){return!!e.location}).length:0},i.prototype.getDataPointPadding=function(){return 2*this.maxDataPointRadius},i.prototype.clearMaxDataPointRadius=function(){this.maxDataPointRadius=0},i.prototype.setMaxDataPointRadius=function(e){this.maxDataPointRadius=Math.max(e,this.maxDataPointRadius)},i.prototype.getDefaultMap=function(e,t){this.clearDataPoints()},i.prototype.converter=function(e,t,i,a,r){void 0===r&&(r=!0);var n=this.mapControl,s=e.width/2,l=e.height/2,c=1;this.dataLabelsSettings=i;var u=Math.min(e.width,e.height)/384;this.clearMaxDataPointRadius();var h,d,p=[],g=[],m=t?t.categorical:null,f=-1;m&&m.values&&(h=m.values.grouped(),f=o.getMeasureIndexOfRole(h,"Size"),d=m.values.source);for(var y=this.mapData?this.mapData.dataPoints:[],v=this.mapData.hasSize,b=0,C=y.length;C>b;b++){var S=y[b],x=S.categoryValue,w=S.location;if(w){var P=n.tryLocationToPixel(new Microsoft.Maps.Location(w.latitude,w.longitude)),D=P.x+s,L=P.y+l,T=S.radius*u;this.setMaxDataPointRadius(T);var _=S.subDataPoints,V=_.length;if(1===V){var M=_[0];p.push({x:D,y:L,labeltext:x,radius:T,fill:M.fill,stroke:M.stroke,strokeWidth:c,tooltipInfo:M.tooltipInfo,identity:M.identity,selected:!1,labelFill:i.labelColor})}else{for(var N=[],A=0;V>A;A++){var M=_[A],O=v?M.value:1;N.push({x:D,y:L,labeltext:x,radius:T,fill:M.fill,stroke:M.stroke,strokeWidth:c,value:O,tooltipInfo:M.tooltipInfo,identity:M.identity,selected:!1,labelFill:i.labelColor})}a&&a.applySelectionStateToData(N),g.push(N)}}}return a&&a.applySelectionStateToData(p),{bubbleData:p,sliceData:g}},i.prototype.updateInternal=function(e,i,a,r,o){c.removeTransform3d(this.root),this.mapRendererData=e,this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px");var n=this.arc,s=r&&r.hasSelection(),l=this.bubbleGraphicsContext.selectAll(".bubble").data(e.bubbleData,function(e){return e.identity.getKey()});l.enter().append("circle").classed("bubble",!0),l.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",function(e){return e.radius}).style("fill",function(e){return e.fill}).style("stroke",function(e){return e.stroke}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,s,!1)}).style("strokeWidth",function(e){return e.strokeWidth}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,s,!1)}).style("cursor","default"),l.exit().remove(),this.tooltipsEnabled&&(t.TooltipManager.addTooltip(this.bubbleGraphicsContext,function(e){return e.data.tooltipInfo}),l.style("pointer-events","all"));var u=e.sliceData,h=this.sliceGraphicsContext.selectAll(".sliceContainer").data(u);h.enter().append("g").classed("sliceContainer",!0),h.exit().remove();var d=this.sliceLayout,p=h.selectAll(".slice").data(function(e){return d(e)},function(e){return e.data.identity.getKey()});p.enter().append("path").classed("slice",!0),p.style("fill",function(e){return e.data.fill}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,!1)}).style("stroke",function(e){return e.data.stroke}).style("strokeWidth",function(e){return e.data.strokeWidth}).style("stroke-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,!1)}).style("cursor","default").attr("transform",function(e){return t.SVGUtil.translate(e.data.x,e.data.y)}).attr("d",function(e){return n.innerRadius(0).outerRadius(function(e){return e.data.radius})(e)}),p.exit().remove(),this.updateInternalDataLabels(i,o),this.tooltipsEnabled&&(t.TooltipManager.addTooltip(this.sliceGraphicsContext,function(e){return e.data.data.tooltipInfo}),p.style("pointer-events","all"));for(var g=e.bubbleData.slice(),m=0,f=u.length;f>m;m++)g.push.apply(g,u[m]);var y={bubbleEventGroup:this.bubbleGraphicsContext,sliceEventGroup:this.sliceGraphicsContext,bubbles:l,slices:p,clearCatcher:this.clearCatcher,dataPoints:g};return y},i.prototype.updateInternalDataLabels=function(i,a){var r=this.dataLabelsSettings,o=[];if(r&&(r.show||r.showCategory)){var n=this.createLabelDataPoints(),s=new e.LabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset}),l={labelDataPoints:n,maxNumberOfLabels:n.length};o=s.layout([l],{width:i.width,height:i.height})}t.NewDataLabelUtils.drawLabelBackground(this.labelGraphicsContext,o,e.visuals.DefaultBackgroundColor,e.visuals.DefaultFillOpacity),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,o,!1)},i.prototype.createLabelDataPoints=function(){var r=this.mapRendererData,o=[],n=r.bubbleData;n=n.concat(_.map(r.sliceData,function(e){return e[0]}));for(var s=this.dataLabelsSettings,l=0,c=n;l<c.length;l++){var u=c[l],h=u.labeltext,d={text:h,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:a.fromPoint(s.fontSize),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},p=e.TextMeasurementService.measureSvgTextWidth(d),g=e.TextMeasurementService.estimateSvgTextHeight(d);o.push({isPreferred:!0,text:h,textSize:{width:p,height:g},outsideFill:s.labelColor?s.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,parentShape:{point:{x:u.x,y:u.y},radius:u.radius,validPositions:i.validLabelPositions},fontSize:s.fontSize,identity:void 0,hasBackground:!0})}return o},i.validLabelPositions=[1,2,4,8],i}();t.MapBubbleDataPointRenderer=n;var s=function(){function i(e,t){this.filledMapDataLabelsEnabled=e,this.tooltipsEnabled=t}return i.getFilledMapParams=function(e,i){switch(e){case t.MapUtil.CategoryTypes.Continent:case t.MapUtil.CategoryTypes.CountryRegion:return 10>i?{level:1,maxPolygons:50,strokeWidth:0}:30>i?{level:1,maxPolygons:20,strokeWidth:0}:{level:1,maxPolygons:5,strokeWidth:0};default:return 100>i?{level:1,maxPolygons:5,strokeWidth:6}:200>i?{level:0,maxPolygons:5,strokeWidth:6}:{level:0,maxPolygons:5,strokeWidth:0}}},i.buildPaths=function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],r=a.geographic;r.length>2&&t.push(a)}return t},i.prototype.init=function(e,i,a){this.mapControl=e,this.polygonInfo=new t.MapPolygonInfo,this.root=i;var r=d3.select(i[0]);r.attr("drag-resize-disabled","true");var o=this.svg=r.append("svg").style("position","absolute").style("pointer-events","none");if(a){var n=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(n)}this.shapeGraphicsContext=o.append("g").classed("mapShapes",!0),this.labelBackgroundGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass["class"],!0),this.labelGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass["class"],!0),this.clearMaxShapeDimension(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings()},i.prototype.setData=function(e){this.mapData=e},i.prototype.clearDataPoints=function(){this.mapData={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1}},i.prototype.getDataPointCount=function(){return this.mapData?_.filter(this.mapData.dataPoints,function(e){return!!e.paths}).length:0},i.prototype.converter=function(e,a,r,n){this.clearMaxShapeDimension(),this.dataLabelsSettings=r;for(var s=1,l=[],c=this.mapData?this.mapData.dataPoints:[],u=0,h=c.length;h>u;u++){var d=a?a.categorical:null,p=c[u],g=p.subDataPoints[0],m=p.paths,f=void 0,y=-1,v=void 0;if(d&&d.values&&(f=d.values.grouped(),y=o.getMeasureIndexOfRole(f,"Size"),v=d.values.source),m)for(var b=p.value,C=p.categoryValue,S=g.identity,x=S.getKey(),w=t.NewDataLabelUtils.createColumnFormatterCacheManager(),P=i.getIndexOfLargestShape(m),D=0,L=m.length;L>D;D++){var T=m[D],V=a&&a.categorical&&!_.isEmpty(a.categorical.values)?t.valueFormatter.getFormatString(a.categorical.values[0].source,t.filledMapProps.general.formatString):void 0;this.setMaxShapeDimension(T.absoluteBounds.width,T.absoluteBounds.height);var M=w.getOrCreate(V,r);l.push({absolutePointArray:T.absolute,path:T.absoluteString,fill:g.fill,stroke:g.stroke,strokeWidth:s,tooltipInfo:g.tooltipInfo,identity:S,selected:!1,key:JSON.stringify({id:x,pIdx:D}),displayLabel:D===P,labeltext:C,catagoryLabeltext:null!=b?t.NewDataLabelUtils.getLabelFormattedText(M.format(b)):void 0,labelFormatString:V})}}return n&&n.applySelectionStateToData(l),{shapeData:l}},i.prototype.updateInternal=function(e,i,a,r,o){c.removeTransform3d(this.root),this.mapRendererData=e,this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.polygonInfo.reCalc(this.mapControl,i.width,i.height),this.shapeGraphicsContext.attr("transform",this.polygonInfo.transformToString(this.polygonInfo.transform));var n=r&&r.hasSelection(),s=this.shapeGraphicsContext.selectAll("polygon").data(e.shapeData,function(e){return e.key});s.enter().append("polygon").classed("shape",!0).attr("points",function(e){return e.path}),s.style("fill",function(e){return e.fill}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,n,!1)}).style("cursor","default"),a&&s.attr("points",function(e){return e.path}),s.exit().remove(),this.updateInternalDataLabels(i,o),this.tooltipsEnabled&&(t.TooltipManager.addTooltip(this.shapeGraphicsContext,function(e){return e.data.tooltipInfo}),s.style("pointer-events","all"));var l={shapeEventGroup:this.shapeGraphicsContext,shapes:s,clearCatcher:this.clearCatcher,dataPoints:e.shapeData};return l},i.prototype.getDataPointPadding=function(){return 12},i.getIndexOfLargestShape=function(e){for(var t=0,i=0,a=0,o=e.length;o>a;a++){var n=e[a],s=new r(n.absolute),l=Math.abs(r.calculateAbsolutePolygonArea(s.polygonPoints));l>i&&(t=a,i=l)}return t},i.prototype.updateInternalDataLabels=function(i,a){var r,o=this.dataLabelsSettings;if(o&&(o.show||o.showCategory)){var n=this.createLabelDataPoints();void 0===this.labelLayout&&(this.labelLayout=new e.FilledMapLabelLayout),r=this.labelLayout.layout(n,{width:i.width,height:i.height},this.polygonInfo.transform,a)}this.drawLabelStems(this.labelGraphicsContext,r,o.show,o.showCategory),t.NewDataLabelUtils.drawLabelBackground(this.labelGraphicsContext,r,e.visuals.DefaultBackgroundColor,e.visuals.DefaultFillOpacity),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,r,!1,o.show&&o.showCategory)},i.prototype.clearMaxShapeDimension=function(){this.maxShapeDimension=0},i.prototype.setMaxShapeDimension=function(e,t){this.maxShapeDimension=Math.max(e,this.maxShapeDimension),this.maxShapeDimension=Math.max(t,this.maxShapeDimension)},i.prototype.createLabelDataPoints=function(){
var a=this.mapRendererData,o=[];if(this.filledMapDataLabelsEnabled)for(var n=a.shapeData,s=this.dataLabelsSettings,l=0,c=n;l<c.length;l++){var u=c[l];if(u.displayLabel){var h=void 0,d=void 0,p=0,g=!1;if(this.dataLabelsSettings.show&&!this.dataLabelsSettings.showCategory){if(h=u.catagoryLabeltext,void 0===h)continue}else if(this.dataLabelsSettings.showCategory&&!this.dataLabelsSettings.show){if(h=u.labeltext,void 0===h)continue}else if(this.dataLabelsSettings.showCategory&&this.dataLabelsSettings.show){if(h=u.catagoryLabeltext,d=u.labeltext,void 0===h&&void 0===d)continue;g=!0}if(g){var m={text:d,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.NewDataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight};p=e.TextMeasurementService.measureSvgTextWidth(m)}var f={text:h,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.NewDataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},y=e.TextMeasurementService.measureSvgTextWidth(f),v=e.TextMeasurementService.estimateSvgTextHeight(f);d&&void 0!==u.labeltext&&void 0!==u.catagoryLabeltext&&(v=2*v);var b={parentType:2,parentShape:{polygon:new r(u.absolutePointArray),validPositions:i.validLabelPolygonPositions},text:h,secondRowText:d,textSize:{width:Math.max(y,p),height:v},insideFill:s.labelColor,outsideFill:s.labelColor?s.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,isPreferred:!1,identity:void 0,hasBackground:!0};o.push(b)}}return o},i.prototype.drawLabelStems=function(e,i,a,r){var o=_.filter(i,function(e){return e.isVisible}),n=function(e,t){return e.identity?e.identity.getKeyWithoutHighlight():t};t.NewDataLabelUtils.drawLabelLeaderLines(e,o,n,t.LeaderLineColor)},i.validLabelPolygonPositions=[256,2,1,8,4,16,32,64,128],i}();t.MapShapeDataPointRenderer=s;var l=11,c=function(){function a(e){e.filledMap?(this.dataPointRenderer=new s(e.filledMapDataLabelsEnabled,e.tooltipsEnabled),this.filledMapDataLabelsEnabled=e.filledMapDataLabelsEnabled,this.isFilledMap=!0):(this.dataPointRenderer=new n(e.tooltipsEnabled),this.isFilledMap=!1),this.mapControlFactory=e.mapControlFactory?e.mapControlFactory:this.getDefaultMapControlFactory(),this.behavior=e.behavior,this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,this.disableZooming=e.disableZooming,this.disablePanning=e.disablePanning,this.isLegendScrollable=!!e.behavior,this.viewChangeThrottleInterval=e.viewChangeThrottleInterval,this.enableCurrentLocation=e.enableCurrentLocation,this.boundsHaveBeenUpdated=!1}return a.prototype.init=function(i){var r=this,o=this.element=$("<div>");o.appendTo(i.element),this.pendingGeocodingRender=!1,this.currentViewport=i.viewport,this.style=i.style,this.colors=this.style.colorPalette.dataColors,this.behavior&&(this.interactivityService=t.createInteractivityService(i.host)),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.legend=e.visuals.createLegend(o,i.interactivity&&i.interactivity.isInteractiveLegend,this.interactivityService,this.isLegendScrollable),this.legendHeight=0,this.legendData={dataPoints:[]},this.geoTaggingAnalyzerService=e.createGeoTaggingAnalyzerService(i.host.getLocalizedString),this.host=i.host,i.host.locale&&(this.locale=i.host.locale()),this.geocoder=i.host.geocoder(),this.promiseFactory=i.host.promiseFactory(),this.resetBounds(),this.mapControlFactory.ensureMap(this.locale,function(){a.removeHillShading(),Microsoft.Maps.loadModule("Microsoft.Maps.Overlays.Style",{callback:function(){r.initialize(o[0]),r.enableCurrentLocation&&r.createCurrentLocation(o)}})})},a.prototype.destroy=function(){this.geocodingContext&&this.geocodingContext.timeout&&(this.geocodingContext.timeout.resolve(null),this.geocodingContext.timeout=null)},a.prototype.createCurrentLocation=function(e){var i,a=this,r=InJs.DomFactory.div().addClass("mapCurrentLocation").appendTo(e);r.on("click",function(){a.isCurrentLocation?(i&&a.mapControl.entities.remove(i),a.updateInternal(!1,!1),a.isCurrentLocation=!1):a.host.geolocation().getCurrentPosition(function(e){var r=new Microsoft.Maps.Location(e.coords.latitude,e.coords.longitude);i&&a.mapControl.entities.remove(i),i=t.MapUtil.CurrentLocation.createPushpin(r),a.mapControl.entities.push(i),a.updateMapView(r,l),a.isCurrentLocation=!0})})},a.prototype.addDataPoint=function(e){var t=e.location;this.updateBounds(t.latitude,t.longitude),this.scheduleRedraw()},a.prototype.scheduleRedraw=function(){var e=this;!this.pendingGeocodingRender&&this.mapControl&&(this.pendingGeocodingRender=!0,setTimeout(function(){e.updateInternal(!0,!0),e.pendingGeocodingRender=!1},a.ScheduleRedrawInterval))},a.prototype.enqueueGeoCode=function(e){var t=this,i=this.geocoder.tryGeocodeImmediate(e.geocodingQuery,this.geocodingCategory);if(i)this.completeGeoCode(e,i);else{var a=this.geocodingContext;this.geocoder.geocode(e.geocodingQuery,this.geocodingCategory,{timeout:this.geocodingContext.timeout.promise}).then(function(i){i&&a===t.geocodingContext&&t.completeGeoCode(e,i)})}},a.prototype.completeGeoCode=function(e,t){e.location=t,this.addDataPoint(e)},a.prototype.enqueueGeoCodeAndGeoShape=function(e,t){var i=this,a=this.geocoder.tryGeocodeImmediate(e.geocodingQuery,this.geocodingCategory);if(a)this.completeGeoCodeAndGeoShape(e,t,a);else{var r=this.geocodingContext;this.geocoder.geocode(e.geocodingQuery,this.geocodingCategory,{timeout:this.geocodingContext.timeout.promise}).then(function(a){a&&r===i.geocodingContext&&i.completeGeoCodeAndGeoShape(e,t,a)})}},a.prototype.completeGeoCodeAndGeoShape=function(e,t,i){e.location=i,this.enqueueGeoShape(e,t)},a.prototype.enqueueGeoShape=function(e,t){var i=this,a=this.geocoder.tryGeocodeBoundaryImmediate(e.location.latitude,e.location.longitude,this.geocodingCategory,t.level,t.maxPolygons);if(a)this.completeGeoShape(e,t,a);else{var r=this.geocodingContext;this.geocoder.geocodeBoundary(e.location.latitude,e.location.longitude,this.geocodingCategory,t.level,t.maxPolygons,{timeout:this.geocodingContext.timeout.promise}).then(function(a){r===i.geocodingContext&&i.completeGeoShape(e,t,a)})}},a.prototype.completeGeoShape=function(e,i,a){var r;0===a.locations.length||a.locations[0].geographic?r=s.buildPaths(a.locations):(t.MapUtil.calcGeoData(a),r=s.buildPaths(a.locations)),e.paths=r,this.addDataPoint(e)},a.prototype.getOptimumLevelOfDetail=function(e,i){var a=this.dataPointRenderer.getDataPointCount();if(0===a)return t.MapUtil.MinLevelOfDetail;for(var r=this.dataPointRenderer.getDataPointPadding(),o=t.MapUtil.MaxLevelOfDetail;o>=t.MapUtil.MinLevelOfDetail;o--){var n=t.MapUtil.latLongToPixelXY(this.minLatitude,this.minLongitude,o),s=t.MapUtil.latLongToPixelXY(this.maxLatitude,this.maxLongitude,o);if(s.x-n.x+r<=e&&n.y-s.y+r<=i)return 2>a&&(o=Math.min(t.MapUtil.MaxAutoZoomLevel,o)),o}return t.MapUtil.MinLevelOfDetail},a.prototype.getViewCenter=function(e){var i=t.MapUtil.latLongToPixelXY(this.minLatitude,this.minLongitude,e),a=t.MapUtil.latLongToPixelXY(this.maxLatitude,this.maxLongitude,e);return t.MapUtil.pixelXYToLocation((i.x+a.x)/2,(a.y+i.y)/2,e)},a.prototype.resetBounds=function(){this.boundsHaveBeenUpdated=!1,this.minLongitude=t.MapUtil.MaxAllowedLongitude,this.maxLongitude=t.MapUtil.MinAllowedLongitude,this.minLatitude=t.MapUtil.MaxAllowedLatitude,this.maxLatitude=t.MapUtil.MinAllowedLatitude},a.prototype.updateBounds=function(e,t){this.boundsHaveBeenUpdated=!0,t<this.minLongitude&&(this.minLongitude=t),t>this.maxLongitude&&(this.maxLongitude=t),e<this.minLatitude&&(this.minLatitude=e),e>this.maxLatitude&&(this.maxLatitude=e)},a.legendObject=function(e){return e&&e.metadata&&e.metadata.objects&&e.metadata.objects.legend},a.isLegendHidden=function(e){var i=a.legendObject(e);return null!=i&&i[t.legendProps.show]===!1},a.legendPosition=function(e){var i=a.legendObject(e);return i&&t.LegendPosition[i[t.legendProps.position]]},a.getLegendFontSize=function(e){var i=a.legendObject(e);return i&&i[t.legendProps.fontSize]||t.SVGLegend.DefaultFontSizeInPt},a.isShowLegendTitle=function(e){var i=a.legendObject(e);return i&&i[t.legendProps.showTitle]},a.prototype.legendTitle=function(){var e=a.legendObject(this.dataView);return e&&e[t.legendProps.titleText]||this.legendData.title},a.prototype.renderLegend=function(e){var i=a.isLegendHidden(this.dataView),r=a.isShowLegendTitle(this.dataView),o=this.legendTitle(),n={dataPoints:i?[]:e.dataPoints,grouped:e.grouped,title:r?o:"",fontSize:a.getLegendFontSize(this.dataView)},s=a.legendPosition(this.dataView);void 0!==s?this.legend.changeOrientation(s):this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend(n,this.currentViewport)},a.calculateGroupSizes=function(e,t,i,a,r){for(var o=e.values[0].values.length,n=t.length,s=0,l=o;l>s;++s){var c=null;if(a>=0)for(var u=0;n>u;++u){var h=t[u].values[a].values[s];h&&(null===c?c=h:c+=h)}i.push(c),c&&(r?(r.min=Math.min(r.min,c),r.max=Math.max(r.max,c)):r={min:c,max:c})}return r},a.calculateRadius=function(e,t){var i=e?e.max-e.min:0,a=6;return null!=e&&null!=t&&0!==i&&(a=14*((t-e.min)/i)+6),a},a.getGeocodingCategory=function(e,t){if(e&&e.categories&&e.categories.length>0&&e.categories[0].source){var i=e.categories[0].source.type;if(i&&i.categoryString)return t.getFieldType(i.categoryString);var a=e.categories[0].source.displayName,r=t.getFieldType(a);if(r)return r;var o=e.categories[0].source.roles;if(o)for(var n=Object.keys(o),s=0,l=n.length;l>s;++s){var c=t.getFieldType(n[s]);if(c)return c}}},a.hasSizeField=function(e,t){if(_.isEmpty(e))return!1;for(var i=0,a=e.length;a>i;i++){var r=e[i].source.roles;if(!r&&i===t&&e[i].source.type.numeric)return!0;if(r)for(var o=Object.keys(r),n=0,s=o.length;s>n;n++){var l=o[n];if("Size"===l)return!0}}return!1},a.shouldEnumerateDataPoints=function(e,t){var i=o.hasRoleInDataView(e,"Series"),a=t?"Size":"Gradient",r=o.hasRoleInDataView(e,a);return i||!r},a.shouldEnumerateCategoryLabels=function(e,t){return!e||t},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"dataPoint":if(a.shouldEnumerateDataPoints(this.dataView,this.isFilledMap)){var r=[],o=this.hasDynamicSeries;if(!o){var n=this.dataPointRenderer.converter(this.getMapViewPort(),this.dataView,this.dataLabelsSettings,this.interactivityService,this.tooltipsEnabled);r=n.bubbleData}a.enumerateDataPoints(i,this.dataPointsToEnumerate,this.colors,o,this.defaultDataPointColor,this.showAllDataPoints,r)}break;case"categoryLabels":a.shouldEnumerateCategoryLabels(this.isFilledMap,this.filledMapDataLabelsEnabled)&&t.dataLabelUtils.enumerateCategoryLabels(i,this.dataLabelsSettings,!0,!0);break;case"legend":this.hasDynamicSeries&&a.enumerateLegend(i,this.dataView,this.legend,this.legendTitle());break;case"labels":if(this.filledMapDataLabelsEnabled){this.dataLabelsSettings=this.dataLabelsSettings?this.dataLabelsSettings:t.dataLabelUtils.getDefaultMapLabelSettings();var s={enumeration:i,dataLabelsSettings:this.dataLabelsSettings,show:!0,displayUnits:!0,precision:!0};t.dataLabelUtils.enumerateDataLabels(s)}}return i.complete()},a.enumerateDataPoints=function(e,a,r,o,n,s,l){var c=a&&a.length;if(o)for(var u=0;c>u;u++){var h=a[u];e.pushInstance({objectName:"dataPoint",displayName:h.label,selector:t.ColorHelper.normalizeSelector(h.identity.getSelector()),properties:{fill:{solid:{color:h.color}}}})}else if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:n||r.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!s}}),l)for(var u=0;u<l.length;u++){var d=l[u];e.pushInstance({objectName:"dataPoint",displayName:d.labeltext,selector:t.ColorHelper.normalizeSelector(d.identity.getSelector()),properties:{fill:{solid:{color:i.normalizeToHexString(d.fill)}}}})}},a.enumerateLegend=function(e,i,r,o){e.pushInstance({selector:null,properties:{show:!a.isLegendHidden(i),position:t.LegendPosition[r.getOrientation()],showTitle:a.isShowLegendTitle(i),titleText:o,fontSize:a.getLegendFontSize(i)},objectName:"legend"})},a.prototype.onDataChanged=function(i){var r=this;this.resetBounds(),this.geocodingContext&&this.geocodingContext.timeout&&this.geocodingContext.timeout.resolve(null),this.geocodingContext={timeout:this.promiseFactory.defer()},this.behavior&&this.behavior.resetZoomPan(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.defaultDataPointColor=null,this.showAllDataPoints=null;var o=this.dataView=i.dataViews[0],n=this.isFilledMap,l=[],c={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1};if(o){if(o.metadata&&o.metadata.objects){var u=o.metadata.objects;if(this.defaultDataPointColor=e.DataViewObjects.getFillColor(u,t.mapProps.dataPoint.defaultColor),this.showAllDataPoints=e.DataViewObjects.getValue(u,t.mapProps.dataPoint.showAllDataPoints),this.dataLabelsSettings.showCategory=e.DataViewObjects.getValue(u,t.filledMapProps.categoryLabels.show,this.dataLabelsSettings.showCategory),n){this.dataLabelsSettings.precision=e.DataViewObjects.getValue(u,t.filledMapProps.labels.labelPrecision,this.dataLabelsSettings.precision),this.dataLabelsSettings.precision=this.dataLabelsSettings.precision!==t.dataLabelUtils.defaultLabelPrecision&&this.dataLabelsSettings.precision<0?0:this.dataLabelsSettings.precision,this.dataLabelsSettings.displayUnits=e.DataViewObjects.getValue(u,t.filledMapProps.labels.labelDisplayUnits,this.dataLabelsSettings.displayUnits);var h=u.labels;h&&(this.dataLabelsSettings.show=void 0!==h.show?h.show:this.dataLabelsSettings.show,void 0!==h.color&&(this.dataLabelsSettings.labelColor=h.color.solid.color))}else{var d=u.categoryLabels;d&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(d,this.dataLabelsSettings)}}var p=new t.ColorHelper(this.colors,t.mapProps.dataPoint.fill,this.defaultDataPointColor);c=a.converter(o,p,this.geoTaggingAnalyzerService,n,this.tooltipBucketEnabled),this.hasDynamicSeries=c.hasDynamicSeries,this.legendData=a.createLegendData(o,p),this.dataPointsToEnumerate=this.legendData.dataPoints,this.renderLegend(this.legendData),null!=c?(this.geocodingCategory=c.geocodingCategory,this.mapControlFactory.ensureMap(this.locale,function(){a.removeHillShading();var e;n&&(e=s.getFilledMapParams(r.geocodingCategory,c.dataPoints.length));for(var t=0,i=c.dataPoints;t<i.length;t++){var o=i[t];o.location?n&&!o.paths?r.enqueueGeoShape(o,e):r.addDataPoint(o):_.isEmpty(o.categoryValue)||(n?r.enqueueGeoCodeAndGeoShape(o,e):r.enqueueGeoCode(o))}})):this.clearDataPoints(),n&&(this.geocodingCategory&&this.geoTaggingAnalyzerService.isGeoshapable(this.geocodingCategory)||l.push(new t.FilledMapWithoutValidGeotagCategoryWarning))}else this.clearDataPoints(),this.renderLegend({dataPoints:[],title:void 0}),this.dataPointsToEnumerate=[];_.isEmpty(l)||this.host.setWarnings(l),this.dataPointRenderer.setData(c),this.updateInternal(!0,!0)},a.converter=function(r,o,n,s,l){var c=e.data.createIDataViewCategoricalReader(r),u=[],h=c.hasDynamicSeries(),d=c.getSeriesColumnIdentityFields(),p=c.getMeasureQueryName("Size");null==p&&(p="");var g=c.hasValues("Size"),m=null,f=t.mapProps.general.formatString;if(c.hasCategories()){var y=[],v=void 0;if(g){for(var b=void 0,C=void 0,S=0,x=c.getCategoryCount();x>S;S++){for(var w=void 0,P=0,D=c.getSeriesCount();D>P;P++){var L=c.getValue("Size",S,P);null==w&&null!=L&&(w=0),null!=w&&(w+=L)}y.push(w),null!=w&&((void 0===b||b>w)&&(b=w),(void 0===C||w>C)&&(C=w))}v=void 0!==b&&void 0!==C?{max:C,min:b}:void 0}var T=c.hasCompositeCategories()&&c.hasCategoryWithRole("X")&&c.hasCategoryWithRole("Y"),_=c.hasCategoryWithRole("Category");if(m=a.getGeocodingCategory(r.categorical,n),T||_)for(var S=0,x=c.getCategoryCount();x>S;S++){var V=void 0,M=_?c.getCategoryObjects("Category",S):c.getCategoryObjects("Y",S),N=void 0,A=void 0,O=void 0,I=void 0,R=void 0,F=void 0,H=void 0;if(_){if(V=c.getCategoryValue("Category",S),A={displayName:c.getCategoryDisplayName("Category"),value:t.converterHelper.formatFromMetadataColumn(V,c.getCategoryMetadataColumn("Category"),f)},c.hasValues("Y")&&c.hasValues("X")){var z=c.getFirstNonNullValueForCategory("Y",S),G=c.getFirstNonNullValueForCategory("X",S);null!=z&&null!=G&&(N={latitude:z,longitude:G}),O={displayName:c.getValueDisplayName("Y"),value:t.converterHelper.formatFromMetadataColumn(z,c.getValueMetadataColumn("Y"),f)},I={displayName:c.getValueDisplayName("X"),value:t.converterHelper.formatFromMetadataColumn(G,c.getValueMetadataColumn("X"),f)}}}else{var z=c.getCategoryValue("Y",S),G=c.getCategoryValue("X",S);null!=z&&null!=G&&(V=z+", "+G,N={latitude:z,longitude:G},O={displayName:c.getCategoryDisplayName("Y"),value:t.converterHelper.formatFromMetadataColumn(z,c.getCategoryMetadataColumn("Y"),f)},I={displayName:c.getCategoryDisplayName("X"),value:t.converterHelper.formatFromMetadataColumn(G,c.getCategoryMetadataColumn("X"),f)})}var k=g?y[S]:void 0,j=[],D=c.getSeriesCount();g||h||(D=1);for(var P=0;D>P;P++){var E=void 0;E=h?o.getColorForSeriesValue(c.getSeriesObjects(P),d,c.getSeriesName(P)):c.hasCategoryWithRole("Series")?o.getColorForSeriesValue(c.getCategoryObjects("Series",S),c.getCategoryColumnIdentityFields("Series"),V):o.getColorForMeasure(M,p);var B=i.parseColorString(E),W=i.hexString(i.darken(B,a.StrokeDarkenColorValue));B.A=.6;var U=i.rgbString(B),Y=(new t.SelectionIdBuilder).withCategory(c.getCategoryColumn(_?"Category":"Y"),S).withMeasure(p);h&&(Y=Y.withSeries(c.getSeriesValueColumns(),c.getSeriesValueColumnGroup(P))),h&&(R={displayName:c.getSeriesDisplayName(),value:t.converterHelper.formatFromMetadataColumn(c.getSeriesName(P),c.getSeriesMetadataColumn(),f)});var K=void 0;g&&(K=c.getValue("Size",S,P),F={displayName:c.getValueDisplayName("Size"),value:t.converterHelper.formatFromMetadataColumn(K,c.getValueMetadataColumn("Size",P),f)}),c.hasValues("Gradient")&&(H={displayName:c.getValueDisplayName("Gradient"),value:t.converterHelper.formatFromMetadataColumn(c.getValue("Gradient",S,P),c.getValueMetadataColumn("Gradient",P),f)});var X=[];if(A&&X.push(A),R&&X.push(R),O&&X.push(O),I&&X.push(I),F&&X.push(F),H&&X.push(H),l){var q=c.getAllValuesForRole("Tooltips",S,P),$=c.getAllValueMetadataColumnsForRole("Tooltips",P);if(q&&$)for(var Q=0;Q<q.length;Q++)null!=q[Q]&&X.push({displayName:$[Q].displayName,value:t.converterHelper.formatFromMetadataColumn(q[Q],$[Q],f)})}(K||!g||0===K&&s)&&j.push({value:K,fill:U,stroke:W,identity:Y.createSelectionId(),tooltipInfo:X})}(k||!g||0===k&&s)&&u.push({geocodingQuery:V,value:k,categoryValue:V,subDataPoints:j,radius:a.calculateRadius(v,k),location:N})}}var Z={dataPoints:u,geocodingCategory:m,hasDynamicSeries:h,hasSize:g};return Z},a.createLegendData=function(i,a){var r,o=e.data.createIDataViewCategoricalReader(i),n=[];if(o.hasDynamicSeries()){r=o.getSeriesDisplayName();for(var s=o.getSeriesColumnIdentityFields(),l=0,c=o.getSeriesCount();c>l;l++){var u=a.getColorForSeriesValue(o.getSeriesObjects(l),s,o.getSeriesName(l)),h=(new t.SelectionIdBuilder).withSeries(o.getSeriesValueColumns(),o.getSeriesValueColumnGroup(l)).createSelectionId();n.push({color:u,label:t.valueFormatter.format(o.getSeriesName(l)),icon:t.LegendIcon.Circle,identity:h,selected:!1})}}var d={dataPoints:n,title:r};return d},a.prototype.swapLogoContainerChildElement=function(){var e=this.element.find(".LogoContainer");if(e){var t=e.find("a");if(null==t)return;var i=$("<div>");t.children().clone().appendTo(i),t.remove(),i.appendTo(e)}},a.prototype.onResizing=function(e){this.currentViewport.width===e.width&&this.currentViewport.height===e.height||(this.currentViewport=e,this.renderLegend(this.legendData),this.updateInternal(!1,!1))},a.prototype.initialize=function(e){var i=this,r={credentials:t.MapUtil.Settings.BingKey,showMapTypeSelector:!1,enableClickableLogo:!1,enableSearchLogo:!1,mapTypeId:Microsoft.Maps.MapTypeId.road,customizeOverlays:!0,showDashboard:!1,showScalebar:!1,disableKeyboardInput:!0,disableZooming:this.disableZooming,disablePanning:this.disablePanning},o=this.root=InJs.DomFactory.div().addClass(a.MapContainer.cssClass).appendTo(e);this.mapControl=this.mapControlFactory.createMapControl(o[0],r),void 0!==this.viewChangeThrottleInterval?Microsoft.Maps.Events.addThrottledHandler(this.mapControl,"viewchange",function(){i.onViewChanged()},this.viewChangeThrottleInterval):Microsoft.Maps.Events.addHandler(this.mapControl,"viewchange",function(){i.onViewChanged()}),Microsoft.Maps.Events.addHandler(this.mapControl,"viewchangeend",function(){i.onViewChangeEnded()}),this.dataPointRenderer.init(this.mapControl,o,!!this.behavior),this.pendingGeocodingRender||this.updateInternal(!0,!0)},a.prototype.onViewChanged=function(){this.updateOffsets(!1,!1),this.behavior&&this.behavior.viewChanged(),this.swapLogoContainerChildElement()},a.prototype.onViewChangeEnded=function(){this.dataPointRenderer.updateInternalDataLabels(this.currentViewport,!0)},a.prototype.getMapViewPort=function(){var e=this.currentViewport,t=this.legend.getMargins(),i={width:e.width-t.width,height:e.height-t.height};return i},a.removeTransform3d=function(e){var t=window.navigator.userAgent.toLowerCase();if(e&&-1===t.indexOf("applewebkit")){var i=e.find("img");i.css("transform","")}},a.prototype.updateInternal=function(e,t){if(this.mapControl){var i=this.legend.isVisible();i||(this.legendData={dataPoints:[]});var r=this.element.children(a.MapContainer.selector),o=this.getMapViewPort();if(r.height(o.height),r.width(o.width),this.updateOffsets(e,t),this.boundsHaveBeenUpdated&&(!this.behavior||!this.behavior.hasReceivedZoomOrPanEvent())){var n=this.getOptimumLevelOfDetail(o.width,o.height),s=this.getViewCenter(n);this.updateMapView(s,n)}}},a.prototype.updateMapView=function(e,t){this.mapControl.setView({center:e,zoom:t,animate:!0})},a.prototype.updateOffsets=function(e,i){var a,r=this.dataView,o=this.getMapViewPort();a=r&&r.categorical?this.dataPointRenderer.converter(o,this.dataView,this.dataLabelsSettings,this.interactivityService,this.tooltipsEnabled):{bubbleData:[],shapeData:[],sliceData:[]};var n=this.dataPointRenderer.updateInternal(a,o,e,this.interactivityService,i);t.Legend.positionChartArea(d3.select(this.root[0]),this.legend),this.interactivityService&&n&&this.interactivityService.bind(n.dataPoints,this.behavior,n)},a.prototype.onClearSelection=function(){this.interactivityService.clearSelection(),this.updateOffsets(!1,!1)},a.prototype.clearDataPoints=function(){this.dataPointRenderer.clearDataPoints(),this.legend.drawLegend({dataPoints:[]},this.currentViewport)},a.prototype.getDefaultMapControlFactory=function(){return{createMapControl:function(e,t){return new Microsoft.Maps.Map(e,t)},ensureMap:jsCommon.ensureMap}},a.removeHillShading=function(){Microsoft.Maps.Globals.roadUriFormat=Microsoft.Maps.Globals.roadUriFormat.replace("&shading=hill","")},a.MapContainer={cssClass:"mapControl",selector:".mapControl"},a.StrokeDarkenColorValue=63.75,a.ScheduleRedrawInterval=3e3,a}();t.Map=c}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){e.append("div").classed("imgCon",!0).append("img")}function a(e,t){e.selectAll(".imgCon").style({height:r(t.maxHeight)}).selectAll("img").style({"max-height":r(t.maxHeight),"max-width":r(t.maxWidth)})}function r(e){return e+"px"}var o=e.visuals.KpiUtil.getKpiImageMetadata,n=jsCommon.CssConstants.createClassAndSelector,s=jsCommon.PixelConverter,l=jsCommon.UrlUtils,c=e.visuals.controls.internal.TablixUtils.EdgeSettings,u="wf_segoe-ui_semibold",h="wf_segoe-ui_normal",d=10,p=13,g=9,m="#767676",f="#333333",y="#ACACAC",v=t.outline.none,b="#E8E8E8",C=1,S=!0,x="#A6A6A6",w=t.outline.leftOnly,P=3,D=function(){function D(){this.isInteractivityOverflowHidden=!1}return D.prototype.init=function(e){this.options=e,this.style=e.style;var t=this.currentViewport=e.viewport,i=this.interactivity=e.interactivity;i&&"hidden"===i.overflow&&(this.isInteractivityOverflowHidden=!0);var a=this.element=$("<div/>").addClass(D.MultiRowCardRoot["class"]).css({height:r(t.height)});e.element.append(a),this.initializeCardRowSelection()},D.prototype.onDataChanged=function(i){var a=i.dataViews;if(a&&a.length>0){var r=this.dataView=a[0],o=r.table.columns,n=r.table.rows,s=i.operationKind!==e.VisualDataChangeOperationKind.Append,l=this.data=D.converter(r,o.length,n.length,this.isInteractivityOverflowHidden);this.setCardDimensions(),this.listView.data(l.dataModel,function(e){return l.dataModel.indexOf(e)},s)}else this.data={dataModel:[],dataColumnCount:0,cardTitleSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,m,p),categoryLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,y,g),dataLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,f,d),cardSettings:D.getCardSettings(null)};this.waitingForData=!1},D.getCardSettings=function(i){var a=i&&i.metadata&&i.metadata.objects?i.metadata.objects:null,r={outline:e.DataViewObjects.getValue(a,t.multiRowCardProps.card.outline,v),color:e.DataViewObjects.getFillColor(a,t.multiRowCardProps.card.outlineColor,b),weight:e.DataViewObjects.getValue(a,t.multiRowCardProps.card.outlineWeight,C)},o=e.DataViewObjects.getValue(a,t.multiRowCardProps.card.barShow,S),n={outline:o?w:t.outline.none,color:e.DataViewObjects.getFillColor(a,t.multiRowCardProps.card.barColor,x),weight:e.DataViewObjects.getValue(a,t.multiRowCardProps.card.barWeight,P)},s=e.DataViewObjects.getValue(a,t.multiRowCardProps.card.cardPadding,D.DefaultStyle.row.marginBottom),l=e.DataViewObjects.getFillColor(a,t.multiRowCardProps.card.cardBackground,D.DefaultStyle.row.background);return{outlineSettings:r,barSettings:n,cardPadding:s,cardBackground:l}},D.prototype.onResizing=function(e){var t=this.currentViewport.height===e.height;if(this.currentViewport=e,this.element.css("height",r(e.height)),this.dataView){var i=this.maxColPerRow;this.maxColPerRow=this.getMaxColPerRow();var a=i===this.maxColPerRow;t&&a||this.listView.viewport(e)}},D.converter=function(i,a,r,n){void 0===n&&(n=!1);var s,c,u,h=[],v=i.table.rows,b=i.table.columns;if(s=t.dataLabelUtils.getDefaultLabelSettings(!0,m,p),c=t.dataLabelUtils.getDefaultLabelSettings(!0,f,d),u=t.dataLabelUtils.getDefaultLabelSettings(!0,y,g),i.metadata&&i.metadata.objects){var C=e.DataViewObjects.getObject(i.metadata.objects,"cardTitle");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(C,s);var S=e.DataViewObjects.getObject(i.metadata.objects,"dataLabels");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(S,c);var x=e.DataViewObjects.getObject(i.metadata.objects,"categoryLabels");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(x,u)}for(var w=0,P=r;P>w;w++){for(var L=v[w],T=void 0,_=void 0,V=!1,M=!1,N=!1,A=[],O=0;a>O;O++){var I=b[O],R=o(I,L[O]),F=void 0,H=void 0;R&&(F=R["class"],H=R.statusGraphic),F||(F=t.valueFormatter.format(L[O],t.valueFormatter.getFormatString(I,D.formatStringProp)));var z=void 0!==R&&void 0!==R.caption,G=b[O].displayName;n||I.type.numeric||(void 0===T?(T=!0,_=F,V=t.converterHelper.isWebUrlColumn(I)&&l.isValidUrl(_),M=t.converterHelper.isImageUrlColumn(I)&&l.isValidImageUrl(F),N=z):T&&(T=!1)),A.push({caption:F,details:G,showURL:t.converterHelper.isWebUrlColumn(I)&&l.isValidUrl(F),showImage:t.converterHelper.isImageUrlColumn(I)&&l.isValidImageUrl(F),showKPI:z,columnIndex:O})}h.push({title:T?_:void 0,showTitleAsURL:V,showTitleAsImage:M,showTitleAsKPI:N,cardItemsData:T?A.filter(function(e){return e.caption!==_}):A})}return{dataModel:h,dataColumnCount:h[0]?h[0].cardItemsData.length:0,cardTitleSettings:s,categoryLabelsSettings:u,dataLabelsSettings:c,cardSettings:D.getCardSettings(i)}},D.getSortableRoles=function(e){if(e&&e.dataViewMappings&&!_.isEmpty(e.dataViewMappings))for(var t=0,i=e.dataViewMappings;t<i.length;t++){var a=i[t];if(a.table){var r=a.table.rows;if(r&&r["for"]&&r["for"]["in"]&&r["for"]["in"].items)return[D.ValuesRole]}}},D.prototype.initializeCardRowSelection=function(){var o=this,n=this.isInteractivityOverflowHidden,l=function(e){var t=e.append("div").classed(D.Card["class"],!0);n?t.classed("mrtile",!0):o.cardHasTitle&&t.append("div").classed(D.Title["class"],!0).each(function(e){e.showTitleAsImage?i(d3.select(this)):e.showTitleAsURL?d3.select(this).append("a"):e.showTitleAsKPI&&d3.select(this).append("div").classed(D.KPITitle["class"],!0).classed(e.title,!0).style({display:"inline-block",verticalAlign:"sub"})});var a=t.selectAll(D.CardItemContainer.selector).data(function(e){return e.cardItemsData}).enter().append("div").classed(D.CardItemContainer["class"],!0);a.append("div").classed(D.Caption["class"],!0).each(function(e){e.showURL?d3.select(this).append("a"):e.showImage?i(d3.select(this)):e.showKPI&&d3.select(this).append("div").classed(e.caption,!0).style({display:"inline-block",verticalAlign:"sub"})}),a.append("div").classed(D.Details["class"],!0)},c=function(t){var i=o.getStyle(),l=e.TextMeasurementService.estimateSvgTextHeight(D.getTextProperties(!1,i.caption.fontSize)),c=e.TextMeasurementService.estimateSvgTextHeight(D.getTextProperties(!1,i.details.fontSize)),u=e.TextMeasurementService.estimateSvgTextHeight(D.getTextProperties(!0,i.title.fontSize)),h=o.getBorderStyles(i.row.border);t.style(h).style({"margin-bottom":n?"0px":o.isSingleRowCard?"0px":r(i.row.marginBottom),background:i.row.background}),!n&&o.cardHasTitle&&(t.selectAll(D.Title.selector).filter(function(e){return!e.showTitleAsImage&&!e.showTitleAsKPI}).style({"font-size":s.fromPoint(i.title.fontSize),"line-height":s.toString(u),color:i.title.color}),t.selectAll(D.Title.selector).filter(function(e){return!e.showTitleAsURL&&!e.showTitleAsImage&&!e.showTitleAsKPI}).text(function(e){return e.title}).attr("title",function(e){return e.title}),t.selectAll(D.TitleUrlSelector).text(function(e){return e.title}).attr({href:function(e){return e.title},target:"_blank"}),t.selectAll(D.TitleImageSelector).attr("src",function(e){return e.title}),a(t.selectAll(D.Title.selector),i.imageTitle),t.selectAll(D.KPITitle.selector).each(function(e){var t=d3.select(this);t.classed(e.title)}));var d=t.selectAll(D.Card.selector),p=o.getBorderStyles(i.card.border);d.style(p),d.selectAll(D.Caption.selector).filter(function(e){return!e.showImage}).style({"line-height":s.toString(l),"font-size":s.fromPoint(i.caption.fontSize)}).filter(function(e){return!e.showKPI}).style({color:i.caption.color}).filter(function(e){return!e.showURL}).text(function(e){return e.caption}).attr("title",function(e){return e.caption}),d.selectAll(D.CaptionImageSelector).attr("src",function(e){return e.caption}).style(i.imageCaption),d.selectAll(D.CardItemContainer.selector).style({"padding-right":function(e){return o.isLastRowItem(e.columnIndex,o.dataView.metadata.columns.length)?"0px":r(i.cardItemContainer.paddingRight)},width:function(e){return o.getColumnWidth(e.columnIndex,o.data.dataColumnCount)},display:function(e){return o.hideColumn(e.columnIndex)?"none":"inline-block"}}),a(d.selectAll(D.Caption.selector),i.imageCaption),d.selectAll(D.CaptionUrlSelector).attr({href:function(e){return e.caption},target:"_blank"}).text(function(e){return e.caption}),i.details.isVisible&&d.selectAll(D.Details.selector).text(function(e){return e.details}).style({"font-size":s.fromPoint(i.details.fontSize),"line-height":s.toString(c),color:i.details.color}).attr("title",function(e){return e.details})},u=function(e){e.remove()},h={rowHeight:void 0,enter:l,exit:u,update:c,loadMoreData:function(){return o.onLoadMoreData()},viewport:this.currentViewport,baseContainer:d3.select(this.element.get(0)),scrollEnabled:!this.isInteractivityOverflowHidden,isReadMode:function(){return 1!==o.options.host.getViewMode()}};this.listView=t.ListViewFactory.createListView(h)},D.prototype.getBorderStyles=function(e){return{"border-top":e&&e.top?e.top.getCSS():"","border-right":e&&e.right?e.right.getCSS():"","border-bottom":e&&e.bottom?e.bottom.getCSS():"","border-left":e&&e.left?e.left.getCSS():""}},D.prototype.getMaxColPerRow=function(){var e=this.currentViewport.width,t=this.getStyle().cardItemContainer.minWidth,i=this.data.dataColumnCount,a=Math.floor(e/t)||1;
return Math.min(i,a)},D.prototype.getRowIndex=function(e){return Math.floor(1*e/this.getMaxColPerRow())},D.prototype.getStyle=function(){var e=D.DefaultStyle,t=this.getCustomStyles();if(!this.isInteractivityOverflowHidden)return $.extend(!0,{},e,t);for(var i=this.currentViewport.width,a={},r=0,o=D.tileMediaQueries;r<o.length;r++){var n=o[r];if(i<=n.maxWidth){a=n.style;break}}return $.extend(!0,{},e,t,a)},D.prototype.getSurroundSettings=function(e){var i=new c(e.weight,e.color),a=e.outline;return{top:t.outline.showTop(a)?i:null,right:t.outline.showRight(a)?i:null,bottom:t.outline.showBottom(a)?i:null,left:t.outline.showLeft(a)?i:null}},D.prototype.getCustomStyles=function(){var e=this.data.dataLabelsSettings,t=this.data.categoryLabelsSettings,i=this.data.cardTitleSettings,a=this.data.cardSettings,r={row:{border:this.getSurroundSettings(a.outlineSettings),marginBottom:a.cardPadding,background:a.cardBackground},card:{border:this.getSurroundSettings(a.barSettings)},details:{fontSize:t.fontSize,color:t.labelColor,isVisible:t.show},caption:{fontSize:e.fontSize,color:e.labelColor},title:{fontSize:i.fontSize,color:i.labelColor}};return r},D.getTextProperties=function(e,t){return{fontFamily:e?u:h,fontSize:s.fromPoint(t)}},D.prototype.hideColumn=function(e){var t=this.getRowIndex(e),i=this.getStyle().card.maxRows;return i&&t>=i},D.prototype.getColumnWidth=function(e,t){var i=this.getMaxColPerRow();if(i>=t)return 100/t+"%";var a=this.getRowIndex(e),r=Math.ceil(1*t/i),o=t%i;return r>a||0===o?100/i+"%":100/o+"%"},D.prototype.isLastRowItem=function(e,t){if(e+1===t)return!0;var i=this.getMaxColPerRow();return i-e%i===1},D.prototype.setCardDimensions=function(){this.cardHasTitle=!1;var e=this.data.dataModel;!this.isInteractivityOverflowHidden&&e&&e.length>0&&(this.cardHasTitle=void 0!==e[0].title,this.isSingleRowCard=1===e.length)},D.prototype.onLoadMoreData=function(){!this.waitingForData&&this.dataView.metadata&&this.dataView.metadata.segment&&(this.options.host.loadMoreData(),this.waitingForData=!0)},D.getDataLabelSettingsOptions=function(e,t,i){return void 0===i&&(i=!1),{enumeration:e,dataLabelsSettings:t,show:i,fontSize:!0}},D.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder,a=this.data.cardTitleSettings,r=this.data.dataLabelsSettings,o=this.data.categoryLabelsSettings;switch(e.objectName){case"cardTitle":!this.isInteractivityOverflowHidden&&this.cardHasTitle&&t.dataLabelUtils.enumerateDataLabels(D.getDataLabelSettingsOptions(i,a));break;case"dataLabels":t.dataLabelUtils.enumerateDataLabels(D.getDataLabelSettingsOptions(i,r));break;case"categoryLabels":t.dataLabelUtils.enumerateDataLabels(D.getDataLabelSettingsOptions(i,o,!0));break;case t.multiRowCardProps.card.outline.objectName:this.enumerateCard(i)}return i.complete()},D.prototype.enumerateCard=function(e){var i=this.data.cardSettings,a=t.multiRowCardProps.card,r={},o=i.outlineSettings;r[a.outline.propertyName]=o.outline,o.outline!==t.outline.none&&(r[a.outlineColor.propertyName]=o.color,r[a.outlineWeight.propertyName]=o.weight);var n=i.barSettings,s=n.outline!==t.outline.none;r[a.barShow.propertyName]=s,s&&(r[a.barColor.propertyName]=n.color,r[a.barWeight.propertyName]=n.weight),r[a.cardPadding.propertyName]=i.cardPadding,r[a.cardBackground.propertyName]=i.cardBackground,e.pushInstance({selector:null,objectName:a.outline.objectName,properties:r})},D.formatStringProp={objectName:"general",propertyName:"formatString"},D.MultiRowCardRoot=n("multiRowCard"),D.Card=n("card"),D.Title=n("title"),D.CardItemContainer=n("cardItemContainer"),D.Caption=n("caption"),D.Details=n("details"),D.TitleUrlSelector=D.Title.selector+" a",D.CaptionUrlSelector=D.Caption.selector+" a",D.TitleImageSelector=D.Title.selector+" img",D.CaptionImageSelector=D.Caption.selector+" img",D.KPITitle=n("kpiTitle"),D.ValuesRole="Values",D.DefaultStyle={row:{border:null,marginBottom:20,background:void 0},card:{border:null},cardItemContainer:{paddingRight:20,minWidth:120},imageCaption:{maxHeight:75,maxWidth:100},imageTitle:{maxHeight:75,maxWidth:100}},D.tileMediaQueries=[{maxWidth:250,style:{card:{maxRows:2},cardItemContainer:{minWidth:110},imageCaption:{maxHeight:45}}},{maxWidth:490,style:{card:{maxRows:2},cardItemContainer:{minWidth:130},imageCaption:{maxHeight:52}}},{maxWidth:750,style:{card:{maxRows:1},cardItemContainer:{minWidth:120},imageCaption:{maxHeight:53}}}],D}();t.MultiRowCard=D}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants.createClassAndSelector,a=jsCommon.KeyUtils,r=jsCommon.StringExtensions,o=jsCommon.UrlUtils,n=function(){function e(){}return e.prototype.init=function(e){this.element=e.element,this.host=e.host,this.viewport=e.viewport,this.readOnly=0===this.host.getViewMode(),this.paragraphs=[],this.refreshView()},e.prototype.onResizing=function(e){this.viewport=e,this.updateSize()},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(this.paragraphs=[],t&&t.length>0){var i=t[0].metadata.objects;i&&i.general&&(this.paragraphs=i.general.paragraphs)}this.refreshView()},e.prototype.destroy=function(){},e.prototype.focus=function(){return this.editor?(this.editor.focus(),!0):void 0},e.prototype.onViewModeChanged=function(e){this.readOnly=0===e,this.refreshView()},e.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t)},e.prototype.refreshView=function(){var t=this;if(this.readOnly){this.editor&&(this.saveContents(),this.editor.destroy(),this.editor=null),this.element.empty();var i=s.convertParagraphsToHtml(this.paragraphs);i.addClass(e.ClassName),i.css({"font-family":l.defaultFont,"font-size":l.defaultFontSize}),this.element.append(i)}else{if(!this.editor){this.editor=new l.QuillWrapper(this.readOnly,this.host),this.editor.textChanged=function(e,i){return t.saveContents()},this.element.empty();var a=this.editor.getElement();a.addClass(e.ClassName),a.css({"font-family":l.defaultFont,"font-size":l.defaultFontSize}),this.element.append(a)}this.editor.setContents(s.convertParagraphsToOps(this.paragraphs))}this.updateSize()},e.prototype.saveContents=function(){if(this.editor){var e=this.editor.getContents();this.paragraphs=s.convertDeltaToParagraphs(e);var t=[{objectName:"general",properties:{paragraphs:this.paragraphs},selector:null}];this.host.persistProperties(t)}},e.prototype.updateSize=function(){this.editor&&this.editor.resize(this.viewport)},e.ClassName="textbox",e}();t.Textbox=n;var s;!function(e){function t(e){for(var t=[],i={textRuns:[]},a=0,r=e.ops.length;r>a;a++){var s=e.ops[a];if("string"==typeof s.insert){var l=s.insert,c=s.attributes;c&&c.align&&(i.horizontalTextAlignment=c.align);var u=0,h=0,d=void 0;do{if(h=l.indexOf("\n",u),0>h?(d=!1,h=l.length):d=!0,h-u>0){var p=l.substring(u,h),g={value:p};if(c){void 0!==c.link&&o.isValidUrl(c.link)&&(g.url=c.link);var m=n(c);m&&(g.textStyle=m)}i.textRuns.push(g)}d&&(0===i.textRuns.length&&i.textRuns.push({value:""}),t.push(i),i={textRuns:[]}),u=h+1}while(u<l.length)}}return i.textRuns.length>0&&i.textRuns[0].value.length>0&&t.push(i),t}function i(e){for(var t=$(),i=0,a=e.length;a>i;++i){var r=e[i],n=!0,c=$("<div>");r.horizontalTextAlignment&&c.css("text-align",r.horizontalTextAlignment);for(var u=0,h=r.textRuns.length;h>u;++u){var d=r.textRuns[u],p=$("<span>"),g=d.textStyle;if(g){var m={};g.fontFamily&&(m["font-family"]=l.getCssFontFamily(s(g.fontFamily))),g.fontSize&&(m["font-size"]=g.fontSize),g.fontStyle&&(m["font-style"]=g.fontStyle),g.fontWeight&&(m["font-weight"]=g.fontWeight),g.textDecoration&&(m["text-decoration"]=g.textDecoration),p.css(m)}var f=d.value;if(_.isEmpty(f)||(n=!1),void 0!==d.url){var y=void 0;y=o.isValidUrl(d.url)?$("<a>").attr("href",d.url).attr("target","_blank").text(f):$("<span>").text(f),p.append(y)}else p.text(f);c.append(p)}n&&c.append($("<br>")),t=t.add(c)}return t}function a(e){for(var t=[],i=0,a=e.length;a>i;++i)for(var n=e[i],c=0,u=n.textRuns.length;u>c;++c){var h=n.textRuns[c],d={};n.horizontalTextAlignment&&(d.align=n.horizontalTextAlignment);var p=h.textStyle;p&&(p.fontFamily&&(d.font=l.getCssFontFamily(s(p.fontFamily))),p.fontSize&&(d.size=p.fontSize),d.italic="italic"===p.fontStyle,d.bold="bold"===p.fontWeight,d.underline="underline"===p.textDecoration);var g=h.value;h.url&&o.isValidUrl(h.url)&&(d.link=h.url);var m={insert:g,attributes:d};t.push(m),c!==u-1||r.endsWith(g,"\n")||t.push({insert:"\n",attributes:d})}return t}function n(e){var t={};if(e.bold&&(t.fontWeight="bold"),e.font){var i=s(e.font);i=l.getFontFamilyForBuiltInFont(i),t.fontFamily=i}return e.italic&&(t.fontStyle="italic"),e.size&&(t.fontSize=e.size),e.underline&&(t.textDecoration="underline"),t}function s(e){return r.startsWith(e,"'")?e.slice(1,e.length-1):e}e.convertDeltaToParagraphs=t,e.convertParagraphsToHtml=i,e.convertParagraphsToOps=a}(s||(s={}));var l;!function(t){function r(e){var t=n[e];return null==t&&(t=e),t}function o(e){var t=_.findKey(n,function(t){return t===e});return t||e}var n={"Segoe (Bold)":"wf_segoe-ui_bold","Segoe UI":"wf_segoe-ui_normal","Segoe UI Light":"wf_segoe-ui_light",Heading:"wf_segoe-ui_light",Body:"wf_segoe-ui_normal"},s=["Arial","Arial Black","Arial Unicode MS","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Georgia","Lucida Sans Unicode","Segoe (Bold)","Segoe UI","Segoe UI Light","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Wingdings"].map(function(e){return{label:e,value:r(e)}});t.defaultFont=r("Segoe UI Light");var l=["8","9","10","10.5","11","12","14","16","18","20","24","28","32","36","40","42","44","54","60","66","72","80","88","96"].map(function(e){return{label:e,value:e+"px"}});t.defaultFontSize="14px";var c=["Left","Center","Right"].map(function(e){return{label:e,value:e.toLowerCase()}});t.getCssFontFamily=r,t.getFontFamilyForBuiltInFont=o;var u=function(){function i(e,t){var a=this;this.QuillPackage={javaScriptFiles:i.quillJsFiles,cssFiles:i.quillCssFiles},this.textChanged=function(e,t){},this.host=t,this.$container=$("<div>"),this.readOnly=e,this.localizationProvider={get:function(e){return a.host.getLocalizedString(e)},getOptional:function(e){return a.host.getLocalizedString(e)}},this.dependenciesLoaded=$.Deferred(),i.loadQuillResources?(this.initialized=!1,this.dependenciesLoaded.done(function(){a.rebuildQuillEditor(),a.initialized=!0}),jsCommon.requires(this.QuillPackage,function(){return a.dependenciesLoaded.resolve()})):(this.rebuildQuillEditor(),this.initialized=!0,this.dependenciesLoaded.resolve())}return i.prototype.addModule=function(e,t){return this.editor?this.editor.addModule(e,t):void 0},i.prototype.getElement=function(){return this.$container},i.prototype.getContents=function(){return this.initialized?this.editor.getContents():void 0},i.prototype.setContents=function(e){var t=this;return this.initialized?(this.editor.setHTML("","api"),void(e&&this.editor.setContents(e,"api"))):void this.dependenciesLoaded.done(function(){return t.setContents(e)})},i.prototype.resize=function(e){this.$container.width(e.width),this.$container.height(e.height)},i.prototype.setReadOnly=function(e){var t=e!==this.readOnly;this.readOnly=e,this.initialized&&t&&this.rebuildQuillEditor()},i.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t,"api")},i.prototype.getSelection=function(){return this.editor?this.editor.getSelection():void 0},i.prototype.focus=function(){this.editor&&0===$(document.activeElement).closest(this.$container).length&&this.editor.focus()},i.prototype.destroy=function(){this.host.setToolbar(null),this.$container.remove(),this.$container=null,this.$toolbarDiv=null,this.$editorDiv=null,this.editor=null},i.prototype.getSelectionAtCursor=function(){var e=this.getTextWithoutTrailingBreak();this.editor.focus();var t=this.getSelection();return t&&t.start===t.end?jsCommon.WordBreaker.find(t.start,e):t},i.prototype.getWord=function(){var e=this.getSelectionAtCursor();return this.getTextWithoutTrailingBreak().slice(e.start,e.end)},i.prototype.insertLinkAtCursor=function(e,t){var i=t+e.length;return this.editor.insertText(t,e,"api"),this.editor.formatText(t,i,"link",e,"api"),this.setSelection(t,i),this.onTextChanged(null,null),i},i.prototype.getEditorContainer=function(){return this.editor?$(this.editor.container):void 0},i.prototype.getTextWithoutTrailingBreak=function(){return this.editor.getText().slice(0,-1)},i.prototype.rebuildQuillEditor=function(){var e=this,r=null;this.editor&&(this.editor.removeAllListeners(),r=this.editor.getContents()),this.$container.empty(),this.$container.keydown(function(e){e.ctrlKey&&a.isCtrlDefaultKey(e.which)&&e.stopPropagation(),a.isArrowKey(e.which)&&e.stopPropagation()});var o=this.$editorDiv=$("<div>");o.css("font-family",t.defaultFont),o.css("font-size",t.defaultFontSize);var n={readOnly:this.readOnly,formats:["bold","italic","underline","font","size","link","align"],styles:!1};if(this.editor=new Quill(o.get(0),n),!this.readOnly){var s=this.$toolbarDiv;s||(this.$toolbarDiv=s=h.buildToolbar(this,this.localizationProvider)),s.addClass("unselectable"),this.host.setToolbar(s),this.editor.addModule("toolbar",{container:s.get(0)}),o.attr("drag-resize-disabled","true")}this.$container.append(o),r&&this.setContents(r);var l=new jsCommon.ThrottleUtility(i.textChangeThrottle);this.editor.on("text-change",function(t,i){"api"!==i&&l.run(function(){return e.onTextChanged(t,i)})}),this.editor.root.addEventListener("blur",function(t){var i=t.relatedTarget||document.activeElement;i&&"SELECT"===i.tagName||"INPUT"===i.tagName||i.getAttribute("contentEditable")||e.setSelection(null,null)},!1)},i.prototype.onTextChanged=function(e,t){this.textChanged(e,t)},i.textChangeThrottle=200,i.loadQuillResources=!0,i.quillJsFiles=[e.build+"/externals/quill.min.js"],i.quillCssFiles=[e.build+"/externals/quill.base.css"],i}();t.QuillWrapper=u;var h;!function(e){function a(e,i){var a=n(i);e.addModule("link-tooltip",{template:a});var r=C(e,v("Link",i),i.get("RichTextbox_Link_DefaultText")),o=m(v("Font",i),s,"font",t.defaultFont,function(e,t){return e.css("font-family",t.value),e}),p=d().addClass("toolbar ql-toolbar").append(u().append(h(i.get("RichTextbox_Font_Label"))).append(o).append(m(v("Size",i),l,"size",t.defaultFontSize))).append(u().append(y(v("Bold",i),"bold")).append(y(v("Italic",i),"italic")).append(y(v("Underline",i),"underline"))).append(u().append(g("Text Alignment",c,"align","Left",i))).append(r);return p.on("mousedown",function(e){var t=e.target||document.activeElement;"INPUT"!==t.tagName&&"SELECT"!==t.tagName&&e.preventDefault()}),p}function r(e,t){e.val(t);var i=document.createEvent("UIEvent");i.initUIEvent("change",!1,!1,null,0),e.get(0).dispatchEvent(i)}function o(e,t){return $('\n                        <a href="#" class="url" target="_blank"></a>\n                        <input class="input" type="text">\n                        <span class="bar">&nbsp;|&nbsp;</span>\n                        <a class="change"></a>\n                        <a class="remove">'+e+'</a>\n                        <a class="done">'+t+"</a>\n                    ")}function n(e){var t=d(),i=e.get("RichTextbox_Link_Done"),a=e.get("RichTextbox_Link_Remove");return t.append(o(a,i)),t.html()}function u(){return p().addClass("ql-format-group").attr("drag-resize-disabled","true")}function h(e){return $("<label>").text(e)}function d(){return $("<div>")}function p(){return $("<span>")}function g(e,t,i,a,o){var n=v(e,o),s=p().attr("title",n).addClass("ql-toggle-group"),l=f(n,t,a).addClass("ql-picker ql-"+i).css("display","none"),c=t.map(function(e){var t=y(v(e.label,o),"align"+e.value).attr("data-value",e.value).click(function(t){return r(l,e.value)});return t});return l.change(function(e){for(var t=l.val(),i=0;i<c.length;i++)c[i].toggleClass("ql-active",c[i].attr("data-value")===t)}),s.append(l),s.append(c),s}function m(e,t,i,a,r){var o=f(e,t,a,r).addClass("ql-picker ql-"+i);return o}function f(e,t,i,a){for(var r=$("<select>").attr("title",e),o=0;o<t.length;o++){var n=t[o],s=$("<option>").attr("value",n.value).text(n.label);n.value===i&&s.attr("selected","selected"),void 0!==a&&(s=a(s,n)),r.append(s)}return r}function y(e,t){var i=p().addClass("ql-format-button");return null!=e&&i.attr("title",e),null!=t&&(i.addClass("ql-"+t),i.addClass("powervisuals-glyph "+t)),i}function v(e,t){return t.get("RichTextbox_"+e+"_ToolTip")}function b(e){e.removeClass("editing"),e.removeClass("blank-editing"),e.find(".input").val(S)}function C(t,i,a){var r=t.getEditorContainer().find(e.selectors.linkTooltip.selector),o=u().addClass(e.selectors.toolbarUrlInput["class"]).append(y(i,"link").append("<div>")).append(r);return o.on("keydown mousedown",function(e){if(e.keyCode===jsCommon.DOMConstants.enterKeyCode||e.target.classList.contains("done")){if(!r.hasClass("blank-editing"))return!0;var i=o.find(".input").val(),a=t.getSelectionAtCursor(),n=t.getWord();if(!n){var s=t.insertLinkAtCursor(i,a.start);return b(r),t.setSelection(s,s),!1}}}),o.find(".input").blur(function(e){var t=e.relatedTarget;(null===t||t&&!t.classList.contains("done"))&&b(r)}),o.find(".ql-link div").click(function(e){var i=e.target.parentElement;if(i&&i.classList.contains("ql-active"))return o.find(".change")[0].click(),!1;var a=t.getWord();if(!a){r.addClass("editing blank-editing");var n=o.find(".input").get(0);return n.value=S,n.selectionStart=n.selectionEnd=S.length,n.focus(),!1}}).mousedown(function(e){var i=e.target.parentElement;if(i&&!i.classList.contains("ql-active")){var a=t.getSelectionAtCursor();t.setSelection(a.start,a.end)}}),o}var S="http://";e.selectors={linkTooltip:i("ql-link-tooltip"),toolbarUrlInput:i("toolbar-url-input")},e.buildToolbar=a,e.setSelectValue=r}(h||(h={}))}(l=t.RichText||(t.RichText={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=t.utility.SelectionManager;t.cheerMeterProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}};var a=function(){function a(){this.isFirstTime=!0}return a.converter=function(i){if(!i.categorical||!i.categorical.categories)return null;var r=i.categorical.categories[0];if(!r)return null;var o=r.values;if(!o||_.isEmpty(i.categorical.values))return null;var n=i.categorical.values[0].values,s=i.categorical.categories[0].objects,l=s&&s.length>0?s[0]:void 0,c=s&&s.length>1?s[1]:void 0,u=i.metadata.objects,h=a.DefaultBackgroundColor;if(u){var d=u.general;if(d){var p=d.fill;p&&(h=p.solid.color)}}var g=e.DataViewObjects.getFillColor(l,t.cheerMeterProps.dataPoint.fill,a.DefaultFontColor),m=e.DataViewObjects.getFillColor(c,t.cheerMeterProps.dataPoint.fill,a.DefaultFontColor),f=t.SelectionIdBuilder.builder().withCategory(r,0).createSelectionId(),y=t.SelectionIdBuilder.builder().withCategory(r,1).createSelectionId(),v={teamA:{name:o[0],value:n[0],color:g,identity:f},teamB:{name:o[1],value:n[1],color:m,identity:y},background:h};return v},a.prototype.init=function(e){this.selectionManager=new i({hostServices:e.host});var t=this.svg=d3.select(e.element.get(0)).append("svg");this.textOne=t.append("text").style("font-family",a.DefaultFontFamily),this.textTwo=t.append("text").style("font-family",a.DefaultFontFamily)},a.prototype.update=function(e){if(e.dataViews[0]){var i=this.data=a.converter(e.dataViews[0]);if(i){var r=e.suppressAnimations?0:t.AnimatorCommon.MinervaAnimationDuration;this.draw(i,r,e.viewport)}}},a.prototype.getRecomendedFontProperties=function(t,i,r){for(var o,n={fontSize:"",fontFamily:a.DefaultFontFamily,text:t+i},s=1,l=1e3,c=r.width,u=0;l>=s;)if(o=(s+l)/2|0,n.fontSize=o+"px",u=e.TextMeasurementService.measureSvgTextWidth(n),c>u)s=o+1;else{if(!(u>c))break;l=o-1}return n.fontSize=o+"px",u=e.TextMeasurementService.measureSvgTextWidth(n),u>c&&(o--,n.fontSize=o+"px"),n},a.prototype.calculateLayout=function(t,i){var r=t.teamA.name,o=t.teamB.name,n={height:i.height,width:i.width-a.PaddingBetweenText},s=this.getRecomendedFontProperties(r,o,n);s.text=r;var l=0|e.TextMeasurementService.measureSvgTextWidth(s);s.text=o;var c=0|e.TextMeasurementService.measureSvgTextWidth(s),u=(i.width-l-c-a.PaddingBetweenText)/2|0;s.text=r+o;var h=0|e.TextMeasurementService.measureSvgTextHeight(s),d=t.teamA.value+t.teamB.value,p=i.height-h,g=(d-t.teamA.value)/d*p+h/2|0,m=(d-t.teamB.value)/d*p+h/2|0;return{x1:u,x2:u+l+a.PaddingBetweenText,y1:g,y2:m,fontSize:s.fontSize}},a.prototype.ensureStartState=function(e,t){if(this.isFirstTime){this.isFirstTime=!1;var i=t.height/2;this.textOne.attr({x:e.x1,y:i}),this.textTwo.attr({x:e.x2,y:i})}},a.prototype.clearSelection=function(){var e=this;this.selectionManager.clear().then(function(){e.clearSelectionUI()})},a.prototype.clearSelectionUI=function(){this.textOne.style("stroke","#FFF").style("stroke-width",0),this.textTwo.style("stroke","#FFF").style("stroke-width",0)},a.prototype.updateSelectionUI=function(e){this.textOne.style("stroke","#FFF").style("stroke-width",i.containsSelection(e,this.data.teamA.identity)?"2px":"0px"),this.textTwo.style("stroke","#FFF").style("stroke-width",i.containsSelection(e,this.data.teamB.identity)?"2px":"0px")},a.prototype.draw=function(e,t,i){var a=this,r="back",o=this.textOne,n=this.textTwo;this.svg.attr({height:i.height,width:i.width}).on("click",function(){a.clearSelection()}).style("background-color",e.background);var s=this.calculateLayout(e,i);this.ensureStartState(s,i),o.style("font-size",s.fontSize).style("fill",e.teamA.color).on("click",function(){a.selectionManager.select(e.teamA.identity,d3.event.ctrlKey).then(function(e){a.updateSelectionUI(e)}),d3.event.stopPropagation()}).text(e.teamA.name),n.style("font-size",s.fontSize).style("fill",e.teamB.color).on("click",function(){a.selectionManager.select(e.teamB.identity,d3.event.ctrlKey).then(function(e){a.updateSelectionUI(e)}),d3.event.stopPropagation()}).text(e.teamB.name),o.transition().duration(t).ease(r).attr({y:s.y1,x:s.x1}),n.transition().duration(t).ease(r).attr({y:s.y2,x:s.x2})},a.prototype.destroy=function(){this.svg=null,this.textOne=this.textTwo=null},a.prototype.enumerateObjectInstances=function(e){var t=[],i=this.data;switch(e.objectName){case"dataPoint":if(i)for(var r=[i.teamA,i.teamB],o=0;o<r.length;o++){var n=r[o],s=n.color,l=n.identity,c={objectName:"dataPoint",displayName:n.name,selector:l,properties:{fill:{solid:{color:s}}}};t.push(c)}break;case"general":var u={objectName:"general",displayName:"General",selector:null,properties:{fill:{solid:{color:i?i.background:a.DefaultBackgroundColor}}}};t.push(u)}return t},a.capabilities={dataRoles:[{displayName:"Category",name:"Category",kind:e.VisualDataRoleKind.Grouping},{displayName:"Noise Measure",name:"Y",kind:e.VisualDataRoleKind.Measure}],dataViewMappings:[{categorical:{categories:{"for":{"in":"Category"}},values:{select:[{bind:{to:"Y"}}]}}}],objects:{dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},width:{displayName:"",type:{numeric:!0}}}},general:{displayName:"General",properties:{fill:{displayName:"Background color",type:{fill:{solid:{color:!0}}}}}}}},a.DefaultFontFamily="cursive",a.DefaultFontColor="rgb(165, 172, 175)",a.DefaultBackgroundColor="#243C18",a.PaddingBetweenText=15,a}();t.CheerMeter=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.Color,a=jsCommon.CssConstants.createClassAndSelector,r=jsCommon.PixelConverter,o=e.data.DataRoleHelper,n=function(){function a(e){e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,this.interactivityService=e.interactivityService,this.animator=e.animator),this.renderer=new l}return a.prototype.init=function(e){this.options=e,this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.host=e.host,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend;var i=this.svg=e.svg;i.classed(a.ClassName+" "+t.PlayChart.ClassName,!0),this.renderer.init(i,e.labelsContext,this.isMobileChart,this.tooltipsEnabled)},a.getAdditionalTelemetry=function(e){var t={hasSize:o.hasRoleInDataView(e,"Size"),hasPlayAxis:o.hasRoleInDataView(e,"Play")};return t},a.getObjectProperties=function(i,a){var r;r=i&&i.metadata&&i.metadata.objects?i.metadata.objects:{};var o={};o.defaultDataPointColor=e.DataViewObjects.getFillColor(r,t.columnChartProps.dataPoint.defaultColor),o.showAllDataPoints=e.DataViewObjects.getValue(r,t.columnChartProps.dataPoint.showAllDataPoints,!1);var n=r.categoryLabels;n&&a&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(n,a);var s=i&&t.GradientUtils.hasGradientRole(i.categorical);return o.fillPoint=e.DataViewObjects.getValue(r,t.scatterChartProps.fillPoint.show,s),o.colorBorder=e.DataViewObjects.getValue(r,t.scatterChartProps.colorBorder.show,!1),o.colorByCategory=e.DataViewObjects.getValue(r,t.scatterChartProps.colorByCategory.show,!1),o},a.converter=function(i,r,o,n,s){void 0===n&&(n=!0);var l,c,u,h,d,p=e.data.createIDataViewCategoricalReader(i),g=r.viewport,m=r.colors,f=r.interactivityService,y=r.categoryAxisProperties,v=r.valueAxisProperties,b=i.categorical,C=t.GradientUtils.getGradientValueColumn(b);b.categories&&b.categories.length>0?(l=b.categories[0].values,c=t.valueFormatter.create({format:t.valueFormatter.getFormatString(b.categories[0].source,t.scatterChartProps.general.formatString),value:l[0],value2:l[l.length-1]}),h=b.categories[0].identity,u=b.categories[0].objects,d=b.categories[0].source.queryName):(l=[null],c=t.valueFormatter.createDefaultFormatter(null));var S=b.categories,x=b.values,w=!!x.source,P=x.grouped(),D=x.source,L=a.getMetadata(P,D),T=t.dataLabelUtils.getDefaultPointLabelSettings(),V=a.getSizeRangeForGroups(P,L.idx.size),M=a.getObjectProperties(i,T),N=a.createDataPointSeries(p,x,L,S,l,c,h,u,m,g,w,T,C,M.defaultDataPointColor,d,M.colorByCategory,o,n,s),A=_.reduce(N,function(e,t){return e.concat(t.dataPoints)},[]),O=w?a.createSeriesLegend(x,m,x,t.valueFormatter.getFormatString(D,t.scatterChartProps.general.formatString),M.defaultDataPointColor):[],I=x&&D?D.displayName:"";return I||(I=S&&S.length>0&&S[0].source.displayName?S[0].source.displayName:""),y&&null!==y.showAxisTitle&&y.showAxisTitle===!1&&(L.axesLabels.x=null),v&&null!==v.showAxisTitle&&v.showAxisTitle===!1&&(L.axesLabels.y=null),f&&(f.applySelectionStateToData(A),f.applySelectionStateToData(O)),{xCol:L.cols.x,yCol:L.cols.y,dataPoints:A,dataPointSeries:N,legendData:{title:I,dataPoints:O},axesLabels:L.axesLabels,size:L.cols.size,sizeRange:V,dataLabelsSettings:T,defaultDataPointColor:M.defaultDataPointColor,hasDynamicSeries:w,showAllDataPoints:M.showAllDataPoints,fillPoint:M.fillPoint,colorBorder:M.colorBorder,colorByCategory:M.colorByCategory}},a.getSizeRangeForGroups=function(e,i){var r={};return e&&e.forEach(function(e){var o=a.getMeasureValue(i,e.values),n=t.AxisHelper.getRangeForColumn(o);(null==r.min||r.min>n.min)&&(r.min=n.min),(null==r.max||r.max<n.max)&&(r.max=n.max)}),r},a.createDataPointSeries=function(e,i,r,o,n,s,l,c,u,h,d,p,g,m,f,y,v,b,C){var S=e.hasValues("X"),x=e.hasValues("Y");if(!S&&!x)return[];for(var w=[],P=r.idx,D=t.scatterChartProps.general.formatString,L=i.source,T=i.grouped(),V=new t.ColorHelper(u,t.scatterChartProps.dataPoint.fill,m),M=0,N=T.length;N>M;M++){var A=T[M],O=A.values,I=a.getMeasureValue(P.x,O),R=a.getMeasureValue(P.y,O),F=a.getMeasureValue(P.size,O),H=void 0;if(d)H=V.getColorForSeriesValue(A.objects,i.identityFields,A.name);else if(!y&&!c){var z=null!=F?F.source.queryName:"";H=V.getColorForMeasure(null,z)}var G={identityKey:A&&A.identity&&A.identity.key||"",dataPoints:[],hasSize:!(!F||!F.values),fill:H};w.push(G);for(var k=0,j=n.length;j>k;k++){var E=n[k],B=S?t.AxisHelper.normalizeNonFiniteNumber(e.getValue("X",k,M)):0,W=x?t.AxisHelper.normalizeNonFiniteNumber(e.getValue("Y",k,M)):0,U=t.AxisHelper.normalizeNonFiniteNumber(e.getValue("Size",k,M));if(null!=B&&null!=W){var Y=void 0;if(d)Y=V.getColorForSeriesValue(A.objects,i.identityFields,A.name);else if(y)Y=V.getColorForSeriesValue(c&&c[k],i.identityFields,E);else{var z=null!=F?F.source.queryName:"";Y=V.getColorForMeasure(c&&c[k],z)}var K=_.isEmpty(o)?null:o[0],X=t.SelectionIdBuilder.builder().withCategory(K,k).withSeries(i,A).createSelectionId(),q=void 0;if(b&&(q=[],K&&q.push({displayName:K.source.displayName,value:t.converterHelper.formatFromMetadataColumn(E,K.source,D)}),d&&(K&&K.source===L||q.push({displayName:L.displayName,value:t.converterHelper.formatFromMetadataColumn(A.name,L,D)})),I&&null!=B&&q.push({displayName:I.source.displayName,value:t.converterHelper.formatFromMetadataColumn(B,I.source,D)}),R&&null!=W&&q.push({displayName:R.source.displayName,value:t.converterHelper.formatFromMetadataColumn(W,R.source,D)}),F&&null!=F.values[k]&&q.push({displayName:F.source.displayName,value:t.converterHelper.formatFromMetadataColumn(F.values[k],F.source,D)}),g&&null!=g.values[k]&&q.push({displayName:g.source.displayName,value:t.converterHelper.formatFromMetadataColumn(g.values[k],g.source,D)}),v&&q.push({displayName:v.column.displayName,value:t.converterHelper.formatFromMetadataColumn(v.label,v.column,D)}),C)){var $=e.getAllValuesForRole("Tooltips",k,M),Q=e.getAllValueMetadataColumnsForRole("Tooltips",M);if($&&Q)for(var Z=0;Z<$.length;Z++)null!=$[Z]&&q.push({displayName:Q[Z].displayName,value:t.converterHelper.formatFromMetadataColumn($[Z],Q[Z],D)})}var J={x:B,y:W,size:U,radius:{sizeMeasure:F,index:k},fill:Y,formattedCategory:a.createLazyFormattedCategory(s,null!=o?E:A.name),selected:!1,identity:X,tooltipInfo:q,labelFill:p.labelColor};G.dataPoints.push(J)}}}return w},a.createLazyFormattedCategory=function(e,t){return new jsCommon.Lazy(function(){return e.format(t)})},a.createSeriesLegend=function(e,i,a,r,o){for(var n=e.grouped(),s=new t.ColorHelper(i,t.scatterChartProps.dataPoint.fill,o),l=[],c=0,u=n.length;u>c;c++){var h=n[c],d=s.getColorForSeriesValue(h.objects,e.identityFields,h.name);l.push({color:d,icon:t.LegendIcon.Circle,label:t.valueFormatter.format(h.name,r),identity:h.identity?t.SelectionId.createWithId(h.identity):t.SelectionId.createNull(),selected:!1})}return l},a.getBubbleRadius=function(e,t,i){var r=null,o=null,n=e.sizeMeasure;if(!n)return a.BubbleRadius;var s=t.min?t.min:0,l=t.max?t.max:0,c=Math.min(s,0),u=Math.max(l,0);if(r={minRange:c,maxRange:u,delta:u-c},o=a.getBubblePixelAreaSizeRange(i,a.MinSizeRange,a.MaxSizeRange),n.values){var h=n.values[e.index];if(null!=h)return a.projectSizeToPixels(h,r,o)/2}return a.BubbleRadius},a.getMeasureValue=function(e,t){return e>=0?t[e]:null},a.getMetadata=function(e,t){var i,a,r,n=o.getMeasureIndexOfRole(e,"X"),s=o.getMeasureIndexOfRole(e,"Y"),l=o.getMeasureIndexOfRole(e,"Size"),c="",u="";if(e&&e.length){var h=e[0];n>=0&&(i=h.values[n].source,c=h.values[n].source.displayName),s>=0&&(a=h.values[s].source,u=h.values[s].source.displayName),l>=0&&(r=h.values[l].source)}return{idx:{x:n,y:s,size:l},cols:{x:i,y:a,size:r},axesLabels:{x:c,y:u}}},a.getDefaultData=function(){return{xCol:void 0,yCol:void 0,dataPoints:[],dataPointSeries:[],legendData:{dataPoints:[]},axesLabels:{x:"",y:""},sizeRange:[],dataLabelsSettings:t.dataLabelUtils.getDefaultPointLabelSettings(),defaultDataPointColor:null,hasDynamicSeries:!1}},a.prototype.renderAtFrame=function(e){this.data=e,this.cartesianVisualHost.triggerRender(!1)},a.prototype.setData=function(e){var i=this;if(this.data=a.getDefaultData(),e.length>0){var r=e[0]||e[1];if(r){this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(r.metadata,!0),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(r.metadata,!0),this.dataView=r;var o={viewport:this.currentViewport,colors:this.colors,interactivityService:this.interactivityService,categoryAxisProperties:this.categoryAxisProperties,
valueAxisProperties:this.valueAxisProperties};if(t.PlayChart.isDataViewPlayable(r)){this.playAxis||(this.playAxis=new t.PlayAxis({animator:this.animator,interactivityService:this.interactivityService,isScrollable:!1}),this.playAxis.init(this.options));var n=this.playAxis.setData(r,function(e,t){return a.converter(e,o,t,i.tooltipsEnabled,i.tooltipBucketEnabled)});this.mergeSizeRanges(n),this.data=n.currentViewModel,this.playAxis.setRenderFunction(function(e){return i.renderAtFrame(e)})}else this.playAxis&&(this.playAxis.remove(),this.playAxis=null),r.categorical&&r.categorical.values&&(this.data=a.converter(r,o,void 0,this.tooltipsEnabled,this.tooltipBucketEnabled))}}else this.playAxis&&(this.playAxis.remove(),this.playAxis=null)},a.prototype.mergeSizeRanges=function(e){if(e&&e.currentViewModel){for(var t=e.currentViewModel.sizeRange,i=0,a=e.allViewModels;i<a.length;i++){var r=a[i],o=r.sizeRange;null!=o.min&&(t.min=Math.min(t.min,o.min)),null!=o.max&&(t.max=Math.max(t.max,o.max))}for(var n=0,s=e.allViewModels;n<s.length;n++){var l=s[n];l.sizeRange=t}}},a.prototype.calculateLegend=function(){return this.data&&this.data.legendData},a.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},a.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"colorByCategory":this.data&&(this.data.hasDynamicSeries||e.pushInstance({objectName:"colorByCategory",selector:null,properties:{show:this.data.colorByCategory}}));break;case"dataPoint":if(!this.playAxis){var a=this.dataView&&this.dataView.categorical?this.dataView.categorical:null;if(!t.GradientUtils.hasGradientRole(a))return this.enumerateDataPoints(e)}break;case"categoryAxis":e.pushInstance({selector:null,properties:{showAxisTitle:this.categoryAxisProperties&&null!=this.categoryAxisProperties.showAxisTitle?this.categoryAxisProperties.showAxisTitle:!0},objectName:"categoryAxis"});break;case"valueAxis":e.pushInstance({selector:null,properties:{showAxisTitle:this.valueAxisProperties&&null!=this.valueAxisProperties.showAxisTitle?this.valueAxisProperties.showAxisTitle:!0},objectName:"valueAxis"});break;case"categoryLabels":this.data?t.dataLabelUtils.enumerateCategoryLabels(e,this.data.dataLabelsSettings,!0):t.dataLabelUtils.enumerateCategoryLabels(e,null,!0);break;case"fillPoint":if(this.hasSizeMeasure())return;e.pushInstance({objectName:"fillPoint",selector:null,properties:{show:this.data.fillPoint}});break;case"colorBorder":this.hasSizeMeasure()&&e.pushInstance({objectName:"colorBorder",selector:null,properties:{show:this.data.colorBorder}})}},a.prototype.hasSizeMeasure=function(){var e=this.data.sizeRange;return e&&void 0!==e.min},a.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.dataPoints.length;if(i.hasDynamicSeries)for(var r=i.legendData.dataPoints.length,o=0;r>o;o++){var n=i.legendData.dataPoints[o];e.pushInstance({objectName:"dataPoint",displayName:n.label,selector:t.ColorHelper.normalizeSelector(n.identity.getSelector()),properties:{fill:{solid:{color:n.color}}}})}else{e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:i.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!i.showAllDataPoints}});for(var o=0;a>o;o++){var s=i.dataPoints[o];e.pushInstance({objectName:"dataPoint",displayName:s.formattedCategory.getValue(),selector:t.ColorHelper.normalizeSelector(s.identity.getSelector(),!0),properties:{fill:{solid:{color:s.fill}}}})}}}},a.prototype.supportsTrendLine=function(){var e=this.data;return e?!this.hasSizeMeasure()&&e.dataPointSeries.length>0:!1},a.getExtents=function(e){var t=e.dataPoints;return _.isEmpty(t)?{minY:0,maxY:0,minX:0,maxX:0}:{minY:d3.min(t,function(e){return e.y}),maxY:d3.max(t,function(e){return e.y}),minX:d3.min(t,function(e){return e.x}),maxX:d3.max(t,function(e){return e.x})}},a.prototype.calculateAxesProperties=function(e){var i=this.data,r=this.currentViewport=e.viewport,o=e.margin;this.currentViewport=r,this.margin=o;var n=r.width-(o.left+o.right),s=r.height-(o.top+o.bottom),l={minY:0,maxY:10,minX:0,maxX:10};this.playAxis?(l=this.playAxis.getCartesianExtents(l,a.getExtents),this.playAxis.setPlayControlPosition(e.playAxisControlLayout)):_.isEmpty(i.dataPoints)||(l=a.getExtents(i));var c=[l.minX,l.maxX],u=t.AxisHelper.combineDomain(e.forcedXDomain,c,e.ensureXDomain);this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:n,dataDomain:u,metaDataColumn:i.xCol,formatString:t.valueFormatter.getFormatString(i.xCol,t.scatterChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!0,scaleType:e.categoryAxisScaleType,axisDisplayUnits:e.categoryAxisDisplayUnits,axisPrecision:e.categoryAxisPrecision}),this.xAxisProperties.axis.tickSize(-s,0),this.xAxisProperties.axisLabel=this.data.axesLabels.x;var h=t.AxisHelper.combineDomain(e.forcedYDomain,[l.minY,l.maxY],e.ensureYDomain);return this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:s,dataDomain:h,metaDataColumn:i.yCol,formatString:t.valueFormatter.getFormatString(i.yCol,t.scatterChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:e.valueAxisScaleType,axisDisplayUnits:e.valueAxisDisplayUnits,axisPrecision:e.valueAxisPrecision}),this.yAxisProperties.axisLabel=this.data.axesLabels.y,[this.xAxisProperties,this.yAxisProperties]},a.prototype.overrideXScale=function(e){this.xAxisProperties=e},a.prototype.render=function(i,r){if(this.data){var o=this.data,n=this.margin,l=this.currentViewport,c=this.interactivityService&&this.interactivityService.hasSelection(),u={width:l.width-(n.left+n.right),height:l.height-(n.top+n.bottom)},h=t.AnimatorCommon.GetAnimationDuration(this.animator,i);this.playAxis&&this.playAxis.isCurrentlyPlaying()&&(this.isMobileChart||h>0)&&(h=t.PlayChart.FrameAnimationDuration);var d=this.playAxis?"linear":"cubic-in-out",p=(!o.sizeRange||!o.sizeRange.min)&&o.fillPoint,g=this.hasSizeMeasure(),m=1===r&&o.dataPoints&&o.dataPoints.length>a.NoRenderResizeThreshold,f={data:o,drawBubbles:g,isPlay:!!this.playAxis,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,viewport:u,hasSelection:c,animationDuration:h,animationOptions:this.options.animation,fillMarkers:p,easeType:d,suppressDataPointRendering:m};if(g){var y=o.dataPoints.sort(a.sortBubbles);f.data=e.Prototype.inherit(f.data),f.data.dataPoints=y}var v=[];(o.dataLabelsSettings&&o.dataLabelsSettings.show||o.dataLabelsSettings.showCategory)&&(v=s.createLabelDataPoints(f));var b=this.renderer.render(f,this.interactivityService);this.isMobileChart&&(b={data:b.data,dataPointsSelection:b.dataPointsSelection,eventGroup:b.eventGroup,plotContext:b.plotContext,host:this.cartesianVisualHost,root:this.svg,visualInitOptions:this.options,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,background:d3.select(this.element.get(0))});var C;if(this.playAxis&&(C=this.playAxis.render(i,f,l,n),this.interactivityService)){var S={traceLineRenderer:this.renderer.createTraceLineRenderer(C.viewModel)};c&&t.PlayChart.renderTraceLines(C.allDataPoints,S.traceLineRenderer,!i),b.playOptions=S}return{dataPoints:C?C.allDataPoints:o.dataPoints,behaviorOptions:b,labelDataPoints:v,labelsAreNumeric:!1}}},a.getStrokeFill=function(e,t){if(null!=e.size&&t){var r=i.parseColorString(e.fill);return i.hexString(i.darken(r,a.StrokeDarkenColorValue))}return e.fill},a.getBubblePixelAreaSizeRange=function(e,t,i){var r=1;if(e.height>0&&e.width>0){var o=Math.min(e.height,e.width);r=o*o/a.AreaOf300By300Chart}var n=Math.round(t*r),s=Math.round(i*r);return{minRange:n,maxRange:s,delta:s-n}},a.project=function(e,t,i){if(0===t.delta||0===i.delta)return a.rangeContains(t,e)?i.minRange:null;var r=(e-t.minRange)/t.delta;return i.minRange+r*i.delta},a.projectSizeToPixels=function(e,t,i){var r=0;if(t){if(r=i.maxRange,0!==t.delta){var o=Math.min(Math.max(e,t.minRange),t.maxRange);r=a.project(o,t,i)}r=2*Math.sqrt(r/Math.PI)}return Math.round(r)},a.rangeContains=function(e,t){return e.minRange<=t&&t<=e.maxRange},a.getMarkerFillOpacity=function(e,t,i,r){return e||t?i&&!r?a.DimmedBubbleOpacity:a.DefaultBubbleOpacity:0},a.getMarkerStrokeOpacity=function(e,t,i,r){return e&&t?1:i&&!r?a.DimmedBubbleOpacity:a.DefaultBubbleOpacity},a.getMarkerStrokeFill=function(e,t,r){if(e&&t){var o=i.parseColorString(r);return i.hexString(i.darken(o,a.StrokeDarkenColorValue))}return r},a.getMarkerStyle=function(e,t,i,r){return{"stroke-opacity":a.getMarkerStrokeOpacity(null!=e.size,t,i,e.selected),stroke:a.getMarkerStrokeFill(null!=e.size,t,e.fill),fill:e.fill,"fill-opacity":a.getMarkerFillOpacity(null!=e.size,r,i,e.selected)}},a.getSeriesStyle=function(e,t,i,r,o){return{"stroke-opacity":a.getMarkerStrokeOpacity(e,t,i,!1),stroke:a.getMarkerStrokeFill(e,t,o),fill:o,"fill-opacity":a.getMarkerFillOpacity(e,r,i,!1)}},a.getBubbleOpacity=function(e,t){return t&&!e.selected?a.DimmedBubbleOpacity:a.DefaultBubbleOpacity},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.prototype.getSupportedCategoryAxisType=function(){return t.axisType.scalar},a.sortBubbles=function(e,t){var i=t.radius.sizeMeasure.values[t.radius.index]-e.radius.sizeMeasure.values[e.radius.index];return 0!==i?i:t.identity.getKey().localeCompare(e.identity.getKey())},a.BubbleRadius=6,a.DefaultBubbleOpacity=.85,a.DimmedBubbleOpacity=.4,a.StrokeDarkenColorValue=63.75,a.dataLabelLayoutStartingOffset=2,a.dataLabelLayoutOffsetIterationDelta=6,a.dataLabelLayoutMaximumOffset=a.dataLabelLayoutStartingOffset+2*a.dataLabelLayoutOffsetIterationDelta,a.AreaOf300By300Chart=9e4,a.MinSizeRange=200,a.MaxSizeRange=3e3,a.ClassName="scatterChart",a.NoAnimationThreshold=1e3,a.NoRenderResizeThreshold=1e3,a}();t.ScatterChart=n;var s,l=function(){function e(){}return e.prototype.init=function(t,i,a,r){this.mainGraphicsG=t.append("g").classed(e.MainGraphicsContext["class"],!0),this.isMobileChart=a,a&&(this.mainGraphicsBackgroundRect=this.mainGraphicsG.append("rect").classed("backgroundRect",!0).attr({width:"100%",height:"100%"})),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.labelGraphicsContext=i,this.tooltipsEnabled=r,this.mainGraphicsContext.attr("stroke-width","1")},e.prototype.render=function(e,i){var a=e.viewport;this.mainGraphicsContext.attr({width:a.width,height:a.height});var r;return r=e.suppressDataPointRendering?this.removeScatterMarkers():e.animationDuration>0&&e.data.dataPoints.length<=n.NoAnimationThreshold?this.drawScatterMarkers(e):this.drawScatterMarkersNoAnimation(e,e.drawBubbles),e.drawBubbles&&r.order(),this.tooltipsEnabled&&t.TooltipManager.addTooltip(this.mainGraphicsContext,function(e){return e.data.tooltipInfo}),t.SVGUtil.flushAllD3TransitionsIfNeeded(e.animationOptions),{dataPointsSelection:r,eventGroup:this.mainGraphicsG,data:e.data,plotContext:this.mainGraphicsContext}},e.prototype.createTraceLineRenderer=function(e){return new c(e,this.mainGraphicsContext,this.tooltipsEnabled)},e.prototype.removeScatterMarkers=function(){return this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).remove(),this.mainGraphicsContext.selectAll(e.DotClass.selector)},e.prototype.drawScatterMarkers=function(t){var i=t.data,a=t.xAxisProperties.scale,r=t.yAxisProperties.scale,o=[{identityKey:"",dataPoints:i.dataPoints}],s=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(o,function(e){return e.identityKey});s.enter().append("g").classed(e.ScatterMarkerSeriesGroup["class"],!0),s.exit().remove();var l=s.selectAll(e.DotClass.selector).data(function(e){return e.dataPoints},function(e){return e.identity.getKey()});return l.enter().append("circle").classed(e.DotClass["class"],!0).style("opacity",0).attr("r",0),l.style({"stroke-opacity":function(e){return n.getMarkerStrokeOpacity(null!=e.size,i.colorBorder,t.hasSelection,e.selected)},stroke:function(e){return n.getStrokeFill(e,i.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return n.getMarkerFillOpacity(null!=e.size,t.fillMarkers,t.hasSelection,e.selected)}}).transition().ease(t.easeType).duration(t.animationDuration).style("opacity",1).attr({r:function(e){return n.getBubbleRadius(e.radius,i.sizeRange,t.viewport)},cx:function(e){return a(e.x)},cy:function(e){return r(e.y)}}),l.exit().transition().ease(t.easeType).duration(t.animationDuration).style("opacity",0).attr("r",0).remove(),l},e.prototype.drawScatterMarkersNoAnimation=function(t,i){var a,r=t.data,o=t.xAxisProperties.scale,s=t.yAxisProperties.scale;if(i){var l=[{identityKey:"",dataPoints:r.dataPoints}];a=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(l,function(e){return e.identityKey})}else a=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(r.dataPointSeries,function(e){return e.identityKey});return a.enter().append("g").classed(e.ScatterMarkerSeriesGroup["class"],!0),a.exit().remove(),a.each(function(i){var a=n.getSeriesStyle(i.hasSize,r.colorBorder,t.hasSelection,t.fillMarkers,i.fill),l=d3.select(this);e.applyStyle(this,a);var c=l.selectAll(e.DotClass.selector).data(i.dataPoints,function(e){return e.identity.getKey()});c.enter().append("circle").classed(e.DotClass["class"],!0),c.exit().remove(),c.each(function(i){var o=n.getMarkerStyle(i,r.colorBorder,t.hasSelection,t.fillMarkers);e.styleException(o,a),e.applyStyle(this,o)}),c.attr({r:function(e){return n.getBubbleRadius(e.radius,r.sizeRange,t.viewport)},cx:function(e){return o(e.x)},cy:function(e){return s(e.y)}})}),this.mainGraphicsContext.selectAll(e.DotClass.selector)},e.styleException=function(e,t){if(t)for(var i in e)e[i]===t[i]&&(e[i]=null)},e.applyStyle=function(e,t){for(var i in t){var a=e.style[i],r=t[i];if(null==r){if(""===a)continue}else if(r=r.toString(),r===a)continue;e.style[i]=r}},e.DotClass=a("dot"),e.MainGraphicsContext=a("mainGraphicsContext"),e.ScatterMarkerSeriesGroup=a("scatterMarkerSeriesGroup"),e}();!function(i){function a(i){for(var a=i.xAxisProperties.scale,s=i.yAxisProperties.scale,l=i.data.sizeRange,c=[],u=i.data.dataPoints,p=i.data.dataLabelsSettings,g=o(i),m=0,f=u;m<f.length;m++){var y=f[m],v=y.formattedCategory.getValue(),b={text:v,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:r.fromPoint(p.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},C=e.TextMeasurementService.measureSvgTextWidth(b),S=e.TextMeasurementService.estimateSvgTextHeight(b);c.push({isPreferred:g?h(y.identity.getKey(),g):!1,text:v,textSize:{width:C,height:S},outsideFill:p.labelColor?p.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,parentShape:{point:{x:a(y.x),y:s(y.y)},radius:n.getBubbleRadius(y.radius,l,i.viewport),validPositions:d},identity:y.identity,fontSize:p.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}return c}function o(e){var i=e.viewport.width,a=e.viewport.height,r=new t.Point(i/2,a/2),o=s(i,a);return l(r,o,e)}function s(e,i){var a=[],r=e/4,o=i/4;return a.push(new t.Point(r,o)),a.push(new t.Point(3*r,o)),a.push(new t.Point(r,3*o)),a.push(new t.Point(3*r,3*o)),a}function l(e,t,i){for(var a,r=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],o=[],n=i.xAxisProperties.scale,s=i.yAxisProperties.scale,l=0,h=i.data.dataPoints;l<h.length;l++){var d=h[l],p=n(d.x),g=s(d.y),m=c(p,g,e);i.drawBubbles?o[m]||(o[m]=d.identity):(a=u(t[m].x,t[m].y,p,g),a<r[m]&&(o[m]=d.identity,r[m]=a))}for(var f=[],y=0,v=o;y<v.length;y++){var b=v[y];b&&f.push(b.getKey())}return f}function c(e,t,i){return e>i.x&&t<=i.y?0:e<=i.x&&t<=i.y?1:e<=i.x&&t>i.y?2:3}function u(e,t,i,a){return Math.sqrt((e-i)*(e-i)+(t-a)*(t-a))}function h(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(0===e.localeCompare(r))return!0}return!1}var d=[2,1,8,4,16,32,64,128];i.createLabelDataPoints=a}(s||(s={}));var c=function(){function e(e,t,i){this.viewModel=e,this.element=t,this.tooltipsEnabled=i}return e.prototype.remove=function(){this.element.selectAll(e.TraceLine.selector).remove(),this.element.selectAll(e.TraceBubble.selector).remove()},e.prototype.render=function(i,a){var r=this.viewModel,o=r.viewModel,s=[];if(_.isEmpty(i)||o.suppressDataPointRendering)this.remove();else{for(var l=r.data.currentFrameIndex,c=[],u=0,h=i.length;h>u;u++){s[u]=[],c[u]=!1;for(var d=0,p=r.data.allViewModels.length;p>d&&l>=d;d++){var g=_.find(r.data.allViewModels[d].dataPoints,function(e,t){return e.identity.getKey()===i[u].identity.getKey()});null!=g&&(g.frameIndex=d,s[u].push(g),d===l&&(c[u]=!0))}}var m=o.xAxisProperties.scale,f=o.yAxisProperties.scale,y=d3.svg.line().x(function(e){return m(e.x)}).y(function(e){return f(e.y)}).defined(function(e){return null!==e.x&&null!==e.y}),v=this.element.selectAll(e.TraceLine.selector).data(i,function(e){return e.identity.getKey()});v.enter().append("path").classed(e.TraceLine["class"],!0);var b=[],C=[],S=!1;v.each(function(e,t){var i=this,a=i.hasAttribute("d")?i.getTotalLength():0;b.push(a);var r=$("<svg><path></path></svg>"),o=$("path",r);o.attr("d",y(s[t]));var n=s[t].length>0?o.get()[0].getTotalLength():0;C.push(n),S=S||a>n}),S?a?v.transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).attr("stroke-dashoffset",function(e,t){return b[t]-C[t]}).transition().ease("linear").duration(1).delay(t.PlayChart.FrameAnimationDuration).style("stroke",function(e){return n.getStrokeFill(e,!0)}).attr({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return C[t]+" "+C[t]},"stroke-dashoffset":0}):v.style("stroke",function(e){return n.getStrokeFill(e,!0)}).attr({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return C[t]+" "+C[t]},"stroke-dashoffset":0}):(v.style("stroke",function(e){return n.getStrokeFill(e,!0)}).attr({d:function(e,t){return y(s[t])},"stroke-dasharray":function(e,t){return C[t]+" "+C[t]},"stroke-dashoffset":function(e,t){return C[t]-b[t]}}),a?v.transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).attr("stroke-dashoffset",0):v.attr("stroke-dashoffset",0)),v.exit().remove();for(var x=[],w=0;w<s.length;w++){var P=s[w],D=c[w]?P.slice(0,P.length-1):P;x=x.concat(D)}var L=this.element.selectAll(e.TraceBubble.selector).data(x,function(e){return e.identity.getKey()+e.x+e.y+e.size});L.enter().append("circle").style("opacity",0).classed(e.TraceBubble["class"],!0),L.attr("cx",function(e){return m(e.x)}).attr("cy",function(e){return f(e.y)}).attr("r",function(e){return n.getBubbleRadius(e.radius,r.data.currentViewModel.sizeRange,r.viewport)}).style({"stroke-opacity":function(e){return n.getBubbleOpacity(e,!0)},stroke:function(e){return n.getStrokeFill(e,r.data.currentViewModel.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return null!=e.size?.2+e.frameIndex/l*.6:0}}).transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).style("opacity",1),L.exit().transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).style("opacity",0).remove(),this.tooltipsEnabled&&t.TooltipManager.addTooltip(L,function(e){return e.data.tooltipInfo}),L.sort(function(e,t){return t.size-e.size})}},e.TraceLine=a("traceLine"),e.TraceBubble=a("traceBubble"),e}()}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants.createClassAndSelector,a=e.data.createDataViewScopeIdentity,r=e.data.DataViewConcatenateCategoricalColumns,o=e.data.utils.DataViewMatrixUtils,n=e.data.SQExprBuilder,s=function(){function t(e){e&&(this.interactivityService=e.interactivityService)}return t.prototype.init=function(e){var t=this;this.element=e.element,this.svg=e.svg,this.host=e.host,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService&&(this.playControl=new c(this.element,function(e){return t.moveToFrameAndRender(e)},this.isMobileChart),this.playControl.onPlay(function(){return t.play()}))},t.prototype.setData=function(e,t){if(e){if(this.ridiculousFlagForPersistProperties&&e.metadata)return this.ridiculousFlagForPersistProperties=!1,this.playData;e.matrix||e.categorical?this.playData=l.converter(e,t):this.playData=l.getDefaultPlayData()}else this.playData=l.getDefaultPlayData();return this.lastViewport=void 0,this.playData},t.prototype.render=function(e,t,i,a){var r=this.playData,o=!this.lastViewport||this.lastViewport.height!==i.height||this.lastViewport.width!==i.width;if(this.lastViewport=i,o&&this.stop(),r){var n={data:this.playData,viewModel:t,viewport:i},s=!1;if(this.interactivityService){var l=r.currentViewModel;this.interactivityService.applySelectionStateToData(l.dataPoints),s=this.interactivityService.hasSelection()}this.updateCallout(i,a),this.playControl&&o&&this.playControl.rebuild(r,i);var c=r.allViewModels.map(function(e){return e.dataPoints}),u=_.flatten(c);return{allDataPoints:u,viewModel:n}}},t.prototype.updateCallout=function(i,a){var r=this.playData,o=r.frameData,n=r.currentFrameIndex,s=i.height,l=s-a.top-a.bottom,c=i.width,u=c-a.left-a.right,h=Math.min(s,1.3*c),d=Math.max(12,Math.round(h/7));d=Math.min(d,70);var p={fontSize:jsCommon.PixelConverter.toString(d),text:o[n].text||"",fontFamily:"wf_segoe-ui_normal"},g=e.TextMeasurementService.estimateSvgTextHeight(p)-e.TextMeasurementService.estimateSvgTextBaselineDelta(p),m=[];if(n<o.length&&n>=0&&l>g){var f=u-2*t.calloutOffsetMultiplier*g,y=e.TextMeasurementService.getTailoredTextOrDefault(p,f);m=[y]}var v=this.svg.selectAll(t.PlayCallout.selector).data(m);v.enter().append("text").classed(t.PlayCallout["class"],!0),v.text(function(e){return e}).attr({x:u-t.calloutOffsetMultiplier*g,y:function(){return g}}).style({"font-size":d+"px","text-anchor":"end"}),v.exit().remove()},t.prototype.play=function(){var e=this.playData;if(this.isPlaying)this.stop();else if(this.playControl){this.isPlaying=!0,this.playControl.play();var t=Math.round(this.playControl.getCurrentIndex());t>=e.allViewModels.length-1?e.currentFrameIndex=-1:e.currentFrameIndex=t-1,this.playNextFrame(e)}},t.prototype.playNextFrame=function(e,t,i){var a=this;if(!this.isPlaying)return void this.stop();var r=e.currentFrameIndex+1;null!=t&&null!=i&&(r=Math.abs(i-t+1),t=r),r<e.allViewModels.length&&r>-1?(e.currentFrameIndex=r,e.currentViewModel=e.allViewModels[r],this.renderDelegate(e.currentViewModel),this.playControl.setFrame(r),r<e.allViewModels.length&&window.setTimeout(function(){a.playNextFrame(e,t,i)},l.FrameStepDuration)):this.stop()},t.prototype.stop=function(){this.playControl&&this.playControl.pause(),this.isPlaying=!1},t.prototype.remove=function(){this.playControl&&this.playControl.remove(),d3.selectAll(t.PlayCallout.selector).remove()},t.prototype.setRenderFunction=function(e){this.renderDelegate=e},t.prototype.getCartesianExtents=function(e,t){return this.playData&&this.playData.allViewModels&&this.playData.allViewModels.length>0?l.getMinMaxForAllFrames(this.playData,t):e},t.prototype.setPlayControlPosition=function(e){if(this.playControl){var t=this.playControl.getContainer();t.css("left",e.left?e.left+"px":""),t.css("top",e.top?e.top+"px":"")}},t.prototype.moveToFrameAndRender=function(e){var t=this.playData;if(this.isPlaying=!1,t&&e>=0&&e<t.allViewModels.length&&e!==t.currentFrameIndex){t.currentFrameIndex=e;var i=t.allViewModels[e];t.currentViewModel=i,this.renderDelegate(i)}},t.prototype.isCurrentlyPlaying=function(){return this.isPlaying},t.PlayCallout=i("play-callout"),t.calloutOffsetMultiplier=.3,t}();t.PlayAxis=s;var l,c=function(){function e(e,t,i){this.isMobileChart=i,this.createSliderDOM(e),this.renderDelegate=t}return e.prototype.getContainer=function(){return this.playAxisContainer},e.prototype.remove=function(){this.playAxisContainer&&this.playAxisContainer.remove()},e.prototype.pause=function(){this.playButton.removeClass("pause").addClass("play")},e.prototype.play=function(){this.playButton.removeClass("play").addClass("pause")},e.prototype.getCurrentIndex=function(){return Math.round(this.noUiSlider.get())},e.prototype.onPlay=function(e){this.playButtonCircle.off("click"),this.playButtonCircle.on("click",e)},e.prototype.setFrame=function(e){this.noUiSlider.set([e])},e.prototype.rebuild=function(t,i){var a=this,r=this.slider;this.noUiSlider&&this.noUiSlider.destroy();var o=t.labelData,n=e.calucalateSliderSize(o,i.width),s=this.getContainer();n.marginLeft>e.SliderMarginLeft&&(s.css("padding-left",n.marginLeft-e.SliderMarginLeft+"px"),s.css("box-sizing","border-box"));var l=this.updateSliderControl(t,n.width),c=e.adjustWidthRegardingLastItem(o,l,n.width);this.slider.css("width",c+"px"),this.noUiSlider.on("slide",function(){var e=a.getCurrentIndex();a.renderDelegate(e)});var u=0;$(".noUi-value",r).each(function(e,t){var i=o.labelInfo[u].labelWidth;$(t).width(i),$(t).css("margin-left",-i/2+"px"),u+=l})},e.prototype.updateSliderControl=function(t,i){var a=t.labelData,r=this.slider.get(0),o=t.frameData.length,n={start:0===o?0:t.currentFrameIndex,step:1,range:{min:0,max:0===o?0:o-1}},s=null,l=0;if(o>0){var c=e.createPipsFilterFn(t,i,a);l=c.skipStep,s={mode:"steps",density:Math.ceil(100/o),format:{to:function(e){return t.frameData[e].escapedText},from:function(e){return t.frameData.indexOf(e)}},filter:c.filter}}return n.pips=s,noUiSlider.create(r,n),this.noUiSlider=r.noUiSlider,l},e.createPipsFilterFn=function(e,t,i){var a=_.max(_.map(i.labelInfo,function(e){return e.labelWidth})),r=1,o=1,n=e.frameData.length>1?t/(e.frameData.length-1):t,s=a/n;s>1.25?(o=Math.ceil(s),r=2):(s>1||i.anyWordBreaks)&&(r=2);var l=function(e,t){return e%o===0?r:0};return{filter:l,skipStep:o}},e.adjustWidthRegardingLastItem=function(t,i,a){var r=t.labelInfo.length,o=Math.floor((r-1)/i)*i,n=a+e.SliderMarginRight-a/r*(o+1),s=t.labelInfo[o].labelWidth,l=s/2-n;if(l>0){var c=e.SliderMaxMargin-e.SliderMarginRight;return l=l>c?c:l,a-l}return a},e.prototype.createSliderDOM=function(t){this.playAxisContainer=$('<div class="play-axis-container"></div>').appendTo(t).css("height",e.PlayControlHeight+"px"),this.playButtonCircle=$('<div class="button-container"></div>').appendTo(this.playAxisContainer),this.isMobileChart&&this.playButtonCircle.addClass("mobile-button-container"),this.playButton=$('<div class="play"></div>').appendTo(this.playButtonCircle),this.slider=$('<div class="sliders"></div>').appendTo(this.playAxisContainer)},e.calucalateSliderSize=function(t,i){var a=0;_.isEmpty(t.labelInfo)||(a=_.first(t.labelInfo).labelWidth/2);var r=Math.max(a,e.SliderMarginLeft);r=Math.min(e.SliderMaxMargin,r);var o=Math.max(i-r-e.SliderMarginRight,1);return{width:o,marginLeft:r}},e.SliderMarginLeft=44,e.SliderMarginRight=20,e.SliderMaxMargin=100,e.PlayControlHeight=80,e}();!function(i){function s(i,a){var n=i.matrix,s={categories:[],values:e.data.DataViewTransform.createValueColumns()};if(_.isEmpty(n.columns.levels)||n.rows.levels.length<2&&n.columns.levels.length<2)return{metadata:i.metadata,categorical:s};for(var c=1,u=[],h=c,d=n.rows.levels.length;d>h;h++){var p=n.rows.levels[h].sources[0];u.push({source:p,values:[],identity:[],objects:void 0})}var g=!_.isEmpty(n.rows.root.children),m=!_.isEmpty(n.columns.root.children),f=n.columns.levels.length>1&&m,y=n.rows.levels.length>1&&g;if(f&&!y){s.categories=void 0;var v=n.columns.root;s.values.source=n.columns.levels[0].sources[0];for(var b=n.valueSources.length,C=0,S=v.children.length;S>C;C++)for(var x=v.children[C],w=0;b>w;w++){var P=_.create(n.valueSources[w],{groupName:void 0===x.value?null:x.value}),D={identity:x.identity,values:[],source:P};s.values.push(D)}for(var L=n.rows.root.children[a],T=L.values,V=0,M=v.children.length;M>V;V++)for(var w=0;b>w;w++)s.values[V*b+w].values.push(T[V*b+w].value)}else if(f&&g){var L=n.rows.root.children[a];o.forEachLeafNode(L.children,function(e,t,i){l(i,u)}),s.categories=u,s.values.source=n.columns.levels[0].sources[0];for(var N=[],x=n.columns.root,A=-1;x;){if(x.children&&x.children[0].children)for(var w=0,O=x.children.length;O>w;w++)N.push(x.children[w]);else if(x.children&&L.children){for(var I=x.children.length,w=0;I>w;w++){var P=_.create(n.valueSources[w],{groupName:x.value}),D={identity:x.identity,values:[],source:P};s.values.push(D)}o.forEachLeafNode(L.children,function(e){for(var t=0;I>t;t++)s.values[A*I+t].values.push(e.values[A*I+t].value)})}N.length>0?(x=N[0],N=N.splice(1),A++):x=void 0}}else if(y){for(var L=n.rows.root.children[a],R=n.valueSources.length,w=0;R>w;w++){var D={identity:void 0,values:[],source:n.valueSources[w]};s.values.push(D)}o.forEachLeafNode(L.children,function(e,t,i){l(i,u);for(var a=0;R>a;a++)s.values[a].values.push(e.values[a].value)}),s.categories=u}return r.applyToPlayChartCategorical(i.metadata,t.scatterChartCapabilities.objects,"Category",s)}function l(e,t){var i=e[0].identity;if(e.length>1){for(var r=i.expr,o=1,s=e.length;s>o;o++){var l=e[o].identity.expr;r=n.and(r,l)}i=a(r)}for(var c=0,u=t.length;u>c;c++){t[c].identity.push(i);var h=e[c];t[c].values.push(h.value)}}function c(i,a){var r={};if(i&&i.objects){var o=i.objects;r.currentFrameIndex=e.DataViewObjects.getValue(o,t.scatterChartProps.currentFrameIndex.index,null)}return r}function u(e,i){var a,r=e.metadata,o=t.dataLabelUtils.getDefaultPointLabelSettings(),n=c(r,o),l=[],u=[],h=void 0,d=e.matrix.rows,g=d.root.children?d.root.children.length:0;if(e.matrix&&g>0&&!_.isEmpty(d.levels)&&!_.isEmpty(d.levels[0].sources)){a=d.levels[0].sources[0];var m=t.valueFormatter.getFormatString(a,t.scatterChartProps.general.formatString),f=void 0;if(a.type.numeric){var y=Math.abs(d.root.children[g-1].value-d.root.children[0].value);f=t.valueFormatter.create({format:m,value:y,value2:0})}else f=t.valueFormatter.createDefaultFormatter(m,!0);for(var v=0,b=g;b>v;v++){var C=d.root.children[v],S=f.format(C.value),x=$("<div/>").text(S).html();u.push({escapedText:x,text:S});var w=s(e,v),P={label:x,column:a};h=i(w,P),l.push(h)}}else{var w=s(e,0);h=i(w),l.push(h)}return n.currentFrameIndex=u.length-1,{allViewModels:l,currentViewModel:h,frameData:u,currentFrameIndex:n.currentFrameIndex,labelData:p(u,a)}}function h(){var e={frameData:[],allViewModels:[],currentFrameIndex:0,currentViewModel:void 0,labelData:{anyWordBreaks:!1,labelInfo:[]}};return e}function d(e,t){var i={minY:0,maxY:10,minX:0,maxX:10};if(e.allViewModels&&e.allViewModels.length>0){i.minY=i.minX=Number.MAX_VALUE,i.maxY=i.maxX=Number.MIN_VALUE;for(var a=0,r=e.allViewModels.length;r>a;a++){var o=e.allViewModels[a],n=t(o);i={minY:d3.min([n.minY,i.minY]),maxY:d3.max([n.maxY,i.maxY]),minX:d3.min([n.minX,i.minX]),maxX:d3.max([n.maxX,i.maxX])}}}return i}function p(t,i){for(var a={fontFamily:"wf_segoe-ui_normal",fontSize:jsCommon.PixelConverter.toString(14)},r=[],o=!1,n=0,s=t;n<s.length;n++){var l=s[n],c=jsCommon.WordBreaker.getMaxWordWidth(l.escapedText,e.TextMeasurementService.measureSvgTextWidth,a);o=o||jsCommon.WordBreaker.hasBreakers(l.escapedText)||l.escapedText.indexOf("-")>-1,r.push({label:l.escapedText,labelWidth:c})}return{labelInfo:r,anyWordBreaks:o,labelFieldName:i&&i.displayName}}function g(e,t){void 0===t&&(t="Play");var i=e.matrix&&e.matrix.rows&&e.matrix.rows.levels&&e.matrix.rows.levels[0]&&e.matrix.rows.levels[0].sources&&e.matrix.rows.levels[0].sources[0]&&e.matrix.rows.levels[0].sources[0].roles;return i&&i[t]}function m(e,t,i){var a=_.filter(e,function(e){return e.selected});a=_.uniq(a,function(e){return e.identity.getKey()}),t.render(a,i)}i.FrameStepDuration=800,i.FrameAnimationDuration=750,i.ClassName="playChart",i.convertMatrixToCategorical=s,i.converter=u,i.getDefaultPlayData=h,i.getMinMaxForAllFrames=d,i.isDataViewPlayable=g,i.renderTraceLines=m}(l=t.PlayChart||(t.PlayChart={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.PixelConverter,i=function(){function i(e){this.textProperties={fontFamily:"wf_segoe-ui_normal, helvetica, arial, sans-serif",
fontSize:"14px"},e&&(this.behavior=e.behavior),this.domHelper=e.domHelper}return i.prototype.getDefaultValue=function(){return this.data&&this.data.defaultValue?this.data.defaultValue.value:void 0},i.prototype.getIdentityFields=function(){return e.SlicerUtil.DefaultValueHandler.getIdentityFields(this.dataView)},i.prototype.init=function(i){var r=this;this.element=i.visualInitOptions.element,this.currentViewport=i.visualInitOptions.viewport;var o,n=this.hostServices=i.visualInitOptions.host,s=this.settings=e.Slicer.DefaultStyleProperties(),l=this.domHelper,c=l.getSlicerBodyViewport(this.currentViewport,s,this.textProperties);this.behavior&&(o=e.createInteractivityService(n));var u=document.createElement("div");u.className=a.Container["class"];var h=this.container=d3.select(u),d=l.createSlicerHeader(n);u.appendChild(d),this.header=d3.select(d),this.body=h.append("div").classed(e.SlicerUtil.Selectors.Body["class"],!0).style({height:t.toString(c.height),width:t.toString(c.width)});var p=function(e){r.onEnterSelection(e)},g=function(e){r.onUpdateSelection(e,o)},m=function(e){e.remove()},f={rowHeight:l.getRowHeight(s,this.textProperties),enter:p,exit:m,update:g,loadMoreData:function(){return i.loadMoreData()},scrollEnabled:!0,viewport:l.getSlicerBodyViewport(this.currentViewport,s,this.textProperties),baseContainer:this.body,isReadMode:function(){return 1!==r.hostServices.getViewMode()}};return this.listView=e.ListViewFactory.createListView(f),this.element.get(0).appendChild(u),o},i.prototype.render=function(e){var t=this.data=e.data;this.currentViewport=e.viewport;var i=e.dataView;if(!i||!t)return void this.listView.empty();this.dataView=i;var a=this.settings=t.slicerSettings,r=this.domHelper;r.updateSlicerBodyDimensions(this.currentViewport,this.body,a),this.updateSelectionStyle(),this.listView.viewport(r.getSlicerBodyViewport(this.currentViewport,a,this.textProperties)).rowHeight(r.getRowHeight(a,this.textProperties)).data(t.slicerDataPoints,function(e){return $.inArray(e,t.slicerDataPoints)},e.resetScrollbarPosition)},i.prototype.updateSelectionStyle=function(){var e=this.settings;this.container.classed("isMultiSelectEnabled",e&&e.selection&&!e.selection.singleSelect)},i.prototype.onEnterSelection=function(i){var r=this.settings,o=i.append("li").classed(a.ItemContainer["class"],!0),n=o.append("div").classed(a.Input["class"],!0);n.append("input").attr("type","checkbox"),n.append("span").classed(a.Checkbox["class"],!0),o.each(function(i,a){var o=d3.select(this);i.isImage?o.append("img").classed(e.SlicerUtil.Selectors.LabelImage["class"],!0):o.append("span").classed(e.SlicerUtil.Selectors.LabelText["class"],!0),null!=i.count&&o.append("span").classed(e.SlicerUtil.Selectors.CountText["class"],!0).style("font-size",t.fromPoint(r.slicerText.textSize))})},i.prototype.onUpdateSelection=function(t,i){var r=this.settings,o=this.data;if(o&&r){var n=this.domHelper;n.styleSlicerHeader(this.header,r,o.categorySourceName),this.header.attr("title",o.categorySourceName);var s=t.selectAll(e.SlicerUtil.Selectors.LabelText.selector);s.text(function(e){return e.value}).attr("title",function(e){return e.tooltip}),n.setSlicerTextStyle(s,r);var l=t.selectAll(e.SlicerUtil.Selectors.LabelImage.selector);l.empty()||l.attr("src",function(e){return e.value});var c=t.selectAll(e.SlicerUtil.Selectors.CountText.selector);if(c.empty()||(c.text(function(e){return e.count}),n.setSlicerTextStyle(c,r)),i&&this.body){var u=this.body.attr("width",this.currentViewport.width),h=u.selectAll(a.ItemContainer.selector),d=u.selectAll(e.SlicerUtil.Selectors.LabelText.selector),p=u.selectAll(a.Input.selector),g=this.header.select(e.SlicerUtil.Selectors.Clear.selector),m=this.header.select("input"),f={dataPoints:o.slicerDataPoints,slicerContainer:this.container,itemContainers:h,itemLabels:d,itemInputs:p,clear:g,interactivityService:i,settings:o.slicerSettings,searchInput:m},y={behaviorOptions:f,orientation:0};i.bind(o.slicerDataPoints,this.behavior,y,{overrideSelectionFromData:!0,hasSelectionOverride:o.hasSelectionOverride,slicerDefaultValueHandler:this}),e.SlicerWebBehavior.styleSlicerItems(t.select(a.Input.selector),o.hasSelectionOverride,i.isSelectionModeInverted())}else e.SlicerWebBehavior.styleSlicerItems(t.select(a.Input.selector),!1,!1)}},i}();e.VerticalSlicerRenderer=i;var a;!function(e){var t=jsCommon.CssConstants.createClassAndSelector;e.Container=t("slicerContainer"),e.ItemContainer=t("slicerItemContainer"),e.Input=t("slicerCheckbox"),e.Checkbox=t("checkbox")}(a||(a={}));var r;!function(e){e.MinimumSize=8,e.Size=13,e.SizeRange=e.Size-e.MinimumSize}(r||(r={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.PixelConverter,a=50,r=80,o=.8,n={labelText:{marginRight:2,paddingLeft:8,paddingRight:8}},s=function(){function s(e){this.textProperties={fontFamily:"wf_segoe-ui_normal",fontSize:"14px"},e&&(this.behavior=e.behavior),this.domHelper=e.domHelper,this.dataStartIndex=0}return s.prototype.getDefaultValue=function(){return this.data&&this.data.defaultValue?this.data.defaultValue.value:void 0},s.prototype.getIdentityFields=function(){return t.SlicerUtil.DefaultValueHandler.getIdentityFields(this.dataView)},s.prototype.init=function(e){this.element=e.visualInitOptions.element,this.currentViewport=e.visualInitOptions.viewport;var i=this.hostServices=e.visualInitOptions.host;this.behavior&&(this.interactivityService=t.createInteractivityService(i)),this.loadMoreData=function(){return e.loadMoreData()};var a=document.createElement("div");a.className=l.container["class"];var r=this.container=d3.select(a),o=this.domHelper.createSlicerHeader(this.hostServices);a.appendChild(o),this.header=d3.select(o);var n=this.body=r.append("div").classed(t.SlicerUtil.Selectors.Body["class"]+" "+l.FlexDisplay["class"],!0);return this.leftNavigationArrow=n.append("button").classed(l.NavigationArrow["class"]+" "+l.LeftNavigationArrow["class"],!0),this.itemsContainer=n.append("div").classed(l.ItemsContainer["class"]+" "+l.FlexDisplay["class"],!0),this.rightNavigationArrow=n.append("button").classed(l.NavigationArrow["class"]+" "+l.RightNavigationArrow["class"],!0),this.element.get(0).appendChild(a),this.bindNavigationEvents(),this.interactivityService},s.prototype.render=function(e){var t=e.data,i=e.dataView;if(!i||!t)return void this.itemsContainer.selectAll("*").remove();this.data=t,this.dataView=i;var a=this.currentViewport&&e.viewport&&(this.currentViewport.height!==e.viewport.height||this.currentViewport.width!==e.viewport.width);this.isMaxWidthCalculated()&&a||(this.calculateAndSetMaxItemWidth(),this.calculateAndSetTotalItemWidth()),this.currentViewport=e.viewport,this.updateStyle();var r=this.element.find(l.ItemsContainer.selector).width();this.itemsToDisplay=this.getNumberOfItemsToDisplay(r),0!==this.itemsToDisplay&&this.renderCore()},s.prototype.renderCore=function(){var e=this.data;if(e&&e.slicerDataPoints){this.normalizePosition(e.slicerDataPoints);var t=this.itemsToDisplay,i=this.dataStartIndex;this.container.classed(l.CanScrollRight["class"],i+this.itemsToDisplay<=e.slicerDataPoints.length-1),this.container.classed(l.CanScrollLeft["class"],i>0),this.renderItems(e.slicerSettings),this.bindInteractivityService(),i+t>=e.slicerDataPoints.length*o&&this.loadMoreData()}},s.prototype.updateStyle=function(){var e=this.currentViewport,t=this.data,a=t.slicerSettings,r=this.domHelper;this.container.classed(l.MultiSelectEnabled["class"],!a.selection.singleSelect).style({width:i.toString(e.width),height:i.toString(e.height)}),r.styleSlicerHeader(this.header,a,t.categorySourceName);var o=r.getHeaderTextProperties(a);this.header.attr("title",t.categorySourceName);var n=this.bodyViewport=r.getSlicerBodyViewport(e,a,o);this.body.style({height:i.toString(n.height),width:i.toString(n.width)})},s.prototype.renderItems=function(a){var r=this,o=this.itemsToDisplay,s=this.dataStartIndex,c=this.data.slicerDataPoints.slice(s,s+o),u=this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector).data(c,function(e){return _.indexOf(r.data.slicerDataPoints,e)});u.enter().append("div").classed(t.SlicerUtil.Selectors.LabelText["class"]+" "+l.FlexDisplay["class"],!0),u.order(),u.style({"font-family":this.textProperties.fontFamily,"padding-left":i.toString(n.labelText.paddingLeft),"padding-right":i.toString(n.labelText.paddingRight),"margin-right":function(e,t){return r.isLastRowItem(t,o)?"0px":i.toString(n.labelText.marginRight)}}),this.domHelper.setSlicerTextStyle(u,a),u.exit().remove(),window.setTimeout(function(){u.attr("title",function(e){return e.tooltip}).text(function(e){return e.value});var i=r.element.find(t.SlicerUtil.Selectors.LabelText.selector),a=i.first(),o=a.width(),n=a.height();i.each(function(t,i){e.TextMeasurementService.wordBreakOverflowingText(i,o,n)})})},s.prototype.bindInteractivityService=function(){if(this.interactivityService&&this.body){var e=this.body,i=e.selectAll(l.ItemsContainer.selector),a=e.selectAll(t.SlicerUtil.Selectors.LabelText.selector),r=this.header.select(t.SlicerUtil.Selectors.Clear.selector),o=this.data,n={dataPoints:o.slicerDataPoints,slicerContainer:this.container,itemsContainer:i,itemLabels:a,clear:r,interactivityService:this.interactivityService,settings:o.slicerSettings},s={behaviorOptions:n,orientation:1};this.interactivityService.bind(o.slicerDataPoints,this.behavior,s,{overrideSelectionFromData:!0,hasSelectionOverride:o.hasSelectionOverride}),t.SlicerWebBehavior.styleSlicerItems(this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector),this.interactivityService.hasSelection(),this.interactivityService.isSelectionModeInverted())}else t.SlicerWebBehavior.styleSlicerItems(this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector),!1,!1)},s.prototype.normalizePosition=function(e){var t=this.dataStartIndex;t=Math.min(t,e.length-1),this.dataStartIndex=Math.max(t,0)},s.prototype.bindNavigationEvents=function(){this.registerMouseWheelScrollEvents(),this.registerMouseClickEvents()},s.prototype.registerMouseClickEvents=function(){var e=this,t=this.container.selectAll(l.RightNavigationArrow.selector),i=this.container.selectAll(l.LeftNavigationArrow.selector);t.on("click",function(){e.scrollRight()}),i.on("click",function(){e.scrollLeft()})},s.prototype.registerMouseWheelScrollEvents=function(){var e=this,t=this.body.node();t.addEventListener("mousewheel",function(t){e.onMouseWheel(t.wheelDelta)}),t.addEventListener("DOMMouseScroll",function(t){e.onMouseWheel(t.detail)})},s.prototype.onMouseWheel=function(e){0>e?this.scrollRight():e>0&&this.scrollLeft()},s.prototype.scrollRight=function(){var e=this.itemsToDisplay,t=this.dataStartIndex,i=this.data.slicerDataPoints.length,a=i-1;e+t>a||(t+=1===e?e:e-1,e+t>a&&(t=a-e+1),this.dataStartIndex=t,this.renderCore())},s.prototype.scrollLeft=function(){var e=this.itemsToDisplay,t=this.dataStartIndex,i=0;0!==t&&(1===e&&(t-=e),t=i>t-e?i:t-e+1,this.dataStartIndex=t,this.renderCore())},s.prototype.isLastRowItem=function(e,t){return e===t-1},s.prototype.getScaledTextWidth=function(e){return e/jsCommon.TextSizeDefaults.TextSizeMin*r},s.prototype.isMaxWidthCalculated=function(){return void 0!==this.maxItemWidth},s.prototype.calculateAndSetMaxItemWidth=function(){var t=this.getDataPointsCount(),r=0;if(0===t)return void(this.maxItemWidth=r);var o=this.data,n=o.slicerDataPoints,s=Math.min(t,a),l=jQuery.extend(!0,{},this.textProperties),c=o.slicerSettings.slicerText.textSize;l.fontSize=i.fromPoint(c);for(var u=jsCommon.WordBreaker.getMaxWordWidth,h=0;s>h;h++){var d=n[h].value;l.text=d,r=Math.max(r,u(d,e.TextMeasurementService.measureSvgTextWidth,l))}this.maxItemWidth=Math.min(r,this.getScaledTextWidth(c))},s.prototype.calculateAndSetTotalItemWidth=function(){var e=this.data,t=n.labelText.paddingLeft+n.labelText.paddingRight+n.labelText.marginRight,i=this.domHelper.getRowsOutlineWidth(e.slicerSettings.slicerText.outline,e.slicerSettings.general.outlineWeight);this.totalItemWidth=this.maxItemWidth+t+i},s.prototype.getNumberOfItemsToDisplay=function(e){var t=this.totalItemWidth;if(0===t)return 0;var i=this.getDataPointsCount(),a=Math.min(i,Math.round(e/t));return Math.max(a,1)},s.prototype.getDataPointsCount=function(){return _.size(this.data.slicerDataPoints)},s}();t.HorizontalSlicerRenderer=s;var l;!function(e){var t=jsCommon.CssConstants.createClassAndSelector;e.container=t("horizontalSlicerContainer"),e.ItemsContainer=t("slicerItemsContainer"),e.NavigationArrow=t("navigationArrow"),e.LeftNavigationArrow=t("left"),e.RightNavigationArrow=t("right"),e.MultiSelectEnabled=t("isMultiSelectEnabled"),e.FlexDisplay=t("flexDisplay"),e.CanScrollRight=t("canScrollRight"),e.CanScrollLeft=t("canScrollLeft")}(l||(l={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=t.SlicerUtil.DisplayNameKeys,a=t.SlicerUtil.DOMHelper,r=t.SlicerUtil.SettingsHelper,o=function(){function o(e){e&&(this.behavior=e.behavior),this.domHelper=new a}return o.DefaultStyleProperties=function(){return{general:{outlineColor:"#808080",outlineWeight:1,orientation:0},header:{borderBottomWidth:1,show:!0,outline:t.outline.bottomOnly,fontColor:"#000000",textSize:10},slicerText:{color:"#666666",outline:t.outline.none,textSize:10},selection:{selectAllCheckboxEnabled:!1,singleSelect:!0},search:{enabled:!1}}},o.prototype.init=function(e){this.initOptions=e,this.element=e.element,this.currentViewport=e.viewport,this.hostServices=e.host;var t=this.settings=o.DefaultStyleProperties();this.slicerOrientation=t.general.orientation,this.waitingForData=!1,this.initializeSlicerRenderer(this.slicerOrientation)},o.prototype.onDataChanged=function(t){var i=t.dataViews;if(!_.isEmpty(i)){var a=this.dataView;this.dataView=i[0];var r=t.operationKind!==e.VisualDataChangeOperationKind.Append&&!e.DataViewAnalysis.hasSameCategoryIdentity(a,this.dataView);this.render(r,!0)}},o.prototype.onResizing=function(e){this.currentViewport=e,this.render(!1)},o.prototype.enumerateObjectInstances=function(e){return n.enumerateObjectInstances(e,this.slicerData,this.settings,this.dataView)},o.prototype.loadMoreData=function(){var e=this.dataView;if(e){var t=e.metadata;!this.waitingForData&&t&&t.segment&&(this.hostServices.loadMoreData(),this.waitingForData=!0)}},o.prototype.onClearSelection=function(){this.interactivityService&&(this.interactivityService.clearSelection(),this.render(!1))},o.prototype.render=function(e,a){var n=this.hostServices.getLocalizedString(i.SelectAll);if(this.slicerData=t.DataConversion.convert(this.dataView,n,this.interactivityService,this.hostServices),this.slicerData){this.slicerData.slicerSettings.general.outlineWeight=Math.max(this.slicerData.slicerSettings.general.outlineWeight,0),this.settings=this.slicerData.slicerSettings;var s=r.areSettingsDefined(this.slicerData)&&this.slicerData.slicerSettings.general&&this.slicerData.slicerSettings.general.orientation?this.slicerData.slicerSettings.general.orientation:o.DefaultStyleProperties().general.orientation,l=this.orientationHasChanged(s);l&&(this.slicerOrientation=s,this.element.empty(),this.initializeSlicerRenderer(s))}this.slicerRenderer.render({dataView:this.dataView,data:this.slicerData,viewport:this.currentViewport,resetScrollbarPosition:e}),a&&(this.waitingForData=!1)},o.prototype.orientationHasChanged=function(e){return this.slicerOrientation!==e},o.prototype.initializeSlicerRenderer=function(e){switch(e){case 1:this.initializeHorizontalSlicer();break;case 0:this.initializeVerticalSlicer()}},o.prototype.initializeVerticalSlicer=function(){var e=this.slicerRenderer=new t.VerticalSlicerRenderer({domHelper:this.domHelper,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i)},o.prototype.initializeHorizontalSlicer=function(){var e=this.slicerRenderer=new t.HorizontalSlicerRenderer({domHelper:this.domHelper,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i)},o.prototype.createInitOptions=function(){var e=this;return{visualInitOptions:this.initOptions,loadMoreData:function(){return e.loadMoreData()}}},o}();t.Slicer=o;var n;!function(e){function t(e,t,r,l){if(t)switch(e.objectName){case"items":return n(t,r);case"header":return o(t,r);case"general":return s(t,r);case"selection":if(i(l))return a(t,r)}}function i(e){return!(e&&e.metadata&&e.metadata.columns&&_.some(e.metadata.columns,function(e){return e.discourageAggregationAcrossGroups}))}function a(e,t){var i=t,a=r.areSettingsDefined(e)&&e.slicerSettings.selection,o=a&&e.slicerSettings.selection.selectAllCheckboxEnabled?e.slicerSettings.selection.selectAllCheckboxEnabled:i.selection.selectAllCheckboxEnabled,n=e&&e.slicerSettings&&e.slicerSettings.selection&&void 0!==e.slicerSettings.selection.singleSelect?e.slicerSettings.selection.singleSelect:i.selection.singleSelect;return[{selector:null,objectName:"selection",properties:{selectAllCheckboxEnabled:o,singleSelect:n}}]}function o(e,t){var i=t,a=r.areSettingsDefined(e)&&e.slicerSettings.header,o=a&&e.slicerSettings.header.fontColor?e.slicerSettings.header.fontColor:i.header.fontColor,n=a&&e.slicerSettings.header.background?e.slicerSettings.header.background:i.header.background;return[{selector:null,objectName:"header",properties:{show:i.header.show,fontColor:o,background:n,outline:i.header.outline,textSize:i.header.textSize}}]}function n(e,t){var i=t,a=r.areSettingsDefined(e)&&e.slicerSettings.slicerText,o=a&&e.slicerSettings.slicerText.color?e.slicerSettings.slicerText.color:i.slicerText.color,n=a&&e.slicerSettings.slicerText.background?e.slicerSettings.slicerText.background:i.slicerText.background;return[{selector:null,objectName:"items",properties:{fontColor:o,background:n,outline:i.slicerText.outline,textSize:i.slicerText.textSize}}]}function s(e,t){var i=t,a=r.areSettingsDefined(e)&&null!=e.slicerSettings.general,o=a&&e.slicerSettings.general.outlineColor?e.slicerSettings.general.outlineColor:i.general.outlineColor,n=a&&e.slicerSettings.general.outlineWeight?e.slicerSettings.general.outlineWeight:i.general.outlineWeight,s=a&&null!=e.slicerSettings.general.orientation?e.slicerSettings.general.orientation:i.general.orientation;return[{selector:null,objectName:"general",properties:{outlineColor:o,outlineWeight:n,orientation:s}}]}e.enumerateObjectInstances=t}(n||(n={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=t.controls.internal.TablixUtils,a=t.controls.internal.TablixObjects,r=i.EdgeSettings,o=i.EdgeType,n=function(){function t(e,t){this.tableDataView=e,this.formatter=t}return t.prototype.getColumnHierarchyDepth=function(){return 1},t.prototype.getRowHierarchyDepth=function(){return 1},t.prototype.getLeafCount=function(e){return e.length},t.prototype.getLeafAt=function(e,t){return e[t]},t.prototype.getParent=function(e){return null},t.prototype.getIndex=function(e){return e?this.isRow(e)?e.index:this.getColumnIndex(e):-1},t.prototype.isRow=function(e){if(!e)return!1;var t=e;return void 0!==t.index&&void 0!==t.values},t.prototype.getColumnIndex=function(e){return t.getIndex(this.tableDataView.columns,e)},t.prototype.isLeaf=function(e){return!0},t.prototype.isRowHierarchyLeaf=function(e){return!1},t.prototype.isColumnHierarchyLeaf=function(e){return!0},t.prototype.isFirstItem=function(e,t){return e===t[0]},t.prototype.areAllParentsFirst=function(e,t){return this.isFirstItem(e,t)},t.prototype.isLastItem=function(e,t){return t[t.length-1]===e},t.prototype.areAllParentsLast=function(e,t){return this.isLastItem(e,t)},t.prototype.getChildren=function(e){return null},t.prototype.getChildrenLevelDifference=function(e){return 1/0},t.prototype.getCount=function(e){return e.length},t.prototype.getAt=function(e,t){return e[t]},t.prototype.getLevel=function(e){return 0},t.prototype.getIntersection=function(e,r){var o,n=!1,s=new i.CellPosition,l=t.getIndex(this.tableDataView.columns,r);s.column.index=l,s.column.isFirst=0===l,s.column.isLast=l===this.tableDataView.columns.length-1;var c=e;if(null!=c.totalCells)n=!0,o=c.totalCells[l];else{var u=e,h=u.index;s.row.index=h,s.row.isFirst=0===h,s.row.isLast=h===this.tableDataView.rows.length-1,o=u.values[l]}var d=new i.TablixVisualCell(o,n,r,this.formatter,!0);d.position=s;var p=e;if(p&&p.values){var g=p.values.objects;if(g){var m=g[l];m&&(d.backColor=a.PropValuesBackColor.getValue(m))}}return d},t.prototype.getCorner=function(e,t){return null},t.prototype.headerItemEquals=function(t,i){if(t===i)return!0;if(t.displayName&&i.displayName){var a=t,r=i;return e.DataViewAnalysis.areMetadataColumnsEquivalent(a,r)}return this.isRow(t)&&this.isRow(i)?t.index===i.index:!1},t.prototype.bodyCellItemEquals=function(e,t){return e.isMatch(t)},t.prototype.cornerCellItemEquals=function(e,t){return!0},t.prototype.update=function(e){this.tableDataView=e},t.getIndex=function(e,t){for(var i=0,a=e.length;a>i;i++){var r=e[i];if(null!=r.index&&null!=t.index&&r.index===t.index)return i;if(t===e[i])return i}return-1},t}();t.TableHierarchyNavigator=n;var s=function(){function n(e){this.options=e}return n.prototype.onDataViewChanged=function(e){this.tableDataView=e,this.formattingProperties=e.formattingProperties,this.updateTextHeights()},n.prototype.updateTextHeights=function(){var t={fontFamily:"",fontSize:a.getTextSizeInPx(this.formattingProperties.general.textSize),text:"a"};t.fontFamily=i.FontFamilyHeader,this.textHeightHeader=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t)),t.fontFamily=i.FontFamilyCell,this.textHeightValue=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t)),t.fontFamily=i.FontFamilyTotal,this.textHeightTotal=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t))},n.prototype.onStartRenderingSession=function(){},n.prototype.onEndRenderingSession=function(){},n.prototype.bindRowHeader=function(e,t){t.contentHeight=this.textHeightValue,i.clearCellStyle(t),this.options.onBindRowHeader&&this.options.onBindRowHeader(e)},n.prototype.unbindRowHeader=function(e,t){},n.prototype.bindColumnHeader=function(e,t){var o=this;t.extension.disableDragResize(),i.resetCellCssClass(t),i.addCellCssClass(t,i.CssClassTablixHeader),i.addCellCssClass(t,i.CssClassTablixColumnHeaderLeaf);var n=new i.CellStyle;n.fontFamily=i.FontFamilyHeader,n.fontColor=i.FontColorHeaders,n.borders.bottom=new r(a.PropGridOutlineWeight.defaultValue,a.PropGridOutlineColor.defaultValue),t.contentHeight=this.textHeightHeader;var s=t.extension.contentHost;if(this.sortIconsEnabled()&&(s=i.addSortIconToColumnHeader(e.sort,s)),i.setCellTextAndTooltip(e.displayName,s,t.extension.contentHost),this.options.onColumnHeaderClick){var l=function(t){if(i.isValidSortClick(t)){var a=i.reverseSort(e.sort);o.options.onColumnHeaderClick(e.queryName?e.queryName:e.displayName,a)}};t.extension.registerClickHandler(l)}this.setColumnHeaderStyle(t,n),t.applyStyle(n)},n.prototype.setColumnHeaderStyle=function(e,i){var a=this.formattingProperties.grid,n=this.formattingProperties.columnHeaders,s=this.formattingProperties.total,l=this.formattingProperties.values;i.borders.top=new r,i.borders.top.applyParams(t.outline.showTop(n.outline),a.outlineWeight,a.outlineColor,o.Outline),i.borders.bottom=new r,i.borders.bottom.applyParams(t.outline.showBottom(n.outline),a.outlineWeight,a.outlineColor,o.Outline),i.borders.left=new r,e.position.column.isFirst&&(i.borders.left.applyParams(t.outline.showLeft(n.outline),a.outlineWeight,a.outlineColor,o.Outline),t.outline.showLeft(n.outline)||!t.outline.showLeft(s.outline)&&!t.outline.showLeft(l.outline)||(i.paddings.left+=a.outlineWeight)),i.borders.right=new r,e.position.column.isLast?(i.borders.right.applyParams(t.outline.showRight(n.outline),a.outlineWeight,a.outlineColor,o.Outline),t.outline.showRight(n.outline)||!t.outline.showRight(s.outline)&&!t.outline.showRight(l.outline)||(i.paddings.right+=a.outlineWeight)):i.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,o.Gridline),i.fontColor=n.fontColor,i.backColor=n.backColor,i.paddings.top=i.paddings.bottom=a.rowPadding},n.prototype.unbindColumnHeader=function(e,t){i.clearCellStyle(t),i.clearCellTextAndTooltip(t),this.sortIconsEnabled()&&i.removeSortIcons(t),this.options.onColumnHeaderClick&&t.extension.unregisterClickHandler()},n.prototype.bindBodyCell=function(e,t){i.resetCellCssClass(t);var o;o=this.formattingProperties.grid.imageHeight;var n=new i.CellStyle;e.isImage?t.contentHeight=o:t.contentHeight=this.textHeightValue;var s=t.extension.contentHost;e.isUrl&&e.isValidUrl?i.appendATagToBodyCell(e.textContent,s,this.formattingProperties.values.urlIcon):e.isImage&&e.isValidUrl?(i.appendImgTagToBodyCell(e.textContent,s,o),n.hasImage=!0):e.kpiContent?$(s).append(e.kpiContent):e.textContent?i.setCellTextAndTooltip(e.textContent,s):i.setCellTextAndTooltip(" ",s),e.isTotal?(i.addCellCssClass(t,i.CssClassTablixValueTotal),i.addCellCssClass(t,i.CssClassTableFooter),n.fontFamily=i.FontFamilyTotal,n.borders.top=new r(a.PropGridOutlineWeight.defaultValue,a.PropGridOutlineColor.defaultValue),t.contentHeight=this.textHeightTotal):e.position.row.isLast?i.addCellCssClass(t,i.CssClassTableBodyCellBottom):(i.addCellCssClass(t,i.CssClassTableBodyCell),n.borders.bottom=new r(a.PropGridHorizontalWeight.defaultValue,a.PropGridHorizontalColor.defaultValue)),e.isNumeric&&i.addCellCssClass(t,i.CssClassTablixValueNumeric),e.isTotal?this.setFooterStyle(t,n):this.setBodyStyle(e,t,n),t.applyStyle(n)},n.prototype.setBodyStyle=function(e,i,a){var n=this.formattingProperties.grid,s=this.formattingProperties.values,l=this.formattingProperties.total,c=this.formattingProperties.columnHeaders;a.borders.top=new r,i.position.row.isFirst&&a.borders.top.applyParams(t.outline.showTop(s.outline),n.outlineWeight,n.outlineColor,o.Outline),a.borders.bottom=new r,i.position.row.isLast?a.borders.bottom.applyParams(t.outline.showBottom(s.outline),n.outlineWeight,n.outlineColor,o.Outline):a.borders.bottom.applyParams(n.gridHorizontal,n.gridHorizontalWeight,n.gridHorizontalColor,o.Gridline),a.borders.left=new r,i.position.column.isFirst&&(a.borders.left.applyParams(t.outline.showLeft(s.outline),n.outlineWeight,n.outlineColor,o.Outline),t.outline.showLeft(s.outline)||!t.outline.showLeft(l.outline)&&!t.outline.showLeft(c.outline)||(a.paddings.left+=n.outlineWeight)),a.borders.right=new r,i.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(s.outline),n.outlineWeight,n.outlineColor,o.Outline),t.outline.showRight(s.outline)||!t.outline.showRight(l.outline)&&!t.outline.showRight(c.outline)||(a.paddings.right+=n.outlineWeight)):a.borders.right.applyParams(n.gridVertical,n.gridVerticalWeight,n.gridVerticalColor,o.Gridline),a.fontColor=i.position.row.index%2===0?s.fontColorPrimary:s.fontColorSecondary,e.backColor?a.backColor=e.backColor:a.backColor=i.position.row.index%2===0?s.backColorPrimary:s.backColorSecondary,a.paddings.top=a.paddings.bottom=n.rowPadding},n.prototype.setFooterStyle=function(e,i){var a=this.formattingProperties.total,n=this.formattingProperties.grid,s=this.formattingProperties.values,l=this.formattingProperties.columnHeaders;i.borders.top=new r,i.borders.top.applyParams(t.outline.showTop(a.outline),n.outlineWeight,n.outlineColor,o.Outline),i.borders.bottom=new r,i.borders.bottom.applyParams(t.outline.showBottom(a.outline),n.outlineWeight,n.outlineColor,o.Outline),i.borders.left=new r,e.position.column.isFirst&&(i.borders.left.applyParams(t.outline.showLeft(a.outline),n.outlineWeight,n.outlineColor,o.Outline),t.outline.showLeft(a.outline)||!t.outline.showLeft(s.outline)&&!t.outline.showLeft(l.outline)||(i.paddings.left+=n.outlineWeight)),i.borders.right=new r,e.position.column.isLast?(i.borders.right.applyParams(t.outline.showRight(a.outline),n.outlineWeight,n.outlineColor,o.Outline),t.outline.showRight(a.outline)||!t.outline.showRight(s.outline)&&!t.outline.showRight(l.outline)||(i.paddings.right+=n.outlineWeight)):i.borders.right.applyParams(n.gridVertical,n.gridVerticalWeight,n.gridVerticalColor,o.Gridline),i.fontColor=a.fontColor,i.backColor=a.backColor,i.paddings.top=i.paddings.bottom=n.rowPadding},n.prototype.unbindBodyCell=function(e,t){i.clearCellStyle(t),i.clearCellTextAndTooltip(t)},n.prototype.bindCornerCell=function(e,t){},n.prototype.unbindCornerCell=function(e,t){},n.prototype.bindEmptySpaceHeaderCell=function(e){},n.prototype.unbindEmptySpaceHeaderCell=function(e){},n.prototype.bindEmptySpaceFooterCell=function(e){},n.prototype.unbindEmptySpaceFooterCell=function(e){},n.prototype.getHeaderLabel=function(e){return e.displayName},n.prototype.getCellContent=function(e){return e},n.prototype.hasRowGroups=function(){return!1},n.prototype.sortIconsEnabled=function(){return 0===this.options.layoutKind},n}();t.TableBinder=s;var l=function(){function r(e){e&&(this.isConditionalFormattingEnabled=e.isConditionalFormattingEnabled,this.isTouchEnabled=e.isTouchEnabled)}return r.customizeQuery=function(e){var t=e.dataViewMappings[0];if(t&&t.table&&t.metadata){var i=t.table.rows,r=t.metadata.objects;i["for"]["in"].subtotalType=a.shouldShowTableTotals(r)?1:0}},r.getSortableRoles=function(){return["Values"]},r.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatVariantMeasureValue,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.getLocalizedString=e.host.getLocalizedString,this.hostServices=e.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},r.converter=function(t){var i=t.table,r=e.Prototype.inherit(i);r.visualRows=[];for(var o=0;o<i.rows.length;o++){var n={index:o,values:i.rows[o]};r.visualRows.push(n)}return r.formattingProperties=a.getTableObjects(t),r},r.prototype.onResizing=function(e){this.updateViewport(e)},r.prototype.getColumnWidthManager=function(){return this.columnWidthManager},r.prototype.onDataChanged=function(t){var i=t.dataViews;if(i&&i.length>0){var a=this.dataView;if(this.dataView=i[0],this.persistingObjects)return void(this.persistingObjects=!1);var o=r.converter(this.dataView),n=o.formattingProperties.general.textSize;if(t.operationKind===e.VisualDataChangeOperationKind.Append)this.hierarchyNavigator.update(o),this.tablixControl.updateModels(!1,o.visualRows,o.columns),this.refreshControl(!1);else{this.createOrUpdateHierarchyNavigator(o),this.createColumnWidthManager(),this.createTablixControl(n);var s=this.tablixControl.getBinder();s.onDataViewChanged(o),this.updateInternal(n,a,o)}}this.waitingForData=!1,this.waitingForSort=!1},r.prototype.createColumnWidthManager=function(){var e=this;this.columnWidthManager?this.columnWidthManager.updateDataView(this.dataView):this.columnWidthManager=new t.controls.TablixColumnWidthManager(this.dataView,!1,function(t){return e.persistColumnWidths(t)})},r.prototype.persistColumnWidths=function(e){this.persistingObjects=!0,this.hostServices.persistProperties(e)},r.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},r.prototype.refreshControl=function(e){(t.visibilityHelper.partiallyVisible(this.element)||1===this.getLayoutKind())&&this.tablixControl.refresh(e)},r.prototype.getLayoutKind=function(){return this.isInteractive?0:1},r.prototype.createOrUpdateHierarchyNavigator=function(e){if(this.tablixControl)this.hierarchyNavigator.update(e);else{var t=new n(e,this.formatter);this.hierarchyNavigator=t}},r.prototype.createTablixControl=function(e){this.tablixControl||(this.tablixControl=this.createControl(this.hierarchyNavigator,e))},r.prototype.createControl=function(e,i){var r=this,o=this.getLayoutKind(),n={onBindRowHeader:function(e){return r.onBindRowHeader(e)},onColumnHeaderClick:function(e,t){return r.onColumnHeaderClick(e,t)},layoutKind:o},l=new s(n),c=1===o?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(l):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(l,this.columnWidthManager),u=document.createElement("div");
this.element.append(u);var h={interactive:this.isInteractive,enableTouchSupport:this.isTouchEnabled,layoutKind:o,fontSize:a.getTextSizeInPx(i)};return new t.controls.TablixControl(e,c,l,u,h)},r.prototype.updateInternal=function(e,i,r){var o=this;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize(t.converterHelper.hasImageUrlColumn(this.dataView)),this.tablixControl.fontSize=a.getTextSizeInPx(e),this.verifyHeaderResize(),this.tablixControl.updateModels(!0,r.visualRows,r.columns);var n=this.createTotalsRow(this.dataView);this.tablixControl.rowDimension.setFooter(n),this.tablixControl.viewport=this.currentViewport;var s=this.shouldClearControl(i,this.dataView);setTimeout(function(){o.refreshControl(s),o.columnWidthManager.shouldPersistAllColumnWidths()&&o.columnWidthManager.persistAllColumnWidths(o.tablixControl.layoutManager.columnWidthsToPersist)},0)},r.prototype.shouldClearControl=function(t,i){return this.waitingForSort&&t&&i?!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata):!0},r.prototype.createTotalsRow=function(e){if(!a.shouldShowTableTotals(e.metadata.objects))return null;var t=e.table.totals;if(!t||0===t.length)return null;for(var i=[],r=e.table.columns,o=0,n=r.length;n>o;++o){var s=r[o],l=t[s.index];null!=l?i.push(l):i.push(0===o?this.getLocalizedString("TableTotalLabel"):"")}return{totalCells:i}},r.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},r.prototype.onColumnHeaderClick=function(e,t){this.waitingForSort=!0,this.hostServices.onCustomSort(i.getCustomSortEventArgs(e,t))},r.prototype.needsMoreData=function(e){if(this.waitingForData||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),i=t*r.preferredLoadMoreThreshold;return this.hierarchyNavigator.getIndex(e)>=i},r.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;return this.dataView&&a.enumerateObjectInstances(e,i,this.dataView,t.controls.TablixType.Table),i.complete()},r.prototype.enumerateObjectRepetition=function(){var e=[];return this.isConditionalFormattingEnabled&&this.dataView&&a.enumerateObjectRepetition(e,this.dataView,t.controls.TablixType.Table),e},r.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},r.prototype.onViewModeChanged=function(e){this.updateViewport(this.currentViewport)},r.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},r.preferredLoadMoreThreshold=.8,r}();t.Table=l}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,t,i){return new c(e,t,i)}var a=t.controls.internal.TablixUtils,r=t.controls.internal.TablixObjects,o=jsCommon.UrlUtils,n=a.EdgeSettings,s=a.EdgeType,l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"isMeasure",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValidUrl",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValidImage",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(a.TablixVisualCell);t.MatrixVisualBodyItem=l,t.createMatrixHierarchyNavigator=i;var c=function(){function t(e,i,a){this.matrix=e,this.rowHierarchy=t.wrapMatrixHierarchy(e.rows),this.columnHierarchy=t.wrapMatrixHierarchy(e.columns),this.formatter=i,this.compositeGroupSeparator=a,this.update()}return t.prototype.getDataViewMatrix=function(){return this.matrix},t.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},t.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},t.prototype.getLeafCount=function(e){var t=this.getMatrixHierarchy(e);return t?t.leafNodes.length:0},t.prototype.getLeafAt=function(e,t){var i=this.getMatrixHierarchy(e);return i?i.leafNodes[t]:null},t.prototype.getLeafIndex=function(e){return e.leafIndex},t.prototype.getParent=function(e){return 0===e.level?null:e.parent},t.prototype.getIndex=function(e){return e.index},t.prototype.isLeaf=function(e){return!e.children||0===e.children.length},t.prototype.isRowHierarchyLeaf=function(e){return!0},t.prototype.isColumnHierarchyLeaf=function(e){return!1},t.prototype.isFirstItem=function(e,t){return e===_.first(t)},t.prototype.areAllParentsFirst=function(e,t){if(!e)return!1;var i=this.getParent(e);return i?this.isFirstItem(e,e.siblings)&&this.areAllParentsFirst(i,i.siblings):this.isFirstItem(e,e.siblings)},t.prototype.isLastItem=function(e,t){return e===_.last(t)},t.prototype.areAllParentsLast=function(e,t){if(!e)return!1;var i=this.getParent(e);return i?this.isLastItem(e,e.siblings)&&this.areAllParentsLast(i,i.siblings):this.isLastItem(e,e.siblings)},t.prototype.getChildren=function(e){return e.children},t.prototype.getChildrenLevelDifference=function(e){for(var t=1/0,i=this.getChildren(e),a=0,r=i.length;r>a;a++)t=Math.min(t,i[a].level-e.level);return t},t.prototype.getCount=function(e){return e.length},t.prototype.getAt=function(e,t){return e[t]},t.prototype.getLevel=function(e){return e.level},t.prototype.getIntersection=function(e,t){var i,a,r,o=e.isSubtotal===!0||t.isSubtotal===!0,n=e.leafIndex,s=t.leafIndex;return i=e.values?e.values[t.leafIndex]:void 0,i?(a=this.matrix.valueSources[i.valueSourceIndex||0],r=new l(i.value,o,a,this.formatter,!1)):r=new l(void 0,o,void 0,this.formatter,!1),r.position.row.index=n,r.position.row.indexInSiblings=e.siblings.indexOf(e),r.position.row.isFirst=0===n,r.position.row.isLast=n===this.rowHierarchy.leafNodes.length-1,r.position.column.index=s,r.position.column.indexInSiblings=t.siblings.indexOf(t),r.position.column.isFirst=0===s,r.position.column.isLast=s===this.columnHierarchy.leafNodes.length-1,r},t.prototype.getCorner=function(e,t){var i=this.columnHierarchy.levels,a=this.rowHierarchy.levels;if(t===i.length-1||0===i.length){var r=a[e];if(r)return{metadata:1===r.sources.length?r.sources[0]:null,displayName:_.map(r.sources,function(e){return e.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:e===a.length-1}}if(e===a.length-1){var r=i[t];if(r)return{metadata:1===r.sources.length?r.sources[0]:null,displayName:_.map(r.sources,function(e){return e.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1}},t.prototype.headerItemEquals=function(e,t){return e&&t?e===t:!1},t.prototype.bodyCellItemEquals=function(e,t){return e.position.isMatch(t.position)},t.prototype.cornerCellItemEquals=function(e,t){return e===t},t.prototype.getMatrixColumnHierarchy=function(){return this.columnHierarchy},t.prototype.getMatrixRowHierarchy=function(){return this.rowHierarchy},t.prototype.update=function(e,i){void 0===i&&(i=!0),e&&(this.matrix=e,this.rowHierarchy=t.wrapMatrixHierarchy(e.rows),i&&(this.columnHierarchy=t.wrapMatrixHierarchy(e.columns))),this.updateHierarchy(this.rowHierarchy),i&&(this.updateHierarchy(this.columnHierarchy),t.updateStaticColumnHeaders(this.columnHierarchy))},t.wrapMatrixHierarchy=function(t){var i=e.Prototype.inherit(t);return i.leafNodes=[],i},t.prototype.updateHierarchy=function(e){e.leafNodes.length>0&&(e.leafNodes.length=0),e.root.children&&this.updateRecursive(e,e.root.children,null,e.leafNodes)},t.prototype.updateRecursive=function(e,t,i,a){for(var o,n=this,s=r.PropColumnFormatString.getPropertyID(),l=0,c=t.length;c>l;l++){var u=t[l];if(u.siblings=t,i&&(u.parent=i),o||(o=e.levels[u.level]),o)if(u.levelValues){var h=_.map(u.levelValues,function(e){var t=o.sources[e.levelSourceIndex||0];return n.formatter(e.value,t,s,!0)});u.valueFormatted=h.join(this.compositeGroupSeparator),u.queryName=1!==o.sources.length?void 0:o.sources[0].queryName}else{var d=o.sources[u.levelSourceIndex||0];u.valueFormatted=d.displayName,u.queryName=d.queryName}u.index=l,u.children&&u.children.length>0?this.updateRecursive(e,u.children,u,a):(u.leafIndex=a.length,a.push(u))}},t.updateStaticColumnHeaders=function(e){var t=e.leafNodes;if(t&&t.length>0)for(var i=e.levels[t[0].level].sources,a=0,r=t.length;r>a;a++){var o=t[a];if(!o.identity&&_.isEmpty(o.levelValues)){var n=i[o.levelSourceIndex?o.levelSourceIndex:0];n&&(o.valueFormatted=n.displayName)}}},t.prototype.getMatrixHierarchy=function(e){var t=this.rowHierarchy.root.children;if(t&&e===t)return this.rowHierarchy;var i=this.columnHierarchy.root.children;return i&&e===i?this.columnHierarchy:null},t}(),u=function(){function i(e,t){this.hierarchyNavigator=e,this.options=t}return i.prototype.onDataViewChanged=function(e){this.formattingProperties=e,this.updateTextHeights()},i.prototype.updateTextHeights=function(){var t={fontFamily:"",fontSize:r.getTextSizeInPx(this.formattingProperties.general.textSize),text:"a"};t.fontFamily=a.FontFamilyHeader,this.textHeightHeader=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t)),t.fontFamily=a.FontFamilyCell,this.textHeightValue=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t)),t.fontFamily=a.FontFamilyTotal,this.textHeightTotal=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(t))},i.prototype.onStartRenderingSession=function(){},i.prototype.onEndRenderingSession=function(){},i.prototype.bindRowHeader=function(e,t){a.resetCellCssClass(t);var i=new a.CellStyle,o=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(e);o&&(a.addCellCssClass(t,a.CssClassMatrixRowHeaderLeaf),i.borders.right=new n(r.PropGridOutlineWeight.defaultValue,r.PropGridOutlineColor.defaultValue)),e.isSubtotal&&(i.paddings.left=a.CellPaddingLeftMatrixTotal),this.bindHeader(e,t,t.extension.contentHost,this.getRowHeaderMetadata(e),i),this.options.onBindRowHeader&&this.options.onBindRowHeader(e),this.setRowHeaderStyle(t,i),t.applyStyle(i)},i.prototype.setRowHeaderStyle=function(e,i){var a=this.formattingProperties.grid,r=this.formattingProperties.rowHeaders,o=this.formattingProperties.values,l=this.formattingProperties.columnHeaders;i.borders.top=new n,e.position.row.isFirst&&(i.borders.top.applyParams(t.outline.showTop(r.outline),a.outlineWeight,a.outlineColor,s.Outline),!t.outline.showTop(r.outline)&&t.outline.showTop(o.outline)&&(i.paddings.top+=a.outlineWeight)),i.borders.bottom=new n,e.position.row.isLast?(i.borders.bottom.applyParams(t.outline.showBottom(r.outline),a.outlineWeight,a.outlineColor,s.Outline),!t.outline.showBottom(r.outline)&&t.outline.showBottom(o.outline)&&(i.paddings.bottom+=a.outlineWeight)):i.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,s.Gridline),i.borders.left=new n,e.position.column.isFirst&&(i.borders.left.applyParams(t.outline.showLeft(r.outline),a.outlineWeight,a.outlineColor,s.Outline),!t.outline.showLeft(r.outline)&&t.outline.showLeft(l.outline)&&(i.paddings.left+=a.outlineWeight)),i.borders.right=new n,e.position.column.isLast?i.borders.right.applyParams(t.outline.showRight(r.outline),a.outlineWeight,a.outlineColor,s.Outline):i.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,s.Gridline),i.fontColor=r.fontColor,i.backColor=r.backColor,i.paddings.top=i.paddings.bottom=a.rowPadding},i.prototype.unbindRowHeader=function(e,t){a.clearCellStyle(t),a.clearCellTextAndTooltip(t)},i.prototype.bindColumnHeader=function(e,t){a.resetCellCssClass(t);var i=new a.CellStyle,o=!1,s=t.extension.contentHost,l=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(e);if(l){if(i.borders.bottom=new n(r.PropGridOutlineWeight.defaultValue,r.PropGridOutlineColor.defaultValue),a.addCellCssClass(t,a.CssClassTablixColumnHeaderLeaf),a.addCellCssClass(t,a.CssClassTablixValueNumeric),this.options.showSortIcons){var c=this.getSortableHeaderColumnMetadata(e);c&&(this.registerColumnHeaderClickHandler(c,t),s=a.addSortIconToColumnHeader(c.sort,s))}e.isSubtotal&&e.parent&&e.parent.children.length>1&&e.parent.children[0].isSubtotal&&(o=!0)}t.extension.disableDragResize(),this.bindHeader(e,t,s,this.getColumnHeaderMetadata(e),i,o),this.setColumnHeaderStyle(t,i),t.applyStyle(i)},i.prototype.setColumnHeaderStyle=function(e,i){var a=this.formattingProperties.grid,r=this.formattingProperties.columnHeaders,o=this.formattingProperties.values;i.fontColor=r.fontColor,i.backColor=r.backColor,i.paddings.top=i.paddings.bottom=a.rowPadding,i.borders.top=new n,e.position.row.isFirst&&i.borders.top.applyParams(t.outline.showTop(r.outline),a.outlineWeight,a.outlineColor,s.Outline),i.borders.bottom=new n,e.position.row.isLast?i.borders.bottom.applyParams(t.outline.showBottom(r.outline),a.outlineWeight,a.outlineColor,s.Outline):i.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,s.Gridline),i.borders.left=new n,e.position.column.isFirst&&!t.outline.showLeft(r.outline)&&t.outline.showLeft(o.outline)&&(i.paddings.left+=a.outlineWeight),i.borders.right=new n,e.position.column.isLast?(i.borders.right.applyParams(t.outline.showRight(r.outline),a.outlineWeight,a.outlineColor,s.Outline),!t.outline.showRight(r.outline)&&t.outline.showRight(o.outline)&&(i.paddings.right+=a.outlineWeight)):i.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,s.Gridline)},i.prototype.unbindColumnHeader=function(e,t){a.clearCellStyle(t),a.clearCellTextAndTooltip(t);var i=this.getSortableHeaderColumnMetadata(e);i&&this.unregisterColumnHeaderClickHandler(t),this.options.showSortIcons&&a.removeSortIcons(t)},i.prototype.bindHeader=function(e,i,r,n,s,l){a.addCellCssClass(i,a.CssClassTablixHeader),s.fontFamily=a.FontFamilyHeader,s.fontColor=a.FontColorHeaders;var c=this.formattingProperties.grid.imageHeight;if(t.converterHelper.isImageUrlColumn(n)?i.contentHeight=c:e.isSubtotal?i.contentHeight=this.textHeightTotal:i.contentHeight=this.textHeightValue,e.isSubtotal&&(a.addCellCssClass(i,a.CssClassTablixValueTotal),s.fontFamily=a.FontFamilyTotal,!l))return void a.setCellTextAndTooltip(this.options.totalLabel,r,i.extension.contentHost);var u=this.getHeaderLabel(e);u?t.converterHelper.isWebUrlColumn(n)&&o.isValidUrl(u)?a.appendATagToBodyCell(e.valueFormatted,r):t.converterHelper.isImageUrlColumn(n)?(s.hasImage=!0,o.isValidImageUrl(u)?a.appendImgTagToBodyCell(e.valueFormatted,r,c):a.setCellTextAndTooltip(u,r,i.extension.contentHost)):a.setCellTextAndTooltip(u,r,i.extension.contentHost):r.innerHTML=a.StringNonBreakingSpace},i.prototype.registerColumnHeaderClickHandler=function(e,t){var i=this;if(this.options.onColumnHeaderClick){var r=function(t){if(a.isValidSortClick(t)){var r=a.reverseSort(e.sort);i.options.onColumnHeaderClick(e.queryName?e.queryName:e.displayName,r)}};t.extension.registerClickHandler(r)}},i.prototype.unregisterColumnHeaderClickHandler=function(e){this.options.onColumnHeaderClick&&e.extension.unregisterClickHandler()},i.prototype.bindBodyCell=function(e,t){a.resetCellCssClass(t);var i=new a.CellStyle;t.contentHeight=this.textHeightValue,e.kpiContent?$(t.extension.contentHost).append(e.kpiContent):(a.addCellCssClass(t,a.CssClassTablixValueNumeric),e.isTotal&&(a.addCellCssClass(t,a.CssClassTablixValueTotal),i.fontFamily=a.FontFamilyTotal,t.contentHeight=this.textHeightTotal),e.textContent&&a.setCellTextAndTooltip(e.textContent,t.extension.contentHost)),this.setBodyCellStyle(t,e,i),t.applyStyle(i)},i.prototype.setBodyCellStyle=function(e,i,a){var r=this.formattingProperties.grid,o=this.formattingProperties.values,l=this.formattingProperties.subtotals,c=this.formattingProperties.rowHeaders,u=this.formattingProperties.columnHeaders;a.paddings.top=a.paddings.bottom=r.rowPadding,a.borders.top=new n,e.position.row.isFirst&&(a.borders.top.applyParams(t.outline.showTop(o.outline),r.outlineWeight,r.outlineColor,s.Outline),!t.outline.showTop(o.outline)&&t.outline.showTop(c.outline)&&(a.paddings.top+=r.outlineWeight)),a.borders.bottom=new n,e.position.row.isLast?(a.borders.bottom.applyParams(t.outline.showBottom(o.outline),r.outlineWeight,r.outlineColor,s.Outline),!t.outline.showBottom(o.outline)&&t.outline.showBottom(c.outline)&&(a.paddings.bottom+=r.outlineWeight)):a.borders.bottom.applyParams(r.gridHorizontal,r.gridHorizontalWeight,r.gridHorizontalColor),a.borders.left=new n,e.position.column.isFirst&&a.borders.left.applyParams(t.outline.showLeft(o.outline),r.outlineWeight,r.outlineColor,s.Outline),a.borders.right=new n,e.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(o.outline),r.outlineWeight,r.outlineColor,s.Outline),!t.outline.showRight(o.outline)&&t.outline.showRight(u.outline)&&(a.paddings.right+=r.outlineWeight)):a.borders.right.applyParams(r.gridVertical,r.gridVerticalWeight,r.gridVerticalColor,s.Gridline);var h;h=this.formattingProperties.general.rowSubtotals&&l.backColor?i.position.row.indexInSiblings:i.position.row.index,i.isTotal&&l.fontColor?a.fontColor=l.fontColor:a.fontColor=h%2===0?o.fontColorPrimary:o.fontColorSecondary,i.isTotal&&l.backColor?a.backColor=l.backColor:a.backColor=h%2===0?o.backColorPrimary:o.backColorSecondary},i.prototype.unbindBodyCell=function(e,t){a.clearCellStyle(t),a.clearCellTextAndTooltip(t)},i.prototype.bindCornerCell=function(e,t){a.resetCellCssClass(t);var i=new a.CellStyle;i.fontFamily=a.FontFamilyHeader,i.fontColor=a.FontColorHeaders,t.contentHeight=this.textHeightHeader;var o=t.extension.contentHost;if(e.isColumnHeaderLeaf&&(a.addCellCssClass(t,a.CssClassTablixColumnHeaderLeaf),i.borders.bottom=new n(r.PropGridOutlineWeight.defaultValue,r.PropGridOutlineColor.defaultValue),this.options.showSortIcons)){var s=this.getSortableCornerColumnMetadata(e);s&&(this.registerColumnHeaderClickHandler(s,t),o=a.addSortIconToColumnHeader(s?s.sort:void 0,o))}a.setCellTextAndTooltip(e.displayName,o,t.extension.contentHost),e.isRowHeaderLeaf&&a.addCellCssClass(t,a.CssClassMatrixRowHeaderLeaf),a.addCellCssClass(t,a.CssClassTablixHeader),this.setCornerCellsStyle(t,i),t.applyStyle(i),t.extension.disableDragResize()},i.prototype.setCornerCellsStyle=function(e,i){var a=this.formattingProperties.grid,r=this.formattingProperties.columnHeaders,o=this.formattingProperties.rowHeaders;i.fontColor=r.fontColor||o.fontColor,i.backColor=r.backColor||o.backColor,i.paddings.top=i.paddings.bottom=a.rowPadding,i.borders.top=new n,e.position.row.isFirst&&i.borders.top.applyParams(t.outline.showTop(r.outline),a.outlineWeight,a.outlineColor,s.Outline),i.borders.bottom=new n,e.position.row.isLast?i.borders.bottom.applyParams(t.outline.showBottom(r.outline),a.outlineWeight,a.outlineColor,s.Outline):i.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,s.Gridline),i.borders.left=new n,e.position.column.isFirst&&(i.borders.left.applyParams(t.outline.showLeft(r.outline),a.outlineWeight,a.outlineColor,s.Outline),!t.outline.showLeft(r.outline)&&t.outline.showLeft(o.outline)&&(i.paddings.left+=a.outlineWeight)),i.borders.right=new n,i.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,s.Gridline)},i.prototype.unbindCornerCell=function(e,t){a.clearCellStyle(t),a.clearCellTextAndTooltip(t),this.options.showSortIcons&&a.removeSortIcons(t),e.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(t)},i.prototype.bindEmptySpaceHeaderCell=function(e){},i.prototype.unbindEmptySpaceHeaderCell=function(e){},i.prototype.bindEmptySpaceFooterCell=function(e){},i.prototype.unbindEmptySpaceFooterCell=function(e){},i.prototype.getHeaderLabel=function(e){return e.valueFormatted},i.prototype.getCellContent=function(e){return e.textContent||""},i.prototype.hasRowGroups=function(){var e=this.hierarchyNavigator.getDataViewMatrix();return!!(e&&e.rows&&e.rows.levels&&0!==e.rows.levels.length)},i.prototype.getSortableCornerColumnMetadata=function(e){return e.isColumnHeaderLeaf?e.metadata:void 0},i.prototype.getRowHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.rows)return this.getHierarchyMetadata(t.rows,e.level)}},i.prototype.getColumnHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.columns)return this.getHierarchyMetadata(t.columns,e.level)}},i.prototype.getHierarchyMetadata=function(e,t){if(e&&e.levels&&!(e.levels.length<t)){var i=e.levels[t];if(i&&i.sources&&0!==i.sources.length)return i.sources[0]}},i.prototype.getSortableHeaderColumnMetadata=function(e){var t=this.hierarchyNavigator.getDataViewMatrix();if(!t.rows||!t.rows.levels||0===t.rows.levels.length)return null;var i=t.valueSources&&t.valueSources.length>1,a=t.columns?t.columns.levels.length:0;i?a--:1===a&&t.columns.levels[0]&&t.columns.levels[0].sources&&t.columns.levels[0].sources[0]&&t.columns.levels[0].sources[0].roles&&t.columns.levels[0].sources[0].roles.Values&&(a=0);var r=-1;return 0===a?r=e.levelSourceIndex:e.isSubtotal&&(i?e.parent&&0===e.parent.level&&(r=e.levelSourceIndex):0===e.level&&(r=e.levelSourceIndex)),-1!==r?(r=r?r:0,t.valueSources[r]):null},i}();t.MatrixBinder=u;var h=function(){function o(e){e&&(this.isTouchEnabled=e.isTouchEnabled)}return o.customizeQuery=function(e){var t=e.dataViewMappings[0];if(t&&t.matrix&&t.metadata){var i=t.matrix;_.isEmpty(i.columns["for"]["in"].items)||(i.rows.dataReductionAlgorithm.window.count=100);var a=t.metadata.objects;i.rows["for"]["in"].subtotalType=r.shouldShowRowSubtotals(a)?2:0,i.columns["for"]["in"].subtotalType=r.shouldShowColumnSubtotals(a)?2:0}},o.getSortableRoles=function(){return["Rows","Values"]},o.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatVariantMeasureValue,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.hostServices=e.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},o.converter=function(e){return r.getMatrixObjects(e)},o.prototype.onResizing=function(e){this.updateViewport(e)},o.prototype.getColumnWidthManager=function(){return this.columnWidthManager},o.prototype.onDataChanged=function(t){var i=t.dataViews;if(i&&i.length>0){var a=this.dataView;this.dataView=i[0];var r=o.converter(this.dataView),n=r.general.textSize;if(t.operationKind===e.VisualDataChangeOperationKind.Append){var s=a.matrix.rows.root!==this.dataView.matrix.rows.root;this.hierarchyNavigator.update(this.dataView.matrix,s),s&&this.tablixControl.updateModels(!1,this.dataView.matrix.rows.root.children,this.dataView.matrix.columns.root.children),this.refreshControl(!1)}else{this.createOrUpdateHierarchyNavigator(),this.createColumnWidthManager(),this.createTablixControl(n);var l=this.tablixControl.getBinder();l.onDataViewChanged(r),this.updateInternal(n,a)}}this.waitingForData=!1,this.waitingForSort=!1},o.prototype.createColumnWidthManager=function(){var e=this,i=this.hierarchyNavigator.getMatrixColumnHierarchy();this.columnWidthManager?this.persistingObjects||this.columnWidthManager.updateDataView(this.dataView,i.leafNodes):this.columnWidthManager=new t.controls.TablixColumnWidthManager(this.dataView,!0,function(t){return e.persistColumnWidths(t)},i.leafNodes)},o.prototype.persistColumnWidths=function(e){this.persistingObjects=!0,this.hostServices.persistProperties(e)},o.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},o.prototype.refreshControl=function(e){(t.visibilityHelper.partiallyVisible(this.element)||1===this.getLayoutKind())&&this.tablixControl.refresh(e)},o.prototype.getLayoutKind=function(){return this.isInteractive?0:1},o.prototype.createOrUpdateHierarchyNavigator=function(){if(this.tablixControl)this.hierarchyNavigator.update(this.dataView.matrix);else{var e=i(this.dataView.matrix,this.formatter,this.hostServices.getLocalizedString("ListJoin_Separator"));this.hierarchyNavigator=e}},o.prototype.createTablixControl=function(e){this.tablixControl||(this.tablixControl=this.createControl(this.hierarchyNavigator,e))},o.prototype.createControl=function(e,i){var a=this,n=this.getLayoutKind(),s={onBindRowHeader:function(e){a.onBindRowHeader(e)},totalLabel:this.hostServices.getLocalizedString(o.TotalLabel),onColumnHeaderClick:function(e,t){return a.onColumnHeaderClick(e,t)},showSortIcons:0===n},l=new u(this.hierarchyNavigator,s),c=1===n?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(l):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(l,this.columnWidthManager),h=document.createElement("div");this.element.append(h);var d={interactive:this.isInteractive,enableTouchSupport:this.isTouchEnabled,layoutKind:n,fontSize:r.getTextSizeInPx(i)};return new t.controls.TablixControl(e,c,l,h,d)},o.prototype.updateInternal=function(e,i){var a=this;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize(t.converterHelper.hasImageUrlColumn(this.dataView)),this.tablixControl.fontSize=r.getTextSizeInPx(e),this.verifyHeaderResize(),this.tablixControl.updateModels(!this.persistingObjects,this.dataView.matrix.rows.root.children,this.dataView.matrix.columns.root.children),this.tablixControl.viewport=this.currentViewport;var o=this.shouldClearControl(i,this.dataView);setTimeout(function(){return a.refreshControl(o),a.persistingObjects?void(a.persistingObjects=!1):void(a.columnWidthManager.shouldPersistAllColumnWidths()&&a.columnWidthManager.persistAllColumnWidths(a.tablixControl.layoutManager.columnWidthsToPersist))},0)},o.prototype.shouldClearControl=function(t,i){return this.waitingForSort&&t&&i?!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata):!0},o.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},o.prototype.onColumnHeaderClick=function(e,t){this.waitingForSort=!0,this.hostServices.onCustomSort(a.getCustomSortEventArgs(e,t))},o.prototype.needsMoreData=function(e){if(this.waitingForData||!this.hierarchyNavigator.isLeaf(e)||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),i=t*o.preferredLoadMoreThreshold;return this.hierarchyNavigator.getLeafIndex(e)>=i},o.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;return this.dataView&&r.enumerateObjectInstances(e,i,this.dataView,t.controls.TablixType.Matrix),i.complete()},o.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},o.prototype.onViewModeChanged=function(e){this.updateViewport(this.currentViewport)},o.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},o.preferredLoadMoreThreshold=.8,o.TotalLabel="TableTotalLabel",o}();t.Matrix=h}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants,a=function(){function a(e){this.tooltipsEnabled=e&&e.tooltipsEnabled,this.tooltipBucketEnabled=e&&e.tooltipBucketEnabled,e&&e.animator&&(this.animator=e.animator,this.isScrollable=e.isScrollable?e.isScrollable:!1,this.behavior=e.behavior)}return a.getLayout=function(e,i){var r=t.dataLabelUtils.createColumnFormatterCacheManager(),o=e.showCategory,n=e.show||e.showCategory;return{shapeClass:function(e){return a.getNodeClass(e,!1)},shapeLayout:a.createTreemapShapeLayout(!1),highlightShapeClass:function(e){return a.getNodeClass(e,!0)},highlightShapeLayout:a.createTreemapShapeLayout(!0),zeroShapeLayout:a.createTreemapZeroShapeLayout(),majorLabelClass:function(e){return a.MajorLabelClassName},majorLabelLayout:{x:function(e){return e.x+a.TextMargin},y:function(e){return e.y+a.TextMargin+a.MajorLabelTextSize}},majorLabelText:function(t){return a.createMajorLabelText(t,e,i,r)},minorLabelClass:function(e){return a.MinorLabelClassName},minorLabelLayout:{x:function(e){return e.x+a.TextMargin},y:function(e){return e.y+e.dy-a.TextMargin}},minorLabelText:function(t){return a.createMinorLabelText(t,e,i,r)},areMajorLabelsEnabled:function(){return o},areMinorLabelsEnabled:function(){return n}}},a.prototype.init=function(e){this.options=e;var i=e.element;i.empty(),this.svg=d3.select(i.get(0)).append("svg").style("position","absolute").classed(a.ClassName,!0),this.shapeGraphicsContext=this.svg.append("g").classed(a.ShapesClassName,!0),this.labelGraphicsContext=this.svg.append("g").classed(a.LabelsGroupClassName,!0),this.element=i,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.style=e.style,this.treemap=d3.layout.treemap().sticky(!1).sort(function(e,t){return e.size-t.size}).value(function(e){return e.size}).round(!1),this.behavior&&(this.interactivityService=t.createInteractivityService(e.host)),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.colors=this.style.colorPalette.dataColors,this.hostService=e.host},a.converter=function(i,r,o,n,s,l,c,u){void 0===c&&(c=!0);var h,d=e.data.createIDataViewCategoricalReader(i),p={key:"root",name:"root",children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},g=[],m=[],f="",y=new t.ColorHelper(r,t.treemapProps.dataPoint.fill),v=void 0;if(i&&i.metadata&&i.metadata.objects){var b=i.metadata.objects;o.show=e.DataViewObjects.getValue(b,t.treemapProps.labels.show,o.show),o.labelColor=e.DataViewObjects.getFillColor(b,t.treemapProps.labels.color,o.labelColor),o.displayUnits=e.DataViewObjects.getValue(b,t.treemapProps.labels.labelDisplayUnits,o.displayUnits),o.precision=e.DataViewObjects.getValue(b,t.treemapProps.labels.labelPrecision,o.precision),o.showCategory=e.DataViewObjects.getValue(b,t.treemapProps.categoryLabels.show,o.showCategory)}if(d.hasValues(t.treemapRoles.values)||d.hasValues(t.treemapRoles.gradient)){var C=d.hasValues(t.treemapRoles.values)?t.treemapRoles.values:t.treemapRoles.gradient,S=i.categorical;h=d.hasHighlights(C);var x=t.treemapProps.general.formatString,w=a.getValuesFromCategoricalDataView(i,h,C),P=w.values,D=w.highlights,L=w.totalValue;w.highlightsOverflow&&(h=!1,P=D);var T=a.getCullableValue(L,s),V=d.hasDynamicSeries();v=!1;var M=void 0,N=d.getValueColumn(t.treemapRoles.gradient,0);if(null!=S.categories||_.isEmpty(P)){if(S.categories&&S.categories.length>0){var A=d.getSeriesCount(C),O=1===A,I=S.categories[0];f=I.source.displayName;for(var R=t.valueFormatter.getFormatString(I.source,x),F=0,H=P.length;H>F;F++){var b=I.objects&&I.objects[F],z=y.getColorForSeriesValue(b,I.identityFields,I.values[F]),G=t.valueFormatter.format(I.values[F],R),k=P[F],j=0,E=k[j],B=h&&D?D[F][j]:void 0,W=void 0,U=void 0;if(c){W=[],U={displayName:I.source.displayName,value:G},W.push(U);var Y=void 0;null!=E&&(Y=d.getValueMetadataColumn(C,j),W.push({displayName:Y.displayName,value:t.converterHelper.formatFromMetadataColumn(E,Y,x)})),null!=B&&W.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(B,Y,x)});var K=N?N.source:void 0;if(O&&K&&K!==Y&&null!=N.values[F]&&W.push({displayName:K.displayName,value:t.converterHelper.formatFromMetadataColumn(N.values[F],K,x)}),u){var X=d.getAllValuesForRole("Tooltips",F,j),q=d.getAllValueMetadataColumnsForRole("Tooltips",j);if(X&&q)for(var $=0;$<X.length;$++)null!=X[$]&&W.push({displayName:q[$].displayName,value:t.converterHelper.formatFromMetadataColumn(X[$],q[$],x)})}}var Q=t.SelectionIdBuilder.builder().withCategory(I,F).withMeasure(O?d.getValueMetadataColumn(C,j).queryName:void 0).createSelectionId(),Z=JSON.stringify({nodeKey:Q.getKey(),depth:1}),J={key:Z,name:G,color:z,selected:!1,identity:Q,tooltipInfo:W,highlightedTooltipInfo:W,labelFormatString:1===A?t.valueFormatter.getFormatString(d.getValueMetadataColumn(C,j),x):R};h&&(J.highlightMultiplier=0!==E?B/E:0,
J.highlightValue=B),m.push({label:G,color:z,icon:t.LegendIcon.Box,identity:Q,selected:!1});for(var ee=0,te=0;A>j;j++){var ie=d.getValueColumn(C,j),ae=k[j],re=void 0;if(M=T>ae,a.checkValueForShape(ae)&&!M){if(ee+=ae,h&&(re=D[F][j],te+=re),!O){var oe=null;oe=d.hasDynamicSeries()?t.converterHelper.formatFromMetadataColumn(d.getSeriesName(j),d.getSeriesMetadataColumn(),x):t.converterHelper.formatFromMetadataColumn(d.getValueDisplayName(C,j),d.getValueMetadataColumn(C,j),x);var ne=S?S.values:null,se=ie.source.queryName,le=t.SelectionIdBuilder.builder().withCategory(I,F).withSeries(ne,ie).withMeasure(se).createSelectionId(),ce=JSON.stringify({nodeKey:le.getKey(),depth:2}),ue=h&&0!==re?re:void 0,he=void 0;if(c&&(he=[],he.push(U),V&&(I&&I.source===ne.source||he.push({displayName:ne.source.displayName,value:t.converterHelper.formatFromMetadataColumn(d.getSeriesName(j),ne.source,x)})),null!=ae&&he.push({displayName:ie.source.displayName,value:t.converterHelper.formatFromMetadataColumn(ae,ie.source,x)}),null!=B&&he.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(ue,ie.source,x)}),u)){var X=d.getAllValuesForRole("Tooltips",F,V?j:void 0),q=d.getAllValueMetadataColumnsForRole("Tooltips",V?j:void 0);if(X&&q)for(var $=0;$<X.length;$++)null!=X[$]&&he.push({displayName:q[$].displayName,value:t.converterHelper.formatFromMetadataColumn(X[$],q[$],x)})}var de={key:ce,name:oe,size:ae,color:z,selected:!1,identity:le,tooltipInfo:he,highlightedTooltipInfo:he,labelFormatString:t.valueFormatter.getFormatString(ie.source,x)};h&&(de.highlightMultiplier=0!==ae?re/ae:0,de.highlightValue=re),null==J.children&&(J.children=[]),J.children.push(de),g.push(de)}}else v=v||M}a.checkValueForShape(ee)&&(J.size=ee,p.children.push(J),g.push(J)),h&&(J.highlightMultiplier=ee?te/ee:0)}}}else for(var j=0,A=d.getSeriesCount(C);A>j;j++){var ie=d.getValueColumn(C,j),E=P[0][j];if(a.checkValueForShape(E))if(T>E)v=v||M;else{var pe=V?t.converterHelper.formatFromMetadataColumn(d.getSeriesValueColumnGroup(j).name,d.getSeriesMetadataColumn(),x):t.converterHelper.formatFromMetadataColumn(d.getValueDisplayName(C,j),ie.source,x),Q=(new t.SelectionIdBuilder).withSeries(i.categorical.values,V?ie:void 0).withMeasure(ie.source.queryName).createSelectionId(),Z=Q.getKey(),z=V?y.getColorForSeriesValue(d.getSeriesObjects(j),S.values.identityFields,t.converterHelper.getSeriesName(ie.source)):y.getColorForMeasure(ie.source.objects,ie.source.queryName),ue=h?D[0][j]:void 0,W=void 0;if(c){if(W=[],V){var ge=d.getSeriesMetadataColumn(),me=d.getSeriesValueColumnGroup(j).name;W.push({displayName:ge.displayName,value:t.converterHelper.formatFromMetadataColumn(me,ge,x)})}if(null!=E&&W.push({displayName:ie.source.displayName,value:t.converterHelper.formatFromMetadataColumn(E,ie.source,x)}),null!=ue&&W.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(ue,ie.source,x)}),u){var X=d.getAllValuesForRole("Tooltips",0,V?j:void 0),q=d.getAllValueMetadataColumnsForRole("Tooltips",V?j:void 0);if(X&&q)for(var $=0;$<X.length;$++)null!=X[$]&&W.push({displayName:q[$].displayName,value:t.converterHelper.formatFromMetadataColumn(X[$],q[$],x)})}}var J={key:Z,name:pe,size:E,color:z,selected:!1,identity:Q,tooltipInfo:W,highlightedTooltipInfo:W,labelFormatString:t.valueFormatter.getFormatString(ie.source,x)};h&&D&&(J.highlightMultiplier=0!==E?D[0][j]/E:0,J.highlightValue=D[0][j]),p.children.push(J),g.push(J),m.push({label:pe,color:z,icon:t.LegendIcon.Box,identity:Q,selected:!1})}}}return n&&(n.applySelectionStateToData(g),n.applySelectionStateToData(m)),{root:p,hasHighlights:h,legendData:{title:f,dataPoints:m,fontSize:t.SVGLegend.DefaultFontSizeInPt},dataLabelsSettings:o,legendObjectProperties:l,dataWasCulled:v}},a.getValuesFromCategoricalDataView=function(t,i,a){for(var r=e.data.createIDataViewCategoricalReader(t),o=r.getCategoryCount()||1,n=r.getSeriesCount(a),s=[],l=[],c=0,u=0;o>u;u++)s.push([]),i&&l.push([]);for(var h,d=0;n>d;d++)for(var p=0;o>p;p++){var g=r.getValue(a,p,d);if(s[p].push(g),c+=isNaN(g)?0:g,i){var m=r.getHighlight(a,p,d);null==m&&(m=0),l[p].push(m),m>g&&(h=!0)}}return{values:s,highlights:i?l:void 0,highlightsOverflow:i?h:void 0,totalValue:c}},a.getCullableValue=function(e,t){var i=t.width*t.height,r=a.CullableArea/i;return r*e},a.prototype.update=function(e){var i=this.dataViews=e.dataViews;this.currentViewport=e.viewport;var r=i&&i.length>0&&i[0].categorical?i[0].categorical:void 0,o=t.dataLabelUtils.getDefaultTreemapLabelSettings(),n=null;if(r){var s=i[0],l=s.metadata,c=void 0;l&&(c=l.objects),c&&(n=c.legend),this.data=a.converter(s,this.colors,o,this.interactivityService,this.currentViewport,n,this.tooltipsEnabled,this.tooltipBucketEnabled)}else{var u={key:"root",name:"root",children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},h={title:"",dataPoints:[]},d={root:u,hasHighlights:!1,legendData:h,dataLabelsSettings:o,dataWasCulled:!1};this.data=d}if(this.updateInternal(e.suppressAnimations),i){var p=t.getInvalidValueWarnings(i,!1,!1,!1);this.hostService.setWarnings(p)}},a.prototype.onDataChanged=function(e){this.update({suppressAnimations:e.suppressAnimations,dataViews:e.dataViews,viewport:this.currentViewport})},a.prototype.onResizing=function(e){this.update({suppressAnimations:!0,dataViews:this.dataViews,viewport:e})},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.prototype.enumerateObjectInstances=function(e){var i=this.data;if(i){var a=e.objectName,r=new t.ObjectEnumerationBuilder,o=this.data.dataLabelsSettings?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultTreemapLabelSettings();switch(a){case"dataPoint":var n=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,s=t.GradientUtils.hasGradientRole(n);s||this.enumerateDataPoints(r,i);break;case"legend":return this.enumerateLegend(i);case"labels":var l={enumeration:r,dataLabelsSettings:o,show:!0,displayUnits:!0,precision:!0};t.dataLabelUtils.enumerateDataLabels(l);break;case"categoryLabels":t.dataLabelUtils.enumerateCategoryLabels(r,o,!1,!0)}return r.complete()}},a.prototype.enumerateDataPoints=function(e,i){var a=i.root.children;if(!_.isEmpty(a))for(var r=0;r<a.length;r++){var o=a[r];e.pushInstance({displayName:o.name,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}},objectName:"dataPoint"})}},a.prototype.enumerateLegend=function(i){var a={legend:i.legendObjectProperties},r=e.DataViewObjects.getValue(a,t.treemapProps.legend.show,this.legend.isVisible()),o=e.DataViewObjects.getValue(a,t.treemapProps.legend.showTitle,!0),n=e.DataViewObjects.getValue(a,t.treemapProps.legend.titleText,this.data.legendData.title),s=e.DataViewObject.getValue(a,t.legendProps.labelColor,this.data.legendData?this.data.legendData.labelColor:t.LegendData.DefaultLegendLabelFillColor),l=e.DataViewObject.getValue(a,t.legendProps.fontSize,this.data.legendData&&this.data.legendData.fontSize?this.data.legendData.fontSize:t.SVGLegend.DefaultFontSizeInPt);return[{selector:null,objectName:"legend",properties:{show:r,position:t.LegendPosition[this.legend.getOrientation()],showTitle:o,titleText:n,labelColor:s,fontSize:l}}]},a.checkValueForShape=function(e){return e?e>0:!1},a.prototype.calculateTreemapSize=function(){var e=this.legend.getMargins();return{height:this.currentViewport.height-e.height,width:this.currentViewport.width-e.width}},a.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0);var i=this.calculateTreemapSize();this.svg.attr({width:i.width,height:i.height}),t.Legend.positionChartArea(this.svg,this.legend),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.hasChildrenWithIdentity=function(e){var t=e.children;if(!t)return!1;var i=t.length;if(0===i)return!1;for(var a=i-1;a>=0;a--)if(t[a].identity.hasIdentity())return!0;return!1},a.canDisplayMajorLabel=function(e){if(1!==e.depth)return!1;if(_.isEmpty(e.name))return!1;var t=e.dx-2*a.TextMargin;if(t<a.MinTextWidthForMajorLabel)return!1;var i=a.MajorLabelTextSize+2*a.TextMargin;return!(e.dy<i)},a.canDisplayMinorLabel=function(e,t){if(e.depth<1||e.depth>2)return!1;if(1===e.depth&&(e.children||!t.show))return!1;if(_.isEmpty(e.name))return!1;var i=e.dx-2*a.TextMargin;if(i<a.MinTextWidthForMinorLabel)return!1;var r=a.MinorLabelTextSize+2*a.TextMargin;if(e.dy<r)return!1;if(1===e.depth){var o=e.y+a.MajorLabelTextSize+2*a.TextMargin;if(e.y+e.dy-o<r)return!1}else if(2===e.depth){var n=e.parent,o=Math.max(n.y+a.MajorLabelTextSize+2*a.TextMargin,e.y);if(e.y+e.dy-o<r)return!1}return!0},a.createMajorLabelText=function(t,i,r,o){var n=t.dx-2*a.TextMargin,s=a.MajorLabelTextProperties,l={text:t.name,fontFamily:s.fontFamily,fontSize:s.fontSize};return e.TextMeasurementService.getTailoredTextOrDefault(l,n)},a.createMinorLabelText=function(e,i,r,o){var n=e.dx-2*a.TextMargin,s=e.name;if(i.show){var l=o.getOrCreate(e.labelFormatString,i,r);s=t.dataLabelUtils.getLabelFormattedText({label:null!=e.highlightValue?e.highlightValue:e.value,maxWidth:n,formatter:l}),i.showCategory&&2===e.depth&&(s=t.dataLabelUtils.getLabelFormattedText({label:e.name,maxWidth:n})+" "+s)}return t.dataLabelUtils.getLabelFormattedText({label:s,maxWidth:n,fontSize:i.fontSize})},a.getFill=function(e,t){return e.depth>1&&!e.identity.hasIdentity()&&!t?i.noneValue:a.hasChildrenWithIdentity(e)?i.noneValue:e.color},a.getFillOpacity=function(e,t,i,r){return i?r?null:a.DimmedShapeOpacity.toString():!t||e.selected?null:e.depth>1&&e.parent.selected?null:a.hasChildrenWithIdentity(e)?null:a.DimmedShapeOpacity.toString()},a.prototype.updateInternal=function(e){var i=this.data,r=i&&i.hasHighlights,o=i?i.dataLabelsSettings:null,n=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.options.interactivity&&this.options.interactivity.isInteractiveLegend||!this.data||this.renderLegend(),this.initViewportDependantProperties(n);var s=this.calculateTreemapSize();this.treemap.size([s.width,s.height]);var l=i&&i.root?this.treemap.nodes(i.root):[],c=l.filter(function(e){return null!=e.highlightMultiplier&&(!e.children||0===e.children.length)}),u=[],h=[],d=null;o.showCategory&&(u=l.filter(function(e){return a.canDisplayMajorLabel(e)})),(o.show||o.showCategory)&&(h=l.filter(function(e){return a.canDisplayMinorLabel(e,o)}),0===o.displayUnits&&(d=d3.max(h,function(e){return Math.abs(e.value)})));var p,g,m,f,y,v=a.getLayout(o,d);if(this.animator&&!e){var b={viewModel:i,nodes:l,highlightNodes:c,majorLabeledNodes:u,minorLabeledNodes:h,shapeGraphicsContext:this.shapeGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,interactivityService:this.interactivityService,layout:v,labelSettings:o};y=this.animator.animate(b),p=y.shapes,g=y.highlightShapes,m=y.majorLabels,f=y.minorLabels}if(!this.animator||e||y.failed){var C=this.interactivityService&&this.interactivityService.hasSelection(),S=this.shapeGraphicsContext;p=a.drawDefaultShapes(S,l,C,r,v),g=a.drawDefaultHighlightShapes(S,c,C,r,v);var x=this.labelGraphicsContext;m=a.drawDefaultMajorLabels(x,u,o,v),f=a.drawDefaultMinorLabels(x,h,o,v)}if(this.interactivityService){var w={shapes:p,highlightShapes:g,majorLabels:m,minorLabels:f,nodes:l,hasHighlights:i.hasHighlights};this.interactivityService.bind(l,this.behavior,w)}this.tooltipsEnabled&&(t.TooltipManager.addTooltip(p,function(e){return e.data.highlightedTooltipInfo?e.data.highlightedTooltipInfo:e.data.tooltipInfo}),t.TooltipManager.addTooltip(g,function(e){return e.data.highlightedTooltipInfo})),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.renderLegend=function(){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.currentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.currentViewport)},a.getNodeClass=function(e,t){var i;switch(e.depth){case 1:i=a.ParentGroupClassName;break;case 2:i=a.NodeGroupClassName;break;case 0:i=a.RootNodeClassName}return i+=" "+(t?a.HighlightNodeClassName:a.TreemapNodeClassName)},a.createTreemapShapeLayout=function(e){return void 0===e&&(e=!1),{x:function(e){return e.x},y:function(t){return t.y+(e?t.dy*(1-t.highlightMultiplier):0)},width:function(e){return Math.max(0,e.dx)},height:function(t){return Math.max(0,t.dy*(e?t.highlightMultiplier:1))}}},a.createTreemapZeroShapeLayout=function(){return{x:function(e){return e.x},y:function(e){return e.y+e.dy},width:function(e){return Math.max(0,e.dx)},height:function(e){return 0}}},a.drawDefaultShapes=function(e,t,i,r,o){var n=!1,s=e.selectAll("."+a.TreemapNodeClassName).data(t,function(e){return e.key});return s.enter().append("rect").attr("class",o.shapeClass),s.style("fill",function(e){return a.getFill(e,n)}).style("fill-opacity",function(e){return a.getFillOpacity(e,i,r,n)}).attr(o.shapeLayout),s.exit().remove(),s},a.drawDefaultHighlightShapes=function(e,t,i,r,o){var n=!0,s=e.selectAll("."+a.HighlightNodeClassName).data(t,function(e){return e.key+"highlight"});return s.enter().append("rect").attr("class",o.highlightShapeClass),s.style("fill",function(e){return a.getFill(e,n)}).style("fill-opacity",function(e){return a.getFillOpacity(e,i,r,n)}).attr(o.highlightShapeLayout),s.exit().remove(),s},a.drawDefaultMajorLabels=function(e,t,i,r){var o=e.selectAll("."+a.MajorLabelClassName).data(t,function(e){return e.key});return o.enter().append("text").attr("class",r.majorLabelClass),o.attr(r.majorLabelLayout).text(r.majorLabelText).style("fill",function(){return i.labelColor}),o.exit().remove(),o},a.drawDefaultMinorLabels=function(e,t,i,r){var o=e.selectAll("."+a.MinorLabelClassName).data(t,function(e){return e.key});return o.enter().append("text").attr("class",r.minorLabelClass),o.attr(r.minorLabelLayout).text(r.minorLabelText).style("fill",function(){return i.labelColor}),o.exit().remove(),o},a.cleanMinorLabels=function(e){var t=[],i=e.selectAll("."+a.LabelsGroupClassName).selectAll("."+a.MinorLabelClassName).data(t);i.exit().remove()},a.DimmedShapeOpacity=.4,a.ClassName="treemap",a.LabelsGroupClassName="labels",a.MajorLabelClassName="majorLabel",a.MinorLabelClassName="minorLabel",a.ShapesClassName="shapes",a.TreemapNodeClassName="treemapNode",a.RootNodeClassName="rootNode",a.ParentGroupClassName="parentGroup",a.NodeGroupClassName="nodeGroup",a.HighlightNodeClassName="treemapNodeHighlight",a.TextMargin=5,a.MinorLabelTextSize=10,a.MinTextWidthForMinorLabel=18,a.MajorLabelTextSize=12,a.MinTextWidthForMajorLabel=22,a.MajorLabelTextProperties={fontFamily:"wf_segoe-ui_normal",fontSize:a.MajorLabelTextSize+"px"},a.CullableArea=9,a}();t.Treemap=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.visuals.KpiUtil.getKpiImageMetadata,a=jsCommon.CssConstants.createClassAndSelector,r=function(r){function o(t){r.call(this,o.cardClassName),this.isScrollable=!1,this.displayUnitSystemType=e.DisplayUnitSystemType.WholeUnits,t&&(this.isScrollable=!!t.isScrollable,t.animator&&(this.animator=t.animator),null!=t.displayUnitSystemType&&(this.displayUnitSystemType=t.displayUnitSystemType))}return __extends(o,r),o.prototype.init=function(e){this.animationOptions=e.animation;var t=e.element;this.kpiImage=d3.select(t.get(0)).append("div").classed(o.KPIImage["class"],!0);var i=this.svg=d3.select(t.get(0)).append("svg");this.graphicsContext=i.append("g"),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportProperties(),this.isScrollable&&(i.attr("class",o.cardClassName),this.labelContext=i.append("g"))},o.prototype.onDataChanged=function(i){var a,r=i.dataViews[0];if(r){this.getMetaDataColumn(r),r.single&&(a=r.single.value),this.cardFormatSetting=this.getDefaultFormatSettings();var o=r.metadata;if(o){var n=o.objects;if(n){var s=this.cardFormatSetting.labelSettings;s.labelColor=e.DataViewObjects.getFillColor(n,t.cardProps.labels.color,s.labelColor),s.precision=e.DataViewObjects.getValue(n,t.cardProps.labels.labelPrecision,s.precision),s.fontSize=e.DataViewObjects.getValue(n,t.cardProps.labels.fontSize,s.fontSize),s.precision!==t.dataLabelUtils.defaultLabelPrecision&&s.precision<0&&(s.precision=0),s.displayUnits=e.DataViewObjects.getValue(n,t.cardProps.labels.labelDisplayUnits,s.displayUnits),s.showCategory=e.DataViewObjects.getValue(n,t.cardProps.categoryLabels.show,s.showCategory),s.categoryLabelColor=e.DataViewObjects.getFillColor(n,t.cardProps.categoryLabels.color,s.categoryLabelColor),this.cardFormatSetting.wordWrap=e.DataViewObjects.getValue(n,t.cardProps.wordWrap.show,this.cardFormatSetting.wordWrap),this.cardFormatSetting.textSize=e.DataViewObjects.getValue(n,t.cardProps.categoryLabels.fontSize,this.cardFormatSetting.textSize)}}}this.updateInternal(a,!0,!0)},o.prototype.onResizing=function(e){this.currentViewport=e,this.updateViewportProperties(),this.updateInternal(this.value,!0,!0)},o.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},o.prototype.setTextProperties=function(e,t){o.cardTextProperties.fontSize=jsCommon.PixelConverter.fromPoint(t),o.cardTextProperties.text=e},o.prototype.getCardFormatTextSize=function(){return this.cardFormatSetting.textSize},o.prototype.getAdjustedFontHeight=function(e,t,i){var a=r.prototype.getAdjustedFontHeight.call(this,e,t,i);return Math.min(a,o.DefaultStyle.card.maxFontSize)},o.prototype.clear=function(e){void 0===e&&(e=!1),this.svg.select(o.Value.selector).text(""),e||this.svg.select(o.Label.selector).text(""),r.prototype.clear.call(this)},o.prototype.updateInternal=function(a,r,n){void 0===n&&(n=!1);var s=this.value,l=t.AnimatorCommon.GetAnimationDuration(this.animator,r);if(void 0===a)return void(void 0!==s&&this.clear());var c=this.metaDataColumn,u=this.cardFormatSetting.labelSettings,h=0===u.displayUnits,d=this.getFormatString(c),p=t.valueFormatter.create({format:d,value:h?a:u.displayUnits,precision:t.dataLabelUtils.getLabelPrecision(u.precision,d),displayUnitSystemType:h&&u.precision===t.dataLabelUtils.defaultLabelPrecision?this.displayUnitSystemType:e.DisplayUnitSystemType.WholeUnits,formatSingleValues:!!h,allowFormatBeautification:!0,columnType:c?c.type:void 0}),g=this.cardFormatSetting,m=jsCommon.PixelConverter.fromPointToPixel(u.fontSize),f=o.DefaultStyle.value;this.setTextProperties(a,this.getCardFormatTextSize());var y=e.TextMeasurementService.estimateSvgTextHeight(o.cardTextProperties),v=y+o.DefaultStyle.label.paddingTop,b=this.currentViewport.width,C=this.currentViewport.height,S=this.getTranslateX(b),x=(C-v-m)/2,w=i(c,a,1);if(this.isScrollable){if(!n&&s===a)return;s===a||!_.isEmpty(a)&&"string"==typeof a||(a=p.format(a));var P=c?c.displayName:void 0,D=u.showCategory?[P]:[],L=this.getTranslateY(m+v+x),T=this.labelContext.attr("transform",t.SVGUtil.translate(S,L)).selectAll("text").data(D);T.enter().append("text").attr("class",o.Label["class"]),T.text(function(e){return e}).style({"font-size":jsCommon.PixelConverter.fromPoint(this.getCardFormatTextSize()),fill:u.categoryLabelColor,"text-anchor":this.getTextAnchor()});var V=T.node();if(V&&(g.wordWrap?e.TextMeasurementService.wordBreak(V,b/2,C-L):T.call(t.AxisHelper.LabelLayoutStrategy.clip,b,e.TextMeasurementService.svgEllipsis)),T.append("title").text(function(e){return e}),T.exit().remove(),w)this.graphicsContext.selectAll("text").remove(),this.displayStatusGraphic(w,S,x,m);else{this.kpiImage.selectAll("div").remove();var M=this.graphicsContext.attr("transform",t.SVGUtil.translate(S,this.getTranslateY(m+x))).selectAll("text").data([a]);M.enter().append("text").attr("class",o.Value["class"]),M.text(function(e){return e}).style({"font-size":jsCommon.PixelConverter.fromPoint(u.fontSize),fill:u.labelColor,"font-family":f.fontFamily,"text-anchor":this.getTextAnchor()}),M.call(t.AxisHelper.LabelLayoutStrategy.clip,b,e.TextMeasurementService.svgEllipsis),M.append("title").text(function(e){return e}),M.exit().remove()}}else w?(this.graphicsContext.selectAll("text").remove(),this.displayStatusGraphic(w,S,x,m)):(this.kpiImage.selectAll("div").remove(),this.doValueTransition(s,a,this.displayUnitSystemType,this.animationOptions,l,n,p),this.graphicsContext.call(t.tooltipUtils.tooltipUpdate,[a]));this.value=a},o.prototype.displayStatusGraphic=function(e,i,a,r){this.graphicsContext.selectAll("text").remove();var o=this.kpiImage.select("div");o&&!o.empty()||(o=this.kpiImage.append("div")),o.attr("class",e["class"]).style("position","absolute").style("font-size",r+"px");var n=o.node().offsetWidth,s=o.node().offsetHeight;o.style("transform",t.SVGUtil.translateWithPixels(i-n/2,this.getTranslateY(r+a)-s))},o.prototype.getDefaultFormatSettings=function(){return{labelSettings:t.dataLabelUtils.getDefaultCardLabelSettings(o.DefaultStyle.value.color,o.DefaultStyle.label.color,o.DefaultStyle.value.textSize),wordWrap:!1,textSize:o.DefaultStyle.label.textSize}},o.prototype.enumerateObjectInstances=function(e){this.cardFormatSetting||(this.cardFormatSetting=this.getDefaultFormatSettings());var i=this.cardFormatSetting,a=new t.ObjectEnumerationBuilder;switch(e.objectName){case"categoryLabels":t.dataLabelUtils.enumerateCategoryLabels(a,i.labelSettings,!0,!0,i.textSize);break;case"labels":var r={enumeration:a,dataLabelsSettings:i.labelSettings,show:!0,displayUnits:!0,precision:!0,fontSize:!0};t.dataLabelUtils.enumerateDataLabels(r);break;case"wordWrap":a.pushInstance({objectName:"wordWrap",selector:null,properties:{show:i.wordWrap}})}return a.complete()},o.cardClassName="card",o.Label=a("label"),o.Value=a("value"),o.KPIImage=a("caption"),o.cardTextProperties={fontSize:null,text:null,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily},o.DefaultStyle={card:{maxFontSize:200},label:{textSize:12,color:"#a6a6a6",paddingTop:8},value:{textSize:27,color:"#333333",fontFamily:"wf_standard-font"}},o}(t.AnimatedText);t.Card=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(e){e[e.Sad=0]="Sad",e[e.Meh=1]="Meh",e[e.Happy=2]="Happy"}(i||(i={}));var a=function(){function a(){}return a.converter=function(e){return{}},a.getGaugeData=function(e){var i={max:100,min:0,target:void 0,total:0,tooltipItems:[]};if(e&&e.categorical&&e.categorical.values&&e.metadata&&e.metadata.columns)for(var a=e.categorical.values,r=e.metadata.columns,o=0;o<a.length;o++){var n=r[o],s=a[o].values[0]||0;n&&n.roles&&(n.roles[t.gaugeRoleNames.y]?(i.total=s,s&&i.tooltipItems.push({displayName:a[o].source.displayName,value:t.converterHelper.formatFromMetadataColumn(s,a[o].source,t.Gauge.formatStringProp)})):n.roles[t.gaugeRoleNames.minValue]?i.min=s:n.roles[t.gaugeRoleNames.maxValue]?i.max=s:n.roles[t.gaugeRoleNames.targetValue]&&(i.target=s,s&&i.tooltipItems.push({displayName:a[o].source.displayName,value:t.converterHelper.formatFromMetadataColumn(s,a[o].source,t.Gauge.formatStringProp)})))}return i},a.prototype.init=function(e){var t=this;this.rootElem=e.element,this.rootElem.addClass("owlGaugeVisual"),this.svgTailElem=$(a.owlTailSvg),this.svgBgElem=$(a.visualBgSvg),this.svgBodyElem=$(a.owlBodySvg),this.rootElem.append(this.svgBgElem).append(this.svgTailElem).append(this.svgBodyElem),a.OwlDemoMode&&window.setInterval(function(){var e=100*Math.random()+1;t.updateGauge(e)},2e3),this.updateViewportSize(e.viewport.width,e.viewport.height)},a.prototype.update=function(e){this.updateViewportSize(e.viewport.width,e.viewport.height);var t=e.dataViews.length>0?e.dataViews[0]:null;if(t){var i=a.getGaugeData(e.dataViews[0]),r=(i.total-i.min)/(i.max-i.min);this.updateGauge(100*r|0)}else this.updateGauge(0)},a.prototype.updateGauge=function(e){if(e>=0&&100>=e){var t=-180+180*e/100;this.svgBgElem.css({transform:"rotate("+t+"deg)"}),e>=66?this.happinessLevel=i.Happy:e>=33?this.happinessLevel=i.Meh:this.happinessLevel=i.Sad}},Object.defineProperty(a.prototype,"happinessLevel",{set:function(e){switch(this.rootElem.removeClass("sad").removeClass("meh").removeClass("happy"),e){case i.Sad:this.rootElem.addClass("sad");break;case i.Meh:this.rootElem.addClass("meh");break;case i.Happy:this.rootElem.addClass("happy")}},enumerable:!0,configurable:!0}),a.prototype.updateViewportSize=function(e,t){var i=this,r=window.setImmediate||window.requestAnimationFrame;r(function(){i.rootElem.css({height:t,width:e}),i.svgBodyElem.height(i.svgBodyElem.width()*a.owlBodyHeightMultiplier),i.svgBgElem.height(i.svgBgElem.width()*a.visualBgHeightMultiplier),i.svgTailElem.height(i.svgTailElem.width()*a.owlTailHeightMultiplier)})},a.owlBodySvg='<svg version="1.1" class="owlGaugeBody" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 267.7 291.2" style="enable-background:new 0 0 267.7 291.2;" xml:space="preserve"> <style type="text/css"> .owlGaugeBody .st0{fill:#A87D50;} .owlGaugeBody .st1{fill:#C2B59B;} .owlGaugeBody .st2{fill:#EB2227;} .owlGaugeBody .st3{fill:#FFFFFF;} .owlGaugeBody .st4{fill:#F9D018;} .owlGaugeBody .st5{fill:none;} .owlGaugeBody .st6{fill:#83381B;} .owlGaugeBody .st7{fill:#231F20;} </style> <g id="XMLID_31_"> <g id="XMLID_34_"> <ellipse id="XMLID_21_" transform="matrix(0.9998 1.947640e-02 -1.947640e-02 0.9998 2.8614 -2.5802)" class="st0" cx="133.9" cy="145.6" rx="133.9" ry="145.6"/> <polygon id="XMLID_20_" class="st0" points="199.2,32.8 184,11.3 209,9.7 "/> <polygon id="XMLID_19_" class="st0" points="73.9,31.2 62.1,7.7 87.1,9.8 "/> <circle id="XMLID_18_" class="st1" cx="134.8" cy="189.2" r="89.8"/> <path id="XMLID_17_" class="st2" d="M140.1,88c-2.7,3.8-7.9,4.7-11.7,2c-2.7-1.9-3.9-5.1-3.4-8.1c0,0,9.6-41.8,9.6-41.8l6.9,40.8 C142,83.2,141.6,85.8,140.1,88z"/> <path id="XMLID_16_" class="st3" d="M164.6,16.2c-14.2,0-26.3,9.2-30.6,21.9c-4.1-13.1-16.3-22.6-30.8-22.6 C85.4,15.6,71,30,71,47.8s14.4,32.3,32.3,32.3c14.2,0,26.3-9.2,30.6-21.9c4.1,13.1,16.3,22.6,30.8,22.6 c17.8,0,32.3-14.4,32.3-32.3S182.4,16.2,164.6,16.2z"/> <path id="XMLID_15_" class="st4" d="M122,58.7l23.3-0.1c0,0-9,14.8-10.2,16.6c-1.2,1.9-2.2,0.1-2.2,0.1L122,58.7z"/> <rect id="XMLID_14_" x="-11.4" y="-68.8" class="st5" width="288.3" height="259.7"/> <g id="XMLID_37_"> <path id="XMLID_13_" class="st6" d="M121.6,125.5c0,3.7-3.5,6.6-7.7,6.6c-4.2,0-7.7-3-7.7-6.6"/> <path id="XMLID_12_" class="st6" d="M160.1,126.5c0,3.7-3.5,6.6-7.7,6.6s-7.7-3-7.7-6.6"/> <path id="XMLID_11_" class="st6" d="M142.4,148.1c0,3.7-3.5,6.6-7.7,6.6c-4.2,0-7.7-3-7.7-6.6"/> <path id="XMLID_10_" class="st6" d="M183.1,148.8c0,3.7-3.5,6.6-7.7,6.6c-4.2,0-7.7-3-7.7-6.6"/> <path id="XMLID_9_" class="st6" d="M160.9,177.4c0,3.7-3.5,6.6-7.7,6.6s-7.7-3-7.7-6.6"/> <path id="XMLID_8_" class="st6" d="M201.6,178c0,3.7-3.5,6.6-7.7,6.6s-7.7-3-7.7-6.6"/> <path id="XMLID_7_" class="st6" d="M76.4,177.4c0,3.7-3.5,6.6-7.7,6.6c-4.2,0-7.7-3-7.7-6.6"/> <path id="XMLID_6_" class="st6" d="M117,178c0,3.7-3.5,6.6-7.7,6.6s-7.7-3-7.7-6.6"/> <path id="XMLID_5_" class="st6" d="M98.6,148.1c0,3.7-3.5,6.6-7.7,6.6c-4.2,0-7.7-3-7.7-6.6"/> </g> <circle id="XMLID_4_" class="st7" cx="164.1" cy="49" r="6.4"/> <circle id="XMLID_3_" class="st7" cx="102.7" cy="47.7" r="6.4"/> </g> <path id="XMLID_2_" class="st0" d="M160.1,140.9c11.1-8.4,55.6-36,55.6-36l4.7,0.8l10.2,38.8c0,0-3,3-9.2,3.1 c-5.1,0.1-45.9-2.6-60.2-3.5C158.1,143.9,157.7,142.7,160.1,140.9z"/> <path id="XMLID_1_" class="st0" d="M110.6,140.8c-11.1-8.4-55.6-36-55.6-36l-4.7,0.8L40,144.4c0,0,3,3,9.2,3.1 c5.1,0.1,45.9-2.6,60.2-3.5C112.5,143.8,113,142.6,110.6,140.8z"/> </g> </svg>',a.owlTailSvg='<svg version="1.1" class="owlGaugeTail" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 587.8 295.5" style="enable-background:new 0 0 587.8 295.5;" xml:space="preserve"> <style type="text/css"> .owlGaugeTail .st0{fill:#3B2416;} .owlGaugeTail .st1{fill:#5B4B43;} .owlGaugeTail .st2{fill:#603A17;} .owlGaugeTail .st3{fill:#726659;} </style> <g id="XMLID_55_"> <path id="XMLID_29_" class="st0" d="M85.2,106.2c-27.1,0-49.2,22-49.2,49.2c0,19.1,10.9,35.7,26.9,43.8c0,0,231.2,95.9,231.2,95.9 l-171-171C114.1,113.2,100.5,106.2,85.2,106.2z"/> <g id="XMLID_56_"> <path id="XMLID_28_" class="st1" d="M482.5,86.4c0-27.1-22-49.2-49.2-49.2c-19.1,0-35.7,10.9-43.8,26.9c0,0-95.9,231.2-95.9,231.2 l171-171C475.5,115.3,482.5,101.7,482.5,86.4z"/> <path id="XMLID_27_" class="st2" d="M573.5,281.3c19.2-19.2,19.2-50.3,0-69.5c-13.5-13.5-33-17.5-50-12c0,0-231.3,95.7-231.3,95.7 l241.8,0C548,296.9,562.6,292.1,573.5,281.3z"/> <path id="XMLID_26_" class="st3" d="M279.9,14.4c-19.2-19.2-50.3-19.2-69.5,0c-13.5,13.5-17.5,33-12,50c0,0,95.7,231.3,95.7,231.3 L294,54C295.4,39.8,290.7,25.2,279.9,14.4z"/> <path id="XMLID_25_" class="st2" d="M105.3,86.4c0-27.1,22-49.2,49.2-49.2c19.1,0,35.7,10.9,43.8,26.9c0,0,95.9,231.2,95.9,231.2 l-171-171C112.3,115.3,105.3,101.7,105.3,86.4z"/> <path id="XMLID_24_" class="st2" d="M14.4,281.4c-19.2-19.2-19.2-50.3,0-69.5c13.5-13.5,33-17.5,50-12c0,0,231.3,95.7,231.3,95.7 l-241.8,0C39.8,297,25.2,292.3,14.4,281.4z"/> <path id="XMLID_23_" class="st2" d="M308.2,14c19.2-19.2,50.3-19.2,69.5,0c13.5,13.5,17.5,33,12,50c0,0-95.7,231.3-95.7,231.3 l0-241.8C292.6,39.4,297.4,24.8,308.2,14z"/> <path id="XMLID_22_" class="st0" d="M503.2,106c27.1,0,49.2,22,49.2,49.2c0,19.1-10.9,35.7-26.9,43.8c0,0-231.2,95.9-231.2,95.9 l171-171C474.2,113,487.8,106,503.2,106z"/> </g> </g> </svg>',a.visualBgSvg='<svg version="1.1" class="owlGaugeBg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="123.8 94.9 349.1 175.3" style="enable-background:new 123.8 94.9 349.1 175.3;" xml:space="preserve"> <style type="text/css"> .owlGaugeBg .st0{fill:#EF4137;} .owlGaugeBg .st1{fill:#FAAF42;} .owlGaugeBg .st2{fill:#F15B2A;} .owlGaugeBg .st3{fill:#F69321;} </style> <g id="XMLID_10_"> <path id="XMLID_8_" class="st0" d="M174.3,158c-16.1,0-29.2,13.1-29.2,29.2c0,11.4,6.5,21.2,16,26.1l137.3,57L196.9,168.7 C191.5,162.2,183.4,158,174.3,158z"/> <g id="XMLID_11_"> <path id="XMLID_7_" class="st1" d="M410.2,146.3c0-16.1-13.1-29.2-29.2-29.2c-11.4,0-21.2,6.5-26,16l-57,137.5L399.5,169 C406.1,163.5,410.2,155.4,410.2,146.3z"/> <path id="XMLID_6_" class="st0" d="M464.3,262.2c11.4-11.4,11.4-29.9,0-41.3c-8-8-19.6-10.4-29.7-7.1l-137.4,56.9h143.6 C449.2,271.4,457.9,268.6,464.3,262.2z"/> <path id="XMLID_5_" class="st2" d="M290,103.5c-11.4-11.4-29.9-11.4-41.3,0c-8,8-10.4,19.6-7.1,29.7l56.8,137.5V127 C299.2,118.6,296.4,109.9,290,103.5z"/> <path id="XMLID_4_" class="st3" d="M186.3,146.3c0-16.1,13.1-29.2,29.2-29.2c11.4,0,21.2,6.5,26,16l57,137.5L197,168.8 C190.5,163.5,186.3,155.4,186.3,146.3z"/> <path id="XMLID_3_" class="st2" d="M132.3,262.2c-11.4-11.4-11.4-29.9,0-41.3c8-8,19.6-10.4,29.7-7.1l137.4,56.9H155.8 C147.4,271.5,138.7,268.7,132.3,262.2z"/> <path id="XMLID_2_" class="st3" d="M306.8,103.2c11.4-11.4,29.9-11.4,41.3,0c8,8,10.4,19.6,7.1,29.7l-56.8,137.5V126.7 C297.5,118.3,300.3,109.7,306.8,103.2z"/> <path id="XMLID_1_" class="st2" d="M422.5,157.9c16.1,0,29.2,13.1,29.2,29.2c0,11.4-6.5,21.2-16,26.1l-137.3,57L400,168.6 C405.3,162.1,413.4,157.9,422.5,157.9z"/> </g> </g> </svg>',a.owlBodyHeightMultiplier=291.2/267.7,a.owlTailHeightMultiplier=295.5/587.8,a.visualBgHeightMultiplier=295.5/587.8,a.OwlDemoMode=!1,a.capabilities={dataRoles:[{displayName:"Category",name:"Category",kind:e.VisualDataRoleKind.Grouping},{displayName:"Y Axis",name:"Y",kind:e.VisualDataRoleKind.Measure}],dataViewMappings:[{categories:{"for":{"in":"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{bind:{to:"Y"}}]}}]},a}();t.OwlGauge=a}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoMapLocation"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoMapLocationMessage",i="NoMapLocationKey",a="NoMapLocationValue",r={
message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.NoMapLocationWarning=t;var i=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoValidGeotaggedCategory"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoValidGeotaggedCategoryMessage",i="NoValidGeotaggedCategoryKey",a="NoValidGeotaggedCategoryValue",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.FilledMapWithoutValidGeotagCategoryWarning=i;var a=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"GeometryCulledWarning"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="GeometryCulledWarningMessage",i="GeometryCulledWarningKey",a="GeometryCulledWarningVal",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e}();e.GeometryCulledWarning=a;var r=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NegativeValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_NegativeValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.NegativeValuesNotSupportedWarning=r;var o=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"AllNegativeValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_AllNegativeValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.AllNegativeValuesWarning=o;var n=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NaNNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_NanValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.NaNNotSupportedWarning=n;var s=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"InfinityValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_InfinityValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.InfinityValuesNotSupportedWarning=s;var l=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ValuesOutOfRange"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_VisualizationOutOfRange",i={message:e.get(t),title:"",detail:""};return i},e}();e.ValuesOutOfRangeWarning=l;var c=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ZeroValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_ZeroValues",i={message:e.get(t),title:"",detail:""};return i},e}();e.ZeroValueWarning=c;var u=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"VisualKPIDataMissing"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="Visual_KPI_DataMissing",i={message:e.get(t),title:"",detail:""};return i},e}();e.VisualKPIDataMissingWarning=u;var h=function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ScriptVisualNotRefreshed"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="ScriptVisualRefreshWarningMessage",i="ScriptVisualRefreshWarningValue",a={message:e.get(t),title:e.get(t),detail:e.get(i)};return a},e}();e.ScriptVisualRefreshWarning=h}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.PixelConverter,a=jsCommon.CssConstants.createClassAndSelector,r=function(){function r(e){this.isScrollable=e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,this.interactivityService=e.interactivityService}return r.prototype.init=function(e){this.svg=e.svg,this.svg.classed(r.WaterfallClassName,!0),this.style=e.style,this.currentViewport=e.viewport,this.hostServices=e.host,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.element=e.element,this.colors=this.style.colorPalette.dataColors,this.mainGraphicsSVG=this.svg.append("svg"),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").classed(r.MainGraphicsContextClassName,!0),this.labelGraphicsContext=this.mainGraphicsSVG.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass["class"],!0)},r.converter=function(i,a,o,n,s,l,c,u){void 0===c&&(c=!0);var h,d,p,g,m=e.data.createIDataViewCategoricalReader(i),f=r.formatStringProp,y=i.categorical.categories||[],v=s.increaseFill.solid.color,b=s.decreaseFill.solid.color,C=s.totalFill.solid.color,S=o.getLocalizedString(r.TotalLabel),x=o.getLocalizedString(r.IncreaseLabel),w=o.getLocalizedString(r.DecreaseLabel),P=[{label:x,color:v,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("increase").createSelectionId(),selected:!1},{label:w,color:b,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("decrease").createSelectionId(),selected:!1},{label:S,color:C,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("total").createSelectionId(),selected:!1}],D=0,L=0,T=0,V=[],M=[],N=void 0;if(m.hasValues("Tooltips")&&(g=m.getAllValueMetadataColumnsForRole("Tooltips",void 0)),m.hasValues("Y")){N=m.getValueMetadataColumn("Y");var A=N.format;if(_.isEmpty(y))D=T=m.getValue("Y",0),L=0;else{var O=y[0];h=O.source,M=O.values.slice(),M.push(S),m.hasValues("Tooltips")&&(p=m.getSeriesCount("Tooltips"),d=_.map(new Array(p),function(){return 0}));for(var I=0,R=m.getCategoryCount();R>I;I++){var F=M[I],H=m.getValue("Y",I)||0,z=t.SelectionIdBuilder.builder().withCategory(O,I).withMeasure(N.queryName).createSelectionId(),G=void 0;if(c&&(G=[],G.push({displayName:h.displayName,value:t.converterHelper.formatFromMetadataColumn(F,h,f)}),null!=H&&G.push({displayName:N.displayName,value:t.converterHelper.formatFromMetadataColumn(H,N,f)}),u)){var k=m.getAllValuesForRole("Tooltips",I,void 0);if(k&&g){for(var j=0;j<k.length;j++)d[j]+=k[j];for(var E=0;E<k.length;E++)null!=k[E]&&g[E]&&G.push({displayName:g[E].displayName,value:t.converterHelper.formatFromMetadataColumn(k[E],g[E],f)})}}var B=H>0?v:b;V.push({value:H,position:D,color:B,categoryValue:F,categoryIndex:I,seriesIndex:0,selected:!1,identity:z,highlight:!1,key:z.getKey(),tooltipInfo:G,labelFill:n.labelColor,labelFormatString:A}),D+=H,D>T&&(T=D),L>D&&(L=D)}}var W=void 0;if(c&&(W=[],h&&W.push({displayName:h.displayName,value:S}),null!=D&&W.push({displayName:N.displayName,value:t.converterHelper.formatFromMetadataColumn(D,N,f)}),u)){var k=m.getAllValuesForRole("Tooltips",0,void 0);if(d=d?d:k,k&&g)for(var E=0;E<d.length;E++)null!=d[E]&&W.push({displayName:g[E].displayName,value:t.converterHelper.formatFromMetadataColumn(d[E],g[E],f)})}var U=t.SelectionId.createNull();V.push({value:D,position:0,color:C,categoryValue:S,categoryIndex:I,identity:U,seriesIndex:0,selected:!1,highlight:!1,key:U.getKey(),tooltipInfo:W,labelFill:n.labelColor,labelFormatString:A,isTotal:!0})}l&&l.applySelectionStateToData(V);var Y=t.CartesianHelper.getCategoryAxisProperties(i.metadata),K=t.CartesianHelper.getValueAxisProperties(i.metadata),X=t.converterHelper.createAxesLabels(Y,K,h,[N]);return{series:[{data:V}],categories:M,categoryMetadata:h,valuesMetadata:N,legend:{dataPoints:P},hasHighlights:!1,positionMin:L,positionMax:T,dataLabelsSettings:n,sentimentColors:s,axesLabels:{x:X.xAxisLabel,y:X.yAxisLabel}}},r.prototype.setData=function(e){var i=this.getSentimentColorsFromObjects(null),a=e.length>0?e[0]:void 0;if(this.data={series:[{data:[]}],categories:[],valuesMetadata:null,legend:{dataPoints:[]},hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,positionMax:0,positionMin:0,dataLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(!1,void 0),sentimentColors:i,axesLabels:{x:null,y:null}},a){if(a.metadata&&a.metadata.objects){var o=a.metadata.objects,n=o.labels;n&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(n,this.data.dataLabelsSettings),i=this.getSentimentColorsFromObjects(o)}a.categorical&&(this.data=r.converter(a,this.colors,this.hostServices,this.data.dataLabelsSettings,i,this.interactivityService,this.tooltipsEnabled,this.tooltipBucketEnabled))}},r.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"sentimentColors":this.enumerateSentimentColors(e);break;case"labels":var a={enumeration:e,dataLabelsSettings:this.data.dataLabelsSettings,show:!0,displayUnits:!0,precision:!0,fontSize:!0};t.dataLabelUtils.enumerateDataLabels(a)}},r.prototype.enumerateSentimentColors=function(e){var t=this.data.sentimentColors;e.pushInstance({selector:null,properties:{increaseFill:t.increaseFill,decreaseFill:t.decreaseFill,totalFill:t.totalFill},objectName:"sentimentColors"})},r.prototype.calculateLegend=function(){return this.data.legend},r.prototype.hasLegend=function(){return!0},r.createClippedDataIfOverflowed=function(t,i){var a=t,r=t.series[0].data;return t&&i<r.length&&(a=e.Prototype.inherit(t),a.series=[{data:r.slice(0,i)}],a.categories=t.categories.slice(0,i)),a},r.prototype.calculateAxesProperties=function(e){var i=this;this.currentViewport=e.viewport,this.margin=e.margin;var a=this.clippedData=this.data,o=a.categories.length,n=this.getPreferredPlotArea(!1,o,t.CartesianChart.MinOrdinalRectThickness),s=t.CartesianChart.getLayout(null,{availableWidth:n.width,categoryCount:o,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow});this.isScrollable||(a=this.clippedData=r.createClippedDataIfOverflowed(a,s.categoryCount));var l=r.getXAxisCreationOptions(a,n.width,s,e),c=r.getYAxisCreationOptions(a,n.height,e),u=this.xAxisProperties=t.AxisHelper.createAxis(l),h=this.yAxisProperties=t.AxisHelper.createAxis(c),d=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),p=t.dataLabelUtils.createColumnFormatterCacheManager(),g=a.dataLabelsSettings,m=r.getDisplayUnitValueFromAxisFormatter(h,g);return this.layout={categoryCount:s.categoryCount,categoryThickness:s.categoryThickness,isScalar:s.isScalar,outerPaddingRatio:s.outerPaddingRatio,categoryWidth:d,labelText:function(e){var i=p.getOrCreate(e.labelFormatString,g,m);return t.dataLabelUtils.getLabelFormattedText({label:i.format(e.value)})},labelLayout:t.dataLabelUtils.getLabelLayoutXYForWaterfall(u,d,h,c.dataDomain),filter:function(e){return t.dataLabelUtils.doesDataLabelFitInShape(e,h,i.layout)},style:{fill:function(e){return e.isLabelInside?t.dataLabelUtils.defaultInsideLabelColor:e.labelFill}}},this.xAxisProperties.axisLabel=e.showCategoryAxisLabel?a.axesLabels.x:null,this.yAxisProperties.axisLabel=e.showValueAxisLabel?a.axesLabels.y:null,[u,h]},r.getDisplayUnitValueFromAxisFormatter=function(e,t){return e.formatter&&e.formatter.displayUnit&&0===t.displayUnits?e.formatter.displayUnit.value:null},r.lookupXValue=function(e,i,a){var r=e.series[0].data;return i===r.length-1?r[i].categoryValue:t.CartesianHelper.lookupXValue(e,i,a,!1)},r.getXAxisCreationOptions=function(e,i,a,o){var n=t.AxisHelper.getCategoryValueType(e.categoryMetadata),s=t.AxisHelper.createDomain(e.series,n,!1,o.forcedXDomain,o.ensureXDomain),l=a.categoryThickness,c=l*a.outerPaddingRatio;return{pixelSpan:i,dataDomain:s,metaDataColumn:e.categoryMetadata,formatString:t.valueFormatter.getFormatString(e.categoryMetadata,r.formatStringProp),isScalar:!1,outerPadding:c,categoryThickness:l,getValueFn:function(t,i){return r.lookupXValue(e,t,i)},forcedTickCount:o.forcedTickCount,isCategoryAxis:!0,axisDisplayUnits:o.categoryAxisDisplayUnits,axisPrecision:o.categoryAxisPrecision}},r.getYAxisCreationOptions=function(e,i,a){var o=t.AxisHelper.combineDomain(a.forcedYDomain,[e.positionMin,e.positionMax],a.ensureYDomain);return{pixelSpan:i,dataDomain:o,isScalar:!0,isVertical:!0,metaDataColumn:e.valuesMetadata,formatString:t.valueFormatter.getFormatString(e.valuesMetadata,r.formatStringProp),outerPadding:0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,axisDisplayUnits:a.valueAxisDisplayUnits,axisPrecision:a.valueAxisPrecision}},r.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e,this.margin)},r.prototype.getVisualCategoryAxisIsScalar=function(){return!1},r.prototype.overrideXScale=function(e){this.xAxisProperties=e},r.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a.series=[{data:a.series[0].data.slice(t,i)}],a.categories=a.categories.slice(t,i),a},r.prototype.createRects=function(e){var t=this.mainGraphicsContext,i=t.selectAll(r.CategoryValueClasses.selector),a=i.data(e,function(e){return e.key});return a.enter().append("rect").attr("class",function(e){return r.CategoryValueClasses["class"].concat(e.highlight?"highlight":"")}),a.exit().remove(),a},r.prototype.createConnectors=function(e){var t=this.mainGraphicsContext,i=t.selectAll(r.WaterfallConnectorClasses.selector),a=i.data(e.slice(0,e.length-1),function(e){return e.key});return a.enter().append("line").classed(r.WaterfallConnectorClasses["class"],!0),a.exit().remove(),a},r.prototype.render=function(e){var i=this,a=this.clippedData.series[0].data,o=this.createRects(a),n=this.createConnectors(a);this.tooltipsEnabled&&t.TooltipManager.addTooltip(o,function(e){return e.data.tooltipInfo});var s=this.interactivityService&&this.interactivityService.hasSelection(),l=this.xAxisProperties.scale,c=this.yAxisProperties.scale,u=c(0);this.mainGraphicsSVG.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),o.style("fill",function(e){return e.color}).style("fill-opacity",function(e){return e.isTotal?t.ColumnUtil.DefaultOpacity:t.ColumnUtil.getFillOpacity(e.selected,e.highlight,s,i.data.hasHighlights)}).attr("width",this.layout.categoryWidth).attr("x",function(e){return l(e.categoryIndex)}).attr("y",function(e){return r.getRectTop(c,e.position,e.value)}).attr("height",function(e){return u-c(Math.abs(e.value))}),n.attr({x1:function(e){return l(e.categoryIndex)},y1:function(e){return c(e.position+e.value)},x2:function(e){return l(e.categoryIndex+1)+i.layout.categoryWidth},y2:function(e){return c(e.position+e.value)}});var h=this.data.dataLabelsSettings,d=[];(h&&h.show||h.showCategory)&&(d=this.createLabelDataPoints());var p=void 0;return this.interactivityService&&(p={bars:o,datapoints:a}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:a,behaviorOptions:p,labelDataPoints:d,labelsAreNumeric:!0}},r.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},r.prototype.getSupportedCategoryAxisType=function(){return t.axisType.categorical},r.getRectTop=function(e,t,i){return 0>i?e(t):e(t)-(e(0)-e(i))},r.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},r.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},r.prototype.getSentimentColorsFromObjects=function(i){var a=this.colors.getSentimentColors(),o=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.increaseFill,a[2].value),n=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.decreaseFill,a[0].value),s=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.totalFill,r.defaultTotalColor);return{increaseFill:{solid:{color:o}},decreaseFill:{solid:{color:n}},totalFill:{solid:{color:s}}}},r.prototype.createLabelDataPoints=function(){for(var a=[],o=this.data,n=this.xAxisProperties.scale,s=this.yAxisProperties.scale,l=s(0),c=o.series,u=t.NewDataLabelUtils.createColumnFormatterCacheManager(),h=t.NewDataLabelUtils.getDisplayUnitValueFromAxisFormatter(this.yAxisProperties.formatter,o.dataLabelsSettings),d=this.data.dataLabelsSettings,p=0,g=c;p<g.length;p++)for(var m=g[p],f=0,y=m.data;f<y.length;f++){var v=y[f],b={left:n(v.categoryIndex),top:r.getRectTop(s,v.position,v.value),width:this.layout.categoryWidth,height:l-s(Math.abs(v.value))},C=v.labelFormatString,S=u.getOrCreate(C,this.data.dataLabelsSettings,h),x=t.NewDataLabelUtils.getLabelFormattedText(S.format(v.value)),w={text:x,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(d.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},P=e.TextMeasurementService.measureSvgTextWidth(w),D=e.TextMeasurementService.estimateSvgTextHeight(w,!0);a.push({isPreferred:!0,text:x,textSize:{width:P,height:D},outsideFill:d.labelColor?d.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:1,parentShape:{rect:b,orientation:v.value>=0?1:2,validPositions:0===v.value?r.validZeroLabelPosition:r.validLabelPositions},fontSize:d.fontSize,identity:void 0})}return a},r.formatStringProp={objectName:"general",propertyName:"formatString"},r.WaterfallClassName="waterfallChart",r.MainGraphicsContextClassName="mainGraphicsContext",r.IncreaseLabel="Waterfall_IncreaseLabel",r.DecreaseLabel="Waterfall_DecreaseLabel",r.TotalLabel="Waterfall_TotalLabel",r.CategoryValueClasses=a("column"),r.WaterfallConnectorClasses=a("waterfall-connector"),r.defaultTotalColor="#00b8aa",r.validLabelPositions=[16,4],r.validZeroLabelPosition=[16,8],r}();t.WaterfallChart=r}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.visuals.controls.TouchUtils,a=jsCommon.CssConstants.createClassAndSelector,r=a("tooltip-container"),o=a("tooltip-content-container"),n=a("arrow"),s=a("tooltip-header"),l=a("tooltip-row"),c=a("tooltip-color-cell"),u=a("tooltip-title-cell"),h=a("tooltip-value-cell"),d=function(){function e(t){this.tooltipOptions=t,this.isTooltipVisible=!1,t||(this.tooltipOptions=e.DefaultTooltipOptions)}return e.prototype.isTooltipComponentVisible=function(){return this.isTooltipVisible},e.prototype.setTestScreenSize=function(e,t){this.customScreenWidth=e,this.customScreenHeight=t},e.prototype.show=function(e,t){this.isTooltipVisible=!0,this.tooltipContainer||(this.tooltipContainer=this.createTooltipContainer()),this.setTooltipContent(e),this.tooltipContainer.style("visibility","visible").transition().duration(0).style("opacity",this.tooltipOptions.opacity),this.setPosition(t)},e.prototype.move=function(e,t){this.isTooltipVisible&&(e&&this.setTooltipContent(e),this.setPosition(t))},e.prototype.hide=function(){this.isTooltipVisible&&(this.isTooltipVisible=!1,this.tooltipContainer.transition().duration(this.tooltipOptions.animationDuration).style("opacity",0).each("end",function(){this.style.visibility="hidden"}))},e.prototype.createTooltipContainer=function(){var t=d3.select(e.parentContainerSelector).append("div").attr("class",r["class"]);return t.append("div").attr("class",n["class"]),t.append("div").attr("class",o["class"]),t},e.prototype.setTooltipContent=function(e){if(!_.isEqual(e,this.currentTooltipData)){this.currentTooltipData=e;var t=l.selector,i=this.tooltipContainer.select(o.selector);if(i.selectAll(s.selector).remove(),i.selectAll(l.selector).remove(),0!==e.length){e[0].header&&i.append("div").attr("class",s["class"]).text(e[0].header);var a=i.selectAll(t).data(e),r=a.enter().append("div").attr("class",l["class"]);if(_.any(e,function(e){return e.color})){var n=r.filter(function(e){return e.color}).append("div").attr("class",c["class"]);n.append("svg").attr({width:"100%",height:"15px"}).append("circle").attr({cx:"5",cy:"8",r:"5"}).style({fill:function(e){return e.color},"fill-opacity":function(e){return null!=e.opacity?e.opacity:1}})}var d=r.append("div").attr("class",u["class"]),p=r.append("div").attr("class",h["class"]);d.text(function(e){return e.displayName}),p.text(function(e){return e.value})}}},e.prototype.getTooltipPosition=function(e,t){var a=this.tooltipContainer.node().getBoundingClientRect(),r=Math.floor(e.width/2),o=0,n=0,s=new i.Point(e.x+r,e.y+r),l=7;return 0===t?(o+=3*l+r,n-=2*l+r):1===t?(o-=2*l+a.width+r,n-=2*l+r):3===t?(o+=3*l+r,n-=a.height-2*l+r):2===t&&(o-=2*l+a.width+r,n-=a.height-2*l+r),s.offset(o,n),s},e.prototype.setPosition=function(e){var t=this.getClickedScreenArea(e),i=this.getTooltipPosition(e,t);this.tooltipContainer.style({left:i.x+"px",top:i.y+"px"}),this.setArrowPosition(e,t)},e.prototype.setArrowPosition=function(e,t){var i,a=this.getArrowElement();0===t?i="top left":1===t?i="top right":3===t?i="bottom left":2===t&&(i="bottom right"),a.attr("class","arrow").classed(i,!0)},e.prototype.getArrowElement=function(){return this.tooltipContainer.select(n.selector)},e.prototype.getClickedScreenArea=function(e){var t=this.customScreenWidth||window.innerWidth,a=this.customScreenHeight||window.innerHeight,r=e.width/2,o=new i.Point(e.x+r,e.y+r),n=t/2,s=a/2;return o.x<n&&o.y<s?0:o.x>=n&&o.y<s?1:o.x<n&&o.y>=s?3:o.x>=n&&o.y>=s?2:void 0},e.DefaultTooltipOptions={opacity:1,animationDuration:250,offsetX:10,offsetY:10},e.parentContainerSelector="body",e.highlightedValueDisplayNameResorceKey="Tooltip_HighlightedValueDisplayName",e}();t.ToolTipComponent=d;var p;!function(e){function t(t,i,o,n){if(e.ShowTooltips){var f=d3.select(d.parentContainerSelector).node();t.on("mouseover",function(){var t=d3.event.target,r=d3.select(t).datum();if(!D&&u(d3.event)){v=g(f,!0);var o=g(t,!0),n={data:r,coordinates:v,elementCoordinates:o,context:t,isTouchEvent:!1};c();var s=e.ToolTipInstance.isTooltipComponentVisible()?16:S;y=a(n,i,s)}}),t.on("mouseout",function(){D||(c(),y=r(x)),n&&n()}),t.on("mousemove",function(){var e=d3.event.target,t=d3.select(e).datum();if(!D&&u(d3.event)){v=g(f,!0);var a=g(e,!0),r={data:t,coordinates:v,elementCoordinates:a,context:e,isTouchEvent:!1};s(r,i,o)}});var b=h(),L=p(),T="pointerdown"===b||"MSPointerDown"===b;C||(m(b),C=!0),t.on(b,function(){var e=d3.event.target,t=d3.select(e).datum();l();var r=g(f,T),o=g(e,T),n={data:t,coordinates:r,elementCoordinates:o,context:e,isTouchEvent:!0};c(),y=a(n,i,w)}),t.on(L,function(){c(),D&&clearTimeout(D),D=setTimeout(function(){D=0},P)})}}function a(e,t,i){return setTimeout(function(){return n(e,t)},i)}function r(e){return setTimeout(function(){return l()},e)}function o(e){d.localizationOptions=e}function n(t,i){var a=b||i(t);if(!_.isEmpty(a)){var r=v||t.coordinates,o=f(r[0],r[1],t.isTouchEvent);e.ToolTipInstance.show(a,o)}}function s(t,i,a){b=void 0,a&&(b=i(t));var r=f(t.coordinates[0],t.coordinates[1],t.isTouchEvent);e.ToolTipInstance.move(b,r)}function l(){e.ToolTipInstance.hide()}function c(){y&&clearTimeout(y)}function u(e){var t=!0,i=e;if(void 0!==i.buttons){var a=0!==i.buttons;t=!a}return t}function h(){var e="touchstart";return window.PointerEvent?e="pointerdown":window.MSPointerEvent&&(e="MSPointerDown"),e}function p(){var e="touchend";return window.PointerEvent?e="pointerup":window.MSPointerEvent&&(e="MSPointerUp"),e}function g(e,t){var i;if(t){for(var a=d3.event,r=void 0;r=a.sourceEvent;)a=r;var o=e.getBoundingClientRect();i=[a.clientX-o.left-e.clientLeft,a.clientY-o.top-e.clientTop]}else{var n=d3.touches(e);n&&n.length>0&&(i=n[0])}return i}function m(t){d3.select(d.parentContainerSelector).on(t,function(t,i){e.ToolTipInstance.hide()})}function f(e,t,a){var r=0,o=e,n=t;if(a){r=12;var s=r/2;o=Math.max(e-s,0),n=Math.max(t-s,0)}return new i.Rectangle(o,n,r,r)}e.ShowTooltips=!0,e.ToolTipInstance=new d;var y,v,b,C=!1,S=350,x=500,w=350,P=1e3,D=0;e.addTooltip=t,e.showDelayedTooltip=a,e.hideDelayedTooltip=r,e.setLocalizedStrings=o}(p=t.TooltipManager||(t.TooltipManager={}));var g;!function(e){function i(e,t,i,o,n,s,l,c,u,h){var d,p=[],g=void 0;l=0|l;var m=t?t.categories:n;if(m&&m.length>0)if(m.length>1){for(var f=[],y=0,v=m.length;v>y;y++)f.push(m[y].source);d={value:i,metadata:f}}else d={value:i,metadata:[m[0].source]};if(t&&t.values){if(d&&d.metadata[0]===t.values.source||(g=t.values.source),t.values.length>0){var b=t.values[l],C=!!(b&&b.source&&b.source.isAutoGeneratedColumn);C||p.push({value:o,highlightedValue:u,metadata:b})}var S=a(h,c);null!=S&&p.push(S)}if(s)for(var y=0,x=s.length;x>y;y++){var w=s[y];d&&d.metadata[0]===w.metadata.source||p.push({value:w.value,metadata:w.metadata})}var P=r(e,d,g,p);return P}function a(e,t){return e?{value:e.values[t],metadata:{source:e.source,values:[]}}:null}function r(e,t,i,a){var r=[];if(t)if(t.metadata.length>1){for(var n="",s=0,l=t.metadata.length;l>s;s++)0!==s&&(n+="/"),n+=t.metadata[s].displayName;var c=o(t.metadata[0],e,t.value);r.push({displayName:n,value:c})}else{var c=o(t.metadata[0],e,t.value);r.push({displayName:t.metadata[0].displayName,value:c})}if(i){var u=void 0;if(a.length>0){var h=a[0].metadata.source;u=o(i,e,h.groupName)}r.push({displayName:i.displayName,value:u})}for(var s=0;s<a.length;s++){var p=a[s];if(p&&p.metadata){var g=p.metadata.source,m=p.value,f=p.highlightedValue;if(m||0===m){var y=o(g,e,m);r.push({displayName:g.displayName,value:y})}if(f||0===f){var v=o(g,e,f),n=d.localizationOptions.highlightedValueDisplayName;r.push({displayName:n,value:v})}}}return r}function o(e,i,a){var r=n(e,i);return t.valueFormatter.format(a,r)}function n(e,i){if(e){var a=t.valueFormatter.getFormatString(e,i,!0);return a||e.format}return null}e.createTooltipInfo=i,e.createGradientToolTipData=a}(g=t.TooltipBuilder||(t.TooltipBuilder={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function i(t){return void 0===t&&(t=new e.DataColorPalette),{titleText:{color:{value:"rgba(51,51,51,1)"}},subTitleText:{color:{value:"rgba(145,145,145,1)"}},colorPalette:{dataColors:t},labelText:{color:{value:"rgba(51,51,51,1)"},fontSize:"11px"},isHighContrast:!1}}t.create=i}(t=e.visualStyles||(e.visualStyles={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=jsCommon.CssConstants.createClassAndSelector,a=function(){function a(e){e&&(this.sliceWidthRatio=e.sliceWidthRatio,this.animator=e.animator,this.isScrollable=e.isScrollable?e.isScrollable:!1,this.disableGeometricCulling=e.disableGeometricCulling?e.disableGeometricCulling:!1,this.behavior=e.behavior,this.tooltipsEnabled=e.tooltipsEnabled,this.tooltipBucketEnabled=e.tooltipBucketEnabled,e.smallViewPortProperties&&(this.maxHeightToScaleDonutLegend=e.smallViewPortProperties.maxHeightToScaleDonutLegend)),null==this.sliceWidthRatio&&(this.sliceWidthRatio=a.defaultSliceWidthRatio)}return a.converter=function(e,t,i,o,n,s,l,c){void 0===l&&(l=!0);var u=new r.DonutChartConverter(e,t,i,l,c);u.convert();var h=d3.layout.pie().sort(null).value(function(e){return e.percentage});s&&(s.applySelectionStateToData(u.dataPoints),s.applySelectionStateToData(u.legendData.dataPoints));var d=!n&&o?a.cullDataByViewport(u.dataPoints,u.maxValue,o):u.dataPoints;return{dataPointsToDeprecate:d,dataPoints:h(d),unCulledDataPoints:u.dataPoints,dataPointsToEnumerate:u.legendData.dataPoints,legendData:u.legendData,hasHighlights:u.hasHighlights,dataLabelsSettings:u.dataLabelsSettings,legendObjectProperties:u.legendObjectProperties,maxValue:u.maxValue,visibleGeometryCulled:u.dataPoints.length!==d.length}},a.prototype.init=function(e){this.options=e;var i=e.element;i.empty(),this.parentViewport=e.viewport,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.formatter=t.valueFormatter.format,this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[],fontSize:t.SVGLegend.DefaultFontSizeInPt},hasHighlights:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings()},this.drilled=!1,this.allowDrilldown=!1,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.radius=0,this.isInteractive=e.interactivity&&e.interactivity.isInteractiveLegend;var r=this.settings;if(this.behavior&&(this.interactivityService=t.createInteractivityService(e.host)),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.hostService=e.host,this.isInteractive){this.chartRotationAnimationDuration=r&&r.chartRotationAnimationDuration?r.chartRotationAnimationDuration:0;var n=this.legendContainer=d3.select(i.get(0)).append("div").classed(a.InteractiveLegendClassName,!0);this.interactivityState={interactiveLegend:new o(this,n,this.colors,e,this.settings),valueToAngleFactor:0,sliceAngles:[],currentRotate:0,interactiveChosenSliceFinishedSetting:!1,lastChosenInteractiveSliceIndex:0,totalDragAngleDifference:0,currentIndexDrag:0,previousIndexDrag:0,previousDragAngle:0,donutCenter:{x:0,y:0}}}this.svg=d3.select(i.get(0)).append("svg").style("position","absolute").classed(a.ClassName,!0),this.behavior&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.mainGraphicsContext=this.svg.append("g"),this.mainGraphicsContext.append("g").classed("slices",!0),this.labelGraphicsContext=this.svg.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass["class"],!0),this.pie=d3.layout.pie().sort(null).value(function(e){return e.percentage})},a.prototype.update=function(i){var r=i.viewport;this.parentViewport=r;var o=this.dataViews=i.dataViews;if(o&&o.length>0&&o[0].categorical){var n=o[0].metadata,s=void 0;if(n){var l=n.objects;l&&(s=e.DataViewObjects.getFillColor(l,t.donutChartProps.dataPoint.defaultColor))}this.data=a.converter(o[0],this.colors,s,this.currentViewport,this.disableGeometricCulling,this.interactivityService,this.tooltipsEnabled,this.tooltipBucketEnabled),this.data.defaultDataPointColor=s,this.options.interactivity&&this.options.interactivity.isInteractiveLegend||this.renderLegend()}else this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[]},hasHighlights:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings()};if(this.initViewportDependantProperties(),this.initDonutProperties(),this.updateInternal(this.data,i.suppressAnimations),this.hasSetData=!0,o){var c=t.getInvalidValueWarnings(o,!1,!1,!1);this.hostService.setWarnings(c)}},a.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},a.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder,a=this.data&&this.data.dataLabelsSettings?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings();switch(e.objectName){case"legend":this.enumerateLegend(i);break;case"dataPoint":this.enumerateDataPoints(i);break;case"labels":var r={enumeration:i,dataLabelsSettings:a,show:!0,displayUnits:!0,precision:!0,fontSize:!0,labelStyle:!0};t.dataLabelUtils.enumerateDataLabels(r)}return i.complete()},a.prototype.enumerateDataPoints=function(e){var i=this.data;if(i)for(var a=i.dataPointsToEnumerate,r=a.length,o=0;r>o;o++){var n=a[o];e.pushInstance({objectName:"dataPoint",displayName:n.label,selector:t.ColorHelper.normalizeSelector(n.identity.getSelector()),properties:{fill:{solid:{color:n.color}}}})}},a.prototype.enumerateLegend=function(i){var a=this.data;if(a){var r={legend:a.legendObjectProperties},o=e.DataViewObjects.getValue(r,t.donutChartProps.legend.show,this.legend.isVisible()),n=e.DataViewObjects.getValue(r,t.donutChartProps.legend.showTitle,!0),s=e.DataViewObjects.getValue(r,t.donutChartProps.legend.titleText,this.data.legendData.title),l=e.DataViewObject.getValue(r,t.legendProps.labelColor,this.data.legendData.labelColor),c=e.DataViewObject.getValue(r,t.legendProps.fontSize,this.data.legendData.fontSize);i.pushInstance({selector:null,objectName:"legend",properties:{show:o,position:t.LegendPosition[this.legend.getOrientation()],showTitle:n,titleText:s,labelColor:l,fontSize:c}})}},a.prototype.setInteractiveChosenSlice=function(e){var i=this;if(0!==this.interactivityState.sliceAngles.length){this.interactivityState.lastChosenInteractiveSliceIndex=e,
this.interactivityState.interactiveChosenSliceFinishedSetting=!1;var a=this.currentViewport,r=e%this.data.dataPoints.length,o=this.interactivityState.sliceAngles[r];this.svg.select("g").transition().duration(this.chartRotationAnimationDuration).ease("elastic").attr("transform",t.SVGUtil.translateAndRotate(a.width/2,a.height/2,0,0,o)).each("end",function(){i.interactivityState.interactiveChosenSliceFinishedSetting=!0}),this.interactivityState.currentRotate=o,this.interactivityState.interactiveLegend.updateLegend(r),this.svg.selectAll(".slice").attr("opacity",function(e,t){return t===r?1:.6}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},a.prototype.calculateRadius=function(){var e=this.currentViewport;if(!this.isInteractive&&this.data&&this.data.dataLabelsSettings.show){var t=e.height/e.width,i=2+1/(1+Math.exp(-5*(t-1)));return Math.min(e.height,e.width)/i}return Math.min(e.height,e.width)/2},a.prototype.getScaleForLegendArrow=function(){var e=1;return this.maxHeightToScaleDonutLegend&&this.currentViewport.height<this.maxHeightToScaleDonutLegend&&(e=this.currentViewport.height/this.maxHeightToScaleDonutLegend),e},a.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0),this.currentViewport.height=this.parentViewport.height,this.currentViewport.width=this.parentViewport.width;var i=this.currentViewport;if(this.isInteractive)i.height-=a.InteractiveLegendContainerHeight;else{var r=this.legend.getMargins();i.height-=r.height,i.width-=r.width}this.svg.attr({width:i.width,height:i.height}),this.isInteractive?(this.legendContainer.style({width:"100%",height:a.InteractiveLegendContainerHeight+"px",overflow:"hidden",top:0}),this.svg.style("top",a.InteractiveLegendContainerHeight)):t.Legend.positionChartArea(this.svg,this.legend),this.previousRadius=this.radius;var o=this.radius=this.calculateRadius(),n=i.width/2,s=i.height/2;this.arc=d3.svg.arc(),this.outerArc=d3.svg.arc().innerRadius(o*a.OuterArcRadiusRatio).outerRadius(o*a.OuterArcRadiusRatio),this.isInteractive?(this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(n,s)),this.labelGraphicsContext.attr("transform",t.SVGUtil.translate(n,s))):(this.mainGraphicsContext.transition().duration(e).attr("transform",t.SVGUtil.translate(n,s)),this.labelGraphicsContext.transition().duration(e).attr("transform",t.SVGUtil.translate(n,s))),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.initDonutProperties=function(){this.donutProperties={viewport:this.currentViewport,radius:this.radius,arc:this.arc.innerRadius(0).outerRadius(this.radius*a.InnerArcRadiusRatio),outerArc:this.outerArc,innerArcRadiusRatio:a.InnerArcRadiusRatio,outerArcRadiusRatio:a.OuterArcRadiusRatio,dataLabelsSettings:this.data.dataLabelsSettings}},a.prototype.mergeDatasets=function(t,i){var a=d3.set();i.forEach(function(e){a.add(e.identity?e.identity.getKey():e.data.identity.getKey())});var r=t.filter(function(e){return!a.has(e.identity?e.identity.getKey():e.data.identity.getKey())}).map(function(t){var i=e.Prototype.inherit(t);return void 0===i.percentage?i.data.percentage=0:i.percentage=0,i});return d3.merge([i,r])},a.prototype.updateInternal=function(e,i,r){void 0===r&&(r=0);var o=this.currentViewport;if(r=r||t.AnimatorCommon.GetAnimationDuration(this.animator,i),this.animator){var n,s=a.getLayout(this.radius,this.sliceWidthRatio,o),l=void 0,c=void 0,u=e.dataLabelsSettings,h=[];if(u&&u.show&&(h=this.createLabels()),!i){var d={viewModel:e,colors:this.colors,graphicsContext:this.mainGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,interactivityService:this.interactivityService,layout:s,radius:this.radius,sliceWidthRatio:this.sliceWidthRatio,viewport:o,labels:h,innerArcRadiusRatio:a.InnerArcRadiusRatio};l=this.animator.animate(d),n=l.shapes,c=l.highlightShapes}(i||l.failed)&&(n=a.drawDefaultShapes(this.svg,e,s,this.colors,this.radius,this.interactivityService&&this.interactivityService.hasSelection(),this.sliceWidthRatio,this.data.defaultDataPointColor),c=a.drawDefaultHighlightShapes(this.svg,e,s,this.colors,this.radius,this.sliceWidthRatio),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,h,!1,!0,!0),t.NewDataLabelUtils.drawLabelLeaderLines(this.labelGraphicsContext,h)),this.assignInteractions(n,c,e),this.tooltipsEnabled&&(t.TooltipManager.addTooltip(n,function(e){return e.data.data.tooltipInfo}),t.TooltipManager.addTooltip(c,function(e){return e.data.data.tooltipInfo}))}else this.updateInternalToMove(e,r);t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.createLabels=function(){var i=new e.DonutLabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset},this.donutProperties),a=this.createLabelDataPoints();return i.layout(a)},a.prototype.createLabelDataPoints=function(){var e=this.data,i=[],a=t.dataLabelUtils.createColumnFormatterCacheManager(),r=null;0===e.dataLabelsSettings.displayUnits&&(r=d3.max(e.dataPoints,function(e){return Math.abs(e.data.measure)}));for(var o=0;o<this.data.dataPoints.length;o++){var n=this.createLabelDataPoint(e.dataPoints[o],r,a);i.push(n)}return i},a.prototype.createLabelDataPoint=function(e,i,a){var r,o,n,s,l,c=this.outerArc.centroid(e),u=t.DonutLabelUtils.getXPositionForDonutLabel(c[0]),h=c[1],d=this.data.dataLabelsSettings,p=a.getOrCreate(e.data.labelFormatString,d,i),g=0>u?4:8,m={point:{x:u,y:h},validPositions:[g],radius:0},f=d.labelColor?d.labelColor:t.NewDataLabelUtils.defaultLabelColor,y=d.labelStyle,v=d.fontSize,b="";switch(y!==t.labelStyle.both&&y!==t.labelStyle.data||(r=p.format(null!=e.data.highlightValue?e.data.highlightValue:e.data.measure),o=t.NewDataLabelUtils.getTextSize(r,v)),y!==t.labelStyle.both&&y!==t.labelStyle.category||(n=e.data.label,s=t.NewDataLabelUtils.getTextSize(n,v)),y){case t.labelStyle.both:var C=n+" ("+r+")";b=C,l=t.NewDataLabelUtils.getTextSize(C,v);break;case t.labelStyle.category:l=_.clone(s),b=n;break;case t.labelStyle.data:l=_.clone(o),b=r}var S=t.DonutLabelUtils.getLabelLeaderLineForDonutChart(e,this.donutProperties,m.point),x=t.DonutLabelUtils.getLabelLeaderLinesSizeForDonutChart(S);return{isPreferred:!0,text:"",tooltip:b,textSize:l,outsideFill:f,fontSize:v,identity:e.data.identity,parentShape:m,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,alternativeScale:i,donutArcDescriptor:e,angle:(e.startAngle+e.endAngle)/2-Math.PI/2,dataLabel:r,dataLabelSize:o,categoryLabel:n,categoryLabelSize:s,leaderLinePoints:S,linesSize:x}},a.prototype.renderLegend=function(){if(!this.isInteractive){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.parentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.parentViewport)}},a.prototype.addInteractiveLegendArrow=function(){if(this.data&&this.data.dataPoints&&0!==this.data.dataPoints.length){var e=11,i=16.5;if(!this.interactiveLegendArrow){var r=this.svg.append("g");r.append("path").classed(a.InteractiveLegendArrowClassName,!0).attr("d","M1.5,2.6C0.65,1.15,1.85,0,3,0l27,0c1.65,0,2.35,1.15,1.5,2.6L18,26.45c-0.8,1.45-2.15,1.45-2.95,0L1.95,2.6z"),this.interactiveLegendArrow=r}var o=this.currentViewport,n=this.getScaleForLegendArrow(),s=(o.height-2*this.radius)/2+e*n,l=o.width/2-i*n;this.interactiveLegendArrow.attr("transform",t.SVGUtil.translateAndScale(l,s,n))}},a.prototype.calculateSliceAngles=function(){var e=[],t=this.data.dataPoints;if(0===t.length)return this.interactivityState.valueToAngleFactor=0,void(this.interactivityState.sliceAngles=[]);for(var i=0,a=0,r=t.length;r>a;a++)i+=t[a].data.percentage;this.interactivityState.valueToAngleFactor=360/i;for(var o=0,a=0,r=t.length;r>a;a++){var n=t[a].data.percentage*this.interactivityState.valueToAngleFactor;o+=n,e.push(n/2-o)}this.interactivityState.sliceAngles=e},a.prototype.assignInteractions=function(e,t,i){if(this.isInteractive)this.assignInteractiveChartInteractions(e);else if(this.interactivityService){var a=i.dataPoints.map(function(e){return e.data}),r={clearCatcher:this.clearCatcher,slices:e,highlightSlices:t,allowDrilldown:this.allowDrilldown,visual:this,hasHighlights:i.hasHighlights,svg:this.svg};this.interactivityService.bind(a,this.behavior,r)}},a.prototype.setDrilldown=function(e){if(e){var i=d3.layout.pie().sort(null).value(function(e){return e.percentage}),r=[{label:e.label,color:e.color,icon:t.LegendIcon.Box,identity:e.identity,selected:e.selected}],o={title:"",dataPoints:r},n=i(e.internalDataPoints);this.updateInternal({dataPointsToDeprecate:e.internalDataPoints,dataPoints:n,unCulledDataPoints:n.map(function(e){return e.data}),legendData:o,hasHighlights:!1,dataLabelsSettings:this.data.dataLabelsSettings},!1,a.DrillDownAnimationDuration)}else this.updateInternal(this.data,!1,a.DrillDownAnimationDuration)},a.prototype.assignInteractiveChartInteractions=function(e){var t=this,i=this.svg;this.interactivityState.interactiveChosenSliceFinishedSetting=!0;var a=i.node().getBoundingClientRect();this.interactivityState.donutCenter={x:a.left+a.width/2,y:a.top+a.height/2},this.interactivityState.totalDragAngleDifference=0,this.interactivityState.currentRotate=0,this.calculateSliceAngles(),e.on("click",function(e,i){d3.event.defaultPrevented||t.setInteractiveChosenSlice(i)});var r=d3.behavior.drag().origin(Object).on("dragstart",function(){return t.interactiveDragStart()}).on("drag",function(){return t.interactiveDragMove()}).on("dragend",function(){return t.interactiveDragEnd()});i.style("touch-action","none").call(r)},a.prototype.getAngleFromDragEvent=function(){var e,t,i=this.interactivityState,a=d3.event.sourceEvent;if(-1!==a.type.toLowerCase().indexOf("touch")){if(1!==a.touches.length)return null;var r=a.touches[0];e=r.pageX,t=r.pageY}else e=a.pageX,t=a.pageY;var o={x:e-i.donutCenter.x,y:-t+i.donutCenter.y},n=180*Math.atan2(o.y,o.x)/Math.PI;return n},a.prototype.interactiveDragStart=function(){this.interactivityState.totalDragAngleDifference=0,this.interactivityState.previousDragAngle=this.getAngleFromDragEvent()},a.prototype.interactiveDragMove=function(){var e=this.data.dataPoints,i=this.currentViewport,r=this.interactivityState;if(r.interactiveChosenSliceFinishedSetting===!0){var o=this.getAngleFromDragEvent();if(!o)return;var n=r.previousDragAngle-o;r.totalDragAngleDifference+=n,r.previousDragAngle=o,r.currentRotate+=n,this.svg.select("g").attr("transform",t.SVGUtil.translateAndRotate(i.width/2,i.height/2,0,0,this.interactivityState.currentRotate));var s=e[0].data.percentage*r.valueToAngleFactor,l=r.currentRotate<=0?-1*r.currentRotate%360:360-r.currentRotate%360;r.currentIndexDrag=0;for(var c=e.length;r.currentIndexDrag<c&&l>s;)r.currentIndexDrag<c-1&&(s+=e[r.currentIndexDrag+1].data.percentage*r.valueToAngleFactor),r.currentIndexDrag++;r.currentIndexDrag!==r.previousIndexDrag&&(r.interactiveLegend.updateLegend(r.currentIndexDrag),this.svg.selectAll(".slice").attr("opacity",function(e,t){return t===r.currentIndexDrag?a.OpaqueOpacity:a.SemiTransparentOpacity}),r.previousIndexDrag=r.currentIndexDrag)}},a.prototype.interactiveDragEnd=function(){0!==this.interactivityState.totalDragAngleDifference&&(this.setInteractiveChosenSlice(this.interactivityState.currentIndexDrag),d3.event.sourceEvent.stopPropagation())},a.prototype.updateInternalToMove=function(e,i){void 0===i&&(i=0);var r=this.svg,o=this.pie,n=this.key,s=this.arc,l=this.radius,c=this.previousRadius,u=this.sliceWidthRatio,h=this.svg.select(".slices").selectAll("path"+a.sliceClass.selector).data().map(function(e){return e.data});0===h.length&&(h=e.dataPointsToDeprecate);var d=this.mergeDatasets(h,e.dataPointsToDeprecate),p=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(o(e.dataPointsToDeprecate),n);p.enter().insert("path").classed(a.sliceClass["class"],!0).each(function(e){this._current=e}),p=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(o(d),n);var g=l*u;if(a.isSingleColor(e.dataPoints),p.style("fill",function(e){return e.data.color}).style("fill-opacity",function(i){return t.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,e.hasHighlights)}).style("stroke","white").style("stroke-dasharray",function(e){return a.drawStrokeForDonutChart(l,a.InnerArcRadiusRatio,e,u)}).style("stroke-width",function(e){return e.data.strokeWidth}).transition().duration(i).attrTween("d",function(e){var t=d3.interpolate(this._current,e),i=d3.interpolate(c*a.InnerArcRadiusRatio,l*a.InnerArcRadiusRatio);return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(i(e))(t(e))}}),p=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(o(e.dataPointsToDeprecate),n),p.exit().transition().delay(i).duration(0).remove(),!this.isInteractive){var m=e.dataLabelsSettings,f=[];m&&m.show&&(f=this.createLabels()),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,f,!1,!0),t.NewDataLabelUtils.drawLabelLeaderLines(this.labelGraphicsContext,f)}var y=void 0;e.hasHighlights?(y=r.select(".slices").selectAll("path"+a.sliceHighlightClass.selector).data(o(e.dataPointsToDeprecate),n),y.enter().insert("path").classed(a.sliceHighlightClass["class"],!0).each(function(e){this._current=e}),a.isSingleColor(e.dataPoints),y.style("fill",function(e){return e.data.color}).style("fill-opacity",1).style("stroke","white").style("stroke-dasharray",function(e){return a.drawStrokeForDonutChart(l,a.InnerArcRadiusRatio,e,u,e.data.highlightRatio)}).style("stroke-width",function(e){return 0===e.data.highlightRatio?0:e.data.strokeWidth}).transition().duration(i).attrTween("d",function(e){var t=d3.interpolate(this._current,e),i=d3.interpolate(c*a.InnerArcRadiusRatio,a.getHighlightRadius(l,u,e.data.highlightRatio));return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(i(e))(t(e))}}),y.exit().transition().delay(i).duration(0).remove()):r.selectAll("path"+a.sliceHighlightClass.selector).transition().delay(i).duration(0).remove(),this.assignInteractions(p,y,e),this.tooltipsEnabled&&(t.TooltipManager.addTooltip(p,function(e){return e.data.data.tooltipInfo}),e.hasHighlights&&t.TooltipManager.addTooltip(y,function(e){return e.data.data.tooltipInfo})),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),this.isInteractive&&(this.addInteractiveLegendArrow(),this.interactivityState.interactiveLegend.drawLegend(this.data.dataPointsToDeprecate),this.setInteractiveChosenSlice(this.interactivityState.lastChosenInteractiveSliceIndex?this.interactivityState.lastChosenInteractiveSliceIndex:0))},a.drawDefaultShapes=function(e,i,r,o,n,s,l,c){var u=e.select(".slices").selectAll("path"+a.sliceClass.selector).data(i.dataPoints,function(e){return e.data.identity.getKey()});return u.enter().insert("path").classed(a.sliceClass["class"],!0),a.isSingleColor(i.dataPoints),u.style("fill",function(e){return e.data.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,i.hasHighlights)}).style("stroke-dasharray",function(e){return a.drawStrokeForDonutChart(n,a.InnerArcRadiusRatio,e,l)}).style("stroke-width",function(e){return e.data.strokeWidth}).attr(r.shapeLayout),u.exit().remove(),u},a.drawDefaultHighlightShapes=function(e,i,r,o,n,s){var l=e.select(".slices").selectAll("path"+a.sliceHighlightClass.selector).data(i.dataPoints.filter(function(e){return null!=e.data.highlightRatio}),function(e){return e.data.identity.getKey()});return l.enter().insert("path").classed(a.sliceHighlightClass["class"],!0).each(function(e){this._current=e}),a.isSingleColor(i.dataPoints),l.style("fill",function(e){return e.data.color}).style("fill-opacity",function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!0,!1,i.hasHighlights)}).style("stroke","white").style("stroke-dasharray",function(e){return a.drawStrokeForDonutChart(n,a.InnerArcRadiusRatio,e,s,e.data.highlightRatio)}).style("stroke-width",function(e){return 0===e.data.highlightRatio?0:e.data.strokeWidth}).attr(r.highlightShapeLayout),l.exit().remove(),l},a.isSingleColor=function(e){if(e.length>1){var t=e.length-1;e[t].data.isLastInDonut=e[t].data.color===e[0].data.color}},a.drawStrokeForDonutChart=function(e,t,i,r,o){void 0===o&&(o=1);var n,s,l=e*t*o,c=(i.endAngle-i.startAngle)*l;if(r){var u=e*r,h=o*e*(a.InnerArcRadiusRatio-r),d=(i.endAngle-i.startAngle)*u;if(i.data.highlightRatio&&(c=(i.endAngle-i.startAngle)*(h+u)),i.data.isLastInDonut)return"0 "+c+" "+h+" "+d+" "+h;n=c+h+d,s=h}else i.data.isLastInDonut?(n=c,s=2*l):(n=c+l,s=l);return"0 "+n+" "+s},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.getLayout=function(e,t,i){var r=e*t,o=d3.svg.arc().innerRadius(r),n=o.outerRadius(e*a.InnerArcRadiusRatio);return{shapeLayout:{d:function(e){return n(e)}},highlightShapeLayout:{d:function(i){var r=o.outerRadius(a.getHighlightRadius(e,t,i.data.highlightRatio));return r(i)}},zeroShapeLayout:{d:function(e){var t=o.outerRadius(r||a.EffectiveZeroValue);return t(e)}}}},a.getHighlightRadius=function(e,t,i){var r=e*t;return r+i*e*(a.InnerArcRadiusRatio-t)},a.cullDataByViewport=function(e,t,i){for(var r,o=Math.min(i.width,i.height)/2,n=this.invisibleArcLengthInPixels/(o*a.twoPi),s=n*t,l=[],c=0,u=e;c<u.length;c++){var h=u[c];h.measure>=s&&(h.strokeWidth=r===h.color?1:0,r=h.color,l.push(h))}return l},a.ClassName="donutChart",a.InteractiveLegendClassName="donutLegend",a.InteractiveLegendArrowClassName="donutLegendArrow",a.DrillDownAnimationDuration=1e3,a.OuterArcRadiusRatio=.9,a.InnerArcRadiusRatio=.8,a.OpaqueOpacity=1,a.SemiTransparentOpacity=.6,a.defaultSliceWidthRatio=.48,a.invisibleArcLengthInPixels=3,a.sliceClass=i("slice"),a.sliceHighlightClass=i("slice-highlight"),a.twoPi=2*Math.PI,a.InteractiveLegendContainerHeight=70,a.EffectiveZeroValue=1e-9,a.PolylineOpacity=.5,a}();t.DonutChart=a;var r,o=function(){function e(e,t,i,a,r){this.legendContainerParent=t,this.colors=i,this.donutChart=e,this.visualInitOptions=a,this.legendItemsPositions=[],this.legendTransitionAnimationDuration=r&&r.legendTransitionAnimationDuration?r.legendTransitionAnimationDuration:0}return e.prototype.drawLegend=function(i){var a=this;this.data=i,this.currentNumberOfLegendItems=i.length,this.currentIndex=0,this.leftMostIndex=0,this.rightMostIndex=i.length-1,this.legendContainerParent.select(e.LegendContainerSelector).empty()&&(this.legendContainer=this.legendContainerParent.append("div").classed(e.LegendContainerClassName,!0));var r=this.legendContainer.selectAll(e.LegendItemSelector).data(i),o=this.legendContainerWidth=this.legendContainer.node().getBoundingClientRect().width,n=o/2-.4*o/2+e.ItemMargin,s=n;this.currentXOffset=n;var l=function(i,r){i.attr("data-legend-index",r.index).css({position:"absolute",left:s});var o=t.valueFormatter.format(r.label),n=t.valueFormatter.format(r.measure,r.measureFormat),l=t.valueFormatter.format(r.percentage,"0.00 %;-0.00 %;0.00 %"),c=r.color,u=e.createBasicLegendItemSpan(e.LegendItemValueClassName,n,11),h=e.createBasicLegendItemSpan(e.LegendItemCategoryClassName,o,11),d=e.createBasicLegendItemSpan(e.LegendItemPercentageClassName,l,20),p=e.spanWidth(u),g=e.spanWidth(h),m=e.spanWidth(d),f=e.legendBoxSize(p,g,m);i.css("width",f);var y=function(e){return f-e>0?(f-e)/2:0},v=y(p),b=y(g),C=y(m);e.createLegendItemSpan(h,b),e.createLegendItemSpan(u,v),e.createLegendItemSpan(d,C).css("color",c),i.append(h),i.append(d),i.append(u),a.legendItemsPositions.push({startX:s,boxWidth:f}),s+=f+e.ItemMargin};r.enter().insert("div").classed(e.LegendItemClassName,!0).each(function(e){l($(this),e)}),r.exit().remove(),this.assignInteractions()},e.prototype.updateLegend=function(e){var i=this,a=this.legendContainerWidth;this.currentIndex=e,this.updateLabelBlocks(e);var r=this.legendTransitionAnimationDuration,o=-1*(this.legendItemsPositions[e].startX+this.legendItemsPositions[e].boxWidth/2-a/2);this.legendContainer.transition().styleTween("-webkit-transform",function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(o,0))}).styleTween("transform",function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(o,0))}).duration(r).ease("bounce").each("end",function(){i.currentXOffset=o}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.visualInitOptions)},e.prototype.assignInteractions=function(){var t=this,i=0,a=!1,r=function(){i=0,a=!1},o=function(){if(i+=d3.event.dx,!(a||Math.abs(i)<e.MinimumSwipeDX)){var r=0>i;t.dragLegend(r),a=!0}},n=d3.behavior.drag().origin(Object).on("drag",o).on("dragstart",r);this.legendContainer.style({"touch-action":"none",cursor:"pointer"}).call(n)},e.prototype.dragLegend=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled-1?this.currentIndex=this.getCyclingCurrentIndex(t):this.shouldChangeIndexInNonCycling(t)&&(t?this.currentIndex++:this.currentIndex--),this.donutChart.setInteractiveChosenSlice(this.currentIndex)},e.prototype.shouldChangeIndexInNonCycling=function(e){return!(0===this.currentIndex&&!e||this.currentIndex===this.currentNumberOfLegendItems-1&&e)},e.prototype.getCyclingCurrentIndex=function(e){var t=this.data.length,i=e?1:-1,a=(this.currentIndex+i)%(t||1);return 0>a?a+t:a},e.prototype.updateLegendItemsBlocks=function(t,i){var a=$(this.legendContainer[0]);if(t){var r=a.find("[data-legend-index="+this.leftMostIndex+"]");r.remove().insertAfter(a.find("[data-legend-index="+this.rightMostIndex+"]"));var o=this.legendItemsPositions[this.rightMostIndex].startX+this.legendItemsPositions[this.rightMostIndex].boxWidth+e.ItemMargin;this.legendItemsPositions[this.leftMostIndex].startX=o,r.css("left",o),this.rightMostIndex=this.leftMostIndex,this.leftMostIndex=(this.leftMostIndex+1)%this.data.length}else{var n=a.find("[data-legend-index="+this.rightMostIndex+"]");n.remove().insertBefore(a.find("[data-legend-index="+this.leftMostIndex+"]"));var o=this.legendItemsPositions[this.leftMostIndex].startX-this.legendItemsPositions[this.rightMostIndex].boxWidth-e.ItemMargin;this.legendItemsPositions[this.rightMostIndex].startX=o,n.css("left",o),this.leftMostIndex=this.rightMostIndex,this.rightMostIndex=this.rightMostIndex-1===-1?this.legendItemsPositions.length-1:this.rightMostIndex-1}i-1!==0&&this.updateLegendItemsBlocks(t,i-1)},e.prototype.updateLabelBlocks=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled?(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,2),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,2),(this.rightMostIndex===t+1||0===this.rightMostIndex&&t===this.currentNumberOfLegendItems-1)&&this.updateLegendItemsBlocks(!0,1),(this.leftMostIndex===t-1||this.leftMostIndex===this.currentNumberOfLegendItems-1&&0===t)&&this.updateLegendItemsBlocks(!1,1)):this.currentNumberOfLegendItems===e.MinimumItemsInLegendForCycled&&(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,1),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,1))},e.createBasicLegendItemSpan=function(e,t,i){return $("<span/>").addClass(e).css({"white-space":"nowrap","font-size":i+"px"}).text(t)},e.createLegendItemSpan=function(e,t){return e.css({overflow:"hidden","text-overflow":"ellipsis",display:"inline-block",width:"100%","margin-left":t}),e},e.legendBoxSize=function(t,i,a){var r=t>i?t:i;return r=r>a?r:a,r=r>e.MaxLegendItemBoxSize?e.MaxLegendItemBoxSize:r+2},e.spanWidth=function(e){return this.FakeElementSpan||(this.FakeElementSpan=$("<span>").hide().appendTo(document.body)),this.FakeElementSpan.empty(),this.FakeElementSpan.append(e),this.FakeElementSpan.width()},e.LegendContainerClassName="legend-container",e.LegendContainerSelector=".legend-container",e.LegendItemClassName="legend-item",e.LegendItemSelector=".legend-item",e.LegendItemCategoryClassName="category",e.LegendItemPercentageClassName="percentage",e.LegendItemValueClassName="value",e.MaxLegendItemBoxSize=160,e.ItemMargin=30,e.MinimumSwipeDX=15,e.MinimumItemsInLegendForCycled=3,e}();!function(i){var r=function(){function i(i,a,r,o,n){void 0===o&&(o=!0);var s=this.reader=e.data.createIDataViewCategoricalReader(i),l=i.categorical;if(this.dataViewCategorical=l,this.dataViewMetadata=i.metadata,this.tooltipsEnabled=o,this.tooltipBucketEnabled=n,this.colorHelper=new t.ColorHelper(a,t.donutChartProps.dataPoint.fill,r),this.maxValue=0,l.categories&&l.categories.length>0){var c=l.categories[0];this.categoryIdentities=c.identity,this.categoryValues=c.values,this.allCategoryObjects=c.objects,this.categoryColumnRef=c.identityFields,this.categoryFormatString=t.valueFormatter.getFormatString(c.source,t.donutChartProps.general.formatString)}var u=this.grouped=l&&l.values?l.values.grouped():void 0;if(this.isMultiMeasure=u&&u.length>0&&u[0].values&&u[0].values.length>1,this.isSingleMeasure=u&&1===u.length&&u[0].values&&1===u[0].values.length,this.isDynamicSeries=!(!l.values||!l.values.source),this.highlightsOverflow=!1,this.total=0,this.highlightTotal=0,this.dataPoints=[],this.legendDataPoints=[],this.dataLabelsSettings=null,s.hasValues("Y")){var h=this.seriesCount=s.getSeriesCount("Y");this.hasHighlights=this.seriesCount>0&&!_.isEmpty(l.values)&&!!l.values[0].highlights;for(var d=0,p=s.getCategoryCount()||1;p>d;d++)for(var g=0;h>g;g++)this.total+=Math.abs(s.getValue("Y",d,g)),this.highlightTotal+=this.hasHighlights?Math.abs(s.getHighlight("Y",d,g)):0}this.total=t.AxisHelper.normalizeNonFiniteNumber(this.total),this.highlightTotal=t.AxisHelper.normalizeNonFiniteNumber(this.highlightTotal)}return i.normalizedMeasureAndValue=function(e){var i=$.extend(!0,{},e);return i.measure=t.AxisHelper.normalizeNonFiniteNumber(i.measure),i.value=t.AxisHelper.normalizeNonFiniteNumber(i.value),i},i.prototype.convert=function(){var e,r=this.reader;e=0!==this.total?this.categoryValues?this.convertCategoricalWithSlicing():this.isDynamicSeries?this.convertSeries():this.convertMeasures():[];for(var o=!1,n=0,s=e.length;s>n&&!o;n++){var l=e[n];Math.abs(l.highlightMeasureValue.measure)>Math.abs(l.measureValue.measure)&&(o=!0)}this.dataLabelsSettings=this.convertDataLabelSettings();var c=this.dataViewMetadata;if(c){var u=c.objects;u&&(this.legendObjectProperties=u.legend)}var h=_.isEmpty(this.dataViewCategorical.categories)?null:this.dataViewCategorical.categories[0];this.dataPoints=[];for(var d,p=t.donutChartProps.general.formatString,g=t.valueFormatter.getLocalizedString("Percentage"),n=0,s=e.length;s>n;n++){var l=e[n],m=i.normalizedMeasureAndValue(l.highlightMeasureValue),f=i.normalizedMeasureAndValue(l.measureValue),y=f.measure,v=this.total>0?f.value/this.total:0,b=void 0,C=void 0;f.value>this.maxValue&&(this.maxValue=f.value),m.value>this.maxValue&&(this.maxValue=m.value),this.hasHighlights&&(o?(y=m.measure,v=this.highlightTotal>0?m.value/this.highlightTotal:0,b=1):b=0!==f.value?m.value/f.value:0,b||(b=a.EffectiveZeroValue),C=v*b);var S=l.categoryLabel,x=this.dataViewCategorical,w=void 0;w=null!=l.seriesIndex?l.seriesIndex:n;var P=r.getValueMetadataColumn("Y",w),D=this.hasHighlights&&o?l.highlightMeasureValue.measure:l.measureValue.measure,L=this.hasHighlights&&!o?l.highlightMeasureValue.measure:void 0,T=t.valueFormatter.getFormatString(P,p),V=t.valueFormatter.format(v,g),M=void 0;M=t.valueFormatter.format(D,T)+" ("+V+")";var N=void 0;if(this.hasHighlights&&null!=L&&null!=C){var A=t.valueFormatter.format(C,g);N=t.valueFormatter.format(L,T)+" ("+A+")"}var O=void 0;if(this.tooltipsEnabled&&(O=[],h&&O.push({displayName:h.source.displayName,value:S}),this.isDynamicSeries&&(h&&h.source===x.values.source||O.push({displayName:x.values.source.displayName,value:l.label})),null!=M&&O.push({displayName:P.displayName,value:M}),null!=N&&O.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:N})),this.tooltipBucketEnabled){var I=r.getAllValuesForRole("Tooltips",this.categoryValues?l.categoryIndex:0,this.isDynamicSeries?l.seriesIndex:void 0),R=r.getAllValueMetadataColumnsForRole("Tooltips",this.isDynamicSeries?l.seriesIndex:void 0);if(I&&R)for(var F=0;F<I.length;F++)null!=I[F]&&O.push({displayName:R[F].displayName,value:t.converterHelper.formatFromMetadataColumn(I[F],R[F],p)})}var H=d===l.color&&D&&D>0?1:0;d=D&&D>0?l.color:d,this.dataPoints.push({identity:l.identity,measure:y,measureFormat:l.measureFormat,percentage:v,index:l.index,label:l.label,highlightRatio:b,highlightValue:L,selected:!1,tooltipInfo:O,color:l.color,strokeWidth:H,labelFormatString:P.format})}this.legendData=this.convertLegendData()},i.prototype.getLegendTitle=function(){if(0!==this.total){var e=this.dataViewCategorical.values&&this.dataViewCategorical.values.source?this.dataViewCategorical.values.source.displayName:"",t=this.dataViewCategorical.categories&&this.dataViewCategorical.categories.length>0&&this.dataViewCategorical.categories[0].source?this.dataViewCategorical.categories[0].source.displayName:"";return this.categoryValues?t:e}return""},i.prototype.convertCategoricalWithSlicing=function(){for(var e=this.reader,i=this.dataViewCategorical,a=t.donutChartProps.general.formatString,r=[],o=0,n=this.categoryValues.length;n>o;o++){for(var s=this.categoryValues[o],l=this.allCategoryObjects?this.allCategoryObjects[o]:void 0,c=t.SelectionId.createWithId(this.categoryIdentities[o]),u=this.colorHelper.getColorForSeriesValue(l,this.categoryColumnRef,s),h=t.valueFormatter.format(s,this.categoryFormatString),d=0;d<this.seriesCount;d++){var p=e.getValueColumn("Y",d),g=this.isSingleMeasure?h:t.converterHelper.getFormattedLegendLabel(p.source,i.values,a),m=e.getValue("Y",o,d)||0,f=void 0;this.hasHighlights&&(f=e.getHighlight("Y",o,d));var y=p.source.queryName,v=t.SelectionIdBuilder.builder().withCategory(i.categories[0],o).withSeries(i.values,this.isDynamicSeries?p:void 0).withMeasure(y).createSelectionId(),b={identity:v,measureFormat:t.valueFormatter.getFormatString(p.source,a,!0),measureValue:{measure:m,value:Math.abs(m)},highlightMeasureValue:{measure:f,value:null!=f?Math.abs(f):null},index:o*this.seriesCount+d,label:g,categoryLabel:h,color:u,categoryIndex:o,seriesIndex:d};r.push(b)}this.legendDataPoints.push({label:h,color:u,icon:t.LegendIcon.Box,identity:c,selected:!1})}return r},i.prototype.convertMeasures=function(){for(var e=this.reader,i=[],a=t.donutChartProps.general.formatString,r=0;r<this.seriesCount;r++){var o=e.getValueColumn("Y",r),n=t.valueFormatter.getFormatString(o.source,a,!0),s=o.source.displayName,l=t.SelectionId.createWithMeasure(o.source.queryName),c=e.getValue("Y",0,r)||0,u=this.hasHighlights?e.getHighlight("Y",0,r):0,h=this.colorHelper.getColorForMeasure(o.source.objects,o.source.queryName),d={identity:l,measureFormat:n,measureValue:{measure:c,value:Math.abs(c)},highlightMeasureValue:{measure:u,value:Math.abs(u)},index:r,label:s,categoryLabel:s,color:h};i.push(d),this.legendDataPoints.push({label:d.label,color:d.color,icon:t.LegendIcon.Box,identity:d.identity,selected:!1})}return i},i.prototype.convertSeries=function(){for(var e=this.reader,i=this.dataViewCategorical,a=[],r=t.donutChartProps.general.formatString,o=0;o<this.seriesCount;o++){var n=e.getValueColumn("Y",o),s=t.valueFormatter.getFormatString(n.source,r,!0),l=t.converterHelper.getFormattedLegendLabel(n.source,i.values,r),c=(new t.SelectionIdBuilder).withSeries(i.values,n).withMeasure(n.source.queryName).createSelectionId(),u=t.converterHelper.getSeriesName(n.source),h=this.grouped&&this.grouped[o]&&this.grouped[o].objects,d=e.getValue("Y",0,o)||0,p=this.hasHighlights?e.getHighlight("Y",0,o)||0:0,g=this.colorHelper.getColorForSeriesValue(h,i.values.identityFields,u),m={identity:c,measureFormat:s,measureValue:{measure:d,value:Math.abs(d)},highlightMeasureValue:{measure:p,value:Math.abs(p)},index:o,label:l,categoryLabel:l,color:g,seriesIndex:o};a.push(m),this.legendDataPoints.push({label:m.label,color:m.color,icon:t.LegendIcon.Box,identity:m.identity,selected:!1})}return a},i.prototype.convertDataLabelSettings=function(){var e=this.dataViewMetadata,i=t.dataLabelUtils.getDefaultDonutLabelSettings();if(e){var a=e.objects;
if(a){var r=a.labels;r&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(r,i)}}return i},i.prototype.convertLegendData=function(){return{dataPoints:this.legendDataPoints,labelColor:t.LegendData.DefaultLegendLabelFillColor,title:this.getLegendTitle(),fontSize:t.SVGLegend.DefaultFontSizeInPt}},i}();i.DonutChartConverter=r}(r||(r={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.Utility,i=function(){function i(e){this.canRefresh=e.canRefresh}return i.prototype.init=function(t){this.element=t.element,this.hostServices=t.host,this.canRefresh||this.hostServices.setWarnings([new e.ScriptVisualRefreshWarning])},i.prototype.update=function(e){var i=e.dataViews;if(i&&0!==i.length){var a=i[0];if(a&&a.metadata){var r=this.getImageUrl(a),o=this.ensureHtmlElement();if(r&&t.isValidImageDataUrl(r)){var n=e.viewport;o.css({height:n.height,width:n.width,backgroundImage:"url("+r+")"})}else o.css({backgroundImage:"none"})}}},i.prototype.onResizing=function(e){var t=this.ensureHtmlElement();t.css({height:e.height,width:e.width})},i.prototype.getImageUrl=function(e){return e.scriptResult&&e.scriptResult.imageBase64?"data:image/png;base64,"+e.scriptResult.imageBase64:null},i.prototype.ensureHtmlElement=function(){var e=this.imageBackgroundElement;return e||(e=$("<div class='imageBackground' />"),this.imageBackgroundElement=e,this.imageBackgroundElement.appendTo(this.element)),e},i}();e.ScriptVisual=i}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){}return t.prototype.reloadAdapter=function(){var t=this,i=e.localStorageService.getData("DEVELOPMENT_SERVER_URL");$.getScript(i+"visual.js",function(){$.get(i+"visual.css",function(i){$("#css-DEBUG").remove(),$("<style/>",{id:"css-DEBUG",html:i}).appendTo($("head")),e.visuals.plugins.debugVisual.capabilities=e.visuals.plugins.custom.capabilities,t.host.visualCapabilitiesChanged()})})},t.prototype.createRefreshBtn=function(){var e=this,t=$('<i title="Reload Visual\'s Code" class="controlBtn glyphicon pbi-glyph-refresh"></i>');return t.on("click",function(){return e.reloadAdapter()}),t},t.prototype.createDataBtn=function(){var e=$('<i title="Inspect Dataview" class="controlBtn glyphicon pbi-glyph-seedata"></i>');return e},t.prototype.createHelpBtn=function(){var e=$('<i title="Get Help" class="controlBtn glyphicon pbi-glyph-question"></i>');return e},t.prototype.createSmilyBtn=function(){var e=$('<i title="Tweet Feedback" class="controlBtn glyphicon pbi-glyph-smiley"></i>');return e},t.prototype.buildControls=function(){var e=$('<div class="debugVisual-controlsContainer"></div>');return e.append(this.createRefreshBtn(),this.createDataBtn(),this.createHelpBtn(),this.createSmilyBtn()),e},t.prototype.init=function(t){this.host=t.host;var i=this.container=$('<div class="debugVisualContainer"></div>'),a=this.visualContainer=$('<div class="custom"></div>');i.append(a),t.element.append(i);var r=this.optionsForVisual=e.Prototype.inherit(t);r.element=a;var o=this.adapter=e.extensibility.createVisualAdapter(e.visuals.plugins.custom);this.host.setToolbar(this.buildControls()),o.init&&o.init(r)},t.prototype.update=function(t){var i=this.lastUpdateOptions=e.Prototype.inherit(t),a=t.viewport.height,r=t.viewport.width;this.visualContainer.height(a).width(r),this.adapter.update&&this.adapter.update(i)},t.prototype.enumerateObjectInstances=function(e){return this.adapter.enumerateObjectInstances?this.adapter.enumerateObjectInstances(e):[]},t.prototype.destroy=function(){this.adapter.destroy&&this.adapter.destroy(),this.container=null},t.capabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],dataViewMappings:[{table:{rows:{"for":{"in":"Values"}},rowCount:{preferred:{min:1}}}}]},t}();t.DebugVisual=i}(i=t.system||(t.system={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){t.animatedNumber={name:"animatedNumber",capabilities:e.capabilities.animatedNumber,create:function(){return new e.AnimatedNumber}},t.areaChart={name:"areaChart",watermarkKey:"area",capabilities:e.capabilities.lineChart,create:function(){return new e.CartesianChart({chartType:1})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.barChart={name:"barChart",watermarkKey:"bar",capabilities:e.capabilities.barChart,create:function(){return new e.CartesianChart({chartType:6})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.basicShape={name:"basicShape",capabilities:e.basicShapeCapabilities,create:function(){return new e.BasicShapeVisual}},t.card={name:"card",watermarkKey:"card",capabilities:e.capabilities.card,create:function(){return new e.Card}},t.multiRowCard={name:"multiRowCard",watermarkKey:"multiRowCard",capabilities:e.capabilities.multiRowCard,create:function(){return new e.MultiRowCard},getSortableRoles:function(t){return e.MultiRowCard.getSortableRoles(t)}},t.clusteredBarChart={name:"clusteredBarChart",watermarkKey:"clusteredBar",capabilities:e.capabilities.clusteredBarChart,create:function(){return new e.CartesianChart({chartType:5})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.clusteredColumnChart={name:"clusteredColumnChart",watermarkKey:"clusteredColumn",capabilities:e.capabilities.clusteredColumnChart,create:function(){return new e.CartesianChart({chartType:3})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.columnChart={name:"columnChart",watermarkKey:"column",capabilities:e.capabilities.columnChart,create:function(){return new e.CartesianChart({chartType:4})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.comboChart={name:"comboChart",watermarkKey:"combo",capabilities:e.capabilities.comboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:10})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotChart={name:"dataDotChart",capabilities:e.capabilities.dataDotChart,create:function(){return new e.CartesianChart({chartType:11})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotClusteredColumnComboChart={name:"dataDotClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.dataDotClusteredColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:15})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotStackedColumnComboChart={name:"dataDotStackedColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.dataDotStackedColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:16})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.donutChart={name:"donutChart",watermarkKey:"donut",capabilities:e.capabilities.donutChart,create:function(){return new e.DonutChart}},t.funnel={name:"funnel",watermarkKey:"funnel",capabilities:e.capabilities.funnel,create:function(){return new e.FunnelChart}},t.gauge={name:"gauge",watermarkKey:"gauge",capabilities:e.capabilities.gauge,create:function(){return new e.Gauge}},t.hundredPercentStackedBarChart={name:"hundredPercentStackedBarChart",watermarkKey:"100stackedbar",capabilities:e.capabilities.hundredPercentStackedBarChart,create:function(){return new e.CartesianChart({chartType:7})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.hundredPercentStackedColumnChart={name:"hundredPercentStackedColumnChart",watermarkKey:"100stackedcolumn",capabilities:e.capabilities.hundredPercentStackedColumnChart,create:function(){return new e.CartesianChart({chartType:8})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.image={name:"image",capabilities:e.capabilities.image,create:function(){return new e.ImageVisual}},t.lineChart={name:"lineChart",watermarkKey:"line",capabilities:e.capabilities.lineChart,create:function(){return new e.CartesianChart({chartType:0})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.LineChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.lineStackedColumnComboChart={name:"lineStackedColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.lineStackedColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:14})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.lineClusteredColumnComboChart={name:"lineClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.lineClusteredColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:13})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.map={name:"map",watermarkKey:"map",capabilities:e.capabilities.map,create:function(){return new e.Map({filledMap:!1})}},t.filledMap={name:"filledMap",watermarkKey:"filledMap",capabilities:e.capabilities.filledMap,create:function(){return new e.Map({filledMap:!0})}},t.treemap={name:"treemap",watermarkKey:"tree",capabilities:e.capabilities.treemap,create:function(){return new e.Treemap}},t.pieChart={name:"pieChart",watermarkKey:"pie",capabilities:e.capabilities.donutChart,create:function(){return new e.DonutChart({sliceWidthRatio:0})}},t.scatterChart={name:"scatterChart",watermarkKey:"scatterplot",capabilities:e.capabilities.scatterChart,create:function(){return new e.CartesianChart({chartType:9})},getAdditionalTelemetry:function(t){return e.ScatterChart.getAdditionalTelemetry(t)}},t.stackedAreaChart={name:"stackedAreaChart",watermarkKey:"stackedarea",capabilities:e.capabilities.lineChart,create:function(){return new e.CartesianChart({chartType:2})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.table={name:"table",watermarkKey:"table",capabilities:e.capabilities.table,create:function(){return new e.Table},customizeQuery:e.Table.customizeQuery,getSortableRoles:function(t){return e.Table.getSortableRoles()}},t.matrix={name:"matrix",watermarkKey:"matrix",capabilities:e.capabilities.matrix,create:function(){return new e.Matrix},customizeQuery:e.Matrix.customizeQuery,getSortableRoles:function(t){return e.Matrix.getSortableRoles()}},t.slicer={name:"slicer",watermarkKey:"slicer",capabilities:e.capabilities.slicer,create:function(){return new e.Slicer}},t.textbox={name:"textbox",capabilities:e.capabilities.textbox,create:function(){return new e.Textbox}},t.waterfallChart={name:"waterfallChart",watermarkKey:"waterfall",capabilities:e.capabilities.waterfallChart,create:function(){return new e.CartesianChart({chartType:12})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.cheerMeter={name:"cheerMeter",capabilities:e.CheerMeter.capabilities,create:function(){return new e.CheerMeter}},t.consoleWriter={name:"consoleWriter",capabilities:e.samples.consoleWriterCapabilities,create:function(){return new e.samples.ConsoleWriter}},t.helloIVisual={name:"helloIVisual",capabilities:e.samples.HelloIVisual.capabilities,create:function(){return new e.samples.HelloIVisual}},t.owlGauge={name:"owlGauge",watermarkKey:"gauge",capabilities:e.OwlGauge.capabilities,create:function(){return new e.OwlGauge}},t.scriptVisual={name:"scriptVisual",watermarkKey:"scriptvisual",capabilities:e.capabilities.scriptVisual,create:function(){return new e.ScriptVisual({canRefresh:!1})}},t.kpi={name:"kpi",watermarkKey:"kpi",capabilities:e.capabilities.kpi,create:function(){return new e.KPIStatusWithHistory}},t.debugVisual={name:"debugVisual",watermarkKey:"kpi",capabilities:e.system.DebugVisual.capabilities,create:function(){return new e.system.DebugVisual}},t.custom={name:"custom",capabilities:e.system.DebugVisual.capabilities,create:function(){return{init:function(){},update:function(){},destroy:function(){},enumerateObjectInstances:function(){return[]}}}}}(t=e.plugins||(e.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){return"#FFFFFF"}function i(){return{color:t()}}e.getDefaultColor=t,e.getDefaultValues=i}(t=e.CanvasBackgroundHelper||(e.CanvasBackgroundHelper={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));


//# sourceMappingURL=powerbi-visuals.min.js.map
