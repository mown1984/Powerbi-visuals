!function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}({0:function(t,e,r){t.exports=r(341)},341:function(t,e,r){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;window.jsCommon=window.jsCommon||{},window.powerbi=window.powerbi||{},window.debug=window.debug||{},window.InJs=window.InJs||{},r(342),r(343),r(344),r(345),r(346),r(347),r(348),r(349),r(350),r(351),r(352),r(353),r(354),r(355),r(356),r(357),r(358),r(359),r(360),r(361),r(362),r(363),r(364),r(365),r(366),r(367),r(368),r(369),r(370),r(371),r(372),r(373),r(374),r(375),r(376),r(377),r(378),r(379),r(380),r(381),r(382),r(383),r(384),r(385),r(386),r(387),r(388),r(389),r(390),r(391),r(392),r(393),r(394),r(395),r(396),r(397),r(398),r(399),r(400),r(401),r(402),r(403),r(404),r(405),r(406),r(407),r(408),r(409),r(410),r(411),r(412),r(413),r(414),r(415),r(416),r(417),r(418),r(419),r(420),r(421)},342:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},343:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.visitEntity=function(t,e){return this.visitDefault(t,e)},t.prototype.visitColumnRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitMeasureRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitAggr=function(t,e){return this.visitDefault(t,e)},t.prototype.visitPercentile=function(t,e){return this.visitDefault(t,e)},t.prototype.visitHierarchy=function(t,e){return this.visitDefault(t,e)},t.prototype.visitHierarchyLevel=function(t,e){return this.visitDefault(t,e)},t.prototype.visitPropertyVariationSource=function(t,e){return this.visitDefault(t,e)},t.prototype.visitSelectRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitBetween=function(t,e){return this.visitDefault(t,e)},t.prototype.visitIn=function(t,e){return this.visitDefault(t,e)},t.prototype.visitAnd=function(t,e){return this.visitDefault(t,e)},t.prototype.visitOr=function(t,e){return this.visitDefault(t,e)},t.prototype.visitCompare=function(t,e){return this.visitDefault(t,e)},t.prototype.visitContains=function(t,e){return this.visitDefault(t,e)},t.prototype.visitExists=function(t,e){return this.visitDefault(t,e)},t.prototype.visitNot=function(t,e){return this.visitDefault(t,e)},t.prototype.visitStartsWith=function(t,e){return this.visitDefault(t,e)},t.prototype.visitConstant=function(t,e){return this.visitDefault(t,e)},t.prototype.visitDateSpan=function(t,e){return this.visitDefault(t,e)},t.prototype.visitDateAdd=function(t,e){return this.visitDefault(t,e)},t.prototype.visitNow=function(t,e){return this.visitDefault(t,e)},t.prototype.visitDefaultValue=function(t,e){return this.visitDefault(t,e)},t.prototype.visitAnyValue=function(t,e){return this.visitDefault(t,e)},t.prototype.visitArithmetic=function(t,e){return this.visitDefault(t,e)},t.prototype.visitFillRule=function(t,e){return this.visitDefault(t,e)},t.prototype.visitResourcePackageItem=function(t,e){return this.visitDefault(t,e)},t.prototype.visitScopedEval=function(t,e){return this.visitDefault(t,e)},t.prototype.visitWithRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitTransformTableRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitTransformOutputRoleRef=function(t,e){return this.visitDefault(t,e)},t.prototype.visitDefault=function(t,e){},t}();t.DefaultSQExprVisitorWithArg=e;var r=function(t){function e(){t.apply(this,arguments)}return i(e,t),e}(e);t.DefaultSQExprVisitor=r;var n=function(){function t(){}return t.prototype.visitEntity=function(t){this.visitDefault(t)},t.prototype.visitColumnRef=function(t){t.source.accept(this)},t.prototype.visitMeasureRef=function(t){t.source.accept(this)},t.prototype.visitAggr=function(t){t.arg.accept(this)},t.prototype.visitPercentile=function(t){t.arg.accept(this)},t.prototype.visitHierarchy=function(t){t.arg.accept(this)},t.prototype.visitHierarchyLevel=function(t){t.arg.accept(this)},t.prototype.visitPropertyVariationSource=function(t){t.arg.accept(this)},t.prototype.visitSelectRef=function(t){this.visitDefault(t)},t.prototype.visitBetween=function(t){t.arg.accept(this),t.lower.accept(this),t.upper.accept(this)},t.prototype.visitIn=function(t){for(var e=t.args,r=0,i=e.length;i>r;r++)e[r].accept(this);for(var n=t.values,r=0,i=n.length;i>r;r++)for(var o=n[r],a=0,u=o.length;u>a;a++)o[a].accept(this)},t.prototype.visitAnd=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitOr=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitCompare=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitContains=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitExists=function(t){t.arg.accept(this)},t.prototype.visitNot=function(t){t.arg.accept(this)},t.prototype.visitStartsWith=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitConstant=function(t){this.visitDefault(t)},t.prototype.visitDateSpan=function(t){t.arg.accept(this)},t.prototype.visitDateAdd=function(t){t.arg.accept(this)},t.prototype.visitNow=function(t){this.visitDefault(t)},t.prototype.visitDefaultValue=function(t){this.visitDefault(t)},t.prototype.visitAnyValue=function(t){this.visitDefault(t)},t.prototype.visitArithmetic=function(t){t.left.accept(this),t.right.accept(this)},t.prototype.visitFillRule=function(t){t.input.accept(this);var e=t.rule,r=e.linearGradient2,i=e.linearGradient3;r&&this.visitLinearGradient2(r),i&&this.visitLinearGradient3(i)},t.prototype.visitLinearGradient2=function(t){this.visitFillRuleStop(t.min),this.visitFillRuleStop(t.max)},t.prototype.visitLinearGradient3=function(t){this.visitFillRuleStop(t.min),this.visitFillRuleStop(t.mid),this.visitFillRuleStop(t.max)},t.prototype.visitResourcePackageItem=function(t){this.visitDefault(t)},t.prototype.visitScopedEval=function(t){t.expression.accept(this);for(var e=0,r=t.scope;e<r.length;e++){var i=r[e];i.accept(this)}},t.prototype.visitWithRef=function(t){this.visitDefault(t)},t.prototype.visitTransformTableRef=function(t){this.visitDefault(t)},t.prototype.visitTransformOutputRoleRef=function(t){this.visitDefault(t)},t.prototype.visitDefault=function(t){},t.prototype.visitFillRuleStop=function(t){t.color.accept(this);var e=t.value;e&&e.accept(this)},t}();t.DefaultSQExprVisitorWithTraversal=n}(e=t.data||(t.data={}))}(r||(r={}))},344:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){function e(t){return new r(t)}t.createEnumType=e;var r=function(){function t(t){this.allMembers=t}return t.prototype.members=function(t){var e=this.allMembers;if(!t)return e;for(var r=[],i=0,n=e;i<n.length;i++){var o=n[i];_.contains(t,o.value)&&r.push(o)}return r},t}()}(r||(r={}))},345:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t){if(t===!0)return!1;var e=t;return!!e.nullable}t.nullable=e}(e=t.FillSolidColorTypeDescriptor||(t.FillSolidColorTypeDescriptor={}))}(r||(r={}))},346:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},347:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){t.urlType={misc:{imageUrl:!0}}}(e=t.ImageDefinition||(t.ImageDefinition={}))}(r||(r={}))},348:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},349:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t){return!!(t.fill||t.fillRule||t.filter||t.expression||t.image||t.paragraphs)}t.isValid=e}(e=t.StructuralTypeDescriptor||(t.StructuralTypeDescriptor={}))}(r||(r={}))},350:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){function e(t){return t&m}function r(t){return(t&g)===t}function n(t){if(r(t))return null;var e=h[t];if(e){var i=e.lastIndexOf("_");if(i>0){var n=e.slice(0,i);h[n]&&(e=n)}}return e||null}function o(t,r){var i=v[t],n=h[i];if(null==n&&(n=h.Null),t&&r){var o=h[r];if(o){var a=e(o);a===v.Null?(o=n|o,h[o]&&(n=o)):a===t&&(n=o)}}return n}function a(t,e){return(t&y)===(e&y)}var u=i.EnumExtensions,s=function(){function t(t,e,r){this.underlyingType=t,this.category=e,u.hasFlag(t,h.Temporal)&&(this.temporalType=new l(t)),u.hasFlag(t,h.Geography)&&(this.geographyType=new p(t)),u.hasFlag(t,h.Miscellaneous)&&(this.miscType=new f(t)),u.hasFlag(t,h.Formatting)&&(this.formattingType=new d(t)),u.hasFlag(t,h.Enumeration)&&(this.enumType=r),u.hasFlag(t,h.Scripting)&&(this.scriptingType=new c(t))}return t.fromDescriptor=function(e){if(e=e||{},e.text)return t.fromExtendedType(h.Text);if(e.integer)return t.fromExtendedType(h.Integer);if(e.numeric)return t.fromExtendedType(h.Double);if(e.bool)return t.fromExtendedType(h.Boolean);if(e.dateTime)return t.fromExtendedType(h.DateTime);if(e.duration)return t.fromExtendedType(h.Duration);if(e.binary)return t.fromExtendedType(h.Binary);if(e.none)return t.fromExtendedType(h.None);if(e.scripting&&e.scripting.source)return t.fromExtendedType(h.ScriptSource);if(e.enumeration)return t.fromEnum(e.enumeration);if(e.temporal){if(e.temporal.year)return t.fromExtendedType(h.Year_Integer);if(e.temporal.month)return t.fromExtendedType(h.Month_Integer)}if(e.geography){if(e.geography.address)return t.fromExtendedType(h.Address);if(e.geography.city)return t.fromExtendedType(h.City);if(e.geography.continent)return t.fromExtendedType(h.Continent);if(e.geography.country)return t.fromExtendedType(h.Country);if(e.geography.county)return t.fromExtendedType(h.County);if(e.geography.region)return t.fromExtendedType(h.Region);if(e.geography.postalCode)return t.fromExtendedType(h.PostalCode_Text);if(e.geography.stateOrProvince)return t.fromExtendedType(h.StateOrProvince);if(e.geography.place)return t.fromExtendedType(h.Place);if(e.geography.latitude)return t.fromExtendedType(h.Latitude_Double);if(e.geography.longitude)return t.fromExtendedType(h.Longitude_Double)}if(e.misc){if(e.misc.image)return t.fromExtendedType(h.Image);if(e.misc.imageUrl)return t.fromExtendedType(h.ImageUrl);if(e.misc.webUrl)return t.fromExtendedType(h.WebUrl);if(e.misc.barcode)return t.fromExtendedType(h.Barcode_Text)}if(e.formatting){if(e.formatting.color)return t.fromExtendedType(h.Color);if(e.formatting.formatString)return t.fromExtendedType(h.FormatString);if(e.formatting.alignment)return t.fromExtendedType(h.Alignment);if(e.formatting.labelDisplayUnits)return t.fromExtendedType(h.LabelDisplayUnits);if(e.formatting.fontSize)return t.fromExtendedType(h.FontSize);if(e.formatting.labelDensity)return t.fromExtendedType(h.LabelDensity)}return e.extendedType?t.fromExtendedType(e.extendedType):e.operations&&e.operations.searchEnabled?t.fromExtendedType(h.SearchEnabled):t.fromExtendedType(h.Null)},t.fromExtendedType=function(r){r=r||h.Null;var i=e(r),o=n(r);return t.fromPrimitiveTypeAndCategory(i,o)},t.fromPrimitiveTypeAndCategory=function(e,r){e=e||v.Null,r=r||null;var i=e.toString();return r&&(i+="|"+r),t.typeCache[i]||(t.typeCache[i]=new t(o(e,r),r))},t.fromEnum=function(e){return new t(h.Enumeration,null,e)},t.isCompatibleTo=function(e,r){for(var i=t.fromDescriptor(e),n=0,o=r;n<o.length;n++){var a=o[n],u=t.fromDescriptor(a);if(u.isCompatibleFrom(i))return!0}return!1},t.prototype.isCompatibleFrom=function(t){var e=t.primitiveType;return this===t||this.primitiveType===e||e===v.Null},t.prototype.equals=function(t){return _.isEqual(this,t)},Object.defineProperty(t.prototype,"primitiveType",{get:function(){return e(this.underlyingType)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extendedType",{get:function(){return this.underlyingType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"categoryString",{get:function(){return this.category},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.primitiveType===v.Text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numeric",{get:function(){return u.hasFlag(this.underlyingType,h.Numeric)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"integer",{get:function(){return this.primitiveType===v.Integer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bool",{get:function(){return this.primitiveType===v.Boolean},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateTime",{get:function(){return this.primitiveType===v.DateTime||this.primitiveType===v.Date||this.primitiveType===v.Time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.primitiveType===v.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binary",{get:function(){return this.primitiveType===v.Binary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this.primitiveType===v.None},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"temporal",{get:function(){return this.temporalType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geography",{get:function(){return this.geographyType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"misc",{get:function(){return this.miscType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatting",{get:function(){return this.formattingType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enum",{get:function(){return this.enumType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scripting",{get:function(){return this.scriptingType},enumerable:!0,configurable:!0}),t.typeCache={},t}();t.ValueType=s;var c=function(){function t(t){this.underlyingType=t}return Object.defineProperty(t.prototype,"source",{get:function(){return a(this.underlyingType,h.ScriptSource)},enumerable:!0,configurable:!0}),t}();t.ScriptType=c;var l=function(){function t(t){this.underlyingType=t}return Object.defineProperty(t.prototype,"year",{get:function(){return a(this.underlyingType,h.Year)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"month",{get:function(){return a(this.underlyingType,h.Month)},enumerable:!0,configurable:!0}),t}();t.TemporalType=l;var p=function(){function t(t){this.underlyingType=t}return Object.defineProperty(t.prototype,"address",{get:function(){return a(this.underlyingType,h.Address)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"city",{get:function(){return a(this.underlyingType,h.City)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"continent",{get:function(){return a(this.underlyingType,h.Continent)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"country",{get:function(){return a(this.underlyingType,h.Country)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"county",{get:function(){return a(this.underlyingType,h.County)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"region",{get:function(){return a(this.underlyingType,h.Region)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"postalCode",{get:function(){return a(this.underlyingType,h.PostalCode)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateOrProvince",{get:function(){return a(this.underlyingType,h.StateOrProvince)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"place",{get:function(){return a(this.underlyingType,h.Place)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"latitude",{get:function(){return a(this.underlyingType,h.Latitude)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return a(this.underlyingType,h.Longitude)},enumerable:!0,configurable:!0}),t}();t.GeographyType=p;var f=function(){function t(t){this.underlyingType=t}return Object.defineProperty(t.prototype,"image",{get:function(){return a(this.underlyingType,h.Image)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return a(this.underlyingType,h.ImageUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webUrl",{get:function(){return a(this.underlyingType,h.WebUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barcode",{get:function(){return a(this.underlyingType,h.Barcode)},enumerable:!0,configurable:!0}),t}();t.MiscellaneousType=f;var d=function(){function t(t){this.underlyingType=t}return Object.defineProperty(t.prototype,"color",{get:function(){return a(this.underlyingType,h.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatString",{get:function(){return a(this.underlyingType,h.FormatString)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return a(this.underlyingType,h.Alignment)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelDisplayUnits",{get:function(){return a(this.underlyingType,h.LabelDisplayUnits)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return a(this.underlyingType,h.FontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelDensity",{get:function(){return a(this.underlyingType,h.LabelDensity)},enumerable:!0,configurable:!0}),t}();t.FormattingType=d,function(t){t[t.Null=0]="Null",t[t.Text=1]="Text",t[t.Decimal=2]="Decimal",t[t.Double=3]="Double",t[t.Integer=4]="Integer",t[t.Boolean=5]="Boolean",t[t.Date=6]="Date",t[t.DateTime=7]="DateTime",t[t.DateTimeZone=8]="DateTimeZone",t[t.Time=9]="Time",t[t.Duration=10]="Duration",t[t.Binary=11]="Binary",t[t.None=12]="None"}(t.PrimitiveType||(t.PrimitiveType={}));var v=t.PrimitiveType;!function(t){t[t.Numeric=256]="Numeric",t[t.Temporal=512]="Temporal",t[t.Geography=1024]="Geography",t[t.Miscellaneous=2048]="Miscellaneous",t[t.Formatting=4096]="Formatting",t[t.Scripting=8192]="Scripting",t[t.Null=0]="Null",t[t.Text=1]="Text",t[t.Decimal=258]="Decimal",t[t.Double=259]="Double",t[t.Integer=260]="Integer",t[t.Boolean=5]="Boolean",t[t.Date=518]="Date",t[t.DateTime=519]="DateTime",t[t.DateTimeZone=520]="DateTimeZone",t[t.Time=521]="Time",t[t.Duration=10]="Duration",t[t.Binary=11]="Binary",t[t.None=12]="None",t[t.Year=66048]="Year",t[t.Year_Text=66049]="Year_Text",t[t.Year_Integer=66308]="Year_Integer",t[t.Year_Date=66054]="Year_Date",t[t.Year_DateTime=66055]="Year_DateTime",t[t.Month=131584]="Month",t[t.Month_Text=131585]="Month_Text",t[t.Month_Integer=131844]="Month_Integer",t[t.Month_Date=131590]="Month_Date",t[t.Month_DateTime=131591]="Month_DateTime",t[t.Address=6554625]="Address",t[t.City=6620161]="City",t[t.Continent=6685697]="Continent",t[t.Country=6751233]="Country",t[t.County=6816769]="County",t[t.Region=6882305]="Region",t[t.PostalCode=6947840]="PostalCode",t[t.PostalCode_Text=6947841]="PostalCode_Text",t[t.PostalCode_Integer=6948100]="PostalCode_Integer",t[t.StateOrProvince=7013377]="StateOrProvince",t[t.Place=7078913]="Place",t[t.Latitude=7144448]="Latitude",t[t.Latitude_Decimal=7144706]="Latitude_Decimal",t[t.Latitude_Double=7144707]="Latitude_Double",t[t.Longitude=7209984]="Longitude",t[t.Longitude_Decimal=7210242]="Longitude_Decimal",t[t.Longitude_Double=7210243]="Longitude_Double",t[t.Image=13109259]="Image",t[t.ImageUrl=13174785]="ImageUrl",t[t.WebUrl=13240321]="WebUrl",t[t.Barcode=13305856]="Barcode",t[t.Barcode_Text=13305857]="Barcode_Text",t[t.Barcode_Integer=13306116]="Barcode_Integer",t[t.Color=19664897]="Color",t[t.FormatString=19730433]="FormatString",t[t.Alignment=20058113]="Alignment",t[t.LabelDisplayUnits=20123649]="LabelDisplayUnits",t[t.FontSize=20189443]="FontSize",t[t.LabelDensity=20254979]="LabelDensity",t[t.Enumeration=26214401]="Enumeration",t[t.ScriptSource=32776193]="ScriptSource",t[t.SearchEnabled=65541]="SearchEnabled"}(t.ExtendedType||(t.ExtendedType={}));var h=t.ExtendedType,m=255,g=65535,y=4294901760}(r||(r={}))},351:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){!function(t){t[t.Top=0]="Top",t[t.First=1]="First",t[t.Last=2]="Last",t[t.Sample=3]="Sample",t[t.Bottom=4]="Bottom"}(t.DataShapeBindingLimitType||(t.DataShapeBindingLimitType={}));t.DataShapeBindingLimitType;!function(t){t[t.None=0]="None",t[t.Before=1]="Before",t[t.After=2]="After"}(t.SubtotalType||(t.SubtotalType={}));t.SubtotalType}(e=t.data||(t.data={}))}(r||(r={}))},352:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(t){function e(t){if(t){var e;return t.top&&(e={Top:{}},t.top.count&&(e.Top.Count=t.top.count)),t.bottom&&(e={Bottom:{}},t.bottom.count&&(e.Bottom.Count=t.bottom.count)),t.sample&&(e={Sample:{}},t.sample.count&&(e.Sample.Count=t.sample.count)),t.window&&(e={Window:{}},t.window.count&&(e.Window.Count=t.window.count)),e}}t.createFrom=e}(e=t.DataShapeBindingDataReduction||(t.DataShapeBindingDataReduction={}))}(e=t.data||(t.data={}))}(r||(r={}))},353:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=function(){function t(t){this.schemas=t.schemas,t.links&&(this.links=t.links)}return t.prototype.schema=function(t){return this.schemas[t]},t}();t.FederatedConceptualSchema=e}(e=t.data||(t.data={}))}(r||(r={}))},354:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(r){function i(r,i){if(!_.isEmpty(r)){for(var n=[],o=0,a=r.length;a>o;o++){var u=r[o],s=u.data,c=void 0;if(s&&s.length)for(var l=0,p=s.length;p>l;l++)c=e.SQExprBuilder.and(c,u.data[l].expr);c&&n.push(c)}return _.isEmpty(n)?void 0:t.DataViewScopeIdentity.filterFromExprs(n,i)}}function n(r,i){var n=r.data;if(n.length!==i.length)return!1;for(var o=0,a=n.length;a>o;o++){var u=r.data[o],s=u;if(s.expr){if(!t.DataViewScopeIdentity.equals(s,i[o]))return!1}else if(!e.DataViewScopeWildcard.matches(u,i[o]))return!1}return!0}function o(t,r){var i=t.data,n=i.length;if(n!==r.length)return!1;for(var o=0;n>o;o++){var a=t.data[o],u=void 0;if(a.expr)u=e.ScopeIdentityExtractor.getKeys(a.expr);else{if(!a.exprs)return!1;u=a.exprs}if(u&&!e.SQExprUtils.sequenceEqual(r[o],u))return!1}return!0}function a(t,e){return t=t||null,e=e||null,t===e?!0:!t!=!e?!1:t.id!==e.id?!1:t.metadata!==e.metadata?!1:!!u(t.data,e.data)}function u(t,e){if(t=t||null,e=e||null,t===e)return!0;if(!t!=!e)return!1;if(t.length!==e.length)return!1;for(var r=0,i=t.length;i>r;r++)if(!s(t[r],e[r]))return!1;return!0}function s(r,i){var n=r,o=i;return n.expr&&o.expr?t.DataViewScopeIdentity.equals(n,o):n.exprs&&o.exprs?e.DataViewScopeWildcard.equals(n,o):n.roles&&o.roles?e.DataViewRoleWildcard.equals(n,o):!1}function c(t){var e={};if(t.data){for(var r=[],i=0,n=t.data.length;n>i;i++)r.push(t.data[i].key);e.data=r}return t.metadata&&(e.metadata=t.metadata),t.id&&(e.id=t.id),JSON.stringify(e)}function l(t){var e=t.data;if(!e)return!1;for(var r=0,i=e;r<i.length;r++){var n=i[r],o=n;if(o.exprs||o.roles)return!0}return!1}function p(t){var e=t.data;if(_.isEmpty(e))return!1;for(var r=0,i=e;r<i.length;r++){var n=i[r];if(f(n))return!0}return!1}function f(t){return!_.isEmpty(t.roles)}r.filterFromSelector=i,r.matchesData=n,r.matchesKeys=o,r.equals=a,r.getKey=c,r.containsWildcard=l,r.hasRoleWildcard=p,r.isRoleWildcard=f}(r=e.Selector||(e.Selector={}))}(e=t.data||(t.data={}))}(r||(r={}))},355:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t){switch(t){case 0:return"Add";case 1:return"Subtract";case 2:return"Multiply";case 3:return"Divide"}throw new Error("Unexpected ArithmeticOperatorKind: "+t)}!function(t){t[t.Table=0]="Table",t[t.Pod=1]="Pod"}(t.EntitySourceType||(t.EntitySourceType={}));t.EntitySourceType;t.getArithmeticOperatorName=e,function(t){t[t.Day=0]="Day",t[t.Week=1]="Week",t[t.Month=2]="Month",t[t.Year=3]="Year",t[t.Decade=4]="Decade",t[t.Second=5]="Second",t[t.Minute=6]="Minute",t[t.Hour=7]="Hour"}(t.TimeUnit||(t.TimeUnit={}));t.TimeUnit;!function(t){t[t.Sum=0]="Sum",t[t.Avg=1]="Avg",t[t.Count=2]="Count",t[t.Min=3]="Min",t[t.Max=4]="Max",t[t.CountNonNull=5]="CountNonNull",t[t.Median=6]="Median",t[t.StandardDeviation=7]="StandardDeviation",t[t.Variance=8]="Variance"}(t.QueryAggregateFunction||(t.QueryAggregateFunction={}));t.QueryAggregateFunction;!function(t){t[t.Equal=0]="Equal",t[t.GreaterThan=1]="GreaterThan",t[t.GreaterThanOrEqual=2]="GreaterThanOrEqual",t[t.LessThan=3]="LessThan",t[t.LessThanOrEqual=4]="LessThanOrEqual"}(t.QueryComparisonKind||(t.QueryComparisonKind={}));t.QueryComparisonKind;!function(t){t[t.None=0]="None",t[t.Number=1]="Number",t[t.Integer=3]="Integer",t[t.DateTime=4]="DateTime",t[t.Time=8]="Time",t[t.Date=20]="Date",t[t.Month=35]="Month",t[t.Year=67]="Year",t[t.YearAndMonth=128]="YearAndMonth",t[t.MonthAndDay=256]="MonthAndDay",t[t.Decade=515]="Decade",t[t.YearAndWeek=1024]="YearAndWeek",t[t.String=2048]="String",t[t.Boolean=4096]="Boolean",t[t.Table=8192]="Table",t[t.Range=16384]="Range"}(t.SemanticType||(t.SemanticType={}));t.SemanticType;!function(t){t[t.Default=0]="Default",t[t.Period=1]="Period"}(t.FilterKind||(t.FilterKind={}));t.FilterKind}(e=t.data||(t.data={}))}(r||(r={}))},356:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=function(){function t(t,e,r){this.items=t,this._activeProjectionRefs=e,this._showAll=r}return t.prototype.all=function(){return this.items},Object.defineProperty(t.prototype,"activeProjectionRefs",{get:function(){return this._activeProjectionRefs},set:function(t){if(!_.isEmpty(t)){for(var e=this.items.map(function(t){return t.queryRef}),r=0,i=t;r<i.length;r++){var n=i[r];if(!_.contains(e,n))return}this._activeProjectionRefs=t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showAll",{get:function(){return this._showAll},set:function(t){this._showAll=t},enumerable:!0,configurable:!0}),t.prototype.addActiveQueryReference=function(t){this._activeProjectionRefs?this._activeProjectionRefs.push(t):this._activeProjectionRefs=[t]},t.prototype.getLastActiveQueryReference=function(){return _.isEmpty(this._activeProjectionRefs)?void 0:this._activeProjectionRefs[this._activeProjectionRefs.length-1]},t.prototype.replaceQueryRef=function(t,e){for(var r=0,i=this.items;r<i.length;r++){var n=i[r];n.queryRef===t&&(n.queryRef=e)}},t.prototype.clone=function(){return new t(_.cloneDeep(this.items),_.clone(this._activeProjectionRefs),this._showAll)},t}();t.QueryProjectionCollection=e;var r;!function(t){function e(t){if(!t)return t;var e={};for(var r in t)e[r]=t[r].clone();return e}function r(t,e){return t?t[e]:void 0}t.clone=e,t.getRole=r}(r=t.QueryProjectionsByRole||(t.QueryProjectionsByRole={}))}(e=t.data||(t.data={}))}(r||(r={}))},357:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){!function(t){t[t.Default=0]="Default",t[t.Verbose=1]="Verbose",t[t.WholeUnits=2]="WholeUnits",t[t.DataLabels=3]="DataLabels"}(t.DisplayUnitSystemType||(t.DisplayUnitSystemType={}));t.DisplayUnitSystemType}(r||(r={}))},358:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e=function(){function e(t){this.unit=t,this.sequence=[],this.min=new Date("9999-12-31T23:59:59.999"),this.max=new Date("0001-01-01T00:00:00.000")}return e.prototype.add=function(t){t<this.min&&(this.min=t),t>this.max&&(this.max=t),this.sequence.push(t)},e.prototype.extendToCover=function(t,r){for(var i=this.min;i>t;)i=e.addInterval(i,-this.interval,this.unit),this.sequence.splice(0,0,i);for(this.min=i,i=this.max;r>i;)i=e.addInterval(i,this.interval,this.unit),this.sequence.push(i);this.max=i},e.prototype.moveToCover=function(t,r){var i=e.getDelta(t,r,this.unit),n=Math.floor(i/this.interval);for(this.min=e.addInterval(this.min,n*this.interval,this.unit),this.sequence=[],this.sequence.push(this.min),this.max=this.min;this.max<r;)this.max=e.addInterval(this.max,this.interval,this.unit),this.sequence.push(this.max)},e.calculate=function(r,i,n,o){switch(o||(o=e.getIntervalUnit(r,i,n)),o){case t.DateTimeUnit.Year:return e.calculateYears(r,i,n);case t.DateTimeUnit.Month:return e.calculateMonths(r,i,n);case t.DateTimeUnit.Week:return e.calculateWeeks(r,i,n);case t.DateTimeUnit.Day:return e.calculateDays(r,i,n);case t.DateTimeUnit.Hour:return e.calculateHours(r,i,n);case t.DateTimeUnit.Minute:return e.calculateMinutes(r,i,n);case t.DateTimeUnit.Second:return e.calculateSeconds(r,i,n);case t.DateTimeUnit.Millisecond:return e.calculateMilliseconds(r,i,n)}},e.calculateYears=function(r,i,n){var o=t.NumericSequenceRange.calculateDataRange(r.getFullYear(),i.getFullYear(),!1),a=t.NumericSequence.calculate(t.NumericSequenceRange.calculate(0,o.max-o.min),n,0,null,null,[1,2,5]),u=Math.floor(o.min/a.interval)*a.interval,s=new Date(u,0,1),c=e.fromNumericSequence(s,a,t.DateTimeUnit.Year);return c},e.calculateMonths=function(r,i,n){var o=r.getFullYear(),a=i.getFullYear(),u=r.getMonth(),s=12*(a-o)+i.getMonth(),c=new Date(o,0,1),l=t.NumericSequence.calculateUnits(u,s,n,[1,2,3,6,12]),p=e.fromNumericSequence(c,l,t.DateTimeUnit.Month);return p},e.calculateWeeks=function(r,i,n){var o=0,a=r.getDay(),u=(a-o+7)%7,s=r.getDate()-u,c=new Date(r.getFullYear(),r.getMonth(),s),l=0,p=t.Double.ceilWithPrecision(e.getDelta(c,i,t.DateTimeUnit.Week)),f=t.NumericSequence.calculateUnits(l,p,n,[1,2,4,8]),d=e.fromNumericSequence(c,f,t.DateTimeUnit.Week);return d},e.calculateDays=function(r,i,n){var o=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=0,u=t.Double.ceilWithPrecision(e.getDelta(r,i,t.DateTimeUnit.Day)),s=t.NumericSequence.calculateUnits(a,u,n,[1,2,7,14]),c=e.fromNumericSequence(o,s,t.DateTimeUnit.Day);return c},e.calculateHours=function(r,i,n){var o=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=t.Double.floorWithPrecision(e.getDelta(o,r,t.DateTimeUnit.Hour)),u=t.Double.ceilWithPrecision(e.getDelta(o,i,t.DateTimeUnit.Hour)),s=t.NumericSequence.calculateUnits(a,u,n,[1,2,3,6,12,24]),c=e.fromNumericSequence(o,s,t.DateTimeUnit.Hour);return c},e.calculateMinutes=function(r,i,n){var o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours()),a=t.Double.floorWithPrecision(e.getDelta(o,r,t.DateTimeUnit.Minute)),u=t.Double.ceilWithPrecision(e.getDelta(o,i,t.DateTimeUnit.Minute)),s=t.NumericSequence.calculateUnits(a,u,n,[1,2,5,10,15,30,60,120,180,360,720,1440]),c=e.fromNumericSequence(o,s,t.DateTimeUnit.Minute);return c},e.calculateSeconds=function(r,i,n){var o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes()),a=t.Double.floorWithPrecision(e.getDelta(o,r,t.DateTimeUnit.Second)),u=t.Double.ceilWithPrecision(e.getDelta(o,i,t.DateTimeUnit.Second)),s=t.NumericSequence.calculateUnits(a,u,n,[1,2,5,10,15,30,60,120,300,600,900,1800,3600]),c=e.fromNumericSequence(o,s,t.DateTimeUnit.Second);
return c},e.calculateMilliseconds=function(r,i,n){var o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()),a=e.getDelta(o,r,t.DateTimeUnit.Millisecond),u=e.getDelta(o,i,t.DateTimeUnit.Millisecond),s=t.NumericSequence.calculate(t.NumericSequenceRange.calculate(a,u),n,0),c=e.fromNumericSequence(o,s,t.DateTimeUnit.Millisecond);return c},e.addInterval=function(e,i,n){switch(i=Math.round(i),n){case t.DateTimeUnit.Year:return r.addYears(e,i);case t.DateTimeUnit.Month:return r.addMonths(e,i);case t.DateTimeUnit.Week:return r.addWeeks(e,i);case t.DateTimeUnit.Day:return r.addDays(e,i);case t.DateTimeUnit.Hour:return r.addHours(e,i);case t.DateTimeUnit.Minute:return r.addMinutes(e,i);case t.DateTimeUnit.Second:return r.addSeconds(e,i);case t.DateTimeUnit.Millisecond:return r.addMilliseconds(e,i)}},e.fromNumericSequence=function(t,r,i){for(var n=new e(i),o=0;o<r.sequence.length;o++){var a=r.sequence[o],u=e.addInterval(t,a,i);n.add(u)}return n.interval=r.interval,n.intervalOffset=r.intervalOffset,n},e.getDelta=function(e,r,i){var n=0;switch(i){case t.DateTimeUnit.Year:n=r.getFullYear()-e.getFullYear();break;case t.DateTimeUnit.Month:n=12*(r.getFullYear()-e.getFullYear())+r.getMonth()-e.getMonth();break;case t.DateTimeUnit.Week:n=(r.getTime()-e.getTime())/6048e5;break;case t.DateTimeUnit.Day:n=(r.getTime()-e.getTime())/864e5;break;case t.DateTimeUnit.Hour:n=(r.getTime()-e.getTime())/36e5;break;case t.DateTimeUnit.Minute:n=(r.getTime()-e.getTime())/6e4;break;case t.DateTimeUnit.Second:n=(r.getTime()-e.getTime())/1e3;break;case t.DateTimeUnit.Millisecond:n=r.getTime()-e.getTime()}return n},e.getIntervalUnit=function(r,i,n){n=Math.max(n,2);var o=e.getDelta(r,i,t.DateTimeUnit.Day);if(o>356&&o>=180*n)return t.DateTimeUnit.Year;if(o>60&&o>7*n)return t.DateTimeUnit.Month;if(o>14&&o>2*n)return t.DateTimeUnit.Week;var a=e.getDelta(r,i,t.DateTimeUnit.Hour);if(o>2&&a>12*n)return t.DateTimeUnit.Day;if(a>=24&&a>=n)return t.DateTimeUnit.Hour;var u=e.getDelta(r,i,t.DateTimeUnit.Minute);if(u>2&&u>=n)return t.DateTimeUnit.Minute;var s=e.getDelta(r,i,t.DateTimeUnit.Second);if(s>2&&s>=.8*n)return t.DateTimeUnit.Second;var c=e.getDelta(r,i,t.DateTimeUnit.Millisecond);if(c>0)return t.DateTimeUnit.Millisecond;var l=r;return 0!==l.getMilliseconds()?t.DateTimeUnit.Millisecond:0!==l.getSeconds()?t.DateTimeUnit.Second:0!==l.getMinutes()?t.DateTimeUnit.Minute:0!==l.getHours()?t.DateTimeUnit.Hour:1!==l.getDate()?t.DateTimeUnit.Day:0!==l.getMonth()?t.DateTimeUnit.Month:t.DateTimeUnit.Year},e.MIN_COUNT=1,e.MAX_COUNT=1e3,e}();t.DateTimeSequence=e;var r;!function(t){function e(t){return t%4===0&&t%100!==0||t%400===0}function r(t,r){return e(t)?f[r]:p[r]}function i(t,r){var i=t.getFullYear(),n=t.getMonth(),o=t.getDate(),a=2===n&&29===o,u=new Date(t.getTime());return i+=r,a&&!e(i)&&(o=28),u.setFullYear(i,n,o),u}function n(t,e){var i=t.getFullYear(),n=t.getMonth(),o=t.getDate(),a=new Date(t.getTime());return i+=(e-e%12)/12,n+=e%12,n>11&&(n%=12,i++),o=Math.min(o,r(i,n)),a.setFullYear(i,n,o),a}function o(t,e){return a(t,7*e)}function a(t,e){var r=t.getFullYear(),i=t.getMonth(),n=t.getDate(),o=new Date(t.getTime());return o.setFullYear(r,i,n+e),o}function u(t,e){return new Date(t.getTime()+36e5*e)}function s(t,e){return new Date(t.getTime()+6e4*e)}function c(t,e){return new Date(t.getTime()+1e3*e)}function l(t,e){return new Date(t.getTime()+e)}var p=[31,28,31,30,31,30,31,31,30,31,30,31],f=[31,29,31,30,31,30,31,31,30,31,30,31];t.addYears=i,t.addMonths=n,t.addWeeks=o,t.addDays=a,t.addHours=u,t.addMinutes=s,t.addSeconds=c,t.addMilliseconds=l}(r=t.DateUtils||(t.DateUtils={}))}(r||(r={}))},359:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){function e(e,i){for(var o=[],a=3;n>a;a++){var u=e(a);u&&r(o,t.Double.pow10(a),u.title,u.format,i)}return o}function r(t,e,r,i,n){if(r||i){var o=e;if(t.length>0){var a=t[t.length-1];n&&(o=n(e,a.value,o)),a.applicableRangeMax=o}var u=new p;u.value=e,u.applicableRangeMin=o,u.applicableRangeMax=1e3*o,u.title=r,u.labelFormat=i,t.push(u)}}var n=24,o=1e15,a=1e-4,u="%",s="E+0",c="0.##"+s,l=/^([0\#,]*\.[0\#]+|[0\#,]+|g)$/i,p=function(){function e(){}return e.prototype.project=function(e){return this.value?t.Double.removeDecimalNoise(e/this.value):e},e.prototype.reverseProject=function(t){return this.value?t*this.value:t},e.prototype.isApplicableTo=function(e){e=Math.abs(e);var r=t.Double.getPrecision(e,3);return t.Double.greaterOrEqualWithPrecision(e,this.applicableRangeMin,r)&&t.Double.lessWithPrecision(e,this.applicableRangeMax,r)},e.prototype.isScaling=function(){return this.value>1},e}();t.DisplayUnit=p;var f=function(){function e(t){this.units=t?t:[]}return Object.defineProperty(e.prototype,"title",{get:function(){return this.displayUnit?this.displayUnit.title:void 0},enumerable:!0,configurable:!0}),e.prototype.update=function(t){void 0!==t&&(this.unitBaseValue=t,this.displayUnit=this.findApplicableDisplayUnit(t))},e.prototype.findApplicableDisplayUnit=function(t){for(var e=0,r=this.units;e<r.length;e++){var i=r[e];if(i.isApplicableTo(t))return i}},e.prototype.format=function(t,e,r,i){r=this.getNumberOfDecimalsForFormatting(e,r);var n="";return this.isFormatSupported(e)&&!this.hasScientitifcFormat(e)&&this.isScalingUnit()&&this.shouldRespectScalingUnit(e)&&(t=this.displayUnit.project(t),n=this.displayUnit.labelFormat),this.formatHelper(t,n,e,r,i)},e.prototype.isFormatSupported=function(t){return!e.UNSUPPORTED_FORMATS.test(t)},e.prototype.isPercentageFormat=function(t){return t&&t.indexOf(u)>=0},e.prototype.shouldRespectScalingUnit=function(t){return!this.isPercentageFormat(t)},e.prototype.getNumberOfDecimalsForFormatting=function(t,e){return e},e.prototype.isScalingUnit=function(){return this.displayUnit&&this.displayUnit.isScaling()},e.prototype.formatHelper=function(e,r,i,n,o){if("g"!==i&&"G"!==i||null==n||(i=t.visuals.valueFormatter.DefaultNumericFormat),i=t.NumberFormat.addDecimalsToFormat(i,n,o),i&&!t.formattingService.isStandardNumberFormat(i))return t.formattingService.formatNumberWithCustomOverride(e,i,r);i||(i="G"),r||(r="{0}");var a=t.formattingService.formatValue(e,i);return t.formattingService.format(r,[a])},e.prototype.formatSingleValue=function(e,r,i,n){return this.update(this.shouldUseValuePrecision(e)?t.Double.getPrecision(e,8):e),this.format(e,r,i,n)},e.prototype.shouldUseValuePrecision=function(t){if(0===this.units.length)return!0;for(var e=0,r=0;r<this.units.length;r++)if(this.units[r].isScaling()){e=this.units[r].applicableRangeMin;break}return Math.abs(t)<e},e.prototype.isScientific=function(t){return-o>t||t>o||t>-a&&a>t&&0!==t},e.prototype.hasScientitifcFormat=function(t){return t&&-1!==t.toUpperCase().indexOf("E")},e.prototype.supportsScientificFormat=function(t){return t?l.test(t):!0},e.prototype.shouldFallbackToScientific=function(t,e){return!this.hasScientitifcFormat(e)&&this.supportsScientificFormat(e)&&this.isScientific(t)},e.prototype.getScientificFormat=function(e,r,i,n){if(this.isFormatSupported(r)&&this.shouldFallbackToScientific(e,r)){var o=t.NumberFormat.getNumericFormat(e,r);return i&&(o=t.NumberFormat.addDecimalsToFormat(o?o:"0",Math.abs(i),n)),o?o+s:c}return r},e.UNSUPPORTED_FORMATS=/^(p\d*)|(.*\%)|(e\d*)$/i,e}();t.DisplayUnitSystem=f;var d=function(t){function e(){t.call(this,[])}return i(e,t),e}(f);t.NoDisplayUnitSystem=d;var v=function(t){function r(e){t.call(this,r.getUnits(e))}return i(r,t),r.prototype.format=function(e,r,i,n){return r=this.getScientificFormat(e,r,i,n),t.prototype.format.call(this,e,r,i,n)},r.reset=function(){r.units=null},r.getUnits=function(t){return r.units||(r.units=e(t,function(t,e,r){return t-e>=1e3?t/10:r}),r.units[r.units.length-1].applicableRangeMax=1/0),r.units},r}(f);t.DefaultDisplayUnitSystem=v;var h=function(t){function r(e){t.call(this,r.getUnits(e))}return i(r,t),r.reset=function(){r.units=null},r.getUnits=function(t){return r.units||(r.units=e(t),r.units[r.units.length-1].applicableRangeMax=1/0),r.units},r.prototype.format=function(e,r,i,n){return r=this.getScientificFormat(e,r,i,n),t.prototype.format.call(this,e,r,i,n)},r}(f);t.WholeUnitsDisplayUnitSystem=h;var m=function(t){function n(e){t.call(this,n.getUnits(e))}return i(n,t),n.prototype.isFormatSupported=function(t){return!n.UNSUPPORTED_FORMATS.test(t)},n.getUnits=function(t){if(!n.units){var i=[],o=function(t,e,r){return-1===t&&t-e>=1e3?t/10:r},a=t(-1);r(i,n.AUTO_DISPLAYUNIT_VALUE,a.title,a.format,o),a=t(0),r(i,n.NONE_DISPLAYUNIT_VALUE,a.title,a.format,o),n.units=i.concat(e(t,o)),n.units[n.units.length-1].applicableRangeMax=1/0}return n.units},n.prototype.format=function(e,r,i,n){return r=this.getScientificFormat(e,r,i,n),t.prototype.format.call(this,e,r,i,n)},n.AUTO_DISPLAYUNIT_VALUE=0,n.NONE_DISPLAYUNIT_VALUE=1,n.UNSUPPORTED_FORMATS=/^(e\d*)$/i,n}(f);t.DataLabelsDisplayUnitSystem=m}(r||(r={}))},360:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e=function(){function e(){}return e.calculate=function(r,i,n,o,a,u){var s=new e;if(i=void 0===i?10:t.Double.ensureInRange(i,e.MIN_COUNT,e.MAX_COUNT),void 0===o&&(o=t.Double.MIN_EXP),void 0===a&&(a=!1),void 0===n&&(n=1),void 0===u&&(u=[1,2,5]),r.forcedSingleStop)return s.interval=r.getSize(),s.intervalOffset=s.interval-(r.forcedSingleStop-r.min),s.min=r.min,s.max=r.max,s.sequence=[r.forcedSingleStop],s;var c=0,l=0,p=9,f=n>0&&!r.hasFixedMin,d=n>0&&!r.hasFixedMax,v=r.getSize(),h=t.Double.log10(v),m=t.Double.log10(u[0]);h-=m;var g=t.Double.log10(i);h-=g,h=Math.max(h,o-m+1);var y=void 0;if(0!==c){var w=t.Double.pow10(h),x=t.Double.floorToPrecision(r.min,w),b=t.Double.ceilToPrecision(r.max,w),S=t.NumericSequenceRange.calculateFixedRange(x,b);S.shrinkByStep(r,c),l=S.min,p=S.max,y=Math.floor(S.getSize()/c)}else{var E=void 0;for(E=0;3>E;E++){for(var D=h+E,w=t.Double.pow10(D),x=t.Double.floorToPrecision(r.min,w),b=t.Double.ceilToPrecision(r.max,w),C=u.length,T=t.Double.pow10(D-1),V=0;C>V;V++){var M=u[V]*T,S=t.NumericSequenceRange.calculateFixedRange(x,b,a);if(S.shrinkByStep(r,M),f&&r.min===S.min&&n>=1&&(S.min-=M),d&&r.max===S.max&&n>=1&&(S.max+=M),y=t.Double.ceilWithPrecision(S.getSize()/M),i>=y||2===E&&V===C-1||1===i&&2===y&&(M>r.getSize()||r.min<0&&r.max>0&&2*M>=r.getSize())){c=M,l=S.min,p=S.max;break}}if(0!==c)break}}(y>32*i||y>e.MAX_COUNT)&&(y=Math.min(32*i,e.MAX_COUNT),c=(p-l)/y),s.min=l,s.max=p,s.interval=c,s.intervalOffset=l-r.min,s.maxAllowedMargin=n,s.canExtendMin=f,s.canExtendMax=d;var F=t.Double.getPrecision(c,0);s.precision=F;var R=[],P=t.Double.roundToPrecision(l,F);R.push(P);for(var V=0;y>V;V++)P=t.Double.roundToPrecision(P+c,F),R.push(P);return s.sequence=R,s.trimMinMax(r.min,r.max),s},e.calculateUnits=function(r,i,n,o){n=t.Double.ensureInRange(n,e.MIN_COUNT,e.MAX_COUNT),r===i&&(i=r+1);for(var a=0,u=0,s=0;s<o.length;s++){u=o[s];var c=t.Double.ceilWithPrecision(i/u),l=t.Double.floorWithPrecision(r/u);if(a=c-l,n>=a)break}var p=-r;p%=u;var f=new e;f.sequence=[];for(var d=r+p;f.sequence.push(d),!(d>=i);d+=u);return f.interval=u,f.intervalOffset=p,f.min=f.sequence[0],f.max=f.sequence[f.sequence.length-1],f},e.prototype.trimMinMax=function(t,e){var r=(t-this.min)/this.interval,i=(this.max-e)/this.interval,n=.001;(!this.canExtendMin||r>this.maxAllowedMargin&&r>n)&&(this.min=t),(!this.canExtendMax||i>this.maxAllowedMargin&&i>n)&&(this.max=e)},e.MIN_COUNT=1,e.MAX_COUNT=1e3,e}();t.NumericSequence=e}(r||(r={}))},361:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e=function(){function e(){}return e.prototype._ensureIncludeZero=function(){this.includeZero&&(this.min>0&&!this.hasFixedMin&&(this.min=0),this.max<0&&!this.hasFixedMax&&(this.max=0))},e.prototype._ensureNotEmpty=function(){if(this.min===this.max)if(this.min){var r=this.min,i=t.Double.log10(Math.abs(r)),n=void 0;i>=0&&4>i?(n=.5,this.forcedSingleStop=r):(n=t.Double.pow10(i)/2,this.forcedSingleStop=null),this.min=r-n,this.max=r+n}else this.min=0,this.max=e.DEFAULT_MAX,this.hasFixedMin=!0,this.hasFixedMax=!0},e.prototype._ensureDirection=function(){if(this.min>this.max){var t=this.min;this.min=this.max,this.max=t}},e.prototype.getSize=function(){return this.max-this.min},e.prototype.shrinkByStep=function(t,e){var r=this.min/e,i=t.min/e,n=Math.floor(i-r);this.min+=n*e,r=this.max/e,i=t.max/e,n=Math.ceil(i-r),this.max+=n*e},e.calculate=function(i,n,o,a,u){var s=new e;return s.includeZero=!!u,s.hasDataRange=r.hasValue(i)&&r.hasValue(n),s.hasFixedMin=r.hasValue(o),s.hasFixedMax=r.hasValue(a),i=t.Double.ensureInRange(i,e.MIN_SUPPORTED_DOUBLE,e.MAX_SUPPORTED_DOUBLE),n=t.Double.ensureInRange(n,e.MIN_SUPPORTED_DOUBLE,e.MAX_SUPPORTED_DOUBLE),s.hasFixedMin&&s.hasFixedMax?(s.min=o,s.max=a):s.hasFixedMin?(s.min=o,s.max=n>o?n:o):s.hasFixedMax?(s.min=a>i?i:a,s.max=a):s.hasDataRange?(s.min=i,s.max=n):(s.min=0,s.max=0),s._ensureIncludeZero(),s._ensureNotEmpty(),s._ensureDirection(),0===s.min?s.hasFixedMin=!0:0===s.max&&(s.hasFixedMax=!0),s},e.calculateDataRange=function(t,i,n){return r.hasValue(t)&&r.hasValue(i)?e.calculate(t,i,null,null,n):e.calculateFixedRange(0,e.DEFAULT_MAX)},e.calculateFixedRange=function(t,r,i){var n=new e;return n.hasDataRange=!1,n.includeZero=i,n.min=t,n.max=r,n._ensureIncludeZero(),n._ensureNotEmpty(),n._ensureDirection(),n.hasFixedMin=!0,n.hasFixedMax=!0,n},e.DEFAULT_MAX=10,e.MIN_SUPPORTED_DOUBLE=-1e307,e.MAX_SUPPORTED_DOUBLE=1e307,e}();t.NumericSequenceRange=e;var r;!function(t){function e(t){return void 0!==t&&null!==t}t.hasValue=e}(r=t.ValueUtil||(t.ValueUtil={}))}(r||(r={}))},362:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(e){function r(t){var e=E[t];return e?D[e]||t:t}function n(t){var e=-1===t?"Auto":t.toString(),r=D["DisplayUnitSystem_E"+e+"_Title"],i=0>=t?"{0}":D["DisplayUnitSystem_E"+e+"_LabelFormat"];return r||i?{title:r,format:i}:void 0}function o(t){return D[t]}function a(e){return t.NumberFormat.getCustomFormatMetadata(e)}function u(e){C=e,t.DefaultDisplayUnitSystem.reset(),t.WholeUnitsDisplayUnitSystem.reset()}function s(t,e){void 0===e&&(e=!1);var r=e?C.beautify(t):t;return{format:function(t){return null==t?C["null"]:w(t,r)}}}function c(r){var i=r.allowFormatBeautification?C.beautify(r.format):r.format;if(d(r)){var n=f(r.displayUnitSystemType),o=!!r.formatSingleValues;n.update(Math.max(Math.abs(r.value||0),Math.abs(r.value2||0)));var a,u=null!=r.precision;if(u?a=-r.precision:n.displayUnit&&n.displayUnit.value>1&&(a=-T),r.detectAxisPrecision){u=!0;var c=r.value;n.displayUnit&&n.displayUnit.value>0&&(c/=n.displayUnit.value),t.Double.isInteger(c)?a=0:(a=t.Double.log10(c),i&&e.getFormatMetadata(i).hasPercent&&(a=0>a?Math.min(0,a+2):0))}return{format:function(e){var r=x(e,!0);return S.isNullOrUndefinedOrWhiteSpaceString(r)?(e&&!n.isScalingUnit()&&Math.abs(e)<V&&!u&&(e=t.Double.roundToPrecision(e)),o?n.formatSingleValue(e,i,a,u):n.format(e,i,a,u)):r},displayUnit:n.displayUnit,options:r}}if(v(r.value,r.value2,r.tickCount)){var l=t.DateTimeSequence.getIntervalUnit(r.value,r.value2,r.tickCount);return{format:function(e){if(null==e)return C["null"];var r=t.formattingService.dateFormatString(l);return w(e,r)},options:r}}return s(i)}function l(t,e,r){return null==t?C["null"]:w(t,r?C.beautify(e):e)}function p(t,e,r,i){if(!(e&&e.type&&e.type.dateTime)&&t instanceof Date){var n=h(R,null,!1);return w(t,n,i)}return w(t,h(e,r),i)}function f(e){if(null==e)return new t.DefaultDisplayUnitSystem(C.describe);switch(e){case t.DisplayUnitSystemType.Default:return new t.DefaultDisplayUnitSystem(C.describe);case t.DisplayUnitSystemType.WholeUnits:return new t.WholeUnitsDisplayUnitSystem(C.describe);case t.DisplayUnitSystemType.Verbose:return new t.NoDisplayUnitSystem;case t.DisplayUnitSystemType.DataLabels:return new t.DataLabelsDisplayUnitSystem(C.describe);default:return new t.DefaultDisplayUnitSystem(C.describe)}}function d(e){var r=e.value,i=e.value2,n=e.format;if(e.formatSingleValues&&n&&Math.abs(r)<M){var o=!t.NumberFormat.isStandardFormat(n);if(o){var a=t.NumberFormat.getCustomFormatMetadata(n,!0).precision;if(F>a)return!1}else if(t.Double.isInteger(r))return!1}return"number"==typeof r||"number"==typeof i?!0:void 0}function v(t,e,r){return t instanceof Date&&e instanceof Date&&void 0!==r&&null!==r}function h(r,i,n){if(r){if(i){var o=t.DataViewObjects.getValue(r.objects,i);if(o)return o}if(!n){var a=r.type;if(a){if(a.dateTime)return e.DefaultDateFormat;if(a.integer)return e.DefaultIntegerFormat;if(a.numeric)return e.DefaultNumericFormat}}}}function m(t,e){var r;if(!t)return null;var i=t.length;if(i>0){r=t[0];for(var n=i-1,o=1,a=n;a>o;o++){var u=t[o];r=S.format(C.restatementComma,r,u)}if(i>1){var u=t[n];r=S.format(e,r,u)}}else r=null;return r}function g(t){return m(t,C.restatementCompoundAnd)}function y(t){return m(t,C.restatementCompoundOr)}function w(e,r,i){var n=x(e,i?i:!1);return S.isNullOrUndefinedOrWhiteSpaceString(n)?t.formattingService.formatValue(e,r):n}function x(t,e){return null==t&&e?C["null"]:t===!0?C["true"]:t===!1?C["false"]:"number"==typeof t&&isNaN(t)?C.NaN:t===Number.NEGATIVE_INFINITY?C.negativeInfinity:t===Number.POSITIVE_INFINITY?C.infinity:""}function b(t){var e=f(t);return e.units}var S=i.StringExtensions,E={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"};e.DefaultIntegerFormat="g",e.DefaultNumericFormat="#,0.00",e.DefaultDateFormat="d";var D={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",RestatementComma:"{0}, {1}",RestatementCompoundAnd:"{0} and {1}",RestatementCompoundOr:"{0} or {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",Funnel_PercentOfFirst:"Percent of first",Funnel_PercentOfPrevious:"Percent of previous",Funnel_PercentOfFirst_Highlight:"Percent of first (highlighted)",Funnel_PercentOfPrevious_Highlight:"Percent of previous (highlighted)",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories"};e.getLocalizedString=o;var C={"null":D.NullValue,"true":D.BooleanTrue,"false":D.BooleanFalse,NaN:D.NaNValue,infinity:D.InfinityValue,negativeInfinity:D.NegativeInfinityValue,beautify:function(t){return r(t)},describe:function(t){return n(t)},restatementComma:D.RestatementComma,restatementCompoundAnd:D.RestatementCompoundAnd,restatementCompoundOr:D.RestatementCompoundOr},T=2,V=1e3,M=1e4,F=2,R={displayName:"",type:t.ValueType.fromPrimitiveTypeAndCategory(t.PrimitiveType.DateTime)};e.getFormatMetadata=a,e.setLocaleOptions=u,e.createDefaultFormatter=s,e.create=c,e.format=l,e.formatVariantMeasureValue=p,e.getFormatString=h,e.formatListAnd=g,e.formatListOr=y,e.getDisplayUnits=b}(r=e.valueFormatter||(e.valueFormatter={}))}(e=t.visuals||(t.visuals={}))}(r||(r={}))},363:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},364:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},365:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(t){function e(t,e){if(!_.isEmpty(t)){var r=t[0];if(r.values&&r.values.length>0)for(var n=0,o=r.values.length;o>n;++n){var a=r.values[n];if(a&&a.source&&i(a.source,e))return n}}return-1}function r(t,e){if(!_.isEmpty(t))for(var r=0,n=t.length;n>r;r++)if(i(t[r].source,e))return r;return-1}function i(t,e){var r=t.roles;return r&&r[e]}function n(t,e){return null!=t&&null!=t.metadata&&t.metadata.columns&&_.any(t.metadata.columns,function(t){return t.roles&&void 0!==t.roles[e]})}function o(t,e){return t&&t.source&&t.source.roles&&t.source.roles[e]===!0}t.getMeasureIndexOfRole=e,t.getCategoryIndexOfRole=r,t.hasRole=i,t.hasRoleInDataView=n,t.hasRoleInValueColumn=o}(e=t.DataRoleHelper||(t.DataRoleHelper={}))}(e=t.data||(t.data={}))}(r||(r={}))},366:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(t){return new n(t)}var i=t.data.DataRoleHelper;e.createIDataViewCategoricalReader=r;var n=function(){function t(t){this.dataView=t;var e;t&&(e=t.categorical);var r;e&&(r=this.categories=e.categories),this.hasValidCategories=!_.isEmpty(r);var i;if(e&&(i=e.values),this.hasAnyValidValues=!1,null!=i){var n=t.categorical.values.grouped();if(n.length>0){this.hasAnyValidValues=!0,this.grouped=n;for(var o={},a=n[0].values,u=0,s=a.length;s>u;u++){var c=a[u].source.roles;for(var l in c)c[l]&&(o[l]||(o[l]=[]),o[l].push(u))}this.valueRoleIndexMapping=o}}this.hasAnyValidValues&&(this.dataHasDynamicSeries=!!this.dataView.categorical.values.source)}return t.prototype.hasCategories=function(){return this.hasValidCategories},t.prototype.getCategoryCount=function(){return this.hasValidCategories?this.categories[0].values.length:0},t.prototype.getCategoryValues=function(t){if(this.hasValidCategories){var e=this.getCategoryFromRole(t);return e?e.values:void 0}},t.prototype.getCategoryValue=function(t,e){if(this.hasValidCategories){var r=this.getCategoryFromRole(t);return r?r.values[e]:void 0}},t.prototype.getCategoryColumn=function(t){return this.hasValidCategories?this.getCategoryFromRole(t):void 0},t.prototype.getCategoryMetadataColumn=function(t){if(this.hasValidCategories){var e=this.getCategoryFromRole(t);return e?e.source:void 0}},t.prototype.getCategoryColumnIdentityFields=function(t){if(this.hasValidCategories){var e=this.getCategoryFromRole(t);return e?e.identityFields:void 0}},t.prototype.getCategoryDisplayName=function(t){if(this.hasValidCategories){var e=this.getCategoryColumn(t);if(e&&e.source)return e.source.displayName}},t.prototype.hasCompositeCategories=function(){return this.hasValidCategories?this.categories.length>1:void 0},t.prototype.hasCategoryWithRole=function(t){return-1!==i.getCategoryIndexOfRole(this.categories,t)},t.prototype.getCategoryObjects=function(t,e){if(this.hasValidCategories){var r=this.getCategoryFromRole(t);if(r&&r.objects)return r.objects[e]}},t.prototype.getCategoryFromRole=function(t){var e=this.categories;return e[i.getCategoryIndexOfRole(e,t)]},t.prototype.hasValues=function(t){return this.valueRoleIndexMapping&&!_.isEmpty(this.valueRoleIndexMapping[t])},t.prototype.hasHighlights=function(t){return this.hasValues(t)?!_.isEmpty(this.grouped[0].values[this.valueRoleIndexMapping[t][0]].highlights):!1},t.prototype.getValue=function(t,e,r){return void 0===r&&(r=0),this.hasValues(t)?this.dataHasDynamicSeries?this.getValueInternal(t,e,r,0,!1):this.getValueInternal(t,e,0,r,!1):void 0},t.prototype.getHighlight=function(t,e,r){return void 0===r&&(r=0),this.hasValues(t)?this.dataHasDynamicSeries?this.getValueInternal(t,e,r,0,!0):this.getValueInternal(t,e,0,r,!0):void 0},t.prototype.getAllValuesForRole=function(t,e,r){if(void 0===r&&(r=0),this.hasValues(t)){for(var i=[],n=0,o=this.valueRoleIndexMapping[t].length;o>n;n++)i.push(this.getValueInternal(t,e,r,n,!1));return i}},t.prototype.getAllHighlightsForRole=function(t,e,r){if(void 0===r&&(r=0),this.hasValues(t)){for(var i=[],n=0,o=this.valueRoleIndexMapping[t].length;o>n;n++)i.push(this.getValueInternal(t,e,r,n,!0));return i}},t.prototype.getValueInternal=function(t,e,r,i,n){if(this.hasValues(t)){var o=this.valueRoleIndexMapping[t][i],a=this.grouped[r].values[o];return n?a.highlights[e]:a.values[e]}},t.prototype.getFirstNonNullValueForCategory=function(t,e){if(this.hasValues(t)){if(!this.dataHasDynamicSeries)return this.getValue(t,e);for(var r=0,i=this.grouped.length;i>r;r++){var n=this.getValue(t,e,r);if(null!=n)return n}}},t.prototype.getMeasureQueryName=function(t){return this.hasValues(t)?this.grouped[0].values[this.valueRoleIndexMapping[t][0]].source.queryName:void 0},t.prototype.getValueColumn=function(t,e){return void 0===e&&(e=0),this.hasValues(t)?this.dataHasDynamicSeries?this.grouped[e].values[this.valueRoleIndexMapping[t][0]]:this.grouped[0].values[this.valueRoleIndexMapping[t][e]]:void 0},t.prototype.getValueMetadataColumn=function(t,e){void 0===e&&(e=0);var r=this.getValueColumn(t,e);return r?r.source:void 0},t.prototype.getAllValueMetadataColumnsForRole=function(t,e){if(void 0===e&&(e=0),this.hasValues(t)){for(var r=[],i=0,n=this.valueRoleIndexMapping[t].length;n>i;i++){var o=this.grouped[e].values[this.valueRoleIndexMapping[t][i]].source;r.push(o)}return r}},t.prototype.getValueDisplayName=function(t,e){if(this.hasValues(t)){var r=this.getValueColumn(t,e);if(r&&r.source)return r.source.displayName}},t.prototype.hasDynamicSeries=function(){return this.dataHasDynamicSeries},t.prototype.getSeriesCount=function(t){if(this.hasAnyValidValues){if(this.dataHasDynamicSeries)return this.grouped.length;var e=t&&this.valueRoleIndexMapping[t];return e?e.length:1}},t.prototype.getSeriesObjects=function(t){return this.hasAnyValidValues?this.grouped[t].objects:void 0},t.prototype.getSeriesValueColumns=function(){return this.hasAnyValidValues?this.dataView.categorical.values:void 0},t.prototype.getSeriesValueColumnGroup=function(t){return this.hasAnyValidValues?this.grouped[t]:void 0},t.prototype.getSeriesMetadataColumn=function(){return this.hasAnyValidValues?this.dataView.categorical.values.source:void 0},t.prototype.getSeriesColumnIdentityFields=function(){return this.hasAnyValidValues?this.dataView.categorical.values.identityFields:void 0},t.prototype.getSeriesName=function(t){return this.hasAnyValidValues?this.grouped[t].name:void 0},t.prototype.getSeriesDisplayName=function(){return this.hasAnyValidValues&&this.dataHasDynamicSeries?this.dataView.categorical.values.source.displayName:void 0},t.prototype.getStaticObjects=function(){var t=null;return this.dataView.metadata&&this.dataView.metadata.objects&&(t=this.dataView.metadata.objects),t},t}()}(e=t.data||(t.data={}))}(r||(r={}))},367:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,i=t.Prototype.inherit,n=t.Prototype.inheritSingle,o=t.visuals.valueFormatter;!function(r){function a(t,e,r,i,n,o){var a=t,u=t.categorical;if(u){var c=s(u,t.metadata,r,n,o);if(c){var l=v(i,c.roleName,c.categories);if(l.length>=2){var p=_.chain(o[c.roleName]).filter(function(t){return t.suppressConcat}).map(function(t){return t.queryRef}).value();a=f(t,e,c.roleName,l,p)}}}return a}function u(t,e,r,n){var o;if(!_.isEmpty(n.categories)&&n.categories.length>=2){var a=i(t.columns),u=i(t,function(t){t.columns=a}),s={metadata:u,categorical:n};o=f(s,e,r,n.categories,[])}else o={metadata:t,categorical:n};return o}function s(r,i,n,o,a){var u,s=e.DataViewSelectTransform.createRoleKindFromMetadata(o,i),p=e.DataViewSelectTransform.projectionsFromSelects(o,a),f=t.DataViewAnalysis.chooseDataViewMappings(p,n,s).supportedMappings,d=!_.isEmpty(f)&&_.every(f,function(t){return!!t.categorical});if(d){var v=c(f);if(v&&l(v,f)){var h=_.filter(r.categories,function(t){return t.source.roles&&!!t.source.roles[v]});if(h.length>=2){var m=_.every(h,function(t){return t.values.length===h[0].values.length});m&&(u={roleName:v,categories:h})}}}return u}function c(t){var e,r=_.chain(t).map(function(t){var e=p(t.categorical);return 1===e.length?e[0]:void 0}).uniq().value(),i=1===r.length&&!_.isUndefined(r[0]);return i&&(e=r[0]),e}function l(t,e){var r=_.every(e,function(e){return!_.isEmpty(e.conditions)&&_.every(e.conditions,function(e){return e[t]&&1===e[t].max})});return r}function p(e){var r=[];return t.DataViewMapping.visitCategoricalCategories(e.categories,{visitRole:function(t){r.push(t)}}),r}function f(t,r,i,o,a){var u=e.DataViewObjectDescriptors.findFormatString(r),s=d(o,a,u),c=_.map(o,function(t){return t.source}),l=h(i,c,a),p=n(t);m(p,l);var f=g(o,l,s),v=t.categorical,y=_.difference(v.categories,o);y.push(f);var w=n(v);return w.categories=y,p.categorical=w,p}function d(t,e,r){for(var i=[],n=0,a=t;n<a.length;n++)for(var u=a[n],s=o.getFormatString(u.source,r),c=0,l=u.values.length;l>c;c++)if(!_.contains(e,u.source.queryName)){var p=u.values&&u.values[c],f=o.format(p,s);i[c]=void 0===i[c]?f:f+" "+i[c]}return i}function v(t,e,r){var i;if(t){for(var n={},o=0,a=r;o<a.length;o++){var u=a[o];u.source.roles[e]&&(n[u.source.index]=u)}var s=t[e];i=_.chain(s).map(function(t){return n[t]}).filter(function(t){return!!t}).value()}else i=_.filter(r,function(t){return t.source.roles[e]});return i}function h(e,r,i){for(var n,o=0,a=r;o<a.length;o++){var u=a[o];_.contains(i,u.queryName)||(n=null==n?u.displayName:u.displayName+" "+n)}var s={};s[e]=!0;var c={displayName:n,roles:s,type:t.ValueType.fromPrimitiveTypeAndCategory(t.PrimitiveType.Text)},l=_.last(r);return void 0!==l.isMeasure&&(c.isMeasure=l.isMeasure),c.queryName=l.queryName,c}function m(t,e){var r=n(t.metadata.columns);r.push(e);var i=n(t.metadata);i.columns=r,t.metadata=i}function g(t,e,r){var i={source:e,values:r},n=t[0];return n.identity&&(i.identity=n.identity),n.identityFields&&(i.identityFields=n.identityFields),n.objects&&(i.objects=n.objects),i}r.detectAndApply=a,r.applyToPlayChartCategorical=u}(r=e.DataViewConcatenateCategoricalColumns||(e.DataViewConcatenateCategoricalColumns={}))}(e=t.data||(t.data={}))}(r||(r={}))},368:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t,e){var i=t.categorical;i&&r(i,e);var n=t.table;n&&o(n,e);var u=t.matrix;u&&a(u,e);var c=t.tree;c&&s(c,e);var l=t.single;l&&m(l,e)}function r(t,e){i(t.categories,e),n(t.values,e)}function i(t,e){t&&(p(t,e),f(t,e),d(t,e),h(t,e))}function n(t,e){if(t){p(t,e,0),f(t,e,0),d(t,e,0);var r=t;v(r,e);var i=r.group;if(i)for(var n=0,o=i.select;n<o.length;n++){var a=o[n];p(a,e,1),f(a,e,1)}}}function o(t,e){var r=t.rows;p(r,e),f(r,e),d(r,e),h(r,e)}function a(t,e){u(t.rows,e),u(t.columns,e),u(t.values,e)}function u(t,e){t&&(f(t,e),d(t,e),h(t,e))}function s(t,e){c(t.nodes,e),
l(t.values,e)}function c(t,e){t&&(f(t,e),h(t,e))}function l(t,e){t&&f(t,e)}function p(t,e,r){var i=t.bind;i&&(null!=r?e.visitRole(i.to,r):e.visitRole(i.to))}function f(t,e,r){var i=t["for"];i&&(null!=r?e.visitRole(i["in"],r):e.visitRole(i["in"]))}function d(t,e,r){var i=t.select;if(i)for(var n=0,o=i;n<o.length;n++){var a=o[n];p(a,e,r),f(a,e,r)}}function v(t,e){if(t){var r=t.group;r&&(e.visitRole(r.by),h(r,e))}}function h(t,e){if(e.visitReduction){var r=t.dataReductionAlgorithm;r&&e.visitReduction(r)}}function m(t,e){e.visitRole(t.role)}t.visitMapping=e,t.visitCategorical=r,t.visitCategoricalCategories=i,t.visitCategoricalValues=n,t.visitTable=o,t.visitMatrixItems=u,t.visitTreeNodes=c,t.visitTreeValues=l,t.visitGrouped=v}(e=t.DataViewMapping||(t.DataViewMapping={}))}(r||(r={}))},369:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,i=t.Prototype.inheritSingle;!function(e){function r(t){var e=_.filter(t.dataRoles,function(t){return!_.isEmpty(t.requiredTypes)});n(t.dataview,t.dataViewMappings,e)}function n(t,e,r){if(!_.isEmpty(e)&&!_.isEmpty(r)){for(var i=o(t.metadata.columns,r),n=a(t.metadata.columns,r),u={},s=0,d=e;s<d.length;s++){var h=d[s];for(var m in h)null!=t[m]&&(u[m]=!0)}u.categorical&&c(t.categorical,i,n),u.table&&l(t.table,i,n),u.tree&&p(t.tree.root,i,n),u.matrix&&f(t.matrix,i,n),u.single&&v(t,e,r,n)}}function o(t,e){if(!t||!e)return function(){return!1};for(var r={},i=0,n=t;i<n.length;i++){var o=n[i],a=o.roles;if(a)for(var u=0,s=e;u<s.length;u++){var c=s[u];if(a[c.name]){r[o.index]=!0;break}}}return function(t){return isNaN(t)?!1:!!r[t]}}function a(t,e){if(!t||!e)return function(){return!0};for(var r=[],i=0,n=t;i<n.length;i++){var o=n[i],a=u(o,e);a&&(r[o.index]=a)}return function(t,e){return r[t]?r[t](e):!0}}function u(t,e){var r=s(t,e);if(!_.isEmpty(r))return function(t){return m(t,r)}}function s(e,r){var i=[],n=e&&e.roles;if(!n)return i;for(var o=0,a=r;o<a.length;o++){var u=a[o];if(n[u.name])for(var s=0,c=u.requiredTypes;s<c.length;s++){var l=c[s],p=t.ValueType.fromDescriptor(l);i.push(p)}}return i}function c(t,e,r){var i=t&&t.values;if(i){var n=i.grouped();if(n)for(var o=0,a=n;o<a.length;o++)for(var u=a[o],s=u.values,c=0,l=s;c<l.length;c++){var p=l[c],f=p.source.index;if(e(f))for(var d=0,v=p.values.length;v>d;d++)p.values=h(p.values,d,f,r)}}}function l(t,e,r){var i=t&&t.columns;if(i){for(var n=[],o=0,a=i;o<a.length;o++){var u=a[o];e(u.index)&&n.push(u.index)}for(var s=t.rows,c=0,l=s.length;l>c;c++)for(var p=0,f=n;p<f.length;p++){var d=f[p];s[c]=h(s[c],d,d,r)}}}function p(t,e,r){if(t.values)for(var i in t.values)e(i)&&("object"==typeof t.values[i]&&"value"in t.values[i]?t.values[i]=h(t.values[i],"value",i,r):t.values=h(t.values,i,i,r));else if(t.children)for(var n=0,o=t.children;n<o.length;n++){var a=o[n];p(a,e,r)}}function f(t,e,r){var i=t&&t.rows&&t.rows.root;i&&d(t,i,e,r)}function d(t,e,r,i){if(e.values)for(var n in e.values){var o=e.values[n],a=o.valueSourceIndex||0,u=t.valueSources[a].index;_.isNumber(u)&&r(u)&&(e.values[n]=h(o,"value",u,i))}else if(e.children)for(var s=0,c=e.children;s<c.length;s++){var l=c[s];d(t,l,r,i)}}function v(t,e,r,i){if(t.single){for(var n=[],o=0,a=r;o<a.length;o++){var u=a[o];u.name&&n.push(u.name)}for(var s=t.metadata.columns,c=0,l=e;c<l.length;c++){var p=l[c],f=p.single.role;if(-1!==n.indexOf(f)){var d=g(s,f);return void(d&&(t.single=h(t.single,"value",d.index,i)))}}}}function h(t,e,r,n){if(t){var o=t[e];return null===o||n(r,o)||(t=i(t),t[e]=null),t}}function m(t,e){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.numeric||n.integer)return"number"==typeof t}return!1}function g(t,e){for(var r=0,i=t;r<i.length;r++){var n=i[r],o=n&&n.roles;if(o&&o[e])return n}}e.apply=r,e.filterVariantMeasures=n,e.generateMetadataColumnFilter=o,e.generateValueFilter=a,e.getColumnRequiredTypes=s,e.normalizeVariant=h}(r=e.DataViewNormalizeValues||(e.DataViewNormalizeValues={}))}(e=t.data||(t.data={}))}(r||(r={}))},370:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t,e,i){if(!t)return i;var n=t[e.objectName],o=n;return r.getValue(o,e.propertyName,i)}function i(t,e,r){if(t&&t[e]){var i=t[e];return i}return r}function n(t,e){if(t&&t[e]){var r=t[e];return r}}function o(t,r,i){var n=e(t,r);return n&&n.solid?n.solid.color:i}function a(t){return _.isArray(t)}t.getValue=e,t.getObject=i,t.getUserDefinedObjects=n,t.getFillColor=o,t.isUserDefined=a}(e=t.DataViewObjects||(t.DataViewObjects={}));var r;!function(t){function e(t,e,r){if(!t)return r;var i=t[e];return void 0===i?r:i}function r(e,r,i){var n=t.getValue(e,r);return n&&n.solid?n.solid.color:i}t.getValue=e,t.getFillColorByPropertyName=r}(r=t.DataViewObject||(t.DataViewObject={}))}(r||(r={}))},371:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e,r=i.JsonComparer;!function(e){function i(e,r,i){var n=e[r];n||(e[r]=n=[]);for(var o=0,a=n.length;a>o;o++){var u=n[o];if(t.Selector.equals(u.selector,i))return u}var s={selector:i,properties:{}};return n.push(s),s}function o(t,e,r,i){var o=c(t,e,r);o&&n.deleteSingleProperty(o,i)}function a(t,e,r,n){i(t,e.objectName,r).properties[e.propertyName]=n}function u(t,e,r){var i=s(t,e,r);if(i)return i[e.propertyName]}function s(t,e,r){var i=c(t,e.objectName,r);if(i)return i.properties}function c(e,r,i){if(e){var n=e[r];if(n)for(var o=0,a=n.length;a>o;o++){var u=n[o];if(t.Selector.equals(u.selector,i))return u}}}function l(e,i){return e instanceof t.SemanticFilter&&i instanceof t.SemanticFilter?t.SemanticFilter.isSameFilter(e,i):r.equals(e,i)}function p(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!l(t[r],e[r]))return!1;return!0}function f(e,r){if(r.bool)return"boolean"!=typeof e&&(e=!1),t.SQExprBuilder["boolean"](e);if(r.text||r.scripting&&r.scripting.source)return t.SQExprBuilder.text(e);if(r.numeric){if($.isNumeric(e))return t.SQExprBuilder["double"](+e)}else if(r.fill){if(e)return{solid:{color:t.SQExprBuilder.text(e)}}}else{if(r.formatting)return r.formatting.labelDisplayUnits?t.SQExprBuilder["double"](+e):t.SQExprBuilder.text(e);if(r.enumeration)return $.isNumeric(e)?t.SQExprBuilder["double"](+e):t.SQExprBuilder.text(e);if(r.misc)e=e?t.SQExprBuilder.text(e):null;else if(r.image&&e){var i=e,n={name:t.SQExprBuilder.text(i.name),url:t.SQExprBuilder.text(i.url)};return i.scaling&&(n.scaling=t.SQExprBuilder.text(i.scaling)),n}}return e}function d(t){var e={};for(var r in t){var i=t[r];if(!_.isEmpty(i)){for(var n=[],o=0,a=i;o<a.length;o++){var u=a[o];n.push({properties:v(u.properties),selector:u.selector})}e[r]=n}}return e}function v(t){return _.clone(t)}e.ensure=i,e.deleteProperty=o,e.setValue=a,e.getValue=u,e.getPropertyContainer=s,e.getObjectDefinition=c,e.propertiesAreEqual=l,e.allPropertiesAreEqual=p,e.encodePropertyValue=f,e.clone=d}(e=t.DataViewObjectDefinitions||(t.DataViewObjectDefinitions={}));var n;!function(t){function e(t,e){delete t.properties[e]}t.deleteSingleProperty=e}(n=t.DataViewObjectDefinition||(t.DataViewObjectDefinition={}))}(e=t.data||(t.data={}))}(r||(r={}))},372:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(e){function r(e){return s(e,function(e){var r=t.ValueType.fromDescriptor(e.type).formatting;return r&&r.formatString})}function i(t){return s(t,function(t){var e=t.type;return e&&e.filter&&!e.filter.selfFilter})}function n(t){return s(t,o)}function o(t){var e=t&&t.type;return e&&e.filter&&e.filter.selfFilter}function a(t){return s(t,function(t){var e=t.type;return e&&e.operations&&e.operations.searchEnabled})}function u(t){return s(t,function(t){var e=t.type;return e&&!!e.expression&&e.expression.defaultValue})}function s(t,e){if(t)for(var r in t){var i=t[r].properties;for(var n in i)if(e(i[n]))return{objectName:r,propertyName:n}}}e.findFormatString=r,e.findFilterOutput=i,e.findSelfFilter=n,e.isSelfFilter=o,e.findSelfFilterEnabled=a,e.findDefaultValue=u}(r=e.DataViewObjectDescriptors||(e.DataViewObjectDescriptors={}))}(e=t.data||(t.data={}))}(r||(r={}))},373:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(e){function r(e,r,i){for(var n,o=0,a=i.length;a>o;o++){var u=i[o],s=u.name,c=t.DataViewObjectEvaluator.run(e,r[s],u.properties);c&&(n||(n={}),n[s]=c)}return n}function i(t){var e={data:[]};if(t)for(var r in t)for(var i=t[r],o=0,a=i.length;a>o;o++){var u=i[o];n(e,u.selector).objects.push({name:r,properties:u.properties})}return e}function n(e,r){if(!r)return e.metadataOnce||(e.metadataOnce={objects:[]}),e.metadataOnce;var i;r.data?i=e.data:r.metadata?(e.metadata||(e.metadata=[]),i=e.metadata):r.id&&(e.userDefined||(e.userDefined=[]),i=e.userDefined);for(var n=0,o=i;n<o.length;n++){var a=o[n];if(t.Selector.equals(r,a.selector))return a}var u={selector:r,objects:[]};return i.push(u),u}function o(t,e,r,i){i&&(a(t,e,r,i),u(t,e,r,i))}function a(e,r,i,n){var o=t.DataViewObjectDescriptors.findFormatString(r);if(o)for(var a=0,u=n.length;u>a;a++){var l=n[a];l&&c(e,o,l.queryName,l.format||s(i,a))}}function u(e,r,i,n){var o=t.DataViewObjectDescriptors.findDefaultValue(r);if(o)for(var a=0,u=n;a<u.length;a++){var s=u[a];s&&l(e,o,s.queryName,s.defaultValue)}}function s(t,e){for(var r=0,i=t.length;i>r;r++){var n=t[r];if(n&&n.index===e)return n.format}}function c(e,r,i,n){n&&p(e,r,{metadata:i},t.SQExprBuilder.text(n))}function l(t,e,r,i){i&&p(t,e,{metadata:r},i)}function p(t,e,r,i){var n;if(r){var o=t.metadata;o||(o=t.metadata=[]),n=o}else{var a=t.metadataOnce;a||(a=t.metadataOnce={selector:r,objects:[]}),n=[a]}var u,s=f(n,r);if(s){var c=s.objects;if(u=d(c,e.objectName)){if(u.properties[e.propertyName])return}else u={name:e.objectName,properties:{}},c.push(u)}else u={name:e.objectName,properties:{}},n.push({selector:r,objects:[u]});u.properties[e.propertyName]=i}function f(e,r){for(var i=0,n=e.length;n>i;i++){var o=e[i];if(t.Selector.equals(o.selector,r))return o}}function d(t,e){for(var r=0,i=t.length;i>r;r++){var n=t[r];if(n.name===e)return n}}e.evaluateDataViewObjects=r,e.groupObjectsBySelector=i,e.addImplicitObjects=o}(e=t.DataViewObjectEvaluationUtils||(t.DataViewObjectEvaluationUtils={}))}(e=t.data||(t.data={}))}(r||(r={}))},374:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(e){var r;!function(r){function n(t,e,r){if(e){var i,n=e.properties;for(var a in r){var u=r[a],s=n[a];if(s){var c=o(t,s,u);void 0!==c&&(i||(i={}),i[a]=c)}}return i}}function o(r,i,n){var o=i.type;if(o&&o.expression)return n;var s=v(r,n,t.ValueType.fromDescriptor(i.type));return void 0!==s||n instanceof e.RuleEvaluation?s:a(r,n,o)||u(r,n,o)||c(r,n,o)||l(r,n,o)||n}function a(e,r,i){var n=i.fill;if(n)return n&&n.solid&&n.solid.color&&r.solid?{solid:{color:v(e,r.solid.color,t.ValueType.fromExtendedType(t.ExtendedType.Color))}}:void 0}function u(t,e,r){if(r.fillRule){if(e.linearGradient2){var i=e.linearGradient2;return{linearGradient2:{min:s(t,i.min),max:s(t,i.max)}}}if(e.linearGradient3){var n=e.linearGradient3;return{linearGradient3:{min:s(t,n.min),mid:s(t,n.mid),max:s(t,n.max)}}}}}function s(t,e){var r={color:v(t,e.color,h)},i=v(t,e.value,m);return null!=i&&(r.value=i),r}function c(e,r,i){if(i.image&&r){var n={name:v(e,r.name,g),url:v(e,r.url,t.ValueType.fromDescriptor(t.ImageDefinition.urlType))};return r.scaling&&(n.scaling=v(e,r.scaling,g)),n}}function l(t,e,r){return r.paragraphs&&e?d(t,e,p):void 0}function p(t,e){var r,i=e.textRuns,n=d(t,i,f);return i!==n&&(r=_.clone(e),r.textRuns=n),r||e}function f(t,e){var r,i=e.value,n=v(t,i,g);return void 0!==n&&(r=_.clone(e),r.value=n),r||e}function d(t,e,r){for(var i,n=0,o=e.length;o>n;n++){var a=e[n],u=r(t,a);i||a===u||(i=_.take(e,n)),i&&i.push(u)}return i||e}function v(t,r,i){return r instanceof e.SQExpr?y.evaluate(r,t):r instanceof e.RuleEvaluation?r.evaluate(t):void 0}var h=t.ValueType.fromDescriptor({formatting:{color:!0}}),m=t.ValueType.fromDescriptor({numeric:!0}),g=t.ValueType.fromDescriptor({text:!0});r.run=n,r.evaluateProperty=o,r.evaluateValue=v;var y=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.evaluate=function(t,r){return null!=t?t.accept(e.instance,r):void 0},e.prototype.visitColumnRef=function(t,e){return e.getExprValue(t)},e.prototype.visitConstant=function(t,e){return t.value},e.prototype.visitMeasureRef=function(t,e){return e.getExprValue(t)},e.prototype.visitAggr=function(t,e){return e.getExprValue(t)},e.prototype.visitFillRule=function(t,e){var r=t.input.accept(this,e);if(void 0!==r){var i=e.getColorAllocator(t);if(i)return i.color(r)}},e.prototype.visitSelectRef=function(t,e){return e.getExprValue(t)},e.instance=new e,e}(e.DefaultSQExprVisitorWithArg)}(r=e.DataViewObjectEvaluator||(e.DataViewObjectEvaluator={}))}(e=t.data||(t.data={}))}(r||(r={}))},375:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,i=t.Prototype.inheritSingle;!function(t){function e(t){var e=t.values;if(e){var r,n=!!e.source;if(n){r=i(e.grouped());for(var o=0,a=void 0,u=0,s=e.length;s>u;u++){var c=e[u];if(!a||c.identity!==a.identity){var l=r[o];a=l?i(l):l=r[o]={values:null},r[o]=a,a.values=[],o++}a.values.push(c)}}else r=[{values:e}];e.grouped=function(){return r},t.values=e}}t.apply=e}(r=e.DataViewCategoricalEvalGrouped||(e.DataViewCategoricalEvalGrouped={}))}(e=t.data||(t.data={}))}(r||(r={}))},376:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,i=t.Prototype.inherit;!function(t){function r(t){var r=t.categorical;if(!r)return null;var n=r.categories;if(!n||1!==n.length)return null;var o=r.values;if(_.isEmpty(o)||o.source)return null;for(var a=n[0],u=a.identity,s=a.values,c=[],l=[],p=0,f=s.length;f>p;p++)for(var d=s[p],v=u[p],h=0,m=o.length;m>h;h++){var g=o[h],y=i(g.source);if(g.identity)return null;y.groupName=d;var w={source:y,values:[g.values[p]],identity:v,min:g.min,max:g.max,subtotal:g.subtotal},x=g.highlights;x&&(w.highlights=[x[p]]),c.push(y),l.push(w)}var b=i(t.metadata);return b.columns=c,o=e.DataViewTransform.createValueColumns(l,a.identityFields,a.source),{metadata:b,categorical:{values:o},matrix:t.matrix}}t.apply=r}(r=e.DataViewPivotCategorical||(e.DataViewPivotCategorical={}))}(e=t.data||(t.data={}))}(r||(r={}))},377:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(e){function r(e,r){r.columnHierarchyRewritten||(e.columns=t.Prototype.inherit(e.columns));var a=e.columns;r.rowHierarchyRewritten||(e.rows=t.Prototype.inherit(e.rows));var u=e.rows;if(!(a.levels.length>1)){var s={level:0},c=a.root.children,l=c.length,p=u.levels.length;if(l>0){var f=0,d=function(t){if(t.values){s.values||(s.values={});for(var e=0;l>e;e++)s.values[f++]=t.values[e];delete t.values}if(l>1){t.children||(t.children=[]);for(var r=0;l>r;r++){var i={level:p},n=c[r];i.levelSourceIndex=n.levelSourceIndex,t.isSubtotal&&(i.isSubtotal=!0),t.children.push(i)}}};r.hierarchyTreesRewritten?i(u.root,d):e.columns.root=o(u.root,d)}else r.hierarchyTreesRewritten||(e.columns.root=n(u.root));if(l>1){var v={sources:a.levels[0].sources};u.levels.push(v),a.levels.length=0}if(r.hierarchyTreesRewritten)e.columns.root=u.root,e.rows.root={children:[s]};else{var h=t.Prototype.inherit(e.rows.root);h.children=[s],e.rows.root=h}e.columns.levels=u.levels,e.rows.levels=[]}}function i(t,e){var r=t.children;if(r&&r.length>0)for(var n=0,o=r.length;o>n;n++)i(r[n],e);else e(t)}function n(t){return o(t)}function o(e,r){var i=t.Prototype.inherit(e),n=e.children;if(n&&n.length>0){for(var a=[],u=0,s=n.length;s>u;u++){var c=o(n[u],r);a.push(c)}i.children=a}else r&&r(i);return i}e.apply=r,e.cloneTree=n,e.cloneTreeExecuteOnLeaf=o}(r=e.DataViewPivotMatrix||(e.DataViewPivotMatrix={}))}(e=t.data||(t.data={}))}(r||(r={}))},378:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(t){for(var e=new Array(t),r=0;t>r;r++)e[r]=null;return e}function i(e,r,i){var n=t.Prototype.inherit(e);return n[i]=r[i],n}var n;!function(n){function o(t){if(t.categorical){var e=t.categorical;if(e.categories&&1===e.categories.length&&(!e.values||!e.values.source))return a(t.metadata,e)}}function a(r,i){var n=i.categories[0],o=n.values,a=o.length;if(0!==a){var s=i.values?i.values.grouped()[0].values:[],c=e.createCategoricalDataViewBuilder().withCategories(i.categories).withGroupedValues(u(n,o,a,s)).build();return r=t.Prototype.inherit(r),r.columns=c.metadata.columns,{metadata:r,categorical:c.categorical}}}function u(t,e,n,o){for(var a=r(n),u=o.length,s=[],c=0;n>c;c++){for(var l=[],p=0;u>p;p++){var f=o[p],d=f.highlights,v={values:i(a,f.values,c)};d&&(v.highlights=i(a,d,c)),l.push(v)}s.push(l)}return{groupColumn:{source:t.source,identityFrom:{fields:t.identityFields,identities:t.identity},values:t.values},valueColumns:_.map(o,function(t){return{source:t.source}}),data:s}}n.apply=o}(n=e.DataViewSelfCrossJoin||(e.DataViewSelfCrossJoin={}))}(e=t.data||(t.data={}))}(r||(r={}))},379:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,n=i.ArrayExtensions,o=t.data.DataShapeBindingDataReduction,a=t.Prototype.inheritSingle;!function(r){function i(t,e,r,i){e&&1===e.length&&r.categorical&&r.categorical.dataReductionAlgorithm&&t&&s(t,r)&&(t.Primary.Groupings=[t.Secondary.Groupings[0],t.Primary.Groupings[0]],t.Secondary=void 0,t.DataReduction={Primary:o.createFrom(r.categorical.dataReductionAlgorithm),DataVolume:r.categorical.dataVolume||i})}function u(t){return t&&t.Groupings&&1===t.Groupings.length&&!_.isEmpty(t.Groupings[0].Projections)&&!t.Groupings[0].Subtotal&&_.isEmpty(t.Groupings[0].SuppressedProjections)}function s(t,e){return u(t.Primary)&&u(t.Secondary)&&1===t.Secondary.Groupings[0].Projections.length?!t.DataReduction||!t.DataReduction.Primary&&!t.DataReduction.Secondary:!1}function c(t,r,i,o){if(!l(r,i,t,o))return t;var a={metadata:{columns:n.copy(t.metadata.columns)}};if(t.single&&(a.single=t.single),t.table&&(a.table=t.table),t.matrix){var u=p(t.matrix);if(!_.isEmpty(u.valueSources)){var s=e.utils.DataViewMatrixUtils.containsCompositeGroup(u.columns);s||(a.categorical=f(u,a.metadata.columns))}}return a}function l(r,i,n,o){if(_.isEmpty(r)||_.isEmpty(i)||!n)return!1;var a=e.DataViewSelectTransform.createRoleKindFromMetadata(r,n.metadata),u=e.DataViewSelectTransform.projectionsFromSelects(r,o),s=t.DataViewAnalysis.chooseDataViewMappings(u,i,a).supportedMappings;if(!s||1!==s.length)return!1;var c=s[0].categorical;if(!c)return!1;var l=n.matrix;if(!l)return!1;if(!l.rows||!l.rows.levels||2!==l.rows.levels.length)return!1;var p=[],f=[],d=function(e,r){var i=u[e];if(i)for(var n=0,o=i.all();n<o.length;n++){var s=o[n];a[s.queryRef]===t.VisualDataRoleKind.Grouping&&r.push(s.queryRef)}};if(t.DataViewMapping.visitCategoricalCategories(c.categories,{visitRole:function(t){d(t,p)}}),t.DataViewMapping.visitCategoricalValues(c.values,{visitRole:function(t){d(t,f)}}),_.isEmpty(p)||_.isEmpty(f))return!1;for(var v=0,h=l.columns.levels;v<h.length;v++)for(var m=h[v],g=0,y=m.sources;g<y.length;g++){var w=y[g];if(!w.isMeasure)return!1}return!0}function p(t){var e=t.rows,r=e.root,i=r.children,n=[],o=e.levels[0],u=r.childIdentityFields,s={},c=[],l=e.levels[1],p=_.isEmpty(i)?void 0:i[0].childIdentityFields,f=t.valueSources.length,d=function(t){var e=s[t.key];return e};if(i)for(var v=function(t){var e=t.identity.key,r=s[e];void 0===r&&(r=c.length,s[e]=r,c.push(t))},h=0,m=i;h<m.length;h++){var g=m[h];n.push(g);for(var y=0,w=g.children;y<w.length;y++){var x=w[y];v(x)}}for(var b=new Array(c.length),S=0;S<n.length;++S)for(var g=i[S],E=0,D=g.children;E<D.length;E++){var x=D[E],C=d(x.identity);b[C]||(b[C]=new Array(n.length)),b[C][S]=x.values}var T={root:{children:_.map(n,function(t){var e=a(t);return e.level=0,e.children=void 0,e.childIdentityFields=void 0,e}),childIdentityFields:u},levels:[o]};if(f>0){for(var V=_.map(t.columns.root.children,function(t){var e={level:1};return t.levelSourceIndex&&(e.levelSourceIndex=t.levelSourceIndex),e}),C=0;C<T.root.children.length;++C)T.root.children[C].children=V;T.levels.push(t.columns.levels[0])}var M={root:{children:_.map(c,function(t){var e=a(t);return e.level=0,e.children=void 0,e.childIdentityFields=void 0,e}),childIdentityFields:p},levels:[l]};if(f>0)for(var C=0;C<c.length;++C){for(var F=M.root.children[C],R={},S=0;S<n.length;++S)for(var P=b[C]&&b[C][S],I=0;f>I;++I){var A=S*f+I;R[A]=P?P[I]:0===I?{value:null}:{value:null,valueSourceIndex:I}}F.values=R}var j={rows:M,columns:T,valueSources:t.valueSources};return j}function f(t,e){for(var r=t.columns.root.children.length,i=t.valueSources,n=i.length,o=d(t),a=[],u=0;r>u;++u){var s=t.columns.root.children[u],c={values:[],identity:s.identity,name:s.value||null};a.push(c);for(var l=0;n>l;++l){var p=i[l],f={};for(var v in p)f[v]=p[v];f.groupName=c.name,e.push(f);var h={source:f,values:[],identity:c.identity};c.values.push(h);for(var m=l+u*n,g=0,y=t.rows.root.children;g<y.length;g++){var w=y[g],x=w.values[m].value;h.values.push(x)}}}for(var b=[],S=0,E=a;S<E.length;S++)for(var c=E[S],l=0;n>l;++l)b.push(c.values[l]);b.grouped=function(){return a},b.identityFields=t.columns.root.childIdentityFields,b.source=t.columns.levels[0].sources[0];var D={categories:o,values:b};return D}function d(t){for(var e=_.map(t.rows.root.children,function(t){return t.identity}),r=t.rows.root.childIdentityFields,i=t.rows.levels[0].sources,n=[],o=0,a=i.length;a>o;o++){var u=_.map(t.rows.root.children,function(t){var e=t.levelValues;return void 0!==e?e[o].value:void 0});n.push({source:i[o],values:u,identity:e,identityFields:r})}return n}r.pivotBinding=i,r.unpivotResult=c}(r=e.DataViewPivotCategoricalToPrimaryGroups||(e.DataViewPivotCategoricalToPrimaryGroups={}))}(e=t.data||(t.data={}))}(r||(r={}))},380:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e,r=i.EnumExtensions;!function(e){function i(t,e,i){i&&t.categorical&&r.hasFlag(e,1)&&n(t.categorical,i)}function n(e,r){var i=e.values;if(i){var n=void 0;i.source&&(r[i.source.index]||(i.source=void 0,n=!0));for(var o=i.length-1;o>=0;o--)r[i[o].source.index]||(i.splice(o,1),n=!0);if(n){var a=!!i.source,u=i.length>0;a||u?t.DataViewCategoricalEvalGrouped.apply(e):e.values=void 0}}}e.apply=i}(e=t.DataViewRemoveSelects||(t.DataViewRemoveSelects={}))}(e=t.data||(t.data={}))}(r||(r={}))},381:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r,n=t.Prototype.inherit,o=t.Prototype.inheritSingle,a=i.ArrayExtensions,u=i.EnumExtensions;!function(r){function i(t){var r=t.prototype,i=t.objectDescriptors,n=t.dataViewMappings,o=t.transforms,a=o&&o.roles&&o.roles.activeItems,u=t.colorAllocatorFactory,l=t.dataRoles;if(!r)return c(i,o,u);if(!o)return[r];r=e.DataViewPivotCategoricalToPrimaryGroups.unpivotResult(r,o.selects,n,a);var p=s(r,o,i,n,u,l);return p=e.DataViewRegression.run({dataViewMappings:n,visualDataViews:p,dataRoles:l,objectDescriptors:i,objectDefinitions:o.objects,colorAllocatorFactory:u,transformSelects:o.selects,metadata:r.metadata,projectionActiveItems:a})}function s(t,e,r,i,n,o){var a=[],u=e.splits;if(_.isEmpty(u))a.push(l(t,r,i,e,n,o));else for(var s=0,c=u;s<c.length;s++){var p=c[s],f=l(t,r,i,e,n,o,p.selects);a.push(f)}return a}function c(t,e,r){if(e&&e.objects){var i={metadata:{columns:[]}};return N(i,0,t,e.objects,e.selects,r),[i]}return[]}function l(t,r,i,o,a,u,s){var c=p(i),l=n(t);l.metadata=n(t.metadata);var d=o.roles&&o.roles.ordering,v=o.roles&&o.roles.activeItems;return l=f(l,c,i,o.selects,d),N(l,c,r,o.objects,o.selects,a),e.DataViewRemoveSelects.apply(l,c,s),l=e.DataViewConcatenateCategoricalColumns.detectAndApply(l,r,i,d,o.selects,v),e.DataViewNormalizeValues.apply({dataview:l,dataViewMappings:i,dataRoles:u}),l}function p(t){if(!t)return 0;for(var e=0,r=0,i=t;r<i.length;r++){var n=i[r];n.categorical&&(e|=1),n.matrix&&(e|=2),n.single&&(e|=4),n.table&&(e|=8),n.tree&&(e|=16)}return e}function f(t,r,i,n,o){var a=[];if(n&&(t.metadata.columns=d(t.metadata.columns,n,a),h(t,n)),t.categorical&&u.hasFlag(r,1)&&(t.categorical=w(t.categorical,a),t=ft(t,i)),t.matrix&&u.hasFlag(r,2)){var s={rowHierarchyRewritten:!1,columnHierarchyRewritten:!1,hierarchyTreesRewritten:!1};t.matrix=S(t.matrix,a,i,o,s),vt(t.matrix,i)&&e.DataViewPivotMatrix.apply(t.matrix,s)}return t.table&&u.hasFlag(r,8)&&(t.table=x(t.table,a,o)),t}function d(t,e,r){if(!e)return t;for(var i=n(t),o=0,a=t.length;a>o;o++){var u=t[o],s=e[u.index];if(s){var c=i[o]=v(u,s);r.push({from:u,to:c})}}return i}function v(t,e){var r=n(t);return e.roles&&(r.roles=e.roles),e.type&&(r.type=e.type),r.format=y(e,r),e.displayName&&(r.displayName=e.displayName),e.queryName&&(r.queryName=e.queryName),e.expr&&(r.expr=e.expr),e.kpi&&(r.kpi=e.kpi),e.sort&&(r.sort=e.sort),e.discourageAggregationAcrossGroups&&(r.discourageAggregationAcrossGroups=e.discourageAggregationAcrossGroups),r}function h(r,i){if(i)for(var n,o=r.metadata.columns,a=0,u=i.length;u>a;a++){var s=i[a],c=s&&s.aggregateSources;if(c){n||(n=e.createStaticEvalContext(e.createColorAllocatorCache(),r,i));var l=m(o,a,s),p=l.aggregates={},f=t.ValueType.fromDescriptor(l.type),d=g(n,i,f,c.min);void 0!==d&&(p.min=d),d=g(n,i,f,c.max),void 0!==d&&(p.max=d)}}}function m(t,e,r){for(var i=0,n=t;i<n.length;i++){var o=n[i];if(o.index===e&&void 0===o.groupName)return o}var a=v({displayName:r.displayName},r);return t.push(a),a}function g(t,r,i,n){var o=r[n.index];return o?e.DataViewObjectEvaluator.evaluateValue(t,o.expr,i):void 0}function y(t,e){return t.format||e.format}function w(r,i){function o(t){var e=A(t.source,i);if(e){var r=n(t);return r.source=e,r}}var a=n(r),u=t.Prototype.overrideArray(r.categories,o);u&&(a.categories=u);var s=t.Prototype.overrideArray(r.values,o);if(s&&(a.values=s,s.source)){var c=A(s.source,i);c&&(s.source=c)}return e.DataViewCategoricalEvalGrouped.apply(a),a}function x(e,r,i){var o=n(e),a=function(t){return A(t,r)},u=t.Prototype.overrideArray(e.columns,a);if(u&&(o.columns=u),!i)return o;var s=b(i,r);if(!s)return o;for(var c=u.slice(0),l=Object.keys(s),p=0,f=l.length;f>p;p++){var d=c[s[l[p]]];p===u.length?u.push(d):u[p]=d}var v=t.Prototype.overrideArray(o.rows,function(t){for(var e=[],r=0,i=l.length;i>r;++r)e[r]=t[s[l[r]]];return e});return v&&(o.rows=v),o}function b(t,e){var r=Object.keys(t);if(1===r.length){var i=r[0],n=_.map(e,function(t){return t.from.index}),o=t[i];return R(n,o)}}function S(r,i,o,a,u){function s(t){return A(t,i)}function c(e){var r=null,i=t.Prototype.overrideArray(e.levels,function(e){var r=null,i=t.Prototype.overrideArray(e.sources,s);return i&&(r=j(r,e,function(t){return t.sources=i})),r});return i&&(r=j(r,e,function(t){return t.levels=i})),r}var l=_.find(o,function(t){return!!t.matrix}),p=l.matrix,f=n(r),d=c(f.rows);d&&(f.rows=d,u.rowHierarchyRewritten=!0);var v=c(f.columns);v&&(f.columns=v,u.columnHierarchyRewritten=!0);var h=t.Prototype.overrideArray(f.valueSources,s);if(h){f.valueSources=h;var m=p.values;if(a&&h.length>1&&m&&m["for"]){var g=v.levels.length;if(g>0){var y=F(m,a,h,i);if(y){var w=Object.keys(y),x=w.length;v.root=e.DataViewPivotMatrix.cloneTree(v.root),1===g?E(v.root,y):I(v.root,g-2,function(t){return E(t,y)}),f.rows.root=e.DataViewPivotMatrix.cloneTreeExecuteOnLeaf(f.rows.root,function(t){if(t.values){for(var e={},r=Object.keys(t.values).length/x,i=0,n=r;n>i;i++)for(var o=i*x,a=0;x>a;a++)e[o+a]=t.values[o+y[w[a]]];t.values=e}}),u.hierarchyTreesRewritten=!0}}}}return D(f,p,a),f}function E(t,e){for(var r=Object.keys(e),i=r.length,n=t.children,o=n.slice(0),a=0,u=i;u>a;a++){var s=o[e[r[a]]];a===n.length?n.push(s):n[a]=s}}function D(e,r,i){var n;if(e&&r&&i){var a;t.DataViewMapping.visitMatrixItems(r.rows,{visitRole:function(t,r){a=C(a||e.rows,t,i)}});var u;t.DataViewMapping.visitMatrixItems(r.columns,{visitRole:function(t,r){u=C(u||e.columns,t,i)}}),(a||u)&&(n=o(e),n.rows=a||n.rows,n.columns=u||n.columns)}return n}function C(t,r,i){var n,a=i[r],u=a&&a.length>=2;if(u&&!_.isEmpty(t.levels))for(var s=t.levels.length-1;s>=0;s--){var c=t.levels[s],l=T(c,r,i);if(l){_.isUndefined(n)&&(n=o(t),n.levels=o(t.levels),n.root=e.utils.DataViewMatrixUtils.inheritMatrixNodeHierarchy(t.root,s,!0));var p=o(t.levels[s]);n.levels[s]=V(p,l),M(n.root,s,l)}}return n}function T(t,r,i){var n,o=t.sources;if(o&&o.length>=2){var a=e.utils.DataViewMetadataColumnUtils.joinMetadataColumnsAndProjectionOrder(o,i,r);if(a&&a.length>=2){var u=_.sortBy(a,function(t){return t.projectionOrderIndex});n=R(_.map(a,function(t){return t.sourceIndex}),_.map(u,function(t){return t.sourceIndex}))}}return n}function V(t,e){var r=t.sources;t.sources=r.slice(0);for(var i=Object.keys(e),n=0,o=i.length;o>n;n++){var a=i[n],u=e[a];t.sources[a]=r[u]}return t}function M(t,e,r){var i=P(r);return I(t,e,function(t){var e=t.levelValues;if(!_.isEmpty(e)){for(var r=_.sortBy(e,function(t){return i[t.levelSourceIndex]}),n=0,a=r.length;a>n;n++){var u=o(r[n]);u.levelSourceIndex=i[u.levelSourceIndex],r[n]=u}t.levelValues=r;var s=_.last(r);t.value!==s.value&&(t.value=s.value),(t.levelSourceIndex||0)!==s.levelSourceIndex&&(t.levelSourceIndex=s.levelSourceIndex)}}),t}function F(t,e,r,i){var n=t["for"]["in"],o=e[n],a=_.chain(i).filter(function(t){return _.contains(r,t.to)}).map(function(t){return t.from.index}).value();return R(a,o)}function R(t,e){if(!a.sequenceEqual(t,e,function(t,e){return t===e})){for(var r={},i=0,n=e.length;n>i;++i){var o=e[i];r[i]=t.indexOf(o)}return r}}function P(t){var e={};for(var r in t){var i=t[r],n=parseInt(r,10);e[i]=n}return e}function I(t,e,r){if(t.level===e)return void r(t);var i=t.children;if(i&&i.length>0)for(var n=0,o=i.length;o>n;n++)I(i[n],e,r)}function A(t,e){for(var r=0,i=e.length;i>r;r++){var n=e[r];if(n.from===t)return n.to}}function j(t,e,r){return t||(t=n(e)),r&&r(t),t}function N(t,r,i,n,o,a){if(i){var u=e.DataViewObjectEvaluationUtils.groupObjectsBySelector(n);e.DataViewObjectEvaluationUtils.addImplicitObjects(u,i,t.metadata.columns,o);var s=u.metadataOnce,c=u.data;s&&Q(t,o,i,s.objects,c,a);var l=u.metadata;if(l)for(var p=0,f=l.length;f>p;p++){var d=l[p],v=d.objects,h=B(t,o,v,a);nt(t,o,i,d.selector,v,h)}for(var p=0,f=c.length;f>p;p++){var m=c[p],v=m.objects,h=B(t,o,v,a);G(t,r,o,i,m.selector,m.rules,v,h)}var g=u.userDefined;g&&O(t,o,i,g,a)}}function O(t,r,i,n,o){var a=t.metadata.objects;a||(a=t.metadata.objects={});for(var u=0,s=n;u<s.length;u++){var c=s[u],l=c.selector.id,p=B(t,r,c.objects,o),f=e.createStaticEvalContext(p,t,r),d=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(f,i,c.objects);for(var v in d){var h=d[v],m=a[v];m||(m=a[v]=[]),m.push({id:l,object:h})}}}function Q(t,r,i,n,o,a){var u=B(t,r,n,a),s=e.createStaticEvalContext(u,t,r),c=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(s,i,n);if(c){t.metadata.objects=c;for(var l in c){var p=c[l],f=i[l];for(var d in p){var v=f.properties[d],h=v.rule;if(h){var m=U(t,a,h,l,p[d],v.type);m&&o.push(m);
}}}}}function U(t,e,r,i,n,o){var a=r.output;if(a){var u=at(t,a.selector);if(u)return o.fillRule?L(t,e,r,u,i,n):void 0}}function L(t,r,i,n,o,a){var u=q(t,r,i.inputRole,1,a);if(u){var s=new e.ColorRuleEvaluation(i.inputRole,u),c={};return c[i.output.property]={solid:{color:s}},{selector:n,rules:[s],objects:[{name:o,properties:c}]}}}function q(t,e,r,i,n){return n.linearGradient2?k(t,e,r,i,n,n.linearGradient2):n.linearGradient3?H(t,e,r,i,n,n.linearGradient3):void 0}function k(t,e,r,i,n,o){if(o=n.linearGradient2,void 0===o.min.value||void 0===o.max.value){var a=st(t,r,i);if(!a)return;void 0===o.min.value&&(o.min.value=a.min),void 0===o.max.value&&(o.max.value=a.max)}return e.linearGradient2(n.linearGradient2)}function H(t,e,r,i,n,o){var a;if(o=n.linearGradient3,void 0===o.min.value||void 0===o.mid.value||void 0===o.max.value){var u=st(t,r,i);if(!u)return;if(a=void 0===o.min.value&&void 0===o.max.value&&void 0!==o.mid.value,void 0===o.min.value&&(o.min.value=u.min),void 0===o.max.value&&(o.max.value=u.max),void 0===o.mid.value){var s=(o.max.value+o.min.value)/2;o.mid.value=s}}return e.linearGradient3(n.linearGradient3,a)}function B(t,r,i,n){for(var o=e.createColorAllocatorCache(),a=e.createStaticEvalContext(),u=0,s=i.length;s>u;u++){var c=i[u].properties;for(var l in c){var p=c[l];if(p&&p.solid&&p.solid.color&&23===p.solid.color.kind){var f=p.solid.color,d=ut(r,f.input);if(!d)continue;var v=e.DataViewObjectEvaluator.evaluateProperty(a,yt,f.rule),h=q(t,n,d,0,v);h&&o.register(f,h)}}}return o}function G(t,r,i,n,o,a,s,c){var l=e.Selector.containsWildcard(o),p=t.categorical;p&&u.hasFlag(r,1)&&(z(p,i,n,o,a,l,s,c),X(p,i,n,o,a,l,s,c));var f=t.matrix;if(f&&u.hasFlag(r,2)){var d=Z(f,n,o,a,l,s,c);d&&(t.matrix=d)}var v=t.table;if(v&&u.hasFlag(r,8)){var h=W(v,o),m=rt(v,i,n,h,a,l,s,c);m&&(t.table=m)}}function W(t,r){return e.Selector.hasRoleWildcard(r)&&(r=J(t,r)),r}function J(t,r){for(var i={data:[],id:r.id,metadata:r.metadata},n=0,o=r.data;n<o.length;n++){var a=o[n];if(e.Selector.isRoleWildcard(a)){var u=a.roles,s=K(t.columns,u),c=t.identityFields;if(s&&c){i.data.push(e.DataViewScopeWildcard.fromExprs(c));continue}}Y(i.data,a)&&i.data.push(a)}return i}function Y(t,e){return _.isEmpty(t)?!0:!_.any(t,function(t){return t.key===e.key})}function K(t,e){for(var r=0,i=t;r<i.length;r++){var n=i[r],o=n.roles;if(!o||!_.any(e,function(t){return o[t]}))return!1}return!0}function z(t,r,i,n,o,a,u,s){if(t.categories&&0!==t.categories.length){var c=ot(t,n);if(c){var l,p=c.identities,f=e.createCategoricalEvalContext(s,t,r);if(p){for(var d=0,v=p.length;v>d;d++){var h=p[d];if(a||e.Selector.matchesData(n,[h])){f.setCurrentRowIndex(d);var m=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(f,i,u);if(m&&(c.column.objects||(c.column.objects=[],c.column.objects.length=v),c.column.objects[d]=m),!a)return!0;l=!0}}return l}}}}function X(r,i,n,o,a,u,s,c){var l=r.values;if(l&&l.identityFields&&e.Selector.matchesKeys(o,[l.identityFields])){var p=l.grouped();if(p){for(var f,d=e.createCategoricalEvalContext(c,r,i),v=0,h=p.length;h>v;v++){var m=p[v],g=o.metadata,y=m.values;if(u||e.Selector.matchesData(o,[m.identity])){var w=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(d,n,s);if(w)if(g)for(var x=0,b=y.length;b>x;x++){var S=y[x],E=S.source;if(E.queryName===g){var D=t.Prototype.inherit(E);D.objects=w,S.source=D,f=!0;break}}else m.objects=w,lt(l,p),f=!0;if(!u)return!0}}return f}}}function Z(t,r,i,n,a,u,s){var c=e.createMatrixEvalContext(s,t),l=$(c,t.rows,r,i,n,a,u),p=$(c,t.columns,r,i,n,a,u);if(l||p){var f=o(t);return l&&(f.rows=l),p&&(f.columns=p),f}}function $(t,e,r,i,n,a,u){if(e){var s=e.root;if(s){var c=tt(t,s,r,i,n,a,u);if(c){var l=o(e);return l.root=c,l}}}}function tt(t,r,i,n,a,u,s){var c=r.children;if(c){var l,p,f=r.childIdentityFields;f&&(p=e.Selector.matchesKeys(n,[f]));for(var d=0,v=c.length;v>d;d++){var h=c[d],m=h.identity,g=null;if(p){if(u||e.Selector.matchesData(n,[m])){var y=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(t,i,s);y&&(g=o(h),g.objects=y)}}else g=tt(t,h,i,n,a,u,s);if(g&&(l||(l=et(r)),l.children[d]=g,!u))break}return l}}function et(t){if(Object.getPrototypeOf(t)!==Object.prototype)return t;var e=o(t);return e.children=n(t.children),e}function rt(t,r,i,n,a,u,s,c){var l=e.createTableEvalContext(c,t,r),p=it(l,t.columns,t.rows,t.identity,t.identityFields,i,n,a,u,s);if(p){var f=o(t);return f.rows=p,f}}function it(t,r,i,n,a,u,s,c,l,p){if(!_.isEmpty(n)&&!_.isEmpty(a)&&s.metadata&&e.Selector.matchesKeys(s,[a])){var f=_.findIndex(r,function(t){return t.queryName===s.metadata});if(!(0>f)){for(var d,v=r.length,h=0,m=n.length;m>h;h++){var g=n[h];if(l||e.Selector.matchesData(s,[g])){t.setCurrentRowIndex(h);var y=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(t,u,p);if(y){d||(d=o(i));var w=d[h]=o(d[h]),x=w.objects;x||(w.objects=x=new Array(v)),x[f]=y}if(!l)break}}return d}}}function nt(t,r,i,n,o,a){for(var u=t.metadata.columns,s=n.metadata,c=e.createStaticEvalContext(a,t,r),l=0,p=u.length;p>l;l++){var f=u[l];if(f.queryName===s){var d=e.DataViewObjectEvaluationUtils.evaluateDataViewObjects(c,i,o);d&&(f.objects=d)}}}function ot(t,r){var i=t.categories[0];if(i.identityFields&&e.Selector.matchesKeys(r,[i.identityFields])){var n=i.identity,o=i,a=r.metadata;if(a){var u=t.values;if(u)for(var s=0,c=u.length;c>s;s++){var l=u[s];if(l.source.queryName===a){o=l;break}}}return{column:o,identities:n}}}function at(t,r){if(1===r.length){var i=t.categorical;if(i){var n=i.categories;if(n&&1===n.length){var o=n[0],a=o.source.roles,u=o.identityFields;if(a&&u&&a[r[0]])return{data:[e.DataViewScopeWildcard.fromExprs(u)]}}}}}function ut(t,r){if(e.SQExpr.isSelectRef(r))return r.expressionName;if(t)for(var i=0,n=t.length;n>i;i++){var o=t[i],a=o.expr;if(a&&e.SQExpr.equals(r,o.expr))return o.queryName}}function st(t,e,r){for(var i=t.metadata.columns,n=0,o=i.length;o>n;n++){var a=i[n];if(1===r){var u=a.roles;if(!u||!u[e])continue}else if(a.queryName!==e)continue;var s=a.aggregates;if(s){var c=s.min;if(void 0===c&&(c=s.minLocal),void 0!==c){var l=s.max;if(void 0===l&&(l=s.maxLocal),void 0!==l)return{min:c,max:l}}}}}function ct(t,e,r){void 0===t&&(t=[]);var i=t;return lt(t),e&&(i.identityFields=e),r&&(i.source=r),i}function lt(t,e){t.grouped=e?function(){return e}:function(){return pt(t)}}function pt(t){for(var e,r=[],i=0,n=t.length;n>i;i++){var o=t[i];if(!e||e.identity!==o.identity){if(e={values:[]},o.identity){e.identity=o.identity;var a=o.source;void 0!==a.groupName?e.name=a.groupName:a.displayName&&(e.name=a.displayName)}r.push(e)}e.values.push(o)}return r}function ft(t,r){var i;switch(dt(t.categorical,r)){case 1:i=e.DataViewPivotCategorical.apply(t);break;case 2:i=e.DataViewSelfCrossJoin.apply(t)}return i||t}function dt(t,e){if(t&&!_.isEmpty(e)){var r=t.categories;if(r&&1===r.length){var i=t.values;if(!_.isEmpty(i)&&!i.grouped().some(function(t){return!!t.identity}))for(var n=r[0].source.roles,o=0,a=e.length;a>o;o++){var u=e[o].categorical;if(u&&gt(n,u.values)){var s=u.categories,c=ht(n,s)||mt(n,s);return c?2:1}}}}}function vt(t,e){if(t&&!_.isEmpty(e)){var r=t.rows.levels;if(!(r.length<1)){var i=t.rows.root.children;if(i&&0!==i.length)for(var n=r[0].sources[0].roles,o=0,a=e.length;a>o;o++){var u=e[o].matrix;if(u&&!mt(n,u.rows)&&mt(n,u.columns))return!0}}}}function ht(t,e){return t&&e&&e.bind?t[e.bind.to]:void 0}function mt(t,e){return t&&e&&e["for"]?t[e["for"]["in"]]:void 0}function gt(t,e){return t&&e&&e.group?t[e.group.by]:void 0}var yt={type:{fillRule:{}}};r.apply=i,r.forEachNodeAtLevel=I,r.transformObjects=N,r.createValueColumns=ct,r.setGrouped=lt}(r=e.DataViewTransform||(e.DataViewTransform={}))}(e=t.data||(t.data={}))}(r||(r={}))},382:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t){return function(e){return e.get(t)}}function r(t,e){return"function"==typeof t?t(e):"string"==typeof t?t:void 0}t.createDisplayNameGetter=e,t.getDisplayName=r}(e=t.data||(t.data={}))}(r||(r={}))},383:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},384:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){!function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.Week=2]="Week",t[t.Day=3]="Day",t[t.Hour=4]="Hour",t[t.Minute=5]="Minute",t[t.Second=6]="Second",t[t.Millisecond=7]="Millisecond"}(t.DateTimeUnit||(t.DateTimeUnit={}));t.DateTimeUnit}(r||(r={}))},385:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e;!function(t){function e(t){var e=n.visit(t,l.instance);return e}function r(e){return t.aggregate(i(e),e.aggregate)}function i(e){return t.columnRef(o(e),e.name)}function o(e){return t.entity(e.schema,e.entity,e.entityVar)}function a(e){return t.aggregate(o(e),e.aggregate)}function u(e){return t.aggregate(s(e),e.aggregate)}function s(e){return t.hierarchyLevel(c(e),e.level)}function c(e){return t.hierarchy(o(e),e.name)}t.fieldExpr=e,t.fromColumnAggr=r,t.fromColumn=i,t.fromEntity=o,t.fromEntityAggr=a,t.fromHierarchyLevelAggr=u,t.fromHierarchyLevel=s,t.fromHierarchy=c;var l=function(){function e(){}return e.prototype.visitColumn=function(t){return i(t)},e.prototype.visitColumnAggr=function(t){return r(t)},e.prototype.visitColumnHierarchyLevelVariation=function(e){return t.propertyVariationSource(this.visitEntity(e.source),e.source.name,e.level.name)},e.prototype.visitEntity=function(t){return o(t)},e.prototype.visitEntityAggr=function(t){return a(t)},e.prototype.visitHierarchy=function(t){return c(t)},e.prototype.visitHierarchyLevel=function(t){return s(t)},e.prototype.visitHierarchyLevelAggr=function(t){return u(t)},e.prototype.visitMeasure=function(e){return t.measureRef(this.visitEntity(e),e.name)},e.prototype.visitPercentile=function(e){var r=t.fieldExpr(e.arg);return t.percentile(r,e.k,e.exclusive)},e.prototype.visitPercentOfGrandTotal=function(e){var r=t.fieldExpr(e.baseExpr);return t.arithmetic(r,t.scopedEval(r,[]),3)},e.prototype.visitSelectRef=function(e){return t.selectRef(e.expressionName)},e.instance=new e,e}()}(e=t.SQExprBuilder||(t.SQExprBuilder={}));var r;!function(t){function e(t){return t.accept(o.instance)}t.asFieldPattern=e}(r=t.SQExprConverter||(t.SQExprConverter={}));var n,o=function(r){function n(){r.apply(this,arguments)}return i(n,r),n.prototype.visitColumnRef=function(t){var e=t.source.accept(a.instance);if(e&&e.entity){var r=e.entity;return r.name=t.ref,{column:r}}},n.prototype.visitMeasureRef=function(t){var e=t.source.accept(a.instance);if(e&&e.entity){var r=e.entity;return r.name=t.ref,{measure:r}}},n.prototype.visitEntity=function(t){var e={schema:t.schema,entity:t.entity};return t.variable&&(e.entityVar=t.variable),{entity:e}},n.prototype.visitAggr=function(t){var e=t.arg.accept(this);if(e&&e.column){var r=e.column;return r.aggregate=t.func,{columnAggr:r}}if(e&&e.columnAggr){var r=e.columnAggr;return r.aggregate=t.func,{columnAggr:r}}if(e&&e.hierarchyLevel){var r=e.hierarchyLevel;return r.aggregate=t.func,{hierarchyLevelAggr:r}}var i=t.arg.accept(a.instance);if(i&&i.entity){var r=i.entity;return r.aggregate=t.func,{entityAggr:r}}},n.prototype.visitPercentile=function(t){return{percentile:{arg:t.arg.accept(this),k:t.k,exclusive:t.exclusive}}},n.prototype.visitHierarchy=function(t){var e=t.arg.accept(a.instance);if(e&&e.entity){var r=e.entity;return r.name=t.hierarchy,{hierarchy:r}}},n.prototype.visitHierarchyLevel=function(t){var e=t.arg.accept(u.instance);if(e){var r;return e.hierarchy&&(r={entity:e.hierarchy.entity,schema:e.hierarchy.schema,name:e.hierarchy.name,level:t.level}),e.variation?{columnHierarchyLevelVariation:{source:{entity:e.variation.column.entity,schema:e.variation.column.schema,name:e.variation.column.name},level:r,variationName:e.variation.variationName}}:{hierarchyLevel:r}}},n.prototype.visitArithmetic=function(r){var i={percentOfGrandTotal:{baseExpr:r.left.accept(this)}};return t.SQExpr.equals(r,e.fieldExpr(i))?i:void 0},n.prototype.visitSelectRef=function(t){return{selectRef:{expressionName:t.expressionName}}},n.instance=new n,n}(t.DefaultSQExprVisitor),a=function(e){function r(){e.apply(this,arguments)}return i(r,e),r.prototype.visitEntity=function(t){var e={schema:t.schema,entity:t.entity};return t.variable&&(e.entityVar=t.variable),{entity:e}},r.prototype.visitPropertyVariationSource=function(e){var r=e.arg;if(r instanceof t.SQEntityExpr){var i={schema:r.schema,entity:r.entity,name:e.property};return r.variable&&(i.entityVar=r.variable),{variation:{column:i,variationName:e.name}}}},r.instance=new r,r}(t.DefaultSQExprVisitor),u=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.visitHierarchy=function(t){var e,r,i=t.arg.accept(a.instance);return i.variation?(e={name:t.hierarchy,schema:i.variation.column.schema,entity:i.variation.column.entity},r=i.variation):e={name:t.hierarchy,schema:i.entity.schema,entity:i.entity.entity},{hierarchy:e,variation:r}},e.instance=new e,e}(t.DefaultSQExprVisitor);!function(i){function n(e,i){var n=e instanceof t.SQExpr?r.asFieldPattern(e):e;return n.column?o(n.column,i):n.columnAggr?a(n.columnAggr,i):n.columnHierarchyLevelVariation?u(n.columnHierarchyLevelVariation,i):n.entity?s(n.entity,i):n.entityAggr?c(n.entityAggr,i):n.hierarchy?l(n.hierarchy,i):n.hierarchyLevel?p(n.hierarchyLevel,i):n.hierarchyLevelAggr?f(n.hierarchyLevelAggr,i):n.measure?d(n.measure,i):n.percentile?h(n.percentile,i):n.percentOfGrandTotal?m(n.percentOfGrandTotal,i):n.selectRef?v(n.selectRef,i):void 0}function o(t,e){return e.visitColumn(t)}function a(t,e){return e.visitColumnAggr(t)}function u(t,e){return e.visitColumnHierarchyLevelVariation(t)}function s(t,e){return e.visitEntity(t)}function c(t,e){return e.visitEntityAggr(t)}function l(t,e){return e.visitHierarchy(t)}function p(t,e){return e.visitHierarchyLevel(t)}function f(t,e){return e.visitHierarchyLevelAggr(t)}function d(t,e){return e.visitMeasure(t)}function v(t,e){return e.visitSelectRef(t)}function h(t,e){return e.visitPercentile(t)}function m(t,e){return e.visitPercentOfGrandTotal(t)}function g(t){return e.columnRef(e.entity(t.schema,t.entity,t.entityVar),t.name)}function y(t){return n(t,M.instance)}function w(t){return n(t,F.instance)}function x(t){return void 0!==(t.column||t.columnAggr||t.measure)}function b(t){return i.visit(t,P.instance)}function S(t){var e=t.hierarchy;return e?e.name:void 0}function E(t){return t.columnHierarchyLevelVariation?t.columnHierarchyLevelVariation.source:t.column||t.measure||t.columnAggr}function D(t){var e=b(t);return e?e:T(t).entity}function C(t){var e=i.toFieldExprEntityItemPattern(t);return e.schema}function T(t){return i.visit(t,R.instance)}function V(t){return i.visit(t,R.instance)}i.visit=n,i.toColumnRefSQExpr=g,i.getAggregate=y,i.isAggregation=w,i.hasFieldExprName=x,i.getPropertyName=b,i.getHierarchyName=S,i.getColumnRef=E,i.getFieldExprName=D,i.getSchema=C,i.toFieldExprEntityPattern=T,i.toFieldExprEntityItemPattern=V;var M=function(){function r(){}return r.prototype.visitColumn=function(t){},r.prototype.visitColumnAggr=function(t){return t.aggregate},r.prototype.visitColumnHierarchyLevelVariation=function(t){},r.prototype.visitEntity=function(t){},r.prototype.visitEntityAggr=function(t){return t.aggregate},r.prototype.visitHierarchy=function(t){},r.prototype.visitHierarchyLevel=function(t){},r.prototype.visitHierarchyLevelAggr=function(t){return t.aggregate},r.prototype.visitMeasure=function(t){},r.prototype.visitSelectRef=function(t){},r.prototype.visitPercentile=function(t){},r.prototype.visitPercentOfGrandTotal=function(r){return t.SQExprInfo.getAggregate(e.fieldExpr(r.baseExpr))},r.instance=new r,r}(),F=function(){function t(){}return t.prototype.visitColumn=function(t){return!1},t.prototype.visitColumnAggr=function(t){return!0},t.prototype.visitColumnHierarchyLevelVariation=function(t){return!1},t.prototype.visitEntity=function(t){return!1},t.prototype.visitEntityAggr=function(t){return!0},t.prototype.visitHierarchy=function(t){return!1},t.prototype.visitHierarchyLevel=function(t){return!1},t.prototype.visitHierarchyLevelAggr=function(t){return!0},t.prototype.visitMeasure=function(t){return!0},t.prototype.visitSelectRef=function(t){return!1},t.prototype.visitPercentile=function(t){return!0},t.prototype.visitPercentOfGrandTotal=function(t){return!0},t.instance=new t,t}(),R=function(){function t(){}return t.prototype.visitColumn=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitColumnAggr=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitColumnHierarchyLevelVariation=function(e){return t.toEntityItemExprPattern(e.source)},t.prototype.visitEntity=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitEntityAggr=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitHierarchy=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitHierarchyLevel=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitHierarchyLevelAggr=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitMeasure=function(e){return t.toEntityItemExprPattern(e)},t.prototype.visitSelectRef=function(t){},t.prototype.visitPercentile=function(t){return i.visit(t.arg,this)},t.prototype.visitPercentOfGrandTotal=function(t){return i.visit(t.baseExpr,this)},t.toEntityItemExprPattern=function(t){var e={schema:t.schema,entity:t.entity};return t.entityVar&&(e.entityVar=t.entityVar),e},t.instance=new t,t}(),P=function(){function t(){}return t.prototype.visitColumn=function(t){return t.name},t.prototype.visitColumnAggr=function(t){return t.name},t.prototype.visitColumnHierarchyLevelVariation=function(t){},t.prototype.visitEntity=function(t){},t.prototype.visitEntityAggr=function(t){},t.prototype.visitHierarchy=function(t){},t.prototype.visitHierarchyLevel=function(t){},t.prototype.visitHierarchyLevelAggr=function(t){},t.prototype.visitMeasure=function(t){return t.name},t.prototype.visitSelectRef=function(t){},t.prototype.visitPercentile=function(t){return i.visit(t.arg,this)},t.prototype.visitPercentOfGrandTotal=function(t){return i.visit(t.baseExpr,this)},t.instance=new t,t}()}(n=t.FieldExprPattern||(t.FieldExprPattern={}))}(e=t.data||(t.data={}))}(r||(r={}))},386:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(e,r){if(!r||0===r.length)return{dataView:e,isValid:!0};if(e)for(var i=0,s=r;i<s.length;i++){var c=s[i];if(l(e,c))return{dataView:e,isValid:!0};if(c.categorical&&e.categorical)return n(e,c);if(c.tree&&e.tree)return a(e,c.tree);if(c.single&&e.single)return o(e,c.single);if(c.table&&e.table)return u(e,c.table)}else if(t.ScriptResultUtil.findScriptResult(r))return{dataView:e,isValid:!0};return{isValid:!1}}function n(e,r){var i=r.categorical,n=e.categorical;if(!n)return{isValid:!1};var o;if(i.rowCount&&(o=i.rowCount.supported,o&&o.max)){var a=void 0,u=n.categories,s=o.max,c=void 0;if(u)for(var l=0,f=u.length;f>l;l++){var d=u[l];if(c=d.values.length,void 0!==s&&c>s){var v=T.range(d.values,0,s-1);a=a||{categories:[]},a.categories.push({source:d.source,values:v})}}if(n.values&&n.values.length>0&&s&&(c||(c=n.values[0].values.length),void 0!==s&&c>s)){a=a||{},a.values=t.data.DataViewTransform.createValueColumns();for(var l=0,f=n.values.length;f>l;l++){var h=n.values[l],m={source:h.source,values:T.range(h.values,0,s-1)};void 0!==h.min&&(m.min=h.min),void 0!==h.max&&(m.max=h.max),void 0!==h.subtotal&&(m.subtotal=h.subtotal),a.values.push(m)}}a&&(e={metadata:e.metadata,categorical:a})}return p(e,r)?{dataView:e,isValid:!0}:null}function o(t,e){return t.single?{dataView:t,isValid:!0}:{isValid:!1}}function a(t,e){var r=t.metadata;return null==m(s(r.columns),e.depth)?{dataView:t,isValid:!0}:{isValid:!1}}function u(t,e){return t.table?{dataView:t,isValid:!0}:{isValid:!1}}function s(t){for(var e=0,r=0,i=t.length;i>r;r++)t[r].isMeasure||++e;return e}function c(t){for(var e=0,r=0,i=t.length;i>r;r++)t[r].isMeasure&&++e;return e}function l(t,e,r){return e&&t?e.scriptResult&&!h(t.scriptResult,e.scriptResult)?!1:e.categorical&&!p(t,e.categorical,r)?!1:e.tree&&!d(t,e.tree)?!1:e.single&&!f(t.single,e.single)?!1:!e.table||v(t.table,e.table,r):!1}function p(t,e,r){var i=t.categorical;if(!i)return!1;if(e.rowCount){var n=e.rowCount.supported;if(r&&e.rowCount.preferred&&(n=e.rowCount.preferred),n){var o=0;if(i.values&&i.values.length?o=i.values[0].values.length:i.categories&&i.categories.length&&(o=i.categories[0].values.length),null!=m(o,n))return!1}}return!0}function f(t,e){return!!t}function d(t,e){var r=t.metadata;return null==m(s(r.columns),e.depth)}function v(t,e,r){if(!t)return!1;if(e.rowCount){var i=e.rowCount.supported;if(r&&e.rowCount.preferred&&(i=e.rowCount.preferred),i){var n=0;if(t.rows&&t.rows.length&&(n=t.rows.length),null!=m(n,i))return!1}}return!0}function h(t,e){return t?!!t.imageBase64:!1}function m(t,e,r){return e?!r&&void 0!==e.min&&e.min>t?M.conditionRangeTooSmall:void 0!==e.max&&e.max<t?M.conditionRangeTooLarge:void 0:void 0}function g(e,r,i,n){if(e&&void 0!==e.kind){var o=e.kind,a=i[r];if(a)for(var u=a.all(),s=0,c=u;s<c.length;s++){var l=c[s];if(n[l.queryRef]!==o)switch(o){case t.VisualDataRoleKind.Measure:return M.conditionKindExpectedMeasure;case t.VisualDataRoleKind.Grouping:return M.conditionKindExpectedGrouping;case t.VisualDataRoleKind.GroupingOrMeasure:return M.conditionKindExpectedGroupingOrMeasure}}}}function y(t,e,r,i,n){var o=[],a=[];if(!_.isEmpty(e))for(var u=0,s=e.length;s>u;u++){var c=e[u],l=c.conditions,p=c.requiredProperties,f=x(p,i,n),d=[];if(_.isEmpty(l))d.push({});else for(var v=0,h=l.length;h>v;v++){var m=l[v],g=w(t,m,r);if(_.isEmpty(g))d.push(m);else for(var y=0,b=g;y<b.length;y++){var S=b[y];S.mappingIndex=u,S.conditionIndex=v,a.push(S)}}if(!_.isEmpty(d)&&f){var E=_.cloneDeep(c),D=_.filter(d,function(t){return Object.keys(t).length>0});_.isEmpty(D)||(E.conditions=D),o.push(E)}}return{supportedMappings:T.emptyToNull(o),mappingErrors:T.emptyToNull(a)}}function w(t,e,r){for(var i=Object.keys(e),n=[],o=0,a=i.length;a>o;o++){var u=i[o],s=t[u]&&!_.isEmpty(t[u].activeProjectionRefs),c=e[u],l=b(u,t,s),p=m(l,c);null!=p&&n.push({code:p,roleName:u});var f=g(c,u,t,r);null!=f&&n.push({code:f,roleName:u})}return n}function x(e,r,i){if(_.isEmpty(e))return!0;if(!r||!i)return!1;var n=t.data.createStaticEvalContext();return _.every(e,function(e){var o=null,a=r[e.objectName];a&&(o=a.properties[e.propertyName]);var u=V.getValue(i,e,null);return o&&u?t.data.DataViewObjectEvaluator.evaluateProperty(n,o,u):!1})}function b(t,e,r){var i=e[t];return i?r?1:i.all().length:0}function S(e,r){if(e&&r&&e.categorical&&r.categorical){var i=e.categorical.categories,n=r.categorical.categories;if(i&&n&&i.length===n.length){for(var o=0,a=i.length;a>o;o++){var u=i[o].identity,s=n[o].identity,c=E(u);if(c!==E(s))return!1;for(var l=0;c>l;l++)if(!t.DataViewScopeIdentity.equals(u[l],s[l]))return!1}return!0}}return!1}function E(t){return t?t.length:0}function D(t,e){return t||e?t&&e?t.displayName!==e.displayName?!1:t.queryName!==e.queryName?!1:t.isMeasure!==e.isMeasure?!1:t.type!==e.type?!1:t.sort===e.sort:!1:!0}function C(t,r){if(!t&&!r)return!0;if(!t||!r)return!1;var i=t.columns.length,n=r.columns.length;if(i!==n)return!1;for(var o=0;n>o;o++)if(!e.areMetadataColumnsEquivalent(t.columns[o],r.columns[o]))return!1;return!0}var T=i.ArrayExtensions,V=t.data.DataViewObjectDefinitions;!function(t){t[t.conditionRangeTooLarge=0]="conditionRangeTooLarge",t[t.conditionRangeTooSmall=1]="conditionRangeTooSmall",t[t.conditionKindExpectedMeasure=2]="conditionKindExpectedMeasure",t[t.conditionKindExpectedGrouping=3]="conditionKindExpectedGrouping",t[t.conditionKindExpectedGroupingOrMeasure=4]="conditionKindExpectedGroupingOrMeasure"}(e.DataViewMappingMatchErrorCode||(e.DataViewMappingMatchErrorCode={}));var M=e.DataViewMappingMatchErrorCode;e.validateAndReshape=r,e.countGroups=s,e.countMeasures=c,e.supports=l,e.validateRange=m,e.chooseDataViewMappings=y,e.getPropertyCount=b,e.hasSameCategoryIdentity=S,e.areMetadataColumnsEquivalent=D,e.isMetadataEquivalent=C}(e=t.DataViewAnalysis||(t.DataViewAnalysis={}))}(r||(r={}))},387:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e,r=i.ArrayExtensions,n=i.Lazy;!function(t){function e(t){return new o(t)}function i(t,e){return t.key&&e.key&&t.key===e.key&&r.sequenceEqual(t.roles,e.roles,function(t,e){return t===e})}t.fromRoles=e,t.equals=i;var o=function(){function t(t){var e=this;this._roles=t,this._key=new n(function(){return JSON.stringify(e.roles)})}return Object.defineProperty(t.prototype,"roles",{get:function(){return this._roles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(e=t.DataViewRoleWildcard||(t.DataViewRoleWildcard={}))}(e=t.data||(t.data={}))}(r||(r={}))},388:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function i(t,e,i){return t=t||null,e=e||null,t===e?!0:!t!=!e?!1:r.SQExpr.equals(t.expr,e.expr,i)}function n(t,e){if(!_.isEmpty(t)){for(var r=[],i=0,n=t;i<n.length;i++){var a=n[i];r.push(a.expr)}return o(r,e)}}function o(e,i){if(!_.isEmpty(e)){for(var n,o=0,a=e;o<a.length;o++){var u=a[o],s=r.ScopeIdentityExtractor.getInExpr(u);n=n?r.SQExprBuilder.or(n,s):s||u}return n&&i&&(n=t.data.SQExprBuilder.not(n)),t.data.SemanticFilter.fromSQExpr(n)}}e.equals=i,e.filterFromIdentity=n,e.filterFromExprs=o}(e=t.DataViewScopeIdentity||(t.DataViewScopeIdentity={}));var r;!function(t){function e(t){return new n(t)}var r=i.Lazy;t.createDataViewScopeIdentity=e;var n=function(){function e(e){this._expr=e,this._key=new r(function(){return t.SQExprShortSerializer.serialize(e)})}return Object.defineProperty(e.prototype,"expr",{get:function(){return this._expr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),e}()}(r=t.data||(t.data={}))}(r||(r={}))},389:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e,r=i.Lazy;!function(e){function i(e,r){var i=t.ScopeIdentityExtractor.getKeys(r.expr);return i?t.SQExprUtils.sequenceEqual(e.exprs,i):!1}function n(e,r){return e.key===r.key&&t.SQExprUtils.sequenceEqual(e.exprs,r.exprs)}function o(t){return new a(t)}e.matches=i,e.equals=n,e.fromExprs=o;var a=function(){function e(e){this._exprs=e,this._key=new r(function(){return t.SQExprShortSerializer.serializeArray(e)})}return Object.defineProperty(e.prototype,"exprs",{get:function(){return this._exprs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),e}()}(e=t.DataViewScopeWildcard||(t.DataViewScopeWildcard={}))}(e=t.data||(t.data={}))}(r||(r={}))},390:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(){return new r}t.createColorAllocatorCache=e;var r=function(){function t(){this.cache=[]}return t.prototype.get=function(t){for(var e=0,r=this.cache;e<r.length;e++){var i=r[e];if(i.key===t)return i.allocator}},t.prototype.register=function(t,e){return this.cache.push({key:t,allocator:e}),this},t}()}(e=t.data||(t.data={}))}(r||(r={}))},391:function(t,e){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},392:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(r){function i(r){var i=r.dataViewMappings,n=r.visualDataViews,o=r.dataRoles,a=r.objectDescriptors,u=r.objectDefinitions,s=r.colorAllocatorFactory,c=r.transformSelects,l=r.projectionActiveItems,p=r.metadata;if(!_.isEmpty(n)&&c&&p){var f=e.DataViewSelectTransform.createRoleKindFromMetadata(c,p),d=e.DataViewSelectTransform.projectionsFromSelects(c,l);if(!f||!d||_.isEmpty(i)||!a||!u)return n;var v=t.DataViewAnalysis.chooseDataViewMappings(d,i,f,a,u).supportedMappings;if(v){var h=_.find(v,function(t){return t.usage&&t.usage.regression});if(h){for(var m=[],g=0,y=n;g<y.length;g++){var w=y[g],x=this.linearRegressionTransform(w,o,h,a,u,s);x&&m.push(x)}_.isEmpty(m)||n.push.apply(n,m)}}}return n}function n(e,r,i,n,u,s){if(e.categorical){var c=a(0,e.categorical,r),l=a(1,e.categorical,r);if(!_.isEmpty(c)&&!_.isEmpty(l)){var f=c[0].source,m=l[0].source,g=!0;if(i.usage&&i.usage.regression&&e.metadata.objects){var y=i.usage.regression,w=y.combineSeries;w&&(g=t.DataViewObjects.getValue(e.metadata.objects,w,!0))}var x=d(c,l,g,!1),b=o(x);if(b){var S,E=b.xMin,D=b.xMax,C=h(l)||h(c);if(C){var T=d(c,l,g,!0);S=o(T),S?(E=_.min([E,S.xMin]),D=_.max([D,S.xMax])):C=!1}for(var V=[],M=0,F=b.lineDefs;M<F.length;M++){var R=F[M];V.push(p(R,+E,+D))}var P;if(C){P=[];for(var I=0,A=S.lineDefs;I<A.length;I++){var R=A[I];P.push(p(R,+E,+D))}}var j;if(g)j=["combinedRegressionSeries"];else if(e.categorical.values.source){var N=e.categorical.values.grouped();j=_.map(N,function(t){return t.name})}else j=_.map(l,function(t){return t.source.queryName});var O=v(f,m,j,[E,D],V,P,e,i,n,u,s);return O}}}}function o(t){for(var e,r,i=[],n=0,o=t;n<o.length;n++){var a=o[n],u=a.xValues,p=a.yValues;if(_.isEmpty(u)||_.isEmpty(p))return;var f=s(u);if(!f)return;var d=s(p);if(!d)return;var v=c(u,p),h=v.xValues[0],m=v.xValues[v.xValues.length-1],g=l(v.xValues,v.yValues);e=_.min([e,h]),r=_.max([r,m]),i.push(g)}return{lineDefs:i,xMin:e,xMax:r}}function a(t,e,r){var i=u(t,e.values,r);if(!_.isEmpty(i))return i;var n=e.categories;if(!_.isEmpty(n)){var o=n[0];return i=u(t,[o],r),_.isEmpty(i)?void 0:i}}function u(t,e,r){return _.isEmpty(e)?void 0:_.filter(e,function(e){var i=function(i){if(!e.source.roles[i])return"continue";var n=_.find(r,function(t){return t.name===i});return n&&n.cartesianKind===t?{value:!0}:void 0};for(var n in e.source.roles){var o=i(n);if("object"==typeof o)return o.value}return!1})}function s(t){var e=_.find(t,function(t){return null!=t});if(null!=e){var r=typeof e;if(!_.some(t,function(t){return null!=t&&typeof t!==r}))return r}}function c(t,e){var r=_.zip(t,e),i=_.chain(r).filter(function(t){return null!=t[0]&&null!=t[1]}).sortBy(function(t){return t[0]}).unzip().value(),n=i[0],o=i[1];return{xValues:n,yValues:o}}function l(t,e){var r=_.sum(t)/t.length,i=_.sum(e)/e.length,n=_.chain(t).map(function(t){return Math.pow(t-r,2)}).sum(),o=_.chain(t).map(function(t,n){return(t-r)*(e[n]-i)}).sum(),a=o/n,u=i-r*a;return{slope:a,intercept:u}}function p(t,e,r){return[e*t.slope+t.intercept,r*t.slope+t.intercept]}function f(t,e){if(e){var r=t;if(r.highlights)return r.highlights}return t.values}function d(t,e,r,i){for(var n=[],o=_.map(t,function(t){return f(t,i)}),a=_.map(e,function(t){return f(t,i)}),u=t.length>1,s=0;s<a.length;s++){var c=u?o[s]:o[0],l=a[s];r&&n.length>0?(n[0].xValues=n[0].xValues.concat(c),n[0].yValues=n[0].yValues.concat(l)):n.push({xValues:c,yValues:l})}return n}function v(t,i,n,o,a,u,s,c,l,p,f){var d,v,h=c.categorical.categories["for"]["in"],y=c.categorical.values.group;if(y&&!_.isEmpty(y.select)&&(d=y.select[0]["for"]?y.select[0]["for"]["in"]:y.select[0].bind.to,v=y.by),d&&v){var w=(T={},T[h]=!0,T),x=(V={},V[d]=!0,V),b=(M={},M[v]=!0,M),S=[];
for(var E in a){var D={values:a[E]};u&&(D.highlights=u[E]),S.push([D])}var C=e.createCategoricalDataViewBuilder().withCategory({source:{displayName:t.displayName,queryName:m,type:t.type,isMeasure:!1,roles:w},values:o,identityFrom:{fields:[e.SQExprBuilder.columnRef(e.SQExprBuilder.entity("s","RegressionEntity"),"RegressionCategories")]}}).withGroupedValues({groupColumn:{source:{displayName:i.displayName+"Regression",queryName:g,type:i.type,isMeasure:i.isMeasure,roles:b},values:n,identityFrom:{fields:[e.SQExprBuilder.columnRef(e.SQExprBuilder.entity("s","RegressionEntity"),"RegressionSeries")]}},valueColumns:[{source:{displayName:i.displayName,queryName:r.regressionYQueryName,type:i.type,isMeasure:i.isMeasure,roles:x}}],data:S}).build();return e.DataViewTransform.transformObjects(C,1,l,p,[],f),C;var T,V,M}}function h(t){return _.any(t,function(t){var e=t;return null!=e.highlights})}var m="RegressionX",g="RegressionSeries";r.regressionYQueryName="RegressionY",r.run=i,r.linearRegressionTransform=n}(r=e.DataViewRegression||(e.DataViewRegression={}))}(e=t.data||(t.data={}))}(r||(r={}))},393:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(r){function i(t,r){for(var i={},n=0,o=t;n<o.length;n++){var a=o[n];if(a){var u=a.roles;if(u)for(var s in u)if(u[s]){var c=i[s];c||(c=i[s]=new e.QueryProjectionCollection([])),c.all().push({queryRef:a.queryName}),r&&r[s]&&(c.activeProjectionRefs=_.map(r[s],function(t){return t.queryRef}))}}}return i}function n(e,r){for(var i={},n=0,o=r.columns;n<o.length;n++){var a=o[n];if(!(!a.index&&0!==a.index||a.index<0||a.index>=e.length)){var u=e[a.index];if(u){var s=u.queryName;s&&void 0===i[s]&&(i[s]=a.isMeasure?t.VisualDataRoleKind.Measure:t.VisualDataRoleKind.Grouping)}}}return i}r.projectionsFromSelects=i,r.createRoleKindFromMetadata=n}(r=e.DataViewSelectTransform||(e.DataViewSelectTransform={}))}(e=t.data||(t.data={}))}(r||(r={}))},394:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t,e,r){return new o(t,e,r)}function r(t,e){return i(t.values,e)||i(t.categories,e)}function i(t,e){if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r],o=n.source.roles;if(o&&o[e])return n}}function n(t,e){if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];if(!n.identity&&n.source.index===e)return n}}t.createCategoricalEvalContext=e;var o=function(){function e(t,e,r){this.colorAllocatorProvider=t,this.dataView=e,this.selectTransforms=r,this.columnsByRole={}}return e.prototype.getColorAllocator=function(t){return this.colorAllocatorProvider.get(t)},e.prototype.getExprValue=function(e){var r=this.index;if(_.isNumber(r)){var i=this.selectTransforms;if(i){var o=t.findSelectIndex(e,i);if(-1!==o){var a=this.dataView,u=n(a.values,o);if(u)return u.values[r]}}}},e.prototype.getRoleValue=function(t){var e=this.columnsByRole,i=e[t];if(i||(i=e[t]=r(this.dataView,t)),i){var n=this.index;return null!=n?i.values[this.index]:void 0}},e.prototype.setCurrentRowIndex=function(t){this.index=t},e}()}(e=t.data||(t.data={}))}(r||(r={}))},395:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(t,e,i){return new r(t,e,i)}t.createTableEvalContext=e;var r=function(){function e(t,e,r){this.colorAllocatorProvider=t,this.dataView=e,this.selectTransforms=r}return e.prototype.getColorAllocator=function(t){return this.colorAllocatorProvider.get(t)},e.prototype.getExprValue=function(e){var r=this.rowIdx;if(null!=r)return t.getExprValueFromTable(e,this.selectTransforms,this.dataView,r)},e.prototype.getRoleValue=function(t){},e.prototype.setCurrentRowIndex=function(t){this.rowIdx=t},e}()}(e=t.data||(t.data={}))}(r||(r={}))},396:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.evaluate=function(t){},t}();t.RuleEvaluation=e}(e=t.data||(t.data={}))}(r||(r={}))},397:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e=function(t){function e(e,r){t.call(this),this.inputRole=e,this.allocator=r}return i(e,t),e.prototype.evaluate=function(t){var e=t.getRoleValue(this.inputRole);return void 0!==e?this.allocator.color(e):void 0},e}(t.RuleEvaluation);t.ColorRuleEvaluation=e}(e=t.data||(t.data={}))}(r||(r={}))},398:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(e){var r,n=t.Prototype.inherit,o=t.Prototype.inheritSingle,a=i.ArrayExtensions;!function(t){function e(t,e){if(t)if(r(t))for(var n=0,o=0,a=t;o<a.length;o++){var u=a[o];u&&(n=i(u,n,[],e))}else i(t,0,[],e)}function r(t){return a.isArrayOrInheritedArray(t)}function i(t,e,r,n){if(r.push(t),_.isEmpty(t.children))n(t,e,r),e++;else for(var o=t.children,a=0,u=o;a<u.length;a++){var s=u[a];s&&(e=i(s,e,r,n))}return r.pop(),e}function u(t,e,r){var i=t,a=_.isUndefined(t.level),s=a||t.level<=e;if(s){var c=r?o:n,l=c(t),p=a||t.level<e;if(p&&!_.isEmpty(t.children)){l.children=c(t.children);for(var f=0,d=l.children.length;d>f;f++)l.children[f]=u(l.children[f],e,r)}i=l}return i}function s(t){var e=!1;if(t)if(c(t))e=s(t.rows)||s(t.columns);else{var r=t.levels;if(!_.isEmpty(r))for(var i=0,n=r;i<n.length;i++){var o=n[i];if(o.sources&&o.sources.length>=2){var a=o.sources[0].isMeasure;if(!a){e=!0;break}}}}return e}function c(t){return"rows"in t&&"columns"in t&&"valueSources"in t}t.forEachLeafNode=e,t.inheritMatrixNodeHierarchy=u,t.containsCompositeGroup=s}(r=e.DataViewMatrixUtils||(e.DataViewMatrixUtils={}))}(r=e.utils||(e.utils={}))}(e=t.data||(t.data={}))}(r||(r={}))},399:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(t){var e;!function(t){function e(t,e){var r=t.roles;return r&&r[e]}function r(t,r,i){var n=[];if(!_.isEmpty(t)){for(var o=r[i],a={},u=0,s=o.length;s>u;u++){var c=o[u];a[c]=u}for(var l=0,p=t.length;p>l;l++){var f=t[l];if(e(f,i)){var d={metadataColumn:f,sourceIndex:l,projectionOrderIndex:a[f.index]};n.push(d)}}}return n}t.isForRole=e,t.joinMetadataColumnsAndProjectionOrder=r}(e=t.DataViewMetadataColumnUtils||(t.DataViewMetadataColumnUtils={}))}(e=t.utils||(t.utils={}))}(e=t.data||(t.data={}))}(r||(r={}))},400:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.findProperty=function(t,e){var r=this.entities.withName(t);if(r&&!_.isEmpty(r.properties))return r.properties.withName(e)},t.prototype.findHierarchy=function(t,e){var r=this.entities.withName(t);if(r&&!_.isEmpty(r.hierarchies))return r.hierarchies.withName(e)},t.prototype.findHierarchyByVariation=function(t,e,r,i){var n=this.entities.withName(t);if(n&&!_.isEmpty(n.properties)){var o=n.properties.withName(e);if(o){var a=o.column;if(a&&!_.isEmpty(a.variations)){var u=a.variations.withName(r);if(u){var s=u.navigationProperty?u.navigationProperty.targetEntity:n;if(!s||_.isEmpty(s.hierarchies))return;return s.hierarchies.withName(i)}}}}},t.prototype.findPropertyWithKpi=function(t,e){var r=this.entities.withName(t);if(r&&!_.isEmpty(r.properties))for(var i=0,n=r.properties;i<n.length;i++){var o=n[i];if(o&&o.measure&&o.measure.kpi&&(o.measure.kpi.status===e||o.measure.kpi.goal===e))return o}},t}();t.ConceptualSchema=e,function(t){t[t.None=0]="None",t[t.Address=1]="Address",t[t.City=2]="City",t[t.Company=3]="Company",t[t.Continent=4]="Continent",t[t.Country=5]="Country",t[t.County=6]="County",t[t.Date=7]="Date",t[t.Image=8]="Image",t[t.ImageUrl=9]="ImageUrl",t[t.Latitude=10]="Latitude",t[t.Longitude=11]="Longitude",t[t.Organization=12]="Organization",t[t.Place=13]="Place",t[t.PostalCode=14]="PostalCode",t[t.Product=15]="Product",t[t.StateOrProvince=16]="StateOrProvince",t[t.WebUrl=17]="WebUrl"}(t.ConceptualDataCategory||(t.ConceptualDataCategory={}));t.ConceptualDataCategory}(e=t.data||(t.data={}))}(r||(r={}))},401:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e,r=i.StringExtensions,n=t.data.FieldExprPattern;!function(e){function i(t){return t&&1===t.length?t[0].scriptResult:void 0}function o(e){var r=i(e);if(r){var n=e[0].metadata.objects,o=t.DataViewObjects.getValue(n,r.script.source),a=t.DataViewObjects.getValue(n,r.script.provider);return{source:o,provider:a}}}function a(e,r){var n=i(e);if(n&&r){var o=t.data.DataViewObjectDefinitions.getValue(r,n.script.source,null),a=t.data.DataViewObjectDefinitions.getValue(r,n.script.provider,null);return{source:o?o.value:null,provider:a?a.value:null}}}function u(t,e,i){var o={VariableName:"dataset",Columns:[]};if(t&&e&&!_.isEmpty(e)){var a=[],u=[];for(var c in t)for(var l=0,p=t[c].all();l<p.length;l++){var f=p[l],d=e.withName(f.queryRef);if(d){var v={QueryName:d.name,Name:n.visit(d.expr,new s(i))};u.push(v),a.push(v.Name)}}a=r.ensureUniqueNames(a);for(var h=0;h<a.length;h++){var v=u[h];v.Name=a[h]}o.Columns=u}return o}e.findScriptResult=i,e.extractScriptResult=o,e.extractScriptResultFromVisualConfig=a,e.getScriptInput=u;var s=function(){function t(t){this.federatedSchema=t}return t.prototype.visitColumn=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitColumnAggr=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitColumnHierarchyLevelVariation=function(e){return t.getVariationLevelName(e,this.federatedSchema)},t.prototype.visitEntity=function(t){return t.entity},t.prototype.visitEntityAggr=function(t){return t.entity},t.prototype.visitHierarchy=function(e){return t.getNameForHierarchy(e,this.federatedSchema)},t.prototype.visitHierarchyLevel=function(t){},t.prototype.visitHierarchyLevelAggr=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitMeasure=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitSelectRef=function(t){return n.visit(t,this)},t.prototype.visitPercentile=function(t){return n.visit(t.arg,this)},t.prototype.visitPercentOfGrandTotal=function(t){return n.visit(t.baseExpr,this)},t.getNameForHierarchy=function(t,e){var r=e.schema(t.schema),i=r.findHierarchy(t.entity,t.name);return i?i.name:void 0},t.getNameForProperty=function(t,e){var r=e.schema(t.schema),i=r.findProperty(t.entity,t.name);return i?i.name:void 0},t.getVariationLevelName=function(t,e){var r=t.source,i=e.schema(r.schema).findProperty(r.entity,r.name);if(i)for(var n=i.column.variations,o=0,a=n;o<a.length;o++){var u=a[o];if(u.name===t.variationName)for(var s=0,c=u.defaultHierarchy.levels;s<c.length;s++){var l=c[s];if(l.name===t.level.level)return l.column.name}}},t}()}(e=t.ScriptResultUtil||(t.ScriptResultUtil={}))}(r||(r={}))},402:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r;!function(e){var r;!function(e){function r(e,r){!t.DataViewAnalysis.isMetadataEquivalent(e.metadata,r.metadata),r.metadata.segment||delete e.metadata.segment,e.table&&r.table&&i(e.table,r.table),e.categorical&&r.categorical&&n(e.categorical,r.categorical),e.tree&&r.tree&&a(e.tree.root,r.tree.root,!0),e.matrix&&r.matrix&&a(e.matrix.rows.root,r.matrix.rows.root,!1)}function i(t,e){if(!_.isEmpty(e.rows)){var r=e.lastMergeIndex+1;o(t.rows,e.rows,r),e.identity&&o(t.identity,e.identity,r)}}function n(t,e){if(t.categories&&e.categories)for(var r=e.categories.length,i=0;r>i;i++){var n=e.categories[i],a=t.categories[i],u=e.lastMergeIndex+1;n.values&&o(a.values,n.values,u),n.identity&&o(a.identity,n.identity,u)}if(t.values&&e.values)for(var s=e.values.length,c=0;s>c;c++){var l=e.values[c],p=t.values[c];!p.values&&l.values&&(p.values=[]);var u=e.lastMergeIndex+1;l.values&&o(p.values,l.values,u),l.highlights&&o(p.highlights,l.highlights,u)}}function o(t,e,r){if(r>=e.length)return e;var i=[];return void 0!==r&&(i=e.splice(0,r)),Array.prototype.push.apply(t,e),i}function a(t,e,r){if(e.children&&0!==e.children.length){if(r&&(!t.children||0===t.children.length))return void(t.children=e.children);var i=u(e.children),n=t.children[t.children.length-1],s=o(t.children,e.children,i);s.length>0&&a(n,s[s.length-1],r)}}function u(t){if(0===t.length)return 0;for(var e=0;e<t.length;e++){var r=t[e];if(!r.isMerge)break}return e}e.mergeDataViews=r,e.mergeTables=i,e.mergeCategorical=n,e.mergeTreeNodes=a}(r=e.DataViewMerger||(e.DataViewMerger={}))}(r=e.segmentation||(e.segmentation={}))}(e=t.data||(t.data={}))}(r||(r={}))},403:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=i.ArrayExtensions,r=function(){function r(){}return r.prototype.visitColumnRef=function(e){var r=e.source,i=r.accept(this);return r===i?e:new t.SQColumnRefExpr(i,e.ref)},r.prototype.visitMeasureRef=function(e){var r=e.source,i=r.accept(this);return r===i?e:new t.SQMeasureRefExpr(i,e.ref)},r.prototype.visitAggr=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQAggregationExpr(i,e.func)},r.prototype.visitSelectRef=function(t){return t},r.prototype.visitPercentile=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQPercentileExpr(i,e.k,e.exclusive)},r.prototype.visitHierarchy=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQHierarchyExpr(i,e.hierarchy)},r.prototype.visitHierarchyLevel=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQHierarchyLevelExpr(i,e.level)},r.prototype.visitPropertyVariationSource=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQPropertyVariationSourceExpr(i,e.name,e.property)},r.prototype.visitEntity=function(t){return t},r.prototype.visitAnd=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQAndExpr(i,o)},r.prototype.visitBetween=function(e){var r=e.arg,i=r.accept(this),n=e.lower,o=n.accept(this),a=e.upper,u=a.accept(this);return r===i&&n===o&&a===u?e:new t.SQBetweenExpr(i,o,u)},r.prototype.visitIn=function(r){for(var i,n=r.args,o=this.rewriteAll(n),a=r.values,u=0,s=a.length;s>u;u++){var c=a[u],l=this.rewriteAll(c);c===l||i||(i=e.take(a,u)),i&&i.push(l)}return n!==o||i?new t.SQInExpr(o,i||a):r},r.prototype.rewriteAll=function(t){for(var r,i=0,n=t.length;n>i;i++){var o=t[i],a=o.accept(this);o===a||r||(r=e.take(t,i)),r&&r.push(a)}return r||t},r.prototype.visitOr=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQOrExpr(i,o)},r.prototype.visitCompare=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQCompareExpr(e.comparison,i,o)},r.prototype.visitContains=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQContainsExpr(i,o)},r.prototype.visitExists=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQExistsExpr(i)},r.prototype.visitNot=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQNotExpr(i)},r.prototype.visitStartsWith=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQStartsWithExpr(i,o)},r.prototype.visitConstant=function(t){return t},r.prototype.visitDateSpan=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQDateSpanExpr(e.unit,i)},r.prototype.visitDateAdd=function(e){var r=e.arg,i=r.accept(this);return r===i?e:new t.SQDateAddExpr(e.unit,e.amount,i)},r.prototype.visitNow=function(t){return t},r.prototype.visitDefaultValue=function(t){return t},r.prototype.visitAnyValue=function(t){return t},r.prototype.visitArithmetic=function(e){var r=e.left,i=r.accept(this),n=e.right,o=n.accept(this);return r===i&&n===o?e:new t.SQArithmeticExpr(i,o,e.operator)},r.prototype.visitScopedEval=function(e){var r=e.expression,i=r.accept(this),n=e.scope,o=this.rewriteAll(n);return r===i&&n===o?e:new t.SQScopedEvalExpr(i,o)},r.prototype.visitWithRef=function(t){return t},r.prototype.visitTransformTableRef=function(t){return t},r.prototype.visitTransformOutputRoleRef=function(t){return t},r.prototype.visitFillRule=function(e){var r=e.input,i=r.accept(this),n=e.rule,o=n.linearGradient2,a=o;o&&(a=this.visitLinearGradient2(o));var u=n.linearGradient3,s=u;if(u&&(s=this.visitLinearGradient3(u)),r!==i||o!==a||u!==s){var c={};return a&&(c.linearGradient2=a),s&&(c.linearGradient3=s),new t.SQFillRuleExpr(i,c)}return e},r.prototype.visitLinearGradient2=function(t){var e=t.min,r=this.visitFillRuleStop(e),i=t.max,n=this.visitFillRuleStop(i);return e!==r||i!==n?{min:r,max:n}:t},r.prototype.visitLinearGradient3=function(t){var e=t.min,r=this.visitFillRuleStop(e),i=t.mid,n=this.visitFillRuleStop(i),o=t.max,a=this.visitFillRuleStop(o);return e!==r||i!==n||o!==a?{min:r,mid:n,max:a}:t},r.prototype.visitFillRuleStop=function(t){var e=t.color,r=t.color.accept(this),i=t.value,n=i;if(i&&(n=i.accept(this)),e!==r||i!==n){var o={color:r};return n&&(o.value=n),o}return t},r.prototype.visitResourcePackageItem=function(t){return t},r}();t.SQExprRewriter=r}(e=t.data||(t.data={}))}(r||(r={}))},404:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e;!function(e){function r(t){return t.accept(new n)}e.run=r;var n=function(e){function r(){e.call(this)}return i(r,e),r.prototype.visitCompare=function(e){if(e.comparison!==t.QueryComparisonKind.Equal)return this.visitUnsupported(e);if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var r=this.isComparand(e.left),i=this.isComparand(e.right);if(r===i)return this.visitUnsupported(e);var n=r?e.left:e.right,o=r?e.right:e.left,a=this.current;return a?(a.add(n,o),e):t.SQExprBuilder.inExpr([n],[[o]])},r.prototype.visitOr=function(t){if(!this.isSupported(t.left)||!this.isSupported(t.right))return this.visitUnsupported(t);var e;return this.current||(e=this.current=new o),t.left.accept(this),t.right.accept(this),e?(this.current=null,e.complete()||t):t},r.prototype.visitAnd=function(t){if(!this.isSupported(t.left)||!this.isSupported(t.right))return this.visitUnsupported(t);var r=this.current;return r?(r.cancel(),t):e.prototype.visitAnd.call(this,t)},r.prototype.visitUnsupported=function(t){var e=this.current;return e&&e.cancel(),t},r.prototype.isSupported=function(e){return e instanceof t.SQCompareExpr||e instanceof t.SQColumnRefExpr||e instanceof t.SQConstantExpr||e instanceof t.SQHierarchyLevelExpr||e instanceof t.SQOrExpr||e instanceof t.SQAndExpr},r.prototype.isComparand=function(e){return e instanceof t.SQColumnRefExpr||e instanceof t.SQHierarchyLevelExpr},r}(t.SQExprRewriter),o=function(){function e(){}return e.prototype.add=function(e,r){if(!this.cancelled){if(this.operand&&!t.SQExpr.equals(e,this.operand))return void this.cancel();this.operand=e;var i=this.values;i||(i=this.values=[]),i.push(r)}},e.prototype.cancel=function(){this.cancelled=!0},e.prototype.complete=function(){return!this.cancelled&&this.operand?t.SQExprBuilder.inExpr([this.operand],_.map(this.values,function(t){return[t]})):void 0},e}()}(e=t.EqualsToInRewriter||(t.EqualsToInRewriter={}))}(e=t.data||(t.data={}))}(r||(r={}))},405:function(t,e){var r,i=window.jsCommon,r=window.powerbi,n=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(e){var r;!function(t){function e(t,e){var r=t.conditions(),i=r[0];if(i){var n=new o(e);if(i.accept(n))return n.getResult()}}function r(t){var e=t.expr.accept(new a);return e?e.value:void 0}t.asScopeIdsContainer=e,t.getFirstComparandValue=r}(r=e.SQExprConverter||(e.SQExprConverter={}));var o=function(r){function o(t){r.call(this),this.isRoot=!0,this.isNot=!1,this.keyExprsCount=null,this.valueExprs=[],this.fieldExprs=[];for(var i=0,n=t;i<n.length;i++){var o=n[i];this.fieldExprs.push(e.SQExprBuilder.removeEntityVariables(o))}}return n(o,r),o.prototype.getResult=function(){for(var e=this.valueExprs,r=[],n=this.keyExprsCount||1,a=0,u=n,s=e.length;s>a&&s>=u;){var c=e.slice(a,u),l=o.getScopeIdentity(this.fieldExprs,c);i.ArrayExtensions.isInArray(r,l,t.DataViewScopeIdentity.equals)||r.push(l),a+=n,u+=n}return{isNot:this.isNot,scopeIds:r}},o.getScopeIdentity=function(t,r){for(var i,n=0,o=t.length;o>n;n++){var a=e.SQExprBuilder.equal(t[n],r[n]);i=i?e.SQExprBuilder.and(i,a):a}return e.createDataViewScopeIdentity(i)},o.prototype.visitOr=function(t){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,t.left.accept(this)&&t.right.accept(this))},o.prototype.visitNot=function(t){return this.isRoot?(this.isNot=!0,t.arg.accept(this)):this.unsupportedSQExpr()},o.prototype.visitConstant=function(e){return this.isRoot&&e.type.primitiveType===t.PrimitiveType.Null?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},o.prototype.visitCompare=function(t){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,t.comparison!==e.QueryComparisonKind.Equal?this.unsupportedSQExpr():t.left.accept(this)&&t.right.accept(this))},o.prototype.visitIn=function(t){this.keyExprsCount=0;var e;this.isRoot=!1;for(var r=0,i=t.args;r<i.length;r++){var n=i[r];if(e=n.accept(this),!e)return this.unsupportedSQExpr();this.keyExprsCount++}if(this.keyExprsCount!==this.fieldExprs.length)return this.unsupportedSQExpr();for(var o=t.values,a=0,u=o;a<u.length;a++)for(var s=u[a],c=(s.length,0),l=s;c<l.length;c++){var p=l[c];if(e=p.accept(this),!e)return this.unsupportedSQExpr()}return e},o.prototype.visitColumnRef=function(t){if(this.isRoot)return this.unsupportedSQExpr();var r=e.SQExprBuilder.removeEntityVariables(t);return null!==this.keyExprsCount?e.SQExpr.equals(this.fieldExprs[this.keyExprsCount],r):e.SQExpr.equals(this.fieldExprs[0],r)},o.prototype.visitDefaultValue=function(t){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(t),!0)},o.prototype.visitAnyValue=function(t){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(t),!0)},o.prototype.visitDefault=function(t){return this.unsupportedSQExpr()},o.prototype.unsupportedSQExpr=function(){return!1},o}(e.DefaultSQExprVisitor),a=function(t){function r(){t.apply(this,arguments)}return n(r,t),r.prototype.visitAnd=function(t){return t.left.accept(this)||t.right.accept(this)},r.prototype.visitCompare=function(t){if(t.comparison===e.QueryComparisonKind.Equal){if(t.right instanceof e.SQConstantExpr)return t.right;if(t.left instanceof e.SQConstantExpr)return t.left}},r}(e.DefaultSQExprVisitor)}(e=t.data||(t.data={}))}(r||(r={}))},406:function(t,e){var r,i=window.jsCommon,r=window.powerbi,n=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e,r=i.ArrayExtensions;!function(e){function i(t){var e=new u;return t.accept(e),e.malformed?null:r.emptyToNull(e.keys)}function o(t){var e=new u;return t.accept(e),e.malformed?null:r.emptyToNull(e.values)}function a(e){var i=new u;if(e.accept(i),!i.malformed){var n=r.emptyToNull(i.keys),o=r.emptyToNull(i.values);return n&&o?t.SQExprBuilder.inExpr(n,[o]):void 0}}e.getKeys=i,e.getValues=o,e.getInExpr=a;var u=function(e){function r(){e.apply(this,arguments),this.keys=[],this.values=[]}return n(r,e),r.prototype.visitAnd=function(t){t.left.accept(this),t.right.accept(this)},r.prototype.visitCompare=function(e){return e.comparison!==t.QueryComparisonKind.Equal?void this.visitDefault(e):(e.left.accept(this),void e.right.accept(this))},r.prototype.visitColumnRef=function(t){this.keys.push(t)},r.prototype.visitHierarchyLevel=function(t){this.keys.push(t)},r.prototype.visitConstant=function(t){this.values.push(t)},r.prototype.visitArithmetic=function(t){this.keys.push(t)},r.prototype.visitDefault=function(t){this.malformed=!0},r}(t.DefaultSQExprVisitor)}(e=t.ScopeIdentityExtractor||(t.ScopeIdentityExtractor={}))}(e=t.data||(t.data={}))}(r||(r={}))},407:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(t){function e(t){return t+"M"}function r(t){return t+"D"}function n(t){return t+"L"}function o(t){var e=new Date(t.getTime()-6e4*t.getTimezoneOffset()),r=e.toISOString();return i.StringExtensions.endsWith(r,"Z")&&(r=r.substr(0,r.length-1)),"datetime'"+r+"'"}function a(t){return"'"+t.replace(c,"''")+"'"}function u(){return"null"}function s(t){return t?"true":"false"}var c=/'/g;t.decimal=e,t["double"]=r,t.integer=n,t.dateTime=o,t.text=a,t.nullEncoding=u,t["boolean"]=s}(e=t.PrimitiveValueEncoding||(t.PrimitiveValueEncoding={}))}(e=t.data||(t.data={}))}(r||(r={}))},408:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(t){return new o(t)}function i(t,r){var i=e.SQExprBuilder.removeAggregate(t).getMetadata(r);return i||(i=t.getMetadata(r)),i}var n=t.data.QueryAggregateFunction;e.createSQAggregationOperations=r;var o=function(){function r(t){this.datetimeMinMaxSupported=t}return r.prototype.getSupportedAggregates=function(r,o,a){var u=i(r,o);if(!u)return[];var s=u.type,c=u.kind,l=u.idOnEntityKey;if(!s)return[];if(1===c)return[];if(s.numeric||s.integer){var p=[n.Sum,n.Avg,n.Min,n.Max,n.Count,n.CountNonNull,n.StandardDeviation,n.Variance],f=e.SQExprConverter.asFieldPattern(r),d=e.FieldExprPattern.toFieldExprEntityItemPattern(f),v=o.schema(d.schema);return v.capabilities.supportsMedian&&p.push(n.Median),p}var h=[];this.datetimeMinMaxSupported&&s.dateTime&&(_.isEmpty(a)||t.ValueType.isCompatibleTo(s,a))&&(h.push(n.Min),h.push(n.Max));var m=e.SQExprInfo.getAggregate(r)===n.Count;return l&&!m||h.push(n.Count),h.push(n.CountNonNull),h},r.prototype.isSupportedAggregate=function(t,e,r,i){var n=this.getSupportedAggregates(t,e,i);return _.contains(n,r)},r.prototype.createExprWithAggregate=function(t,r,i,n,o){var a;return a=null!=o&&this.isSupportedAggregate(t,r,o,n)?o:t.getDefaultAggregate(r,i),void 0!==a&&(t=e.SQExprBuilder.aggregate(t,a)),t},r}()}(e=t.data||(t.data={}))}(r||(r={}))},409:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(e){function o(r,i){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(i),o=i.hierarchyLevel||i.hierarchyLevelAggr;return o?e.getConceptualHierarchyLevel(r,n.schema,n.entity,o.name,o.level):void 0}function a(t,e,r,i,n){var o=t.schema(e),a=o.findHierarchy(r,i);return a?a.levels.withName(n):void 0}function u(e,r){if(e instanceof t.SQHierarchyExpr){var i=e;if(e.arg instanceof t.SQEntityExpr){var n=e.arg;return r.schema(n.schema).findHierarchy(n.entity,i.hierarchy)}if(e.arg instanceof t.SQPropertyVariationSourceExpr){var o=e.arg,a=o.arg;return r.schema(a.schema).findHierarchyByVariation(a.entity,o.property,o.name,i.hierarchy)}}}function s(t,e,o){return r.convert(e,t)||n.expand(e,t)||!o&&i.expand(e,t)||e}function c(e,r){if(r instanceof t.SQHierarchyExpr||r instanceof t.SQHierarchyLevelExpr)return!0;var i=r.getConceptualProperty(e);if(i){var n=i.column;if(n&&n.variations&&n.variations.length>0)return!0}return!1}function l(e){var r=t.SQExprConverter.asFieldPattern(e);if(r.columnHierarchyLevelVariation){var i=t.SQExprBuilder.entity(r.columnHierarchyLevelVariation.source.schema,r.columnHierarchyLevelVariation.source.entity);return t.SQExprBuilder.columnRef(i,r.columnHierarchyLevelVariation.source.name)}}function p(e){var r=t.SQExprConverter.asFieldPattern(e),i=r.hierarchyLevel;if(i){var n=t.SQExprBuilder.entity(i.schema,i.entity,i.entityVar);return t.SQExprBuilder.hierarchy(n,i.name)}}function f(e){if(e.arg instanceof t.SQHierarchyExpr){var r=e.arg;return r.arg instanceof t.SQPropertyVariationSourceExpr?r.arg:void 0}}function d(e,r,i){if(!(r instanceof t.SQHierarchyLevelExpr&&i instanceof t.SQHierarchyLevelExpr))return!1;var n=r,o=i;if(!t.SQExpr.equals(n.arg,o.arg))return!1;var a=t.SQExprUtils.indexOfExpr(e,n),u=t.SQExprUtils.indexOfExpr(e,o);return-1!==a&&-1!==u&&u>a}function v(t,e,r){for(var i=0;i<e.length&&d(t,e[i],r);)i++;return i}e.getConceptualHierarchyLevelFromExpr=o,e.getConceptualHierarchyLevel=a,e.getConceptualHierarchy=u,e.expandExpr=s,e.isHierarchyOrVariation=c,e.getSourceVariationExpr=l,e.getSourceHierarchy=p,e.getHierarchySourceAsVariationSource=f,e.areHierarchyLevelsOrdered=d,e.getInsertionIndex=v}(e=t.SQHierarchyExprUtils||(t.SQHierarchyExprUtils={}));var r;!function(r){function i(r,i){if(r instanceof t.SQHierarchyExpr){var n=r,o=e.getConceptualHierarchy(n,i);if(o)return _.map(o.levels,function(e){return t.SQExprBuilder.hierarchyLevel(r,e.name)})}}r.convert=i}(r=t.SQExprHierarchyToHierarchyLevelConverter||(t.SQExprHierarchyToHierarchyLevelConverter={}));var i;!function(e){function r(e,r){var i=[];if(e instanceof t.SQHierarchyLevelExpr){var n=t.SQExprConverter.asFieldPattern(e);if(n.hierarchyLevel){var o=t.FieldExprPattern.toFieldExprEntityItemPattern(n),a=r.schema(o.schema).findHierarchy(o.entity,n.hierarchyLevel.name);if(a)for(var u=a.levels,s=0,c=u;s<c.length;s++){var l=c[s];if(l.name===n.hierarchyLevel.level){i.push(e);break}i.push(t.SQExprBuilder.hierarchyLevel(t.SQExprBuilder.hierarchy(t.SQExprBuilder.entity(o.schema,o.entity,o.entityVar),a.name),l.name))}}}return _.isEmpty(i)?void 0:i}e.expand=r}(i||(i={}));var n;!function(e){function r(e,r){var i,n=e.getConceptualProperty(r);if(n){var o=n.column;if(o&&o.variations&&o.variations.length>0){var a=o.variations,u=a[0],s=t.SQExprConverter.asFieldPattern(e),c=t.FieldExprPattern.toFieldExprEntityItemPattern(s);if(i=[],u.defaultHierarchy)for(var l=t.SQExprBuilder.hierarchy(t.SQExprBuilder.propertyVariationSource(t.SQExprBuilder.entity(c.schema,c.entity,c.entityVar),u.name,n.name),u.defaultHierarchy.name),p=0,f=u.defaultHierarchy.levels;p<f.length;p++){var d=f[p];i.push(t.SQExprBuilder.hierarchyLevel(l,d.name))}}}return i}e.expand=r}(n||(n={}))}(e=t.data||(t.data={}))}(r||(r={}))},410:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e;!function(e){function r(e,r){for(var n=[],o=0,a=r.length;a>o;o++){var u=r[o];u instanceof t.SQHierarchyLevelExpr?i(e,n,u,o):n.push({expr:u,children:null,selectQueryIndex:o})}return n}function i(e,r,i,n){var o=!0,a=t.SQHierarchyExprUtils.getSourceVariationExpr(i)||t.SQHierarchyExprUtils.getSourceHierarchy(i),u=_.last(r);if(u&&u.children&&t.SQExpr.equals(u.expr,a)){var s=t.SQHierarchyExprUtils.expandExpr(e,i.arg);if(s instanceof Array){var c=s;o=!t.SQHierarchyExprUtils.areHierarchyLevelsOrdered(c,_.last(u.children),i);
}}o?r.push({expr:a,children:[i],selectQueryIndex:n}):u.children.push(i)}e.groupExprs=r}(e=t.SQExprGroupUtils||(t.SQExprGroupUtils={}))}(e=t.data||(t.data={}))}(r||(r={}))},411:function(t,e){var r,i=window.jsCommon,r=window.powerbi,n=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(e){function r(t){return t.integer||t.numeric?e.QueryAggregateFunction.Sum:e.QueryAggregateFunction.Count}function o(t){switch(t){case 6:return e.QueryAggregateFunction.Avg;case 3:return e.QueryAggregateFunction.CountNonNull;case 7:return e.QueryAggregateFunction.Count;case 5:return e.QueryAggregateFunction.Max;case 4:return e.QueryAggregateFunction.Min;case 2:return e.QueryAggregateFunction.Sum;default:return}}var a=i.StringExtensions,u=function(){function i(t){this._kind=t}return i.equals=function(t,e,r){return H.run(t,e,r)},i.prototype.validate=function(t,e,r){var i=new G(t,e,r);return this.accept(i),i.errors},i.prototype.accept=function(t,e){},Object.defineProperty(i.prototype,"kind",{get:function(){return this._kind},enumerable:!0,configurable:!0}),i.isArithmetic=function(t){return 22===t.kind},i.isColumn=function(t){return 1===t.kind},i.isConstant=function(t){return 16===t.kind},i.isEntity=function(t){return 0===t.kind},i.isHierarchy=function(t){return 5===t.kind},i.isHierarchyLevel=function(t){return 6===t.kind},i.isAggregation=function(t){return 3===t.kind},i.isMeasure=function(t){return 2===t.kind},i.isSelectRef=function(t){return 28===t.kind},i.isScopedEval=function(t){return 25===t.kind},i.isWithRef=function(t){return 26===t.kind},i.isTransformTableRef=function(t){return 29===t.kind},i.isTransformOutputRoleRef=function(t){return 30===t.kind},i.isResourcePackageItem=function(t){return 24===t.kind},i.prototype.getMetadata=function(t){var r=e.SQExprConverter.asFieldPattern(this);if(r)return r.column||r.columnAggr||r.measure?this.getMetadataForProperty(r,t):r.hierarchyLevel||r.hierarchyLevelAggr?this.getMetadataForHierarchyLevel(r,t):r.columnHierarchyLevelVariation?this.getMetadataForVariation(r,t):r.percentOfGrandTotal?this.getMetadataForPercentOfGrandTotal():i.getMetadataForEntity(r,t)},i.prototype.getDefaultAggregate=function(t,i){void 0===i&&(i=!1);var n=this.getConceptualProperty(t)||this.getHierarchyLevelConceptualProperty(t);if(n){var a;if(n&&0===n.kind){var u=n.column?n.column.defaultAggregate:null;(n.type.integer||n.type.numeric)&&1!==u&&(a=o(u),void 0===a&&(a=r(n.type))),void 0===a&&i&&(a=e.QueryAggregateFunction.CountNonNull)}return a}},i.prototype.getKeyColumns=function(t){var e=J.getColumnRefSQExpr(t,this);if(e){var r=[],i=this.getPropertyKeys(t);if(i&&i.length>0)for(var n=0,o=i.length;o>n;n++)r.push(q.columnRef(e.source,i[n].name));else r.push(e);return r}},i.prototype.hasGroupOnKeys=function(t){var e=J.getColumnRefSQExpr(t,this);if(e){var r=this.getPropertyKeys(t);if(!r||r.length<1)return!1;if(r.length>1)return!0;var n=q.columnRef(e.source,r[0].name);return!i.equals(n,this)}},i.prototype.getPropertyKeys=function(t){var e=this.getConceptualProperty(t)||this.getHierarchyLevelConceptualProperty(t);if(e)return e.column?e.column.keys:void 0},i.prototype.getConceptualProperty=function(t){var r=e.SQExprConverter.asFieldPattern(this);if(r){var i=e.FieldExprPattern.toFieldExprEntityItemPattern(r),n=e.FieldExprPattern.getPropertyName(r);return n?t.schema(i.schema).findProperty(i.entity,n):void 0}},i.prototype.getTargetEntityForVariation=function(t,e){var r=this.getConceptualProperty(t);if(r&&r.column&&!_.isEmpty(r.column.variations))for(var i=r.column.variations,n=0,o=i;n<o.length;n++){var a=o[n];if(a.name===e)return a.navigationProperty.targetEntity.name}},i.prototype.getTargetEntity=function(t){return Y.getEntityExpr(t,this)},i.prototype.getHierarchyLevelConceptualProperty=function(t){var r=e.SQExprConverter.asFieldPattern(this);if(r){var i=r.hierarchyLevel||r.hierarchyLevelAggr;if(i){var n=e.FieldExprPattern.toFieldExprEntityItemPattern(r),o=t.schema(n.schema).findHierarchy(n.entity,i.name);if(o){var a=o.levels.withName(i.level);if(a)return a.column}}}},i.prototype.getMetadataForVariation=function(t,r){var i=t.columnHierarchyLevelVariation,n=e.FieldExprPattern.toFieldExprEntityItemPattern(t),o=r.schema(n.schema).findProperty(n.entity,i.source.name);if(o&&o.column&&o.column.variations)for(var a=0,u=o.column.variations;a<u.length;a++){var s=u[a];if(s.defaultHierarchy&&s.defaultHierarchy.levels)for(var c=0,l=s.defaultHierarchy.levels;c<l.length;c++){var p=l[c];if(p.name===i.level.level){var f=p.column;return{kind:1===f.kind?1:0,type:f.type,format:f.format,idOnEntityKey:f.column?f.column.idOnEntityKey:!1,defaultAggregate:f.column?f.column.defaultAggregate:null}}}}},i.prototype.getMetadataForHierarchyLevel=function(t,e){var r=this.getHierarchyLevelConceptualProperty(e);if(r)return this.getPropertyMetadata(t,r)},i.prototype.getMetadataForPercentOfGrandTotal=function(){return{kind:1,format:"#,##0.00%",type:t.ValueType.fromExtendedType(t.ExtendedType.Double)}},i.prototype.getPropertyMetadata=function(r,i){var n=i.format,o=i.type,a=r.columnAggr||r.hierarchyLevelAggr;if(a)switch(a.aggregate){case e.QueryAggregateFunction.Count:case e.QueryAggregateFunction.CountNonNull:o=t.ValueType.fromExtendedType(t.ExtendedType.Integer),n=void 0;break;case e.QueryAggregateFunction.Avg:o.integer&&(o=t.ValueType.fromExtendedType(t.ExtendedType.Double))}return{kind:1===i.kind||a&&void 0!==a.aggregate?1:0,type:o,format:n,idOnEntityKey:i.column?i.column.idOnEntityKey:!1,aggregate:a?a.aggregate:void 0,defaultAggregate:i.column?i.column.defaultAggregate:null}},i.prototype.getMetadataForProperty=function(t,e){var r=this.getConceptualProperty(e);if(r)return this.getPropertyMetadata(t,r)},i.getMetadataForEntity=function(r,i){var n=e.FieldExprPattern.toFieldExprEntityItemPattern(r),o=i.schema(n.schema).entities.withName(n.entity);if(o&&r.entityAggr)switch(r.entityAggr.aggregate){case e.QueryAggregateFunction.Count:case e.QueryAggregateFunction.CountNonNull:return{kind:1,type:t.ValueType.fromExtendedType(t.ExtendedType.Integer),format:void 0,idOnEntityKey:!1,aggregate:r.entityAggr.aggregate}}},i}();e.SQExpr=u,e.defaultAggregateForDataType=r,e.defaultAggregateToQueryAggregateFunction=o;var s=function(t){function e(e,r,i){t.call(this,0),this.schema=e,this.entity=r,i&&(this.variable=i)}return n(e,t),e.prototype.accept=function(t,e){return t.visitEntity(this,e)},e}(u);e.SQEntityExpr=s;var c=function(t){function e(e,r,i){t.call(this,22),this.left=e,this.right=r,this.operator=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitArithmetic(this,e)},e}(u);e.SQArithmeticExpr=c;var l=function(t){function e(e,r){t.call(this,25),this.expression=e,this.scope=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitScopedEval(this,e)},e.prototype.getMetadata=function(t){return this.expression.getMetadata(t)},e}(u);e.SQScopedEvalExpr=l;var p=function(t){function e(e){t.call(this,26),this.expressionName=e}return n(e,t),e.prototype.accept=function(t,e){return t.visitWithRef(this,e)},e}(u);e.SQWithRefExpr=p;var f=function(t){function e(e,r,i){t.call(this,e),this.source=r,this.ref=i}return n(e,t),e}(u);e.SQPropRefExpr=f;var d=function(t){function e(e,r){t.call(this,1,e,r)}return n(e,t),e.prototype.accept=function(t,e){return t.visitColumnRef(this,e)},e}(f);e.SQColumnRefExpr=d;var v=function(t){function e(e,r){t.call(this,2,e,r)}return n(e,t),e.prototype.accept=function(t,e){return t.visitMeasureRef(this,e)},e}(f);e.SQMeasureRefExpr=v;var h=function(t){function e(e,r){t.call(this,3),this.arg=e,this.func=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitAggr(this,e)},e}(u);e.SQAggregationExpr=h;var m=function(t){function e(e,r,i){t.call(this,27),this.arg=e,this.k=r,this.exclusive=i}return n(e,t),e.prototype.getMetadata=function(t){var e=this.arg.getMetadata(t);return e?{kind:1,type:e.type}:void 0},e.prototype.accept=function(t,e){return t.visitPercentile(this,e)},e}(u);e.SQPercentileExpr=m;var g=function(t){function e(e,r,i){t.call(this,4),this.arg=e,this.name=r,this.property=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitPropertyVariationSource(this,e)},e}(u);e.SQPropertyVariationSourceExpr=g;var y=function(t){function e(e,r){t.call(this,5),this.arg=e,this.hierarchy=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitHierarchy(this,e)},e}(u);e.SQHierarchyExpr=y;var w=function(t){function e(e,r){t.call(this,6),this.arg=e,this.level=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitHierarchyLevel(this,e)},e}(u);e.SQHierarchyLevelExpr=w;var x=function(t){function e(e){t.call(this,28),this.expressionName=e}return n(e,t),e.prototype.accept=function(t,e){return t.visitSelectRef(this,e)},e}(u);e.SQSelectRefExpr=x;var b=function(t){function e(e,r){t.call(this,7),this.left=e,this.right=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitAnd(this,e)},e}(u);e.SQAndExpr=b;var S=function(t){function e(e,r,i){t.call(this,8),this.arg=e,this.lower=r,this.upper=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitBetween(this,e)},e}(u);e.SQBetweenExpr=S;var E=function(t){function e(e,r){t.call(this,9),this.args=e,this.values=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitIn(this,e)},e}(u);e.SQInExpr=E;var D=function(t){function e(e,r){t.call(this,10),this.left=e,this.right=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitOr(this,e)},e}(u);e.SQOrExpr=D;var C=function(t){function e(e,r,i){t.call(this,12),this.comparison=e,this.left=r,this.right=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitCompare(this,e)},e}(u);e.SQCompareExpr=C;var T=function(t){function e(e,r){t.call(this,11),this.left=e,this.right=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitContains(this,e)},e}(u);e.SQContainsExpr=T;var V=function(t){function e(e,r){t.call(this,13),this.left=e,this.right=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitStartsWith(this,e)},e}(u);e.SQStartsWithExpr=V;var M=function(t){function e(e){t.call(this,14),this.arg=e}return n(e,t),e.prototype.accept=function(t,e){return t.visitExists(this,e)},e}(u);e.SQExistsExpr=M;var F=function(t){function e(e){t.call(this,15),this.arg=e}return n(e,t),e.prototype.accept=function(t,e){return t.visitNot(this,e)},e}(u);e.SQNotExpr=F;var R=function(t){function e(e,r,i){t.call(this,16),this.type=e,this.value=r,this.valueEncoded=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitConstant(this,e)},e.prototype.getMetadata=function(t){return{kind:1,type:this.type}},e}(u);e.SQConstantExpr=R;var P=function(t){function e(e,r){t.call(this,17),this.unit=e,this.arg=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitDateSpan(this,e)},e}(u);e.SQDateSpanExpr=P;var I=function(t){function e(e,r,i){t.call(this,18),this.unit=e,this.arg=i,this.amount=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitDateAdd(this,e)},e}(u);e.SQDateAddExpr=I;var A=function(t){function e(){t.call(this,19)}return n(e,t),e.prototype.accept=function(t,e){return t.visitNow(this,e)},e}(u);e.SQNowExpr=A;var j=function(t){function e(){t.call(this,21)}return n(e,t),e.prototype.accept=function(t,e){return t.visitDefaultValue(this,e)},e}(u);e.SQDefaultValueExpr=j;var N=function(t){function e(){t.call(this,20)}return n(e,t),e.prototype.accept=function(t,e){return t.visitAnyValue(this,e)},e}(u);e.SQAnyValueExpr=N;var O=function(t){function e(e,r){t.call(this,23),this.input=e,this.rule=r}return n(e,t),e.prototype.accept=function(t,e){return t.visitFillRule(this,e)},e}(u);e.SQFillRuleExpr=O;var Q=function(t){function e(e,r,i){t.call(this,24),this.packageName=e,this.packageType=r,this.itemName=i}return n(e,t),e.prototype.accept=function(t,e){return t.visitResourcePackageItem(this,e)},e}(u);e.SQResourcePackageItemExpr=Q;var U=function(t){function e(e){t.call(this,29),this.source=e}return n(e,t),e.prototype.accept=function(t,e){return t.visitTransformTableRef(this,e)},e}(u);e.SQTransformTableRefExpr=U;var L=function(t){function e(e,r){t.call(this,30),this.role=e,r&&(this.transform=r)}return n(e,t),e.prototype.accept=function(t,e){return t.visitTransformOutputRoleRef(this,e)},e}(u);e.SQTransformOutputRoleRefExpr=L;var q;!function(r){function i(t,e,r){return new s(t,e,r)}function n(t,e){return new d(t,e)}function o(t,e){return new v(t,e)}function a(t,e){return new h(t,e)}function f(t){return new x(t)}function q(t,e,r){return new m(t,e,r)}function k(t,e,r){return new c(t,e,r)}function H(t,e){return new l(t,e)}function B(t){return new p(t)}function G(t,e){return new y(t,e)}function W(t,e,r){return new g(t,e,r)}function J(t,e){return new w(t,e)}function Y(t){return new U(t)}function K(t,e){return new L(t,e)}function Z(t,e){return t?e?new b(t,e):t:e}function rt(t,e,r){return new S(t,e,r)}function it(t,e){return new E(t,e)}function nt(t,e){if(!t)return e;if(!e)return t;if(t instanceof E&&e instanceof E){var r=ot(t,e);if(r)return r}return new D(t,e)}function ot(t,e){if(t.args&&e.args){var i=t.args.length,n=e.args.length;if(i===n){for(var o=0;i>o;++o)if(!u.equals(t.args[o],e.args[o]))return;var a=t.values.concat(e.values);return r.inExpr(t.args,a)}}}function at(t,e,r){return new C(t,e,r)}function ut(t,e){return new T(t,e)}function st(t){return new M(t)}function ct(t,r){return at(e.QueryComparisonKind.Equal,t,r)}function lt(t){return new F(t)}function pt(t,e){return new V(t,e)}function ft(){return new R(t.ValueType.fromExtendedType(t.ExtendedType.Null),null,e.PrimitiveValueEncoding.nullEncoding())}function dt(){return new A}function vt(){return new j}function ht(){return new N}function mt(r){return new R(t.ValueType.fromExtendedType(t.ExtendedType.Boolean),r,e.PrimitiveValueEncoding["boolean"](r))}function gt(t,e,r){return new I(t,e,r)}function yt(r,i){return void 0===i&&(i=e.PrimitiveValueEncoding.dateTime(r)),new R(t.ValueType.fromExtendedType(t.ExtendedType.DateTime),r,i)}function wt(t,e){return new P(t,e)}function xt(r,i){return void 0===i&&(i=e.PrimitiveValueEncoding.decimal(r)),new R(t.ValueType.fromExtendedType(t.ExtendedType.Decimal),r,i)}function bt(r,i){return void 0===i&&(i=e.PrimitiveValueEncoding["double"](r)),new R(t.ValueType.fromExtendedType(t.ExtendedType.Double),r,i)}function St(r,i){return void 0===i&&(i=e.PrimitiveValueEncoding.integer(r)),new R(t.ValueType.fromExtendedType(t.ExtendedType.Integer),r,i)}function Et(r,i){return new R(t.ValueType.fromExtendedType(t.ExtendedType.Text),r,i||e.PrimitiveValueEncoding.text(r))}function Dt(e,r){return null==e?ft():_.isBoolean(e)?mt(e):_.isString(e)?Et(e):_.isNumber(e)?r.integer&&t.Double.isInteger(e)?St(e):bt(e):e instanceof Date?yt(e):void 0}function Ct(t,e){return z.rewrite(t,e)}function Tt(t){return X.rewrite(t)}function Vt(t){return et.rewrite(t)}function Mt(t){return tt.rewrite(t)}function Ft(t){return $.rewrite(t)}function Rt(t,e){return new O(t,e)}function Pt(t,e,r){return new Q(t,e,r)}r.entity=i,r.columnRef=n,r.measureRef=o,r.aggregate=a,r.selectRef=f,r.percentile=q,r.arithmetic=k,r.scopedEval=H,r.withRef=B,r.hierarchy=G,r.propertyVariationSource=W,r.hierarchyLevel=J,r.transformTableRef=Y,r.transformOutputRoleRef=K,r.and=Z,r.between=rt,r.inExpr=it,r.or=nt,r.compare=at,r.contains=ut,r.exists=st,r.equal=ct,r.not=lt,r.startsWith=pt,r.nullConstant=ft,r.now=dt,r.defaultValue=vt,r.anyValue=ht,r["boolean"]=mt,r.dateAdd=gt,r.dateTime=yt,r.dateSpan=wt,r.decimal=xt,r["double"]=bt,r.integer=St,r.text=Et,r.typedConstant=Dt,r.setAggregate=Ct,r.removeAggregate=Tt,r.setPercentOfGrandTotal=Vt,r.removePercentOfGrandTotal=Mt,r.removeEntityVariables=Ft,r.fillRule=Rt,r.resourcePackageItem=Pt}(q=e.SQExprBuilder||(e.SQExprBuilder={}));var k;!function(t){function e(t){return W.getAggregate(t)}t.getAggregate=e}(k=e.SQExprInfo||(e.SQExprInfo={}));var H=function(){function t(t){this.ignoreCase=t}return t.run=function(e,r,i){return e=e||null,r=r||null,e===r?!0:!e!=!r?!1:i?e.accept(t.ignoreCaseInstance,r):e.accept(t.instance,r)},t.prototype.visitColumnRef=function(t,e){return e instanceof d&&t.ref===e.ref&&this.equals(t.source,e.source)},t.prototype.visitMeasureRef=function(t,e){return e instanceof v&&t.ref===e.ref&&this.equals(t.source,e.source)},t.prototype.visitAggr=function(t,e){return e instanceof h&&t.func===e.func&&this.equals(t.arg,e.arg)},t.prototype.visitPercentile=function(t,e){return e instanceof m&&t.exclusive===e.exclusive&&t.k===e.k&&this.equals(t.arg,e.arg)},t.prototype.visitHierarchy=function(t,e){return e instanceof y&&t.hierarchy===e.hierarchy&&this.equals(t.arg,e.arg)},t.prototype.visitHierarchyLevel=function(t,e){return e instanceof w&&t.level===e.level&&this.equals(t.arg,e.arg)},t.prototype.visitPropertyVariationSource=function(t,e){return e instanceof g&&t.name===e.name&&t.property===e.property&&this.equals(t.arg,e.arg)},t.prototype.visitSelectRef=function(t,e){return e instanceof x&&t.expressionName===e.expressionName},t.prototype.visitBetween=function(t,e){return e instanceof S&&this.equals(t.arg,e.arg)&&this.equals(t.lower,e.lower)&&this.equals(t.upper,e.upper)},t.prototype.visitIn=function(t,e){if(!(e instanceof E&&this.equalsAll(t.args,e.args)))return!1;var r=t.values,i=e.values;if(r.length!==i.length)return!1;for(var n=0,o=r.length;o>n;n++)if(!this.equalsAll(r[n],i[n]))return!1;return!0},t.prototype.visitEntity=function(t,e){return e instanceof s&&t.schema===e.schema&&t.entity===e.entity&&this.optionalEqual(t.variable,e.variable)},t.prototype.visitAnd=function(t,e){return e instanceof b&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitOr=function(t,e){return e instanceof D&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitCompare=function(t,e){return e instanceof C&&t.comparison===e.comparison&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitContains=function(t,e){return e instanceof T&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitDateSpan=function(t,e){return e instanceof P&&t.unit===e.unit&&this.equals(t.arg,e.arg)},t.prototype.visitDateAdd=function(t,e){return e instanceof I&&t.unit===e.unit&&t.amount===e.amount&&this.equals(t.arg,e.arg)},t.prototype.visitExists=function(t,e){return e instanceof M&&this.equals(t.arg,e.arg)},t.prototype.visitNot=function(t,e){return e instanceof F&&this.equals(t.arg,e.arg)},t.prototype.visitNow=function(t,e){return e instanceof A},t.prototype.visitDefaultValue=function(t,e){return e instanceof j},t.prototype.visitAnyValue=function(t,e){return e instanceof N},t.prototype.visitResourcePackageItem=function(t,e){return e instanceof Q&&t.packageName===e.packageName&&t.packageType===e.packageType&&t.itemName===e.itemName},t.prototype.visitStartsWith=function(t,e){return e instanceof V&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitConstant=function(t,e){return e instanceof R&&t.type===e.type?t.type.text&&this.ignoreCase?a.equalIgnoreCase(t.valueEncoded,e.valueEncoded):t.valueEncoded===e.valueEncoded:!1},t.prototype.visitFillRule=function(t,e){if(e instanceof O&&this.equals(t.input,e.input)){var r=t.rule,i=e.rule;if(r===i)return!0;var n=r.linearGradient2,o=i.linearGradient2;if(n&&o)return this.visitLinearGradient2(n,o);var a=r.linearGradient3,u=i.linearGradient3;if(a&&u)return this.visitLinearGradient3(a,u)}return!1},t.prototype.visitLinearGradient2=function(t,e){return this.equalsFillRuleStop(t.min,e.min)&&this.equalsFillRuleStop(t.max,e.max)},t.prototype.visitLinearGradient3=function(t,e){return this.equalsFillRuleStop(t.min,e.min)&&this.equalsFillRuleStop(t.mid,e.mid)&&this.equalsFillRuleStop(t.max,e.max)},t.prototype.equalsFillRuleStop=function(t,e){return this.equals(t.color,e.color)?t.value?this.equals(t.value,e.value):t.value===e.value:!1},t.prototype.visitArithmetic=function(t,e){return e instanceof c&&t.operator===e.operator&&this.equals(t.left,e.left)&&this.equals(t.right,e.right)},t.prototype.visitScopedEval=function(t,e){return e instanceof l&&this.equals(t.expression,e.expression)&&this.equalsAll(t.scope,e.scope)},t.prototype.visitWithRef=function(t,e){return e instanceof p&&t.expressionName===e.expressionName},t.prototype.visitTransformTableRef=function(t,e){return e instanceof U&&t.source===e.source},t.prototype.visitTransformOutputRoleRef=function(t,e){return e instanceof L&&t.role===e.role&&t.transform===e.transform},t.prototype.optionalEqual=function(t,e){return t&&e?t===e:!0},t.prototype.equals=function(t,e){return t.accept(this,e)},t.prototype.equalsAll=function(t,e){var r=t.length;if(r!==e.length)return!1;for(var i=0;r>i;i++)if(!this.equals(t[i],e[i]))return!1;return!0},t.instance=new t(!1),t.ignoreCaseInstance=new t(!0),t}(),B=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.visitDefault=function(t){return t},e}(e.DefaultSQExprVisitor),G=function(t){function r(e,r,i){t.call(this),this.schema=e,this.aggrUtils=r,i&&(this.errors=i)}return n(r,t),r.prototype.visitIn=function(e){for(var r=t.prototype.visitIn.call(this,e),i=r.args,n=r.values,o=0,a=n;o<a.length;o++)for(var u=a[o],s=0,c=u.length;c>s;++s)this.validateCompatibleType(i[s],u[s]);return r},r.prototype.visitCompare=function(e){var r=t.prototype.visitCompare.call(this,e);return this.validateCompatibleType(r.left,r.right),r},r.prototype.visitColumnRef=function(t){var r=e.SQExprConverter.asFieldPattern(t);if(r){var i=e.FieldExprPattern.toFieldExprEntityItemPattern(r),n=this.validateEntity(i.schema,i.entity);if(n){var o=n.properties.withName(r.column.name);o&&0===o.kind&&this.isQueryable(r)||this.register(3)}}return t},r.prototype.visitMeasureRef=function(t){var r=e.SQExprConverter.asFieldPattern(t);if(r){var i=e.FieldExprPattern.toFieldExprEntityItemPattern(r),n=this.validateEntity(i.schema,i.entity);if(n){var o=n.properties.withName(r.measure.name);o&&1===o.kind&&this.isQueryable(r)||this.register(4)}}return t},r.prototype.visitAggr=function(e){var r=t.prototype.visitAggr.call(this,e),i=J.getColumnRefSQExpr(this.schema,r.arg);return i&&(this.aggrUtils.isSupportedAggregate(e,this.schema,e.func,null)||this.register(0)),r},r.prototype.visitHierarchy=function(t){var r=e.SQExprConverter.asFieldPattern(t);if(r){var i=r.hierarchy;i?this.validateHierarchy(i.schema,i.entity,i.name):this.register(5)}return t},r.prototype.visitHierarchyLevel=function(t){var r=e.SQExprConverter.asFieldPattern(t);if(r){var i=r.hierarchyLevel;i?this.validateHierarchyLevel(i.schema,i.entity,i.name,i.level):r.columnHierarchyLevelVariation||this.register(6)}return t},r.prototype.visitPercentile=function(t){if(t.arg.accept(this),_.isEmpty(this.errors)){var e=t.arg.getMetadata(this.schema);e&&0===e.kind&&e.type&&(e.type.integer||e.type.numeric)||this.register(10)}return t},r.prototype.visitEntity=function(t){return this.validateEntity(t.schema,t.entity),t},r.prototype.visitContains=function(t){return this.validateOperandsAndTypeForStartOrContains(t.left,t.right),t},r.prototype.visitStartsWith=function(t){return this.validateOperandsAndTypeForStartOrContains(t.left,t.right),t},r.prototype.visitArithmetic=function(t){return this.validateArithmeticTypes(t.left,t.right),t},r.prototype.visitScopedEval=function(t){for(var e=0,r=t.scope;e<r.length;e++){var i=r[e];u.isWithRef(i)||u.isColumn(i)||this.register(11)}return t},r.prototype.visitWithRef=function(t){return t},r.prototype.visitTransformTableRef=function(t){return t},r.prototype.visitTransformOutputRoleRef=function(t){return t},r.prototype.validateOperandsAndTypeForStartOrContains=function(t,e){t instanceof d?this.visitColumnRef(t):t instanceof w?this.visitHierarchyLevel(t):this.register(7),e instanceof R&&e.type.text?this.validateCompatibleType(t,e):this.register(8)},r.prototype.validateArithmeticTypes=function(t,r){e.SQExprUtils.supportsArithmetic(t,this.schema)||this.register(7),e.SQExprUtils.supportsArithmetic(r,this.schema)||this.register(8)},r.prototype.validateCompatibleType=function(t,e){var r=t.getMetadata(this.schema),i=r&&r.type,n=e.getMetadata(this.schema),o=n&&n.type;i&&o&&!i.isCompatibleFrom(o)&&this.register(9)},r.prototype.validateEntity=function(t,e){var r=this.schema.schema(t);if(r){var i=r.entities.withName(e);if(i)return i;this.register(2)}else this.register(1)},r.prototype.validateHierarchy=function(t,e,r){var i=this.validateEntity(t,e);if(i){var n=i.hierarchies.withName(r);if(n)return n;this.register(5)}},r.prototype.validateHierarchyLevel=function(t,e,r,i){var n=this.validateHierarchy(t,e,r);if(n){var o=n.levels.withName(i);if(o)return o;this.register(6)}},r.prototype.register=function(t){this.errors||(this.errors=[]),this.errors.push(t)},r.prototype.isQueryable=function(t){var r=e.FieldExprPattern.toFieldExprEntityItemPattern(t);if(t.hierarchyLevel||t.hierarchyLevelAggr){var i=e.SQHierarchyExprUtils.getConceptualHierarchyLevelFromExpr(this.schema,t);return i&&1!==i.column.queryable}return 1!==this.schema.schema(r.schema).findProperty(r.entity,e.FieldExprPattern.getPropertyName(t)).queryable},r}(e.SQExprRewriter);e.SQExprValidationVisitor=G;var W=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.visitAggr=function(t){return t.func},e.prototype.visitDefault=function(t){},e.getAggregate=function(t){var r=new e;return t.accept(r)},e}(e.DefaultSQExprVisitor),J=function(t){function r(e){t.call(this),this.schema=e}return n(r,t),r.prototype.visitColumnRef=function(t){return t},r.prototype.visitHierarchyLevel=function(t){var r=t.level,i=t.arg,n=i.accept(this);if(i&&i.arg instanceof g){var o=i.arg,a=n.getTargetEntityForVariation(this.schema,o.name);if(n&&a){var u=n.source.schema,s=q.entity(u,a),c=this.schema.schema(u).findHierarchy(a,i.hierarchy);if(c)for(var l=0,p=c.levels;l<p.length;l++){var f=p[l];if(f.name===r)return new d(s,f.column.name)}}}else{var v=i.arg,h=e.SQHierarchyExprUtils.getConceptualHierarchyLevel(this.schema,v.schema,v.entity,i.hierarchy,t.level);if(h)return new d(i.arg,h.column.name)}},r.prototype.visitHierarchy=function(t){return t.arg.accept(this)},r.prototype.visitPropertyVariationSource=function(t){var e=t.property;return new d(t.arg,e)},r.prototype.visitAggr=function(t){return t.arg.accept(this)},r.prototype.visitDefault=function(t){},r.getColumnRefSQExpr=function(t,e){var i=new r(t);return e.accept(i)},r}(e.DefaultSQExprVisitor),Y=function(t){function r(e){t.call(this),this.schema=e}return n(r,t),r.prototype.visitEntity=function(t){return t},r.prototype.visitColumnRef=function(t){return r.getEntity(t)},r.prototype.visitHierarchyLevel=function(t){var e=r.getColumnRefSQExpr(this.schema,t);return r.getEntity(e)},r.prototype.visitHierarchy=function(t){return t.arg.accept(this)},r.prototype.visitPropertyVariationSource=function(t){var e=r.getColumnRefSQExpr(this.schema,t);return r.getEntity(e)},r.prototype.visitAggr=function(t){var e=r.getColumnRefSQExpr(this.schema,t);return r.getEntity(e)},r.prototype.visitMeasureRef=function(t){return t.source.accept(this)},r.getColumnRefSQExpr=function(t,e){var r=new J(t);return e.accept(r)},r.getEntity=function(t){var r=e.SQExprConverter.asFieldPattern(t),i=r.column;return q.entity(i.schema,i.entity,i.entityVar)},r.getEntityExpr=function(t,e){var i=new r(t);return e.accept(i)},r}(e.DefaultSQExprVisitor),K=function(t){function e(e){t.call(this),this.func=e}return n(e,t),e.prototype.visitAggr=function(t){return t.func===this.func?t:new h(t.arg,this.func)},e.prototype.visitColumnRef=function(t){return new h(t,this.func)},e.rewrite=function(t,r){var i=new e(r);return t.accept(i)},e}(B),z=function(){function t(t,e){this.sqExpr=t,this.aggregate=e}return t.rewrite=function(r,i){return e.FieldExprPattern.visit(r,new t(r,i))},t.prototype.visitPercentOfGrandTotal=function(t){return t.baseExpr=e.SQExprConverter.asFieldPattern(K.rewrite(q.fieldExpr(t.baseExpr),this.aggregate)),q.fieldExpr({percentOfGrandTotal:t})},t.prototype.visitColumn=function(t){return this.defaultRewrite()},t.prototype.visitColumnAggr=function(t){return this.defaultRewrite()},t.prototype.visitColumnHierarchyLevelVariation=function(t){return this.defaultRewrite()},t.prototype.visitSelectRef=function(t){return this.defaultRewrite()},t.prototype.visitEntity=function(t){return this.defaultRewrite()},t.prototype.visitEntityAggr=function(t){return this.defaultRewrite()},t.prototype.visitHierarchy=function(t){return this.defaultRewrite()},t.prototype.visitHierarchyLevel=function(t){return this.defaultRewrite()},t.prototype.visitHierarchyLevelAggr=function(t){return this.defaultRewrite()},t.prototype.visitMeasure=function(t){return this.defaultRewrite()},t.prototype.visitPercentile=function(t){return this.defaultRewrite()},t.prototype.defaultRewrite=function(){return K.rewrite(this.sqExpr,this.aggregate)},t}(),X=function(){function t(t){this.sqExpr=t}return t.rewrite=function(r){return e.FieldExprPattern.visit(r,new t(r))},t.prototype.visitPercentOfGrandTotal=function(e){return t.rewrite(q.fieldExpr(e.baseExpr))},t.prototype.visitColumn=function(t){return this.defaultRewrite()},t.prototype.visitColumnAggr=function(t){return this.defaultRewrite()},t.prototype.visitColumnHierarchyLevelVariation=function(t){return this.defaultRewrite()},t.prototype.visitSelectRef=function(t){return this.defaultRewrite()},t.prototype.visitEntity=function(t){return this.defaultRewrite()},t.prototype.visitEntityAggr=function(t){return this.defaultRewrite()},t.prototype.visitHierarchy=function(t){return this.defaultRewrite()},t.prototype.visitHierarchyLevel=function(t){return this.defaultRewrite()},t.prototype.visitHierarchyLevelAggr=function(t){return this.defaultRewrite()},t.prototype.visitMeasure=function(t){return this.defaultRewrite()},t.prototype.visitPercentile=function(t){return this.defaultRewrite()},t.prototype.defaultRewrite=function(){return Z.rewrite(this.sqExpr)},t}(),Z=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.visitAggr=function(t){return t.arg},e.rewrite=function(t){return t.accept(e.instance)},e.instance=new e,e}(B),$=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.visitEntity=function(t){return t.variable?q.entity(t.schema,t.entity):t},e.rewrite=function(t){return t.accept(e.instance)},e.instance=new e,e}(e.SQExprRewriter),tt=function(t){function r(){t.apply(this,arguments)}return n(r,t),r.rewrite=function(t){return t.accept(r.instance)},r.prototype.visitDefault=function(t){var r=e.SQExprConverter.asFieldPattern(t);return r&&r.percentOfGrandTotal&&(t=q.fieldExpr(r.percentOfGrandTotal.baseExpr)),t},r.instance=new r,r}(B),et=function(t){function r(){t.apply(this,arguments)}return n(r,t),r.rewrite=function(t){return t.accept(r.instance)},r.prototype.visitDefault=function(t){var r=e.SQExprConverter.asFieldPattern(t);return r&&!r.percentOfGrandTotal&&(t=q.fieldExpr({percentOfGrandTotal:{baseExpr:e.SQExprConverter.asFieldPattern(t)}})),t},r.instance=new r,r}(B)}(e=t.data||(t.data={}))}(r||(r={}))},412:function(t,e){var r,i=window.jsCommon,r=window.powerbi,n=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(e){var r,o=i.ArrayExtensions,a=i.StringExtensions;!function(r){function i(t,e){var r=t.getMetadata(e),i=r&&r.type;return r&&i?i.numeric||i.dateTime||i.duration:!1}function u(t,r){for(var i=0,n=t.length;n>i;i++)if(e.SQExpr.equals(t[i],r))return i;return-1}function s(t,r){for(var i=0,n=t.length;n>i;i++){var o=t[i];if(o&&e.SQExpr.equals(o.expr,r))return i}return-1}function c(t,r){var i=t.length;if(i!==r.length)return!1;for(var n=0;i>n;n++)if(!e.SQExpr.equals(t[n],r[n]))return!1;return!0}function l(t,e,r){for(var i={},n=0,o=t.length;o>n;n++)i[t[n].name]=!0;return a.findUniqueName(i,r||p(e))}function p(t,e){return void 0===e&&(e="select"),t?t.accept(A.instance,e):e}function f(t){
return t.accept(j.instance)}function d(t){return t.accept(O.instance)}function v(t){return t.accept(N.instance)}function h(t,e){var r=g(t,e);return r&&r.discourageQueryAggregateUsage}function m(t,e){var r=E(t,e);return r?r.aggregateBehavior:void 0}function g(t,r){var i=e.SQExprConverter.asFieldPattern(t);if(i){var n=e.FieldExprPattern.toFieldExprEntityItemPattern(i),o=r.schema(n.schema);return o?o.capabilities:void 0}}function y(t,e){var r=x(t,e);if(r)return r.kpiValue.measure.kpi.statusMetadata;var i=b(t,e);return i?i.kpiValue.measure.kpi.trendMetadata:void 0}function w(t,e){var r=e.schema(t.schema).entities.withName(t.entity);return r}function x(t,e){var r=t.getConceptualProperty(e);if(r){var i=r.kpiValue;return i&&i.measure.kpi.status===r?r:void 0}}function b(t,e){var r=t.getConceptualProperty(e);if(r){var i=r.kpiValue;return i&&i.measure.kpi.trend===r?r:void 0}}function S(t,e){var r=E(t,e);return r?r.defaultValue:void 0}function E(t,r){if(t&&r){var i=e.SQExprConverter.asFieldPattern(t);if(i){var n=i.column;if(n){if(r.schema(n.schema)&&i.column.name){var o=r.schema(n.schema).findProperty(n.entity,i.column.name);if(o)return o.column}}else{var a=i.hierarchyLevel;if(a){var u=e.FieldExprPattern.toFieldExprEntityItemPattern(i),s=u.schema;if(r.schema(s)){var c=r.schema(s).findHierarchy(u.entity,a.name);if(c){var l=c.levels.withName(a.level);if(l&&l.column)return l.column.column}}}}}}}function D(t,e){if(!_.isEmpty(t)&&e){for(var r=[],i=0,n=t;i<n.length;i++){var o=n[i],a=S(o,e);a&&r.push(a)}return r}}function C(t,r){for(var i=[],n=0;n<t.length;n++)i.push(e.SQExprBuilder.compare(e.QueryComparisonKind.Equal,t[n],r[n]));if(!_.isEmpty(i)){for(var o,a=0,u=i;a<u.length;a++){var s=u[a];o=e.SQExprBuilder.and(o,s)}return o}}function T(t){var e=[];if(t){var r=t.from();if(void 0!==r)for(var i=0,n=r.keys();i<n.length;i++){var o=n[i],a=r.entity(o);e.indexOf(a.entity)<0&&e.push(a.entity)}}return e}function V(t,e,r){return F(t,e,r,0,2)||F(t,r,e,2,0)}function M(t,e,r){return F(t,e,r,2,0)||F(t,r,e,0,2)}function F(t,e,i,n,o){var a=r.getConceptualEntity(e,t);if(_.isEmpty(a.navigationProperties))return!1;var u=r.getConceptualEntity(i,t),s=[];for(s.push(a);!_.isEmpty(s);){var c=s.shift(),l=c.navigationProperties;if(!_.isEmpty(l))for(var p=0,f=l;p<f.length;p++){var d=f[p];if(d.isActive&&d.targetMultiplicity===o&&d.sourceMultiplicity===n){if(d.targetEntity===u)return!0;s.push(d.targetEntity)}}}return!1}function R(t,e,i){var n=r.getConceptualEntity(e,t),o=r.getConceptualEntity(i,t),a=n.navigationProperties,u=o.navigationProperties;return _.isEmpty(a)&&_.isEmpty(u)?!1:P(a,o)||P(u,n)}function P(t,e){if(_.isEmpty(t))return!1;for(var r=0,i=t;r<i.length;r++){var n=i[r];if(n.isActive&&n.targetEntity===e&&0===n.sourceMultiplicity&&0===n.targetMultiplicity)return!0}return!1}function I(t,e){for(var r=o.copy(t),i=0,n=e;i<n.length;i++){var a=n[i];-1===u(r,a)&&r.push(a)}return r}r.supportsArithmetic=i,r.indexOfExpr=u,r.indexOfNamedExpr=s,r.sequenceEqual=c,r.uniqueName=l,r.defaultName=p,r.isMeasure=f,r.isAnyValue=d,r.isDefaultValue=v,r.discourageAggregation=h,r.getAggregateBehavior=m,r.getSchemaCapabilities=g,r.getKpiMetadata=y,r.getConceptualEntity=w,r.getDefaultValue=S,r.getDefaultValues=D,r.getDataViewScopeIdentityComparisonExpr=C,r.getActiveTablesNames=T,r.isRelatedToMany=V,r.isRelatedToOne=M,r.isRelatedOneToOne=R,r.concatUnique=I;var A=function(r){function i(){r.apply(this,arguments)}return n(i,r),i.prototype.visitEntity=function(t){return t.entity},i.prototype.visitColumnRef=function(t){return t.source.accept(this)+"."+t.ref},i.prototype.visitMeasureRef=function(t,e){return t.source.accept(this)+"."+t.ref},i.prototype.visitAggr=function(t,r){return e.QueryAggregateFunction[t.func]+"("+t.arg.accept(this)+")"},i.prototype.visitPercentile=function(t,e){var r=t.exclusive?"Percentile.Exc(":"Percentile.Inc(";return r+t.arg.accept(this)+", "+t.k+")"},i.prototype.visitArithmetic=function(e,r){return t.data.getArithmeticOperatorName(e.operator)+"("+e.left.accept(this)+", "+e.right.accept(this)+")"},i.prototype.visitConstant=function(t){return"const"},i.prototype.visitDefault=function(t,e){return e||"expr"},i.instance=new i,i}(e.DefaultSQExprVisitorWithArg),j=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.visitMeasureRef=function(t){return!0},e.prototype.visitAggr=function(t){return!0},e.prototype.visitArithmetic=function(t){return!0},e.prototype.visitDefault=function(t){return!1},e.instance=new e,e}(e.DefaultSQExprVisitor),N=function(t){function r(){t.apply(this,arguments)}return n(r,t),r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?!1:t.right.accept(this)},r.prototype.visitAnd=function(t){return t.left.accept(this)&&t.right.accept(this)},r.prototype.visitDefaultValue=function(t){return!0},r.prototype.visitDefault=function(t){return!1},r.instance=new r,r}(e.DefaultSQExprVisitor),O=function(t){function r(){t.apply(this,arguments)}return n(r,t),r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?!1:t.right.accept(this)},r.prototype.visitAnd=function(t){return t.left.accept(this)&&t.right.accept(this)},r.prototype.visitAnyValue=function(t){return!0},r.prototype.visitDefault=function(t){return!1},r.instance=new r,r}(e.DefaultSQExprVisitor)}(r=e.SQExprUtils||(e.SQExprUtils={}))}(e=t.data||(t.data={}))}(r||(r={}))},413:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e=function(){function e(t){this.exprRewriter=t}return e.prototype.rewriteFrom=function(e){for(var r={},i=e,n=i.keys(),o=0,a=n.length;a>o;o++){var u=n[o],s=i.entity(u),c=t.SQExprBuilder.entity(s.schema,s.entity,u),l=c.accept(this.exprRewriter);r[u]={schema:l.schema,entity:l.entity}}return new t.SQFrom(r)},e.prototype.rewriteSelect=function(t,e){return this.rewriteNamedSQExpressions(t,e)},e.prototype.rewriteGroupBy=function(t,e){return _.isEmpty(t)?void 0:this.rewriteNamedSQExpressions(t,e)},e.prototype.rewriteNamedSQExpressions=function(e,r){var i=this;return _.map(e,function(e){return{name:e.name,expr:t.SQExprRewriterWithSourceRenames.rewrite(e.expr.accept(i.exprRewriter),r)}})},e.prototype.rewriteOrderBy=function(e,r){if(!_.isEmpty(e)){for(var i=[],n=0,o=e.length;o>n;n++){var a=e[n],u=t.SQExprRewriterWithSourceRenames.rewrite(a.expr.accept(this.exprRewriter),r);i.push({direction:a.direction,expr:u})}return i}},e.prototype.rewriteWhere=function(e,r){var i=this;if(!_.isEmpty(e)){for(var n=[],o=0,a=e.length;a>o;o++){var u=e[o],s={condition:t.SQExprRewriterWithSourceRenames.rewrite(u.condition.accept(this.exprRewriter),r)};u.target&&(s.target=_.map(u.target,function(e){return t.SQExprRewriterWithSourceRenames.rewrite(e.accept(i.exprRewriter),r)})),n.push(s)}return n}},e.prototype.rewriteTransform=function(e,r){var i=this;if(!_.isEmpty(e)){for(var n=[],o=0,a=e;o<a.length;o++){var u=a[o],s=void 0;u.input.table&&!_.isEmpty(u.input.table.columns)&&(s=_.map(u.input.table.columns,function(e){return{role:e.role,expression:{name:e.expression.name,expr:t.SQExprRewriterWithSourceRenames.rewrite(e.expression.expr.accept(i.exprRewriter),r)}}}));var c={name:u.name,algorithm:u.algorithm,input:{parameters:u.input.parameters},output:u.output};u.input.table&&(c.input.table={name:u.input.table.name,columns:s}),n.push(c)}return n}},e}();t.SemanticQueryRewriter=e}(e=t.data||(t.data={}))}(r||(r={}))},414:function(t,e){var r,i=window.jsCommon,r=window.powerbi,n=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e=i.ArrayExtensions,r=function(){function r(t,e,r,i,n,o){this.fromValue=t,this.whereItems=e,this.orderByItems=r,this.selectItems=i,this.groupByItems=n,this.transformItems=o}return r.create=function(){return r.empty||(r.empty=new r(new a,null,null,[],null,null)),r.empty},r.createWithTrimmedFrom=function(t,e,i,n,o,a){var u=new c(t.keys());if(e)for(var s=0,l=e.length;l>s;s++){var p=e[s];p.condition.accept(u);var f=p.target;if(f)for(var d=0,v=f.length;v>d;d++)f[d]&&f[d].accept(u)}if(i)for(var s=0,l=i.length;l>s;s++){var h=i[s].input.table;if(h&&!_.isEmpty(h.columns))for(var m=0,g=h.columns;m<g.length;m++){var y=g[m];y.expression.expr.accept(u)}}if(n)for(var s=0,l=n.length;l>s;s++)n[s].expr.accept(u);for(var s=0,l=o.length;l>s;s++)o[s].expr.accept(u);if(a)for(var s=0,l=a.length;l>s;s++)a[s].expr.accept(u);for(var w=u.result(),s=0,l=w.length;l>s;s++)t.remove(w[s]);return new r(t,e,n,o,a,i)},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.select=function(t){return _.isEmpty(arguments)?this.getSelect():this.setSelect(t)},r.prototype.getSelect=function(){return r.createNamedExpressionArray(this.selectItems)},r.createNamedExpressionArray=function(t){return e.extendWithName(_.map(t,function(t){return{name:t.name,expr:t.expr}}))},r.prototype.setSelect=function(t){var e=this.fromValue.clone(),i=r.rewriteExpressionsWithSourceRenames(t,e);return r.createWithTrimmedFrom(e,this.whereItems,this.transformItems,this.orderByItems,i,this.groupByItems)},r.rewriteExpressionsWithSourceRenames=function(t,e){for(var r=[],i=0,n=t.length;n>i;i++){var o=t[i];r.push({name:o.name,expr:u.rewrite(o.expr,e)})}return r},r.prototype.removeSelect=function(e){for(var i=this.selectItems,n=[],o=0,a=i.length;a>o;o++){var u=i[o];t.SQExpr.equals(u.expr,e)||n.push(u)}return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,this.transformItems,this.orderByItems,n,this.groupByItems)},r.prototype.removeOrderBy=function(e){for(var i=this.orderBy(),n=i.length-1;n>=0;n--)t.SQExpr.equals(i[n].expr,e)&&i.splice(n,1);return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,this.transformItems,i,this.selectItems,this.groupByItems)},r.prototype.removeTransform=function(t){for(var e=this.transforms(),i=0,n=e.length;n>i;i++)if(e[i].name===t.name){e.splice(i,1);break}return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,e,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.selectNameOf=function(e){var r=t.SQExprUtils.indexOfNamedExpr(this.selectItems,e);return r>=0?this.selectItems[r].name:void 0},r.prototype.setSelectAt=function(t,e){if(!(t>=this.selectItems.length)){var i=this.select(),n=this.fromValue.clone(),o=i[t].name;return i[t]={name:o,expr:u.rewrite(e,n)},r.createWithTrimmedFrom(n,this.whereItems,this.transformItems,this.orderByItems,i,this.groupByItems)}},r.prototype.addSelect=function(t,e){var i=this.select(),n=this.fromValue.clone();return i.push(this.createNamedExpr(i,n,t,e)),r.createWithTrimmedFrom(n,this.whereItems,this.transformItems,this.orderByItems,i,this.groupByItems)},r.prototype.createNamedExpr=function(e,r,i,n){return{name:t.SQExprUtils.uniqueName(e,i,n),expr:u.rewrite(i,r)}},r.prototype.groupBy=function(t){return _.isEmpty(arguments)?this.getGroupBy():this.setGroupBy(t)},r.prototype.getGroupBy=function(){return r.createNamedExpressionArray(this.groupByItems)},r.prototype.setGroupBy=function(t){var e=this.fromValue.clone(),i=r.rewriteExpressionsWithSourceRenames(t,e);return r.createWithTrimmedFrom(e,this.whereItems,this.transformItems,this.orderByItems,this.selectItems,i)},r.prototype.addGroupBy=function(t){var e=this.groupBy(),i=this.fromValue.clone();return e.push(this.createNamedExpr(e,i,t)),r.createWithTrimmedFrom(i,this.whereItems,this.transformItems,this.orderByItems,this.selectItems,e)},r.prototype.orderBy=function(t){return _.isEmpty(arguments)?this.getOrderBy():this.setOrderBy(t)},r.prototype.getOrderBy=function(){var t=[],e=this.orderByItems;if(e)for(var r=0,i=e.length;i>r;r++){var n=e[r];t.push({expr:n.expr,direction:n.direction})}return t},r.prototype.setOrderBy=function(t){for(var e=[],i=this.fromValue.clone(),n=0,o=t.length;o>n;n++){var a=t[n];e.push({expr:u.rewrite(a.expr,i),direction:a.direction})}return r.createWithTrimmedFrom(i,this.whereItems,this.transformItems,e,this.selectItems,this.groupByItems)},r.prototype.where=function(t){return _.isEmpty(arguments)?this.getWhere():this.setWhere(t)},r.prototype.getWhere=function(){var t=[],e=this.whereItems;if(e)for(var r=0,i=e.length;i>r;r++)t.push(e[r]);return t},r.prototype.setWhere=function(t){for(var e=[],i=this.fromValue.clone(),n=0,o=t.length;o>n;n++){var a=t[n],s={condition:u.rewrite(a.condition,i)},c=a.target;if(c){s.target=[];for(var l=0,p=c.length;p>l;l++)if(c[l]){var f=u.rewrite(c[l],i);s.target.push(f)}}e.push(s)}return r.createWithTrimmedFrom(i,e,this.transformItems,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.addWhere=function(t){for(var e=this.where(),i=t.where(),n=this.fromValue.clone(),o=0,a=i.length;a>o;o++){var s=i[o],c={condition:u.rewrite(s.condition,n)};s.target&&(c.target=_.map(s.target,function(t){return u.rewrite(t,n)})),e.push(c)}return r.createWithTrimmedFrom(n,e,this.transformItems,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.transforms=function(t){return _.isEmpty(arguments)?this.getTransforms():this.setTransforms(t)},r.prototype.getTransforms=function(){var t=[];if(!_.isEmpty(this.transformItems))for(var e=0,r=this.transformItems;e<r.length;e++){var i=r[e];t.push(i)}return t},r.prototype.setTransforms=function(t){for(var i=this,n=this.fromValue.clone(),o=[],a=0,u=t;a<u.length;a++){var s=u[a],c=void 0;s.input.table&&!_.isEmpty(s.input.table.columns)&&(c=_.map(s.input.table.columns,function(t){return{role:t.role,expression:i.createNamedExpr(e.extendWithName([]),n,t.expression.expr,t.expression.name)}}));var l={name:s.name,algorithm:s.algorithm,input:{parameters:s.input.parameters},output:s.output};s.input.table&&(l.input.table={name:s.input.table.name,columns:c}),o.push(l)}return r.createWithTrimmedFrom(n,this.whereItems,t,this.orderByItems,this.selectItems,this.groupByItems)},r.prototype.rewrite=function(e){var i=new t.SemanticQueryRewriter(e),n=i.rewriteFrom(this.fromValue),o=i.rewriteWhere(this.whereItems,n),a=i.rewriteOrderBy(this.orderByItems,n),u=i.rewriteSelect(this.selectItems,n),s=i.rewriteGroupBy(this.groupByItems,n),c=i.rewriteTransform(this.transformItems,n);return r.createWithTrimmedFrom(n,o,c,a,u,s)},r}();t.SemanticQuery=r;var o=function(){function r(t,e){this.fromValue=t,this.whereItems=e}return r.fromSQExpr=function(t){var e=new a,i=u.rewrite(t,e),n=[{condition:i}];return new r(e,n)},r.getDefaultValueFilter=function(e){return r.getDataViewScopeIdentityComparisonFilters(e,t.SQExprBuilder.defaultValue())},r.getAnyValueFilter=function(e){return r.getDataViewScopeIdentityComparisonFilters(e,t.SQExprBuilder.anyValue())},r.getDataViewScopeIdentityComparisonFilters=function(e,i){if(e instanceof Array){var n=Array.apply(null,Array(e.length)).map(function(){return i});return r.fromSQExpr(t.SQExprUtils.getDataViewScopeIdentityComparisonExpr(e,n))}return r.fromSQExpr(t.SQExprBuilder.equal(e,i))},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.conditions=function(){for(var t=[],e=this.whereItems,r=0,i=e.length;i>r;r++){var n=e[r];t.push(n.condition)}return t},r.prototype.where=function(){for(var t=[],e=this.whereItems,r=0,i=e.length;i>r;r++)t.push(e[r]);return t},r.prototype.rewrite=function(e){var i=new t.SemanticQueryRewriter(e),n=i.rewriteFrom(this.fromValue),o=i.rewriteWhere(this.whereItems,n);return new r(n,o)},r.prototype.validate=function(e,r,i){var n=new t.SQExprValidationVisitor(e,r,i);return this.rewrite(n),n.errors},r.merge=function(t){if(_.isEmpty(t))return null;if(1===t.length)return t[0];for(var i=t[0],n=i.from(),o=e.take(i.whereItems,i.whereItems.length),a=1,u=t.length;u>a;a++)r.applyFilter(t[a],n,o);return new r(n,o)},r.isDefaultFilter=function(e){return e&&1===e.where().length?t.SQExprUtils.isDefaultValue(e.where()[0].condition):!1},r.isAnyFilter=function(e){return e&&1===e.where().length?t.SQExprUtils.isAnyValue(e.where()[0].condition):!1},r.isSameFilter=function(t,e){return i.JsonComparer.equals(t,e)?!(r.isDefaultFilter(t)&&r.isAnyFilter(e)||r.isAnyFilter(t)&&r.isDefaultFilter(e)):!1},r.applyFilter=function(t,e,r){for(var i=t.whereItems,n=0;n<i.length;n++){var o=i[n],a={condition:u.rewrite(o.condition,e)};o.target&&(a.target=_.map(o.target,function(t){return u.rewrite(t,e)})),r.push(a)}},r}();t.SemanticFilter=o;var a=function(){function t(t){this.items=t||{}}return t.prototype.keys=function(){return Object.keys(this.items)},t.prototype.entity=function(t){return this.items[t]},t.prototype.ensureEntity=function(t,e){for(var r=this.keys(),i=0,n=r.length;n>i;i++){var o=r[i],a=this.items[o];if(a&&t.entity===a.entity&&t.schema===a.schema)return{name:o}}for(var u=e||this.candidateName(t.entity),s=u,c=2;this.items[s];)s=u+c++;return this.items[s]=t,{name:s,"new":!0}},t.prototype.remove=function(t){delete this.items[t]},t.prototype.candidateName=function(t){var e=t.lastIndexOf(".");return e>=0&&e!==t.length-1&&(t=t.substr(e+1)),t.substring(0,1).toLowerCase()},t.prototype.clone=function(){var e=new t;return $.extend(e.items,this.items),e},t}();t.SQFrom=a;var u=function(r){function i(t){r.call(this),this.renames=t}return n(i,r),i.prototype.visitEntity=function(e){var i=this.renames[e.entity];return i?new t.SQEntityExpr(e.schema,e.entity,i):r.prototype.visitEntity.call(this,e)},i.prototype.rewriteFilter=function(t){var e=void 0;t.target&&(e=this.rewriteArray(t.target));var r=t.condition.accept(this);if(t.condition===r&&t.target===e)return t;var i={condition:r};return e&&(i.target=e),i},i.prototype.rewriteArray=function(t){for(var r,i=0,n=t.length;n>i;i++){var o=t[i],a=o.accept(this);o===a||r||(r=e.take(t,i)),r&&r.push(a)}return r||t},i.rewrite=function(t,e){var r=s.run(t,e),n=new i(r);return t.accept(n)},i}(t.SQExprRewriter);t.SQExprRewriterWithSourceRenames=u;var s=function(t){function e(e){t.call(this),this.from=e,this.renames={}}return n(e,t),e.run=function(t,r){var i=new e(r);return t.accept(i),i.renames},e.prototype.visitEntity=function(t){var e=this.from.entity(t.variable);if(!e||e.schema!==t.schema||e.entity!==t.entity){var r=this.from.ensureEntity({schema:t.schema,entity:t.entity},t.variable);this.renames[t.entity]=r.name}},e}(t.DefaultSQExprVisitorWithTraversal),c=function(t){function e(e){t.call(this),this.keys=e}return n(e,t),e.prototype.visitEntity=function(t){var e=this.keys.indexOf(t.variable);e>=0&&this.keys.splice(e,1)},e.prototype.result=function(){return this.keys},e}(t.DefaultSQExprVisitorWithTraversal)}(e=t.data||(t.data={}))}(r||(r={}))},415:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){var e,r=i.ArrayExtensions;!function(e){function i(e,r){return e||(e=null),r||(r=null),e===r?!0:!!e!=!!r?!1:n(e,r)?t.SQExpr.equals(e.condition,r.condition):!1}function n(e,i){return r.sequenceEqual(e.target,i.target,t.SQExpr.equals)}function o(t,e){return!_.isEmpty(t)&&_.any(t,function(t){return i(t,e)})}e.equals=i,e.targetsEqual=n,e.contains=o}(e=t.SQFilter||(t.SQFilter={}))}(e=t.data||(t.data={}))}(r||(r={}))},416:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(){return new s}function i(t,r,i,n){var o=t.identities;return o?o[r]:e.createDataViewScopeIdentity(u.equal(t.fields[0],u.typedConstant(i,n)))}function n(t,e){_.contains(t,e)||t.push(e)}function o(t,e,r){var i=e.values;t.values=i;var n=e.highlights;n&&(t.highlights=n);var o;void 0!==e.minLocal&&(o||(o={}),o.minLocal=e.minLocal),void 0!==e.maxLocal&&(o||(o={}),o.maxLocal=e.maxLocal),o&&(t.source.aggregates=o,_.extend(t,o))}var a=t.data.DataViewTransform,u=t.data.SQExprBuilder;e.createCategoricalDataViewBuilder=r;var s=function(){function t(){this.categories=[],this.staticMeasureColumns=[],this.dynamicMeasureColumns=[],this.columnIndex=0}return t.prototype.withCategory=function(t){var e=t.values,r=t.identityFrom,n=t.source.type,o={source:t.source,identityFields:t.identityFrom.fields,identity:t.identityFrom.identities||[],values:e};if(!t.identityFrom.identities)for(var a=0,u=e.length;u>a;a++)o.identity.push(i(r,a,e[a],n));return this.categories||(this.categories=[]),this.categories.push(o),this},t.prototype.withCategories=function(t){return _.isEmpty(this.categories)?this.categories=t:Array.prototype.push.apply(this.categories,t),this},t.prototype.withValues=function(t){for(var e=t.columns,r=0,i=e;r<i.length;r++){var n=i[r];this.staticMeasureColumns.push(n.source)}return this.staticSeriesValues=e,this},t.prototype.withGroupedValues=function(t){var e=t.groupColumn;this.dynamicSeriesMetadata={column:e.source,identityFrom:e.identityFrom,values:e.values};for(var r=t.valueColumns,i=0,n=r;i<n.length;i++){var o=n[i];this.dynamicMeasureColumns.push(o.source)}return this.dynamicSeriesValues=t.data,this},t.prototype.fillData=function(t){var e=_.first(this.categories),r=e&&e.values?e.values.length:0;if(this.hasDynamicSeries())for(var i=0;i<this.dynamicSeriesMetadata.values.length;i++)for(var n=this.dynamicSeriesValues[i],a=0,u=this.dynamicMeasureColumns.length;u>a;a++){var s=i*u+a;o(t[s],n[a],r)}if(this.hasStaticSeries())for(var c=this.hasDynamicSeries()?this.dynamicSeriesValues.length*this.dynamicMeasureColumns.length:0,a=0,u=this.staticMeasureColumns.length;u>a;a++)o(t[c+a],this.staticSeriesValues[a],r)},t.prototype.build=function(){for(var t=[],e={},r=this.categories,o=this.dynamicSeriesMetadata,u=0,s=r;u<s.length;u++){var c=s[u];n(t,c.source)}if(this.hasDynamicSeries()){n(t,o.column),e.values=a.createValueColumns([],o.identityFrom.fields,o.column);for(var l=o.values,p=0;p<l.length;p++)for(var f=l[p],d=i(o.identityFrom,p,f,o.column.type),v=0,h=this.dynamicMeasureColumns;v<h.length;v++){var m=h[v],g=_.toPlainObject(m);g.groupName=f,n(t,g),e.values.push({source:g,values:[],identity:d})}if(this.hasStaticSeries()){var y=e.values.grouped();e.values.grouped=function(){return y},this.appendStaticMeasureColumns(t,e.values)}}else e.values=a.createValueColumns(),this.appendStaticMeasureColumns(t,e.values);var w=this.categories;_.isEmpty(w)||(e.categories=w),this.fillData(e.values);var x={metadata:{columns:t},categorical:e};return this.isLegalDataView(x)?x:void 0},t.prototype.appendStaticMeasureColumns=function(t,e){if(!_.isEmpty(this.staticMeasureColumns))for(var r=0,i=this.staticMeasureColumns;r<i.length;r++){var o=i[r];n(t,o),e.push({source:o,values:[]})}},t.prototype.isLegalDataView=function(e){return!(this.hasDynamicSeries()&&this.hasStaticSeries()&&t.isVisualDataView(e.metadata.columns))},t.isVisualDataView=function(t){return!_.isEmpty(t)&&_.any(t,function(t){return!!t.queryName})},t.prototype.hasDynamicSeries=function(){return!!this.dynamicSeriesMetadata},t.prototype.hasStaticSeries=function(){return!!this.staticSeriesValues},t}()}(e=t.data||(t.data={}))}(r||(r={}))},417:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){function r(t,r,i){return new c(t||e.createColorAllocatorCache(),r||{metadata:{columns:[]}},i)}function i(t,e,r,i){var n=r.rows;if(!(_.isEmpty(n)||n.length<=i)){var a=r.columns,u=o(t,e);if(!(0>u))for(var s=0,c=a.length;c>s;s++)if(u===a[s].index)return n[i][s]}}function n(t,e,r){var i=o(t.arg,e);if(!(0>i))for(var n=0,u=r.length;u>n;n++){var s=r[n],c=s.aggregates;if(i===s.index&&c){var l=a(c,t.func);if(void 0!==l)return l}}}function o(t,e){var r;s.isSelectRef(t)&&(r=t.expressionName);for(var i=0,n=e.length;n>i;i++){var o=e[i];if(o&&(!r||o.queryName))if(r){if(o.queryName===r)return i}else if(s.equals(o.expr,t))return i}return-1}function a(t,r){switch(r){case e.QueryAggregateFunction.Min:return u(t.min,t.minLocal);case e.QueryAggregateFunction.Max:return u(t.max,t.maxLocal)}}function u(t,e){return void 0!==t?t:e}var s=t.data.SQExpr;e.createStaticEvalContext=r;var c=function(){function t(t,e,r){this.colorAllocatorCache=t,this.dataView=e,this.selectTransforms=r}return t.prototype.getColorAllocator=function(t){return this.colorAllocatorCache.get(t)},t.prototype.getExprValue=function(t){var e=this.dataView,r=this.selectTransforms;if(e&&r){if(s.isAggregation(t)){var o=n(t,r,e.metadata.columns);if(void 0!==o)return o}return e.table?i(t,r,e.table,0):void 0}},t.prototype.getRoleValue=function(t){},t}();e.getExprValueFromTable=i,e.findSelectIndex=o}(e=t.data||(t.data={}))}(r||(r={}))},418:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(t){function e(e,r){return t.createStaticEvalContext(e)}t.createMatrixEvalContext=e}(e=t.data||(t.data={}))}(r||(r={}))},419:function(t,e){var r,i=window.jsCommon,r=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e,n=i.StringExtensions,o=i.Formatting,a=i.RegExpExtensions;!function(t){function e(t){return o.lastIndex=0,t.replace(o,"")}function r(t,e){for(o.lastIndex=0;;){var r=o.exec(t);if(!r)break;var i=r[0],n=o.lastIndex-i.length,a=String.fromCharCode(57600+e.length);e.push(i),t=t.substr(0,n)+a+t.substr(o.lastIndex),o.lastIndex=n+1}return t}function i(t,e,r){void 0===r&&(r=!0);for(var i=e.length,n=0;i>n;n++){var o=String.fromCharCode(57600+n),a=e[n];if(!r){var u=a[0];a="\\"===u||1===a.length||a[a.length-1]!==u?a.substring(1):a.substring(1,a.length-1)}t=t.replace(o,a)}return t}var n=["'[^']*'",'"[^"]*"',"\\\\.","'[^']*$",'"[^"]*$',"\\\\$"],o=new RegExp(n.join("|"),"g");t.removeLiterals=e,t.preserveLiterals=r,t.restoreLiterals=i}(e||(e={}));var u,s=/({{)|(}})|{(\d+[^}]*)}/g,c="0",l="#",p="E",f=[c,l],d=new RegExp(f.join("|"),"g"),v=function(){function t(){}return t.prototype.formatValue=function(t,e,r){if(void 0===t||null===t)return"";var i=this.getCulture(r);return u.canFormat(t)?u.format(t,e,i):h.canFormat(t)?h.format(t,e,i):t.toString()},t.prototype.format=function(t,e,r){var i=this;if(!t)return"";var n=t.replace(s,function(t,n,o,a){if(n)return"{";if(o)return"}";var u=a.split(":"),s=parseInt(u[0],10),c=u[1];return i.formatValue(e[s],c,r)});return n},t.prototype.isStandardNumberFormat=function(t){return h.isStandardFormat(t)},t.prototype.formatNumberWithCustomOverride=function(t,e,r,i){var n=this.getCulture(i);return h.formatWithCustomOverride(t,e,r,n)},t.prototype.dateFormatString=function(t){return this._dateTimeScaleFormatInfo||this.initialize(),this._dateTimeScaleFormatInfo.getFormatString(t)},t.prototype.setCurrentCulture=function(t){this._currentCultureSelector!==t&&(this._currentCulture=this.getCulture(t),this._currentCultureSelector=t,this._dateTimeScaleFormatInfo=new m(this._currentCulture))},t.prototype.getCulture=function(t){if(null==t)return null==this._currentCulture&&this.initialize(),this._currentCulture;var e=Globalize.findClosestCulture(t);return e||(e=Globalize.culture("en-US")),e},t.prototype.initialize=function(){var t=this.getCurrentCulture();this.setCurrentCulture(t);var e=this.getUrlParam("calendar");if(e){var r=this._currentCulture,i=r.calendars[e];i&&(r.calendar=i)}},t.prototype.getCurrentCulture=function(){var t=this.getUrlParam("language");return t?t:r&&r.common&&r.common.cultureInfo?r.common.cultureInfo:window.navigator.userLanguage||window.navigator.language||Globalize.culture().name},t.prototype.getUrlParam=function(t){var e=window.location.search.match(RegExp("[?&]"+t+"=([^&]*)"));return e?e[1]:void 0},t}();!function(t){function r(t){var e=t instanceof Date;return e}function i(t,e,r){e=e||"G";var i=1===e.length;try{return i?a(t,e,r):u(t,e,r)}catch(n){return a(t,"G",r)}}function a(t,e,r){var i=r.calendar.patterns;l(r.calendar);var n=o.findDateFormat(t,e,r.name);return e=1===n.format.length?i[n.format]:n.format,r=Globalize.culture("en-US"),Globalize.format(n.value,e,r)}function u(t,r,i){var o,a=[];if(r=e.preserveLiterals(r,a),r.indexOf("F")>-1){r=n.replaceAll(r,"FFFF","FFF");var u=t.getMilliseconds();if(u%10>=1&&(r=n.replaceAll(r,"FFF","fff")),r=n.replaceAll(r,"FFF","FF"),u%100/10>=1&&(r=n.replaceAll(r,"FF","ff")),r=n.replaceAll(r,"FF","F"),u%1e3/100>=1&&(r=n.replaceAll(r,"F","f")),r=n.replaceAll(r,"F",""),""===r||"%"===r)return""}return r=s(r),o=Globalize.format(t,r,i),o=c(o,i.calendar),o=e.restoreLiterals(o,a,!1)}function s(t){return t===p?f:(p=t,t=o.fixDateTimeFormat(t),f=t,t)}function c(t,e){var r=e[":"];if(":"===r)return t;for(var i="",n=t.length,o=0;n>o;o++){var a=t.charAt(o);switch(a){case":":i+=r;break;default:i+=a}}return i}function l(t){var e=t.patterns;void 0===e.g&&(e.g=e.f.replace(e.D,e.d),e.G=e.F.replace(e.D,e.d))}var p,f;t.canFormat=r,t.format=i}(u||(u={}));var h;!function(r){function i(t,e){if(!e||void 0===t)return t;var r="{0:"+e+"}";return t.replace("{0}",r)}function o(t,e){if(null==e)return e;if(v(e)){var i=r.getComponents(e),n=i.positive,o=i.negative,a=i.zero;return t>0?u(t,n):0===t?u(t,a):u(t,o)}return u(t,e)}function u(t,e){var r=a.run(N,e);return r?r[0]:e}function s(t,e,i){if(null==e)return t;if(null==t&&(t=c),v(t)){for(var n=r.getComponents(t),o=n.positive,a=n.negative,u=n.zero,s=[o,a,u],l=0;l<s.length;l++)s[l]=f(s[l],e,i);return s.join(r.NumberFormatComponentsDelimeter)}return f(t,e,i)}function f(t,r,i){if(r=Math.abs(r),r>=0){var o=[];t=e.preserveLiterals(t,o);var u=i?c:l,s=n.repeat(u,Math.abs(r)),p=a.run(j,t);if(p){var f=t.substr(0,p.index),d=t.substr(p.index+1,p[1].length),v=t.substr(p.index+p[0].length);if(i)d=s;else{var h=s.length-d.length;h>0?d+=s.slice(-h):0>h&&(d=d.slice(0,h))}d.length>0&&(d=Q+d),t=f+d+v}else s.length>0&&(t=t.replace(O,"$1"+Q+s));0!==o.length&&(t=e.restoreLiterals(t,o))}return t}function v(t){return-1!==e.removeLiterals(t).indexOf(r.NumberFormatComponentsDelimeter)}function h(t){var i={hasNegative:!1,positive:t,negative:t,zero:t},n=[];t=e.preserveLiterals(t,n);var o=t.split(r.NumberFormatComponentsDelimeter),a=o.length;return a>1&&(0!==n.length&&(o=_.map(o,function(t){return e.restoreLiterals(t,n)})),i.hasNegative=!0,i.positive=i.zero=o[0],i.negative=o[1],a>2&&(i.zero=o[2])),i}function m(t){var e="number"==typeof t;return e}function g(t){return I.test(t)}function y(t,e,r){e=e||"G";try{return g(e)?x(t,e,r):b(t,e,r)}catch(i){return Globalize.format(t,void 0,r)}}function w(t,e,r,i){return b(t,e,i,r)}function x(t,e,r){var i,o=e.length>1?parseInt(e.substr(1,e.length-1),10):void 0,a=r.numberFormat,u=e.charAt(0);switch(u){case"e":case"E":void 0===o&&(o=6);var s=n.repeat("0",o);e="0."+s+u+"+000",i=b(t,e,r);break;case"f":case"F":i=void 0!==o?t.toFixed(o):t.toFixed(a.decimals),i=F(i,a);break;case"g":case"G":var c=Math.abs(t);if(0===c||c>=1e-4&&1e15>c)i=void 0!==o?t.toPrecision(o):t.toString();else{if("number"!=typeof t)return String(t);i=void 0!==o?t.toExponential(o):t.toExponential(),i=i.replace("e","E")}i=F(i,a);break;case"r":case"R":i=t.toString(),i=F(i,a);break;case"x":case"X":if(i=t.toString(16),"X"===u&&(i=i.toUpperCase()),void 0!==o){var l=i.length,p=0>t;p&&l--;var f=o-l,d=void 0;f>0&&(d=n.repeat("0",f)),i=p?"-"+d+i.substr(1):d+i}i=F(i,a);break;default:i=Globalize.format(t,e,r)}return i}function b(n,o,u,s){var c,l=u.numberFormat;if(!isFinite(n))return Globalize.format(n,void 0);var p=h(o);o=n>0?p.positive:0===n?p.zero:p.negative,p.hasNegative&&(n=Math.abs(n));var f=E(o,!0),d=[];if(f.hasLiterals&&(o=e.preserveLiterals(o,d)),f.hasE&&!s){var v=a.run(P,o);if(v){var m=o.substr(0,v.index),g=o.substr(v.index+2),y=D(m,f),w=C(m,f);if(1!==w&&(n*=w),"number"!=typeof n)return String(n);var x=n.toExponential(y),b=x.indexOf("e"),V=x.substr(0,b),M=x.substr(b+1),F=T(V,m,l),R=T(M,g,l);"+"===R.charAt(0)&&"+"!==v[0].charAt(1)&&(R=R.substr(1));var I=v[0].charAt(0);c=F+I+R}}if(void 0===c){var A=void 0,_=!1,y=D(o,f),w=C(o,f);if(1!==w&&(n*=w),n=parseFloat(S(n,y)),s){var j=r.getNumericFormat(n,o);s=i(s,j),A=t.formattingService.format(s,[n],u.name),_=!0}else A=S(n,y);c=T(A,o,l,s,_)}return f.hasLiterals&&(c=e.restoreLiterals(c,d,!1)),U=f,c}function S(e,r){var i="",o=0;
r>16&&(o=r-16,r=16);var a=t.Double.log10(Math.abs(e));if(16>a){if(a>0){var u=16-a;r>u&&(o+=r-u,r=u)}i=e.toFixed(r)}else if(16===a)i=e.toFixed(0),o+=r,o>0&&(i+=".");else{if("number"!=typeof e)return String(e);i=e.toExponential(15);var s=i.indexOf("e");if(s>0){var c=i.indexOf("."),l=i.substr(0,s),p=i.substr(s+1),f=parseInt(p,10)-(l.length-c-1);i=l.replace(".","")+n.repeat("0",f),r>0&&(i=i+"."+n.repeat("0",r))}}return o>0&&(i+=n.repeat("0",o)),i}function E(t,r,i){if(void 0!==U&&t===U.format)return U;for(var n=[],o=e.preserveLiterals(t,n),a={format:t,hasLiterals:0!==n.length,hasE:!1,hasCommas:!1,hasDots:!1,hasPercent:!1,hasPermile:!1,precision:void 0,scale:void 0},u=0,s=o.length;s>u;u++){var c=o.charAt(u);switch(c){case"e":case"E":a.hasE=!0;break;case",":a.hasCommas=!0;break;case".":a.hasDots=!0;break;case"%":a.hasPercent=!0;break;case"":a.hasPermile=!0}}var l=h(t);return r&&(a.precision=D(l.positive,a)),i&&(a.scale=C(l.positive,a)),a}function D(t,r){if(r.precision>-1)return r.precision;var i=0;if(r.hasDots){r.hasLiterals&&(t=e.removeLiterals(t));var n=t.indexOf(".");if(n>-1){for(var o=t.length,a=n;o>a;a++){var u=t.charAt(a);if(u.match(d)&&i++,u===p)break}i=Math.min(19,i)}}return r.precision=i,i}function C(t,e){if(e.scale>-1)return e.scale;var r=1;if(e.hasPercent&&t.indexOf("%")>-1&&(r=100*r),e.hasPermile&&t.indexOf("")>-1&&(r=1e3*r),e.hasCommas){var i=t.indexOf(".");-1===i&&(i=t.length);for(var n=i-1;n>-1;n--){var o=t.charAt(n);if(","!==o)break;r/=1e3}}return e.scale=r,r}function T(t,e,r,i,n){var o=!!i,a=e.split(".",2);if(2===a.length){var u=a[0],s=a[1],c="";i&&(c=i.replace(R,""),t=t.replace(c,""));var l=r["."],p=n?l:".",f=t.split(p,2),d=1===f.length?f[0]+c:f[0],v=2===f.length?f[1]+c:"";v=v.replace(A,"");var h=V(d,u,r,o),m=M(v,s,o);return m.fmtOnly||""===m.value?h+m.value:h+l+m.value}return V(t,e,r,o)}function V(t,e,r,i){var n=e.indexOf(","),o=n>-1&&n<Math.max(e.lastIndexOf("0"),e.lastIndexOf("#"))&&r[","],a=0,u=0,s=r.groupSizes||[3],p=s[0],f=r[","],d="",v=t.charAt(0);"+"!==v&&"-"!==v||(d=r[v],t=t.substr(1));for(var h="0"===t,m="",g="",y=t.length-1,w=!0,x=e.length-1;x>-1;x--){var b=e.charAt(x);switch(b){case c:case l:w=!1,""!==g&&(m=g+m,g=""),i||((y>-1||b===c)&&o&&(a===p?(m=f+m,u++,u<s.length&&(p=s[u]),a=1):a++),y>-1?(h&&b===l||(m=t.charAt(y)+m),y--):b!==l&&(m=b+m));break;case",":break;default:g=b+g}}if(!i){if(y>-1&&""!==m)if(o)for(;y>-1;)a===p?(m=f+m,u++,u<s.length&&(p=s[u]),a=1):a++,m=t.charAt(y)+m,y--;else m=t.substr(0,y+1)+m;return d+g+m}return w?d+g+m:d+g+t+m}function M(t,e,r){var i=0,n=e.length,o=t.length;if(r){var a=e.charAt(n-1);return a.match(d)?{value:t,fmtOnly:""===t}:{value:t+a,fmtOnly:""===t}}for(var u="",s=!0,p=0;n>p;p++){var f=e.charAt(p);if(o>i)switch(f){case c:case l:u+=t[i++],s=!1;break;default:u+=f}else f!==l&&(u+=f,s=s&&f!==c)}return{value:u,fmtOnly:s}}function F(t,e){var r=e["+"],i=e["-"],n=e["."],o=e[","];if("+"===r&&"-"===i&&"."===n&&","===o)return t;for(var a=t.length,u="",s=0;a>s;s++){var c=t.charAt(s);switch(c){case"+":u+=r;break;case"-":u+=i;break;case".":u+=n;break;case",":u+=o;break;default:u+=c}}return u}var R=/\{.+\}/,P=/e[+-]*[0#]+/i,I=/^[a-z]\d{0,2}$/i,A=/0+$/,j=/\.([0#]*)/g,N=/[0#,\.]+[0,#]*/g,O=/(0|#)([^(0|#)]*)$/,Q=".";r.NumberFormatComponentsDelimeter=";",r.getNumericFormat=o,r.addDecimalsToFormat=s,r.hasFormatComponents=v,r.getComponents=h;var U;r.canFormat=m,r.isStandardFormat=g,r.format=y,r.formatWithCustomOverride=w,r.getCustomFormatMetadata=E}(h=t.NumberFormat||(t.NumberFormat={}));var m=function(){function e(t){var e=t.calendar,r=e.patterns,i=e.months.namesAbbr,n=i&&i[0],o=r.Y,a=r.M,u=r.f,s=r.T,c=r.t,l=u.indexOf(",")>-1?", ":" ",p=0===o.indexOf("yyyy'")&&o.length>6&&"'"===o[6];this.YearPattern=p?o.substr(0,7):"yyyy";var f=u.indexOf("yy"),d=u.indexOf("MMMM");this.MonthPattern=n&&d>-1?f>d?"MMM yyyy":"yyyy MMM":o,this.DayPattern=n?a.replace("MMMM","MMM"):a;var v=u.indexOf("mm"),h=u.indexOf("tt"),m=h>-1?c.replace(":mm ",""):c;switch(this.HourPattern=v>f?this.DayPattern+l+m:m+l+this.DayPattern,this.MinutePattern=c,this.SecondPattern=s,this.MillisecondPattern=s.replace("ss","ss.fff"),t.name){case"fi-FI":this.DayPattern=this.DayPattern.replace("'ta'",""),this.HourPattern=this.HourPattern.replace("'ta'","")}}return e.prototype.getFormatString=function(e){switch(e){case t.DateTimeUnit.Year:return this.YearPattern;case t.DateTimeUnit.Month:return this.MonthPattern;case t.DateTimeUnit.Week:case t.DateTimeUnit.Day:return this.DayPattern;case t.DateTimeUnit.Hour:return this.HourPattern;case t.DateTimeUnit.Minute:return this.MinutePattern;case t.DateTimeUnit.Second:return this.SecondPattern;case t.DateTimeUnit.Millisecond:return this.MillisecondPattern}},e}();t.formattingService=new v}(r||(r={}))},420:function(t,e){var r,r=(window.jsCommon,window.powerbi),i=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){var e;!function(t){var e;!function(e){function r(t){return JSON.stringify(t.accept(o.instance))}function n(t){for(var r="[",i=0,n=t.length;n>i;i++)i>0&&(r+=","),r+=e.serialize(t[i]);return r+"]"}e.serialize=r,e.serializeArray=n;var o=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.visitColumnRef=function(t){return{col:{s:t.source.accept(this),r:t.ref}}},e.prototype.visitMeasureRef=function(t){return{measure:{s:t.source.accept(this),r:t.ref}}},e.prototype.visitAggr=function(t){return{agg:{a:t.arg.accept(this),f:t.func}}},e.prototype.visitEntity=function(t){return{e:t.entity}},e.prototype.visitHierarchyLevel=function(t){return{h:t.arg.accept(this),l:t.level}},e.prototype.visitHierarchy=function(t){return{e:t.arg.accept(this),h:t.hierarchy}},e.prototype.visitPropertyVariationSource=function(t){return{e:t.arg.accept(this),n:t.name,p:t.property}},e.prototype.visitAnd=function(t){return{and:{l:t.left.accept(this),r:t.right.accept(this)}}},e.prototype.visitCompare=function(t){return{comp:{k:t.comparison,l:t.left.accept(this),r:t.right.accept(this)}}},e.prototype.visitConstant=function(t){return{"const":{t:t.type.primitiveType,v:t.value}}},e.prototype.visitArithmetic=function(t){return{arithmetic:{o:t.operator,l:t.left.accept(this),r:t.right.accept(this)}}},e.prototype.visitScopedEval=function(t){return{scopedEval:{e:t.expression.accept(this),s:n(t.scope)}}},e.prototype.visitWithRef=function(t){return{withRef:{e:t.expressionName}}},e.prototype.visitTransformTableRef=function(t){return{transformTableRef:{source:t.source}}},e.prototype.visitTransformOutputRoleRef=function(t){return{transformOutputRoleRef:{role:t.role,transform:t.transform}}},e.prototype.visitDefault=function(t){},e.instance=new e,e}(t.DefaultSQExprVisitor)}(e=t.SQExprShortSerializer||(t.SQExprShortSerializer={}))}(e=t.data||(t.data={}))}(r||(r={}))},421:function(t,e){var r,r=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!function(t){var e;!function(e){var r=t.data.Selector,i=function(){function e(t,e){this.selector=t,this.highlight=e,this.key=JSON.stringify({selector:t?r.getKey(t):null,highlight:e}),this.keyWithoutHighlight=JSON.stringify({selector:t?r.getKey(t):null})}return e.prototype.equals=function(t){return this.selector&&t.selector?this.highlight===t.highlight&&r.equals(this.selector,t.selector):!this.selector==!t.selector&&this.highlight===t.highlight},e.prototype.includes=function(e,r){void 0===r&&(r=!1);var i=this.selector,n=e.selector;if(!i||!n)return!1;var o=i.data,a=n.data;if(!o&&i.metadata&&i.metadata!==n.metadata)return!1;if(!r&&this.highlight!==e.highlight)return!1;if(o){if(!a)return!1;if(o.length>0)for(var u=0,s=o.length;s>u;u++){var c=o[u];if(!a.some(function(e){return t.DataViewScopeIdentity.equals(c,e)}))return!1}}return!0},e.prototype.getKey=function(){return this.key},e.prototype.getKeyWithoutHighlight=function(){return this.keyWithoutHighlight},e.prototype.hasIdentity=function(){return this.selector&&!!this.selector.data},e.prototype.getSelector=function(){return this.selector},e.prototype.getSelectorsByColumn=function(){return this.selectorsByColumn},e.createNull=function(t){return void 0===t&&(t=!1),new e(null,t)},e.createWithId=function(t,r){void 0===r&&(r=!1);var i=null;return t&&(i={data:[t]}),new e(i,r)},e.createWithMeasure=function(t,r){void 0===r&&(r=!1);var i={metadata:t},n=new e(i,r);return n.selectorsByColumn={metadata:t},n},e.createWithIdAndMeasure=function(t,r,i){void 0===i&&(i=!1);var n={};t&&(n.data=[t]),r&&(n.metadata=r),t||r||(n=null);var o=new e(n,i);return o},e.createWithIdAndMeasureAndCategory=function(t,e,r,i){void 0===i&&(i=!1);var n=this.createWithIdAndMeasure(t,e,i);return n.selector&&(n.selectorsByColumn={},t&&r&&(n.selectorsByColumn.dataMap={},n.selectorsByColumn.dataMap[r]=t),e&&(n.selectorsByColumn.metadata=e)),n},e.createWithIds=function(t,r,i){void 0===i&&(i=!1);var n=null,o=e.idArray(t,r);return o&&(n={data:o}),new e(n,i)},e.createWithIdsAndMeasure=function(t,r,i,n){void 0===n&&(n=!1);var o={},a=e.idArray(t,r);return a&&(o.data=a),i&&(o.metadata=i),t||r||i||(o=null),new e(o,n)},e.createWithSelectorForColumnAndMeasure=function(t,e,r){void 0===r&&(r=!1);var i,n=Object.keys(t);i=2===n.length?this.createWithIdsAndMeasure(t[n[0]],t[n[1]],e,r):1===n.length?this.createWithIdsAndMeasure(t[n[0]],null,e,r):this.createWithIdsAndMeasure(null,null,e,r);var o={};return _.isEmpty(t)||(o.dataMap=t),e&&(o.metadata=e),t||e||(o=null),i.selectorsByColumn=o,i},e.createWithHighlight=function(t){var r=new e(t.getSelector(),!0);return r.selectorsByColumn=t.selectorsByColumn,r},e.idArray=function(t,e){if(t||e){var r=[];return t&&r.push(t),e&&e!==t&&r.push(e),r}},e}();e.SelectionId=i;var n=function(){function t(){}return t.builder=function(){return new t},t.prototype.withCategory=function(t,e){return t&&t.source&&t.source.queryName&&t.identity&&(this.ensureDataMap()[t.source.queryName]=t.identity[e]),this},t.prototype.withSeries=function(t,e){return t&&t.source&&t.source.queryName&&e&&(this.ensureDataMap()[t.source.queryName]=e.identity),this},t.prototype.withMeasure=function(t){return this.measure=t,this},t.prototype.createSelectionId=function(){return i.createWithSelectorForColumnAndMeasure(this.ensureDataMap(),this.measure)},t.prototype.ensureDataMap=function(){return this.dataMap||(this.dataMap={}),this.dataMap},t}();e.SelectionIdBuilder=n}(e=t.visuals||(t.visuals={}))}(r||(r={}))}});